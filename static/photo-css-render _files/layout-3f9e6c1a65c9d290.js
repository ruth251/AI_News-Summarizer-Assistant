try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c64a7b4b-c066-41e5-8262-3e06e152dc1a",e._sentryDebugIdIdentifier="sentry-dbid-c64a7b4b-c066-41e5-8262-3e06e152dc1a")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8825],{49383:function(e,t,s){Promise.resolve().then(s.bind(s,29702))},81839:function(e,t,s){"use strict";s.d(t,{hO:function(){return d},j1:function(){return m},jZ:function(){return x},ls:function(){return c}});var a=s(99376),r=s(2265),n=s(64040),l=s(49131),i=s(21288),o=s(9568);let c="pending-collaboration-invite",d=()=>{let[e,t]=(0,r.useState)(null);return(0,r.useEffect)(()=>{try{let e=sessionStorage.getItem(c);if(e){let s=JSON.parse(e);t(s)}}catch(e){i.logging.error("Error reading pending collaboration invite:",{error:e})}},[]),{pendingInvite:e,clearPendingInvite:(0,r.useCallback)(()=>{sessionStorage.removeItem(c),t(null)},[])}},u=e=>{let t=new URL((null==e?void 0:e.get("redirect"))?decodeURIComponent(e.get("redirect")):"/",window.location.origin);return t.searchParams.set("should-refresh-credentials","1"),t},m=()=>{let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),{pendingInvite:s,clearPendingInvite:n}=d();return(0,r.useCallback)(a=>{if(s){let e="".concat(s.projectUrl,"?magic_link=").concat(s.magicLink);n(),window.location.href=e;return}let r=u(t),l=new URLSearchParams(t);a?(l.set("redirect",r.pathname+r.search),a.includes("?")?e.push(a+"&".concat(l.toString())):e.push(a+"?".concat(l.toString()))):e.push(r.pathname+r.search),e.refresh()},[e,t,s,n])},x=()=>{let{setIsSuccessfulReferral:e}=(0,o.l)();return(0,r.useCallback)(async(t,s)=>{if(!s)return;let a=(0,l.Tb)();try{let r=await t.getIdToken();await a.post("/user/referral-code/use",{referral_code:s},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}}),e()}catch(t){let e=(0,n.B8)(t);400===e.status&&(e.message=e.message||"Invalid referral code",e.details="Your sign-up will proceed without the referral bonus."),(0,n.Eo)(e)}},[e])}},9568:function(e,t,s){"use strict";s.d(t,{l:function(){return a}});let a=(0,s(59625).Ue)(e=>({shouldShowReferralNotice:!1,setIsSuccessfulReferral:()=>e({shouldShowReferralNotice:!0})}))},29702:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ld}});var a,r,n,l,i,o,c=s(57437),d=s(29827),u=s(21770),m=s(99376),x=s(2265),h=s(14438),p=s(52558),f=s(20958),v=s(27132),g=s(64040),j=s(49131),b=s(24032),y=s(22076),w=s(97318),N=s(46214),_=s(2043),C=s(21288),k=s(49284),E=s(74541),S=s(47176),z=s(74746),I=s(50126),R=s(37675),P=s(10867),D=s(51115),O=s(60256);let T=()=>{let e=(0,x.useRef)({}),t=(0,x.useMemo)(()=>["click","mousemove","keydown","touchstart","touchmove","touchend"],[]),s=(0,x.useCallback)((s,a)=>{let r=new Date().getTime()-s;for(let s of(N.ZP.capture(k.SL.FIRST_INTERACT_AFTER_GEN,{plinged_feature:a,time_to_activity_ms:r}),t))document.removeEventListener(s,e.current[s])},[t]),a=(0,x.useCallback)(a=>{let r=new Date().getTime();for(let n of t){let t=()=>{s(r,a.didPling)};e.current[n]=t,document.addEventListener(n,t)}},[t,s]);return(0,x.useEffect)(()=>()=>{for(let s of t)e.current[s]&&document.removeEventListener(s,e.current[s])},[t]),{startTrackingUserActivity:a}},A=()=>{let{userData:e}=(0,O.SE)(),t=(0,x.useRef)(e);(0,x.useEffect)(()=>{t.current=e},[e]);let{startTrackingUserActivity:s}=T();return{playAudioOnGenerationComplete:(0,x.useCallback)(e=>{var a;let r=t.current,n=null!==(a=null==r?void 0:r.sound_effect_active)&&void 0!==a?a:"firstgen",l=!e.isChatOnly&&"never"!==n&&("always"===n||"firstgen"===n&&!!e.isCreation),i=l;l&&new Audio("/audio/generation-complete.mp3").play().catch(()=>{i=!1}),s({didPling:i})},[s])}};var Z=s(68904),L=s(81839),F=s(65666),M=s(88391),U=s(77113),V=s(62869),W=s(26110),B=s(41135),G=s(30401),J=s(32489),H=s(7455);let K=e=>{let{projectId:t,projectName:s,invitor:a,magicCodeId:r,done:n,onReject:l}=e,[i,o]=(0,x.useState)(!1),u=(0,d.NL)(),{authUser:m}=(0,p.Eu)(),f=(0,H.c)(e=>e.collaborators).find(e=>e.id===(null==m?void 0:m.uid)),v=f&&!f.joined_at,b=async()=>{o(!0);try{if(r){n();return}let e=(0,j.SJ)();await e.put("/projects/".concat(t,"/collaborators/accept-invite")),h.Am.success("Invitation accepted!",{description:'You can now access "'.concat(s,'"')}),await u.invalidateQueries({queryKey:w.iZ.collaborators(t)}),await u.invalidateQueries({queryKey:w.iZ.detail(t)}),n()}catch(e){console.error("Error accepting invite:",e),(0,g.Eo)(e)}finally{o(!1)}},y=async()=>{o(!0);try{if(v){let e=(0,j.SJ)();await e.put("/projects/".concat(t,"/collaborators/reject-invite"))}await u.invalidateQueries({queryKey:w.iZ.collaborators(t)}),null==l||l()}catch(e){(0,g.Eo)(e)}finally{o(!1)}};return(0,c.jsxs)(W.cZ,{className:"gap-4 outline-none focus:ring-0",size:"md",hideCloseButton:!0,blurOverlay:!0,onInteractOutside:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,c.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,c.jsx)(B.xx,{className:"h-9"}),(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{className:"text-2xl md:text-3xl",children:"You've been invited!"}),(0,c.jsxs)(W.Be,{children:["You've been invited to collaborate on \"",s,'"',a&&" by ".concat(a)]})]})]}),(0,c.jsxs)(W.cN,{fullWidthButtons:!0,className:"flex-col gap-2",children:[(0,c.jsxs)(V.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),b()},disabled:i,className:"w-full",children:[(0,c.jsx)(G.Z,{className:"mr-2 h-4 w-4"}),"Accept invitation"]}),(0,c.jsxs)(V.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),y()},disabled:i,className:"w-full",variant:"outline",children:[(0,c.jsx)(J.Z,{className:"mr-2 h-4 w-4"}),"Decline invitation"]})]})]})},q="lovable_collaboration_status",$=()=>{try{let e=localStorage.getItem(q);return e?JSON.parse(e):{}}catch(e){return{}}},Y=(e,t)=>{let s=$()[e];return s&&s.userId===t?Date.now()-s.timestamp>3e5?null:s.isMember:null},X=function(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=$();n[e]={userId:t,isMember:s,joinedAt:a,accessLevel:r,timestamp:Date.now()},localStorage.setItem(q,JSON.stringify(n))},Q=(e,t)=>{let s=$();s[e]&&s[e].userId===t&&(delete s[e],localStorage.setItem(q,JSON.stringify(s)))},ee="magic_link",et=()=>{let{authUser:e}=(0,p.Eu)(),t=(0,m.useRouter)(),s=(0,m.usePathname)(),[a,r]=(0,x.useState)(!1),n=(0,m.useSearchParams)(),l=(0,d.NL)(),i=(0,F.D)(),o=n.get(ee),c=(0,M.z)(K),f=(0,H.c)(e=>e.collaborators),v=(0,H.c)(e=>e.hasFetchedCollaborators),g=f.find(t=>t.id===(null==e?void 0:e.uid)),b=(null==e?void 0:e.uid)?Y(i,e.uid):null,y=g&&g.joined_at,N=null!==b?b:y;(0,x.useEffect)(()=>{if(v&&(null==e?void 0:e.uid)){let s=!!(null==g?void 0:g.joined_at),a=Y(i,e.uid);if(null!==a&&a!==s&&Q(i,e.uid),g){var t;X(i,e.uid,s,(null===(t=g.joined_at)||void 0===t?void 0:t.toString())||null,g.access_level||null)}else!0===a&&Q(i,e.uid)}},[v,null==e?void 0:e.uid,g,i]);let{mutate:_,data:C}=(0,u.D)({mutationFn:async e=>{let{token:t}=e;return(0,j.SJ)().get("/projects/".concat(i,"/magic-codes/").concat(t,"/validate"))},onSuccess:e=>{c({childProps:{projectId:i,projectName:e.project_name,invitor:e.invitor_display_name,magicCodeId:o,done:()=>{k({token:o})},onReject:()=>{z({token:o})}}})},onError:e=>{h.Am.error("Invalid invite link"),t.push("/")}}),{mutate:k}=(0,u.D)({mutationFn:async e=>{let{token:t}=e;return(0,j.SJ)().post("/projects/".concat(i,"/magic-codes/").concat(t,"/accept"))},onSuccess:()=>{(null==e?void 0:e.uid)&&(Q(i,e.uid),X(i,e.uid,!0)),i&&l.invalidateQueries({queryKey:w.iZ.collaborators(i)});let a=new URLSearchParams(n.toString());a.delete(ee),t.replace("".concat(s,"?").concat(a.toString())),h.Am.success("You've joined the project!")}}),[E,S]=(0,x.useState)(new Set),{mutate:z}=(0,u.D)({mutationFn:async e=>{let{token:t}=e;return(0,j.SJ)().post("/projects/".concat(i,"/magic-codes/").concat(t,"/reject"))},onSuccess:()=>{(null==e?void 0:e.uid)&&Q(i,e.uid),o&&S(e=>new Set(e).add(o)),h.Am.info("Invitation declined",{description:"You've declined the invitation to the project"}),c(!1);let a=new URLSearchParams(n.toString());a.delete(ee),t.replace("".concat(s,"?").concat(a.toString()))},onError:e=>{h.Am.error("Failed to decline invitation")}}),I=!!(o&&!e);(0,x.useEffect)(()=>{if(e&&o&&!a){if(E.has(o)){let e=new URLSearchParams(n.toString());e.delete(ee),t.replace("".concat(s,"?").concat(e.toString()));return}if(N){c(!1);let e=new URLSearchParams(n.toString());e.delete(ee),t.replace("".concat(s,"?").concat(e.toString()));return}_({token:o})}},[e,_,a,o,N,n,t,E,s]),(0,x.useEffect)(()=>{if(I){if(o&&i){let e={projectId:i,magicLink:o,timestamp:Date.now(),projectUrl:s};sessionStorage.setItem(L.ls,JSON.stringify(e))}(0,h.Am)("Log in",{description:"You have to log in to join this project"}),t.push("/login?redirect=".concat(s))}},[t,I,o,i,s]);let R=C||!o,{setHasHandledCollaborationInvite:P}=(0,U.d2)();return(0,x.useEffect)(()=>{R&&P(!0)},[R,P]),R};var es=s(44481),ea=s(28667),er=s(57346),en=s(81103),el=s(94508),ei=s(25658),eo=e=>{let{openSidebar:t}=e,s=(0,ei.z)(e=>e.showHistory),{setShowHistory:a}=(0,ei.VF)();return(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",className:(0,el.cn)("bg-transparent hover:bg-transparent md:hover:bg-accent-primary/75 md:hover:text-accent-primary-foreground",s&&"bg-accent-primary text-accent-primary-foreground hover:bg-accent-primary md:hover:bg-accent-primary/75"),onClick:()=>{s||(N.ZP.capture(k.SL.TABS.HISTORY_OPENED),t()),a(e=>!e)},children:(0,c.jsx)(er.Z,{name:"history_2",size:"small"})})}),(0,c.jsx)(en._v,{children:s?"Hide history":"View history"})]})},ec=s(49968),ed=s(95670),eu=s(55721),em=s(67817),ex=s(25057),eh=s(80733),ep=s(3813);function ef(){let{project_id:e}=(0,m.useParams)(),[t,s]=(0,x.useState)(!1),a=(0,U.iZ)(e=>e.project);if(!(0,ep.qT)())return null;let r=async()=>{if(!t)try{s(!0);let t=await eh.g.getValidToken(),r={};t&&(r.Authorization="Bearer ".concat(t));let n=(0,ex.t)(),l=await fetch("".concat(n,"/projects/").concat(e,"/download-zip"),{method:"GET",headers:r,credentials:"include"});if(!l.ok)throw Error("Download failed: ".concat(l.status," ").concat(l.statusText));let i=await l.blob(),o=window.URL.createObjectURL(i),c=document.createElement("a");c.href=o;let d=l.headers.get("Content-Disposition"),u=null==d?void 0:d.match(/filename="(.+)"/),m=(null==a?void 0:a.name)||(null==a?void 0:a.github_repo_name),x=m?"".concat(m,".zip"):"project-".concat(e,".zip"),h=(null==u?void 0:u[1])||x;c.download=h,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)}catch(e){console.error("Error downloading project:",e)}finally{s(!1)}};return(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"secondary",size:"icon-sm",onClick:r,disabled:t,children:(0,c.jsx)(er.Z,{name:"arrow_downward",size:"small"})})}),(0,c.jsx)(en._v,{children:(0,c.jsx)("p",{children:"Download project as ZIP"})})]})}var ev=s(27410),eg=s(29328),ej=e=>{let{open:t,setOpen:s,projectId:a}=e,{authUser:r}=(0,p.Eu)(),n=(0,U.iZ)(e=>e.project),l=(0,em.v)(),{setShowConsole:i}=(0,I.pE)();return(0,c.jsxs)(eu.h_,{open:t,onOpenChange:s,children:[(0,c.jsx)(eu.$F,{asChild:!0,children:(0,c.jsx)("button",{className:"pointer-events-none absolute inset-x-0 select-none bg-transparent text-transparent"})}),(0,c.jsxs)(eu.AW,{className:"z-[1001] flex min-w-[200px] max-w-[250px] flex-col gap-3 rounded-md border bg-background p-4",alignOffset:2,collisionPadding:8,sideOffset:18,children:[(0,c.jsxs)("div",{className:"flex flex-col",children:[(0,c.jsx)("h3",{className:"",children:"Advanced Settings"}),(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:"Developer & debug options."})]}),(l||!1)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ed.Z,{externalHref:(0,ec.U1)(a),iconName:"language",title:"Firestore: Project"},"preview"),(null==n?void 0:n.user_id)&&(null==r?void 0:r.uid)!==(null==n?void 0:n.user_id)&&(0,c.jsx)(ed.Z,{externalHref:(0,ec.fA)(null==n?void 0:n.user_id),iconName:"language",title:"Firestore: User that created this project"},"firestore-user"),(null==r?void 0:r.uid)&&(0,c.jsx)(ed.Z,{externalHref:(0,ec.fA)(null==r?void 0:r.uid),iconName:"language",title:"Firestore: This user"},"firestore-current-user"),(null==n?void 0:n.workspace_id)&&(0,c.jsx)(ed.Z,{externalHref:(0,ec.Ny)(n.workspace_id),iconName:"language",title:"Firestore: Workspace"},"firestore-workspace")]}),!1,l&&(0,c.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,c.jsx)(ef,{}),(0,c.jsx)("p",{children:"Download Project as Zip"})]}),l&&(0,c.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,c.jsx)(V.z,{variant:"secondary",size:"icon-sm",onClick:()=>i("debug"),children:(0,c.jsx)(er.Z,{name:"bug_report",size:"small"})}),(0,c.jsx)("p",{children:"Open Debug Console"})]})]})]})},eb=s(14411),ey=s(47483),ew=s(12285),eN=s(79117),e_=s(33145),eC=s(27648),ek=s(26438),eE=s(5073),eS=s(1828);let ez=[{icon:"code",title:"Smarter Code Edits",description:"90% fewer errors and improved generations."},{icon:"devices",title:"New Capabilities",description:"Web search, image generation and more"},{icon:"trending_up",title:"Adaptive Pricing",description:"Pay based on actions, not messages."}],eI=()=>{let e=(0,ep.zq)(),{isAgentModeDefault:t,setAgentMode:s}=(0,ek.v)(),[a,r]=(0,x.useState)(t);return((0,x.useEffect)(()=>{r(t)},[t]),e)?(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 px-2 py-1.5",children:[(0,c.jsxs)(eE.zs,{children:[(0,c.jsxs)(eE.Yi,{className:"flex w-full cursor-pointer items-center gap-2",children:[(0,c.jsx)(er.Z,{name:"emoji_objects",size:"small"}),(0,c.jsx)("p",{className:"text-sm",children:"Agent Mode"}),(0,c.jsx)(er.Z,{name:"info",className:"text-muted-foreground",size:"small"})]}),(0,c.jsxs)(eE.bZ,{className:"flex w-[560px] max-w-[60vw] gap-0 rounded-2xl p-0",side:"right",sideOffset:64,children:[(0,c.jsx)("div",{className:"relative m-3 hidden w-1/3 md:block",children:(0,c.jsx)(e_.default,{src:"/img/announcements/agent-release.png",alt:"Meet Agent Mode",fill:!0,className:"rounded-md object-cover"})}),(0,c.jsxs)("div",{className:"flex w-2/3 flex-1 flex-col gap-3 p-4 pl-2",children:[(0,c.jsx)("p",{className:"w-full text-2xl font-medium text-card-foreground",children:"Meet Agent Mode (Beta)"}),(0,c.jsx)("p",{className:"w-full text-base text-muted-foreground",children:"Here is what's new:"}),(0,c.jsx)("div",{className:"flex flex-col gap-4",children:ez.map((e,t)=>(0,c.jsxs)("div",{className:"flex items-start gap-3",children:[(0,c.jsx)("div",{className:"mt-0.5 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-secondary",children:(0,c.jsx)(er.Z,{name:e.icon,size:"small",className:"text-secondary-foreground"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-sm font-medium leading-tight text-card-foreground",children:e.title}),(0,c.jsx)("p",{className:"text-sm leading-tight text-muted-foreground",children:e.description})]})]},e.title))}),(0,c.jsx)(V.z,{variant:"secondary",size:"sm",asChild:!0,className:"ml-11 mt-1 w-fit",children:(0,c.jsxs)(eC.default,{href:"https://lovable.dev/blog/agent-mode-beta",target:"_blank",rel:"noopener noreferrer",children:["Read more ",(0,c.jsx)(er.Z,{name:"arrow_outward"})]})})]})]})]}),(0,c.jsx)(eS.r,{checked:a,onCheckedChange:e=>{r(e),s(e)}})]}):null};var eR=s(55157),eP=s(99153),eD=s(93022),eO=s(35354),eT=s(71759),eA=s(48614),eZ=s(1188);let eL=e=>{let{project:t}=e,s=null==t?void 0:t.visibility,a=(0,eg.f6)(e=>"live"===e.visibleMode),r=(0,eg.f6)(e=>"live"!==e.visibleMode&&("live"===e.activeMode||"starting"===e._sandboxState)),n=(0,I.Sl)(e=>e.activeEditId);return t?(0,c.jsx)("div",{className:"flex w-full min-w-0 flex-col items-start gap-0",children:(0,c.jsxs)(eA.M,{mode:"popLayout",initial:!1,children:[(0,c.jsxs)(eZ.E.div,{className:"flex items-center gap-1",layout:"position",transition:{duration:.25,bounce:.1,type:"spring"},layoutDependency:a||n,children:[t&&t.name?(0,c.jsx)("p",{className:"hidden truncate text-sm font-medium leading-none md:block",children:null==t?void 0:t.name}):(0,c.jsx)(eD.O,{className:"hidden h-3 w-[150px] md:flex"}),"public"===s&&(0,c.jsx)(er.Z,{name:"globe",size:"xsmall",className:"hidden md:flex"}),"private"===s&&(0,c.jsx)(er.Z,{name:"lock",size:"xsmall",className:"hidden md:flex"}),(0,c.jsx)(er.Z,{size:"small",name:"keyboard_arrow_down",className:"text-foreground/50 group-data-[state=open]:text-primary"})]},"project-name"),!a&&!n&&(0,c.jsx)(eZ.E.div,{layout:!0,transition:{duration:.3,bounce:0,type:"spring"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,c.jsx)(eA.M,{mode:"wait",initial:!1,children:(0,c.jsx)(eZ.E.p,{className:"hidden w-full min-w-0 truncate text-left text-xs text-muted-foreground md:flex",initial:{y:5,opacity:0},animate:{y:0,opacity:t?1:0},exit:{y:-5,opacity:0},transition:{duration:.15,bounce:0,type:"spring"},children:r?"Loading Live Preview...":"Previewing last saved version"},r?"loading":"saved")})},"status")]})}):(0,c.jsxs)("div",{className:"hidden w-full min-w-0 flex-col items-start gap-1 md:flex",children:[(0,c.jsx)(eD.O,{className:"flex h-3 w-[150px]"}),(0,c.jsx)(eD.O,{className:"flex h-3 w-[125px]"})]})};var eF=e=>{let{}=e,{openSettings:t}=(0,eR.r)(),{authUser:s}=(0,p.Eu)(),a=(0,U.iZ)(e=>e.project),r=null==a?void 0:a.visibility,n=(0,eT.hO)(e=>e.projectWorkspace),{isMac:l}=(0,eO.Z)(),[i,o]=(0,x.useState)(!1),[d,u]=(0,x.useState)(!1),m=(0,em.v)(),{canEdit:h}=(0,_.t)(),[f,v]=(0,x.useState)(!1),g=!!(s&&n&&(null==s?void 0:s.uid)===(null==n?void 0:n.owner_id)),j=(0,ep.F9)();return(0,c.jsxs)("div",{id:"main-menu",className:"relative flex md:min-w-0 md:shrink",children:[(0,c.jsxs)(eu.h_,{children:[(0,c.jsx)(eu.$F,{asChild:!0,onPointerDown:e=>{e.altKey&&(e.preventDefault(),e.stopPropagation(),o(!0),N.ZP.capture(k.SL.HEADER.SETTINGS_OPENED,{project_id:null==a?void 0:a.id}))},children:(0,c.jsxs)("button",{className:"group flex items-center gap-2 border-none text-foreground outline-none duration-150 ease-in-out hover:opacity-80 focus:outline-none md:min-w-0 md:shrink",children:[(0,c.jsx)(B.xx,{className:"h-[18px] w-[18px] shrink-0"}),a&&j?(0,c.jsx)(eL,{project:a}):(0,c.jsxs)(c.Fragment,{children:[a?(0,c.jsx)("p",{className:"hidden truncate text-sm font-medium md:block",children:null==a?void 0:a.name}):(0,c.jsx)(eD.O,{className:"hidden h-3 w-[130px] md:flex"}),"public"===r&&(0,c.jsx)(er.Z,{name:"globe",size:"small",className:"hidden md:flex"}),"private"===r&&(0,c.jsx)(er.Z,{name:"lock",size:"small",className:"hidden md:flex"}),(0,c.jsx)(er.Z,{size:"small",name:"keyboard_arrow_down",className:"text-foreground/50 group-data-[state=open]:text-primary"})]})]})}),(0,c.jsxs)(eu.AW,{className:"min-w-[200px] border md:min-w-[275px]",align:"start",sideOffset:10,children:[(0,c.jsx)(ed.Z,{title:"Go to Dashboard",iconName:"chevron_left",internalHref:"/"},"dashboard"),n&&(0,c.jsx)(eu.VD,{}),n&&(0,c.jsxs)("div",{className:"flex flex-col gap-1.5 px-2 py-1.5",children:[(0,c.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:n.name}),(0,c.jsx)(eb.H,{workspace:n,isOwnerOfWorkspace:g})]}),(0,c.jsx)(eu.VD,{}),(0,c.jsx)(ey.r,{}),(0,c.jsx)(eI,{}),h&&(0,c.jsx)(eu.VD,{}),h&&(0,c.jsxs)(eu.Xi,{onClick:()=>t("project"),children:[(0,c.jsx)(er.Z,{name:"settings"}),(0,c.jsx)("p",{children:"Settings"}),l?(0,c.jsx)(eu.KM,{className:"hidden sm:flex",children:"⌘."}):(0,c.jsx)(eu.KM,{className:"hidden sm:flex",children:"Ctrl."})]}),h&&(0,c.jsx)(ed.Z,{title:"Rename project",iconName:"edit_square",onClick:()=>v(!0)},"rename-project"),(0,c.jsx)(eu.VD,{}),(0,c.jsx)(eP.O,{}),(0,c.jsx)(ed.Z,{title:"Help",iconName:"help",externalHref:"/support"},"help")]})]}),a&&m&&(0,c.jsx)(ej,{open:i,setOpen:o,projectId:a.id}),(0,c.jsx)(ew.O,{projectId:null==a?void 0:a.id,projectName:null==a?void 0:a.name,currentWorkspaceId:null==a?void 0:a.workspace_id,open:d,setOpen:u,isRootDialog:!0}),a&&(0,c.jsx)(eN.i,{project:a,isOpen:f,onClose:()=>v(!1)})]})},eM=s(56613),eU=s(33699),eV=x.memo(e=>{let{children:t,showScrollButtonsInitially:s=!1,className:a}=e,[r,n]=(0,x.useState)(!1),[l,i]=(0,x.useState)(s),[o,d]=(0,x.useState)(s),u=l||o,m=(0,x.useRef)(null),h=()=>{if(!m.current)return;let{scrollLeft:e,scrollWidth:t,clientWidth:s}=m.current;i(e>0),d(e<t-s)};return(0,x.useEffect)(()=>{n(!0),h()},[t]),(0,x.useEffect)(()=>(window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}),[]),(0,c.jsxs)("div",{className:(0,el.cn)("relative flex max-w-full gap-1",a),children:[u&&(0,c.jsx)(V.z,{variant:"ghost",size:"sm",className:(0,el.cn)("absolute left-0 z-10 bg-background px-1 opacity-100 transition-opacity duration-200",{"!opacity-0":!r||!l,"pointer-events-none":!r||!l}),onClick:e=>{e.preventDefault(),m.current&&m.current.scrollTo({behavior:"smooth",left:m.current.scrollLeft-.8*m.current.clientWidth})},children:(0,c.jsx)(er.Z,{name:"chevron_left",size:"small"})}),(0,c.jsx)("div",{ref:m,onScroll:h,className:"w-full overflow-x-auto whitespace-nowrap scrollbar-hide md:overflow-visible",children:t}),u&&(0,c.jsx)(V.z,{variant:"ghost",size:"sm",className:"px-1",disabled:!o,onClick:e=>{e.preventDefault(),m.current&&m.current.scrollTo({behavior:"smooth",left:m.current.scrollLeft+.8*m.current.clientWidth})},children:(0,c.jsx)(er.Z,{name:"chevron_right",size:"small"})})]})}),eW=s(78099);let eB=(0,x.memo)(e=>{let{isSidebarOpen:t,toggleSidebar:s}=e;return(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(V.z,{size:"icon-sm",variant:"ghost",onClick:s,className:(0,el.cn)("hover:bg-muted-hover"),children:(0,c.jsx)(er.Z,{name:t?"dock_to_right-fill":"dock_to_right",size:"small"})})}),(0,c.jsx)(en._v,{children:t?"Hide sidebar":"View sidebar"})]})});eB.displayName="SidebarToggle";var eG=s(27613);let eJ=e=>{let{className:t}=e,{setDevice:s}=(0,eg.My)(),a=(0,eg.f6)(e=>e.device),r=eG.H[a];return(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(V.z,{className:(0,el.cn)(t),variant:"ghost",size:"icon-sm",onClick:()=>{switch(a){case"desktop":s("tablet");break;case"tablet":s("mobile");break;case"mobile":s("desktop")}},children:(0,c.jsx)(er.Z,{name:r.icon,size:"small"})})}),(0,c.jsx)(en._v,{side:"bottom",children:r.tooltip})]})};var eH=s(23518),eK=s(95186),eq=s(57054),e$=s(2925);let eY=()=>{let e=(0,z.IE)();return{pages:e?e.filter(e=>"*"!==e.path):null}},eX=()=>{let{pages:e}=eY(),t=(0,e$.u)(e=>e.setCurrentPage),s=(0,eg.My)().refreshPreview,a=(0,eg.f6)(e=>e.currentPath),r=(0,x.useRef)(null),[n,l]=(0,x.useState)(""),[i,o]=(0,x.useState)(!1),[d,u]=(0,x.useState)(""),[m,h]=(0,x.useState)(!1),p=()=>{o(!1),l(e0(a)),h(!1)},f=function(e){let{onClickOutside:t,enabled:s=!0}=e,a=(0,x.useRef)(null);return(0,x.useEffect)(()=>{if(!s)return;let e=e=>{a.current&&e.target&&!a.current.contains(e.target)&&t()},r=()=>{a.current&&t()};return document.addEventListener("mousedown",e),window.addEventListener("blur",r),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("blur",r)}},[t,s]),a}({onClickOutside:p,enabled:i});(0,x.useEffect)(()=>{t(a||"/")},[a,t]),(0,x.useEffect)(()=>{l(e0(a))},[a]);let v=e0(a),g=e=>{if(!e)return"/";let t=e.replace(/\s+/g,"");return t.startsWith("/")?t:"/".concat(t)},j=(0,x.useMemo)(()=>Array.from(new Set((e||[]).map(e=>e.path))).map(e=>({value:e,label:e})),[e]),b=e=>{e&&(s(e===a?void 0:e),t(e),o(!1))},y=n===a,w=j.some(e=>e.value===n);return(0,c.jsx)("div",{className:"relative min-w-0 flex-1 flex-grow",children:(0,c.jsxs)(eq.J2,{open:i,onOpenChange:o,children:[(0,c.jsx)(eK.I,{ref:r,value:n,onFocus:()=>o(!0),className:"h-auto rounded-none border-none p-0 shadow-none focus-visible:outline-none focus-visible:ring-0",placeholder:v,onKeyDown:e=>{if("Enter"===e.key)e.preventDefault(),b(g(d||n.trim()||"/")),p(),e.target.blur();else if("Escape"===e.key)p(),e.target.blur();else if("ArrowDown"===e.key||"ArrowUp"===e.key){var t;if(e.preventDefault(),0===j.length)return;let s=(j.findIndex(e=>e.value===d)+("ArrowDown"===e.key?1:-1)+j.length)%j.length;u((null===(t=j[s])||void 0===t?void 0:t.value)||"")}},onChange:e=>{i||o(!0);let t=e.target.value;l(t);let s=t!==e0(a);!m&&s&&h(!0)}}),(0,c.jsx)(eq.xo,{className:"sr-only w-full"}),(0,c.jsx)(eq.yk,{className:(0,el.cn)("bg-popover p-0",!i&&"hidden"),onOpenAutoFocus:e=>e.preventDefault(),ref:f,sideOffset:8,style:{width:"calc(var(--radix-popover-trigger-width) + 32px)"},align:"start",alignOffset:-12,children:(0,c.jsxs)(eH.mY,{value:d,onValueChange:u,children:[(0,c.jsx)("div",{tabIndex:-1,className:"pointer-events-none hidden",inert:!0,children:(0,c.jsx)(eH.sZ,{value:m?n:""})}),(0,c.jsx)(eH.e8,{children:j.length>0&&(0,c.jsxs)(eH.fu,{children:[!y&&!w&&""!==n&&(0,c.jsx)(eH.di,{value:n,onSelect:b,keywords:[n],className:"w-full overflow-hidden",children:(0,c.jsx)("span",{className:"min-w-0 max-w-full overflow-hidden pr-2",children:n})}),j.map(e=>{let t=a===e.value,s=eQ(a,e.value);return(0,c.jsxs)(eH.di,{value:e.value,onSelect:b,keywords:[e.label],children:[e.label,(0,c.jsx)(er.Z,{name:"check",className:(0,el.cn)("ml-auto",t||s?"opacity-100":"opacity-0")})]},e.value)})]})})]})})]})})};function eQ(e,t){e.endsWith("/")&&(e=e.slice(0,-1)),t.endsWith("/")&&(t=t.slice(0,-1));let s=e.split("/"),a=t.split("/");if(s.length!==a.length)return!1;for(let e=0;e<s.length;e++){let t=s[e],r=a[e];if(t!==r&&!r.startsWith(":"))return!1}return!0}function e0(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?(e.endsWith("/")&&(e=e.slice(0,-1)),e.startsWith("/")||(e="/"+e),e):"/"}var e1=s(61922),e2=s(76906);let e5=()=>{let e=(0,U.iZ)(e=>e.project),t=(0,e1.aS)(e=>e.currentWorkspace),s=(null==t?void 0:t.disable_named_previews)?(0,e2.t)({projectId:null==e?void 0:e.id}):(null==e?void 0:e.name)?(0,e2.t)({projectName:null==e?void 0:e.name}):"#",a=!(null==e?void 0:e.preview_build_commit_sha),{buildFullPreviewUrl:r}=(0,eg.My)(),n=r({baseUrl:s,path:(0,eg.f6)(e=>e.currentPath)}),l=a?void 0:n;return{openPreview:e=>{if(a){e.preventDefault();return}e.altKey&&l&&(e.preventDefault(),window.open(l,"_blank"))},disabledState:a?{disabled:!0,reason:"There is no preview build to open yet"}:void 0,previewUrl:null!=l?l:void 0}},e4=e=>{let{openPreview:t,disabledState:s,previewUrl:a}=e5(),r=(0,v.Z)("md");return s?(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)("span",{children:(0,c.jsx)(V.z,{disabled:s.disabled,...e,children:(0,c.jsx)(er.Z,{name:"arrow_outward",size:"small"})})})}),(0,c.jsx)(en._v,{side:"bottom",align:"center",children:s.reason})]}):r?(0,c.jsx)(V.z,{...e,asChild:!0,children:(0,c.jsx)("a",{href:a,target:"_blank",rel:"noreferrer",onClick:t,children:(0,c.jsx)(er.Z,{name:"arrow_outward"})})}):(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(V.z,{...e,asChild:!0,children:(0,c.jsx)("a",{href:a,target:"_blank",rel:"noreferrer",onClick:t,children:(0,c.jsx)(er.Z,{name:"arrow_outward",size:"small"})})})}),(0,c.jsx)(en._v,{side:"bottom",align:"center",children:"Open preview in new tab"})]})};var e3=s(42503),e6=s(22287);function e8(e){var t;let{className:s}=e,a=(0,U.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.preview_build_commit_sha}),r=(0,eg.f6)(e=>"live"===e.visibleMode),n=(0,eg.f6)(e=>"live"!==e.visibleMode&&("live"===e.activeMode||"starting"===e._sandboxState)),{snapshot:l}=(0,z.mx)(),i=(0,x.useMemo)(()=>a?l.getEditByShortCommitHash(a.slice(0,7)):null,[a,l]);return(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{className:(0,el.cn)("cursor-default",s),children:n?(0,c.jsx)(e6.$,{variant:"ring",size:"default"}):r?null:(0,c.jsx)(er.Z,{name:"history_toggle_off",size:"small"})}),(0,c.jsx)(en._v,{className:"max-w-[30ch]",children:n?(0,c.jsx)("p",{children:"Starting Live Preview..."}):r?(0,c.jsx)("p",{children:"Live Preview"}):(0,c.jsxs)("p",{children:["Showing"," ",(0,c.jsx)("span",{className:"font-medium",children:null!==(t=null==i?void 0:i.commit_message)&&void 0!==t?t:"previous version"}),(null==i?void 0:i.created_at)?" (".concat((0,e3.l)(i.created_at.toDate(),new Date),")"):""]})})]})}let e9=()=>{let{refreshPreview:e}=(0,eg.My)(),[t,s]=(0,x.useState)(!1),a=(0,ep.Cb)(),r=(0,ep.F9)();return(0,c.jsxs)("div",{id:"preview-url-bar",className:"relative flex min-w-0 flex-1 flex-grow flex-row-reverse items-center gap-2 md:flex-auto md:flex-row",children:[!r&&(0,c.jsx)(e8,{}),(0,c.jsxs)("div",{className:"relative flex h-8 min-w-[150px] flex-grow items-center justify-between gap-2 rounded-lg border border-input px-1 text-sm @xl:min-w-[250px]",children:[(0,c.jsx)(eJ,{className:"hidden h-6 w-6 p-1 hover:bg-muted md:flex"}),(0,c.jsx)("div",{className:"flex-grow",children:(0,c.jsx)(eX,{})}),!!a&&(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(e4,{variant:"ghost",size:"icon-xs",className:"h-6 w-6 p-1 hover:bg-muted"}),(0,c.jsx)(ev.Z,{label:"Refresh page",children:(0,c.jsx)(V.z,{variant:"ghost",size:"icon-xs",className:"h-6 w-6 p-1 hover:bg-muted",onClick:()=>{s(!0),e(),setTimeout(()=>{s(!1)},1e3)},disabled:t,children:(0,c.jsx)(er.Z,{name:"refresh",size:"small",className:t?"animate-spin":""})})})]})]})]})};var e7=s(1266),te=s(92850),tt=s(76003),ts=s(78298),ta=s(60254),tr=s(12339),tn=s(33187),tl=s(63420),ti=s(73521),to=s(85755),tc=s(93252),td=s(67457);let tu=(0,td.P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#2d333b",caret:"#c9d1d9",foreground:"#c9d1d9",gutterActiveForeground:"#c9d1d9",gutterForeground:"#6e7681",gutterBorder:"#21262d",lineHighlight:"#c9d1d910",selectionMatch:"#3392FF44"},styles:[{tag:tc.pJ.comment,color:"#8b949e"},{tag:tc.pJ.variableName,color:"#c9d1d9"},{tag:[tc.pJ.string,tc.pJ.special(tc.pJ.brace)],color:"#a5d6ff"},{tag:tc.pJ.number,color:"#79c0ff"},{tag:tc.pJ.bool,color:"#ff7b72"},{tag:tc.pJ.null,color:"#ff7b72"},{tag:tc.pJ.keyword,color:"oklch(0.833 0.145 321.434)"},{tag:tc.pJ.operator,color:"#ff7b72"},{tag:tc.pJ.className,color:"#ffa657"},{tag:tc.pJ.definition(tc.pJ.typeName),color:"#ffa657"},{tag:tc.pJ.typeName,color:"#ffa657"},{tag:tc.pJ.angleBracket,color:"#7ee787"},{tag:tc.pJ.tagName,color:"#7ee787"},{tag:tc.pJ.attributeName,color:"#79c0ff"},{tag:tc.pJ.function(tc.pJ.variableName),color:"#d2a8ff"},{tag:tc.pJ.function(tc.pJ.propertyName),color:"#d2a8ff"},{tag:tc.pJ.squareBracket,color:"#c9d1d9"},{tag:tc.pJ.brace,color:"#c9d1d9"}]}),tm=(0,td.P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#C7E4FF",caret:"#24292e",foreground:"#24292e",gutterActiveForeground:"#24292e",gutterForeground:"#57606a",gutterBorder:"#e8eaed",lineHighlight:"#2437921a",selectionMatch:"#3392FF33"},styles:[{tag:tc.pJ.comment,color:"#6e7781"},{tag:tc.pJ.variableName,color:"#24292e"},{tag:[tc.pJ.string,tc.pJ.special(tc.pJ.brace)],color:"#0a3069"},{tag:tc.pJ.number,color:"#0550ae"},{tag:tc.pJ.bool,color:"#cf222e"},{tag:tc.pJ.null,color:"#cf222e"},{tag:tc.pJ.keyword,color:"#3479E5"},{tag:tc.pJ.operator,color:"#cf222e"},{tag:tc.pJ.className,color:"#953800"},{tag:tc.pJ.definition(tc.pJ.typeName),color:"#953800"},{tag:tc.pJ.typeName,color:"#953800"},{tag:tc.pJ.angleBracket,color:"#116329"},{tag:tc.pJ.tagName,color:"#116329"},{tag:tc.pJ.attributeName,color:"#0550ae"},{tag:tc.pJ.function(tc.pJ.variableName),color:"#8250df"},{tag:tc.pJ.function(tc.pJ.propertyName),color:"#8250df"},{tag:tc.pJ.squareBracket,color:"#24292e"},{tag:tc.pJ.brace,color:"#24292e"},{tag:[tc.pJ.name,tc.pJ.deleted,tc.pJ.character,tc.pJ.propertyName,tc.pJ.macroName],color:"#0E7490"},{tag:[tc.pJ.meta],color:"#0E7490"},{tag:[tc.pJ.definition(tc.pJ.name),tc.pJ.separator],color:"#a3be8c"},{tag:[tc.pJ.operator,tc.pJ.operatorKeyword],color:"#15803D"},{tag:[tc.pJ.string],color:"#15803D"},{tag:tc.pJ.link,color:"#15803D",textDecoration:"underline",textUnderlinePosition:"under"}]}),tx=[(0,to.eJ)({jsx:!0,typescript:!0}),(0,ti.dy)({autoCloseTags:!0})];var th=s(15345),tp=s.n(th);let tf=(0,x.createContext)({currentFile:null,states:{},openTabs:[],setCurrentFile:()=>{},setStates:()=>{},setOpenTabs:()=>{}});function tv(e){let{children:t}=e,[s,a]=(0,x.useState)(null),[r,n]=(0,x.useState)({}),[l,i]=(0,x.useState)([]),o=(0,x.useMemo)(()=>({currentFile:s,setCurrentFile:a,states:r,setStates:n,openTabs:l,setOpenTabs:i}),[s,r,l]);return(0,c.jsx)(tf.Provider,{value:o,children:t})}let tg=()=>{let e=(0,x.useContext)(tf);if(void 0===e)throw Error("useCodeEditor must be used within a CodeEditorProvider");return e};function tj(e){var t;let{node:s,setCurrentFile:a,currentFile:r,level:n}=e,[l,i]=(0,x.useState)(n<1),o=null===(t=s.children)||void 0===t?void 0:t.sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name));return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:(0,el.cn)("group flex cursor-pointer items-center px-2 py-1 text-sm hover:bg-primary/25",r===s.path&&"!bg-accent/50"),onClick:()=>{"directory"===s.type?i(!l):a(s.path)},role:"button",tabIndex:0,children:[(0,c.jsx)("div",{className:"mr-1 flex-shrink-0",style:{marginLeft:16*n},children:"directory"===s.type?(0,c.jsx)(er.Z,{name:"chevron_right",size:"default",className:(0,el.cn)("transition-transform duration-200",{"rotate-90":l})}):null}),"directory"!==s.type&&(0,c.jsx)("div",{className:"mr-1 h-4 w-4 flex-shrink-0",children:(0,c.jsx)(er.Z,{name:"docs",size:"small"})}),(0,c.jsx)("span",{className:"truncate",children:s.name})]}),"directory"===s.type&&l&&o&&(0,c.jsx)("div",{children:o.map(e=>(0,c.jsx)(tj,{node:e,setCurrentFile:a,currentFile:r,level:n+1},e.path))})]})}function tb(e){let{setCurrentFile:t,code:s,currentFile:a}=e,r=(function(e){let t=[];return e.forEach(e=>{let[s]=e,a=s.split("/"),r=t;a.forEach((e,t)=>{let s=t===a.length-1,n=r.find(t=>t.name===e),l=a.slice(0,t+1).join("/");if(n)s||(r=n.children);else{let t={name:e,path:l,type:s?"file":"directory",...s?{}:{children:[]}};r.push(t),s||(r=t.children)}})}),t})(s).sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name));return(0,c.jsx)("div",{className:"overflow-x-auto p-2",children:r.map(e=>(0,c.jsx)(tj,{node:e,setCurrentFile:t,currentFile:a,level:0},e.path))})}var ty=s(32429),tw=s(82176),tN=s(10531);function t_(){var e;let t=!!(null===(e=(0,ty.G)().features)||void 0===e?void 0:e.code_editor),s=(0,tw.dl)(tN.P.CodeEditorWrite);return t||s}let tC=()=>{let e=t_(),t=(0,eT.hO)(e=>e.projectWorkspace),s=(null==t?void 0:t.plan)!=="free"&&(null==t?void 0:t.plan)!=="inactive";return e||s};function tk(e){let{}=e,[t,s]=(0,x.useState)(!1),{setActiveView:a}=(0,I.pE)(),r=(0,F.D)(),{syncCode:n,hasUnsavedChanges:l,enableServer:i}=(0,tl.v)(),o=(0,ta.A7)(e=>e.clearPendingChanges),{snapshot:d}=(0,ta.ag)(),{openSettings:u}=(0,eR.r)(),m=tC(),p=(0,x.useCallback)(async()=>{s(!0);try{let e=d.getPendingChanges();N.ZP.capture(k.SL.CODE_EDITOR.SAVED,{projectId:r,editedFiles:e}),await n(e,{commitMessage:"Code edited in Lovable Code Editor"}),o(),h.Am.success("Changes saved"),a("preview")}finally{s(!1)}i()},[o,i,r,a,d,n]),f=(0,x.useCallback)(()=>{N.ZP.capture(k.SL.CODE_EDITOR.DISCARDED,{projectId:r}),o()},[o,r]);return m?(0,c.jsx)(eA.M,{children:l&&(0,c.jsxs)(eZ.E.div,{initial:{y:"150%"},animate:{y:0},exit:{y:"150%"},transition:{type:"spring",duration:.15,bounce:.25},className:"flex w-full items-center justify-end gap-2",children:[(0,c.jsx)("div",{className:"text-sm text-foreground",children:"You have unsaved changes"}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(V.z,{variant:"secondary",size:"sm",onClick:f,disabled:t,children:"Discard"}),(0,c.jsx)(V.z,{variant:"affirmative",size:"sm",onClick:p,loading:t,disabled:t,children:"Save"})]})]})}):(0,c.jsxs)("div",{className:"flex items-center gap-1 text-center text-sm text-muted-foreground",children:[(0,c.jsx)("span",{children:"Read Only. To use the code editor, "}),(0,c.jsx)("span",{className:"cursor-pointer font-medium text-affirmative-primary hover:text-affirmative-primary/80",onClick:()=>u("billing"),children:"upgrade to a paid plan."})]})}let tE={history:e7.cE},tS=["tailwind.config.lov.json","package-lock.json","bun.lockb","vite-env.d.ts"],tz=(e,t)=>e.filter(e=>{let[s]=e;return!tS.some(e=>s.includes(e))&&(!t||s.toLowerCase().includes(t.toLowerCase()))}),tI=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s=(0,z.aK)(e=>Object.keys(e.edits||{}).length),{data:a,isFetching:r,refetch:n}=(0,te.a)(tn.W.sourceCode({projectId:e,enabled:t}));return(0,x.useEffect)(()=>{s>0&&!r&&n().catch(t=>{C.logging.error("Error refetching source code",{error:t,projectId:e})})},[s,n]),(0,x.useMemo)(()=>{var e;return null==a?void 0:null===(e=a.files)||void 0===e?void 0:e.filter(e=>{let{binary:t}=e;return!t}).map(e=>{let{name:t,contents:s}=e;return[t,s]})},[a])};function tR(e){let{projectId:t}=e,{code:s,hasInitialCode:a,addPendingChange:r}=(0,tl.v)(),{currentFile:n,setCurrentFile:l,states:i,setStates:o,openTabs:d,setOpenTabs:u}=tg(),m=(0,ta.A7)(e=>e.pendingChanges),h=tI(t,!a),p=(0,x.useMemo)(()=>a?s:h,[h,a,s]),f=null==p?void 0:p.length;(0,x.useEffect)(()=>{if(n||!f)return;let e=null==p?void 0:p.find(e=>{let[t,s]=e;return t.endsWith("pages/Index.tsx")});e&&l(e[0])},[f]);let v=tC(),g=(0,x.useMemo)(()=>{var e;if(n)return n in m?m[n]:null==p?void 0:null===(e=p.find(e=>{let[t,s]=e;return t===n}))||void 0===e?void 0:e[1]},[p,n,m]),[j,b]=(0,x.useState)(""),y=(0,x.useMemo)(()=>tz(null!=p?p:[],j),[p,j]),{startLiveMode:w}=(0,eg.My)();(0,x.useEffect)(()=>{n&&!d.includes(n)&&u([...d,n])},[n,d,u]);let N=(0,x.useCallback)((e,t)=>{e&&(r(e,t),w())},[r,w]),{resolvedTheme:_}=(0,ts.F)(),C=(0,ep.qT)();return(0,c.jsxs)("div",{className:"relative flex h-full w-full",children:[(0,c.jsxs)("div",{className:"flex h-full w-64 flex-shrink-0 flex-grow-0 flex-col border-r border-border",children:[(0,c.jsxs)("div",{className:"flex-grow overflow-y-auto pb-12",children:[(0,c.jsx)("div",{className:"p-2",children:(0,c.jsx)(eK.I,{placeholder:"Search",value:j,onChange:e=>b(e.target.value)})}),f?(0,c.jsx)(tb,{setCurrentFile:l,currentFile:n,code:y}):(0,c.jsx)("div",{className:"flex items-center justify-center pb-16",children:(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:"Starting Live Preview..."})})]}),C&&(0,c.jsxs)("div",{className:"flex min-h-12 flex-shrink-0 items-center gap-2 p-2",children:[(0,c.jsx)(ef,{}),(0,c.jsx)("span",{className:"text-sm text-muted-foreground",children:"Download codebase"})]})]}),(0,c.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden bg-muted p-0",children:[(0,c.jsx)(tr.mQ,{value:n||"",onValueChange:l,className:(0,el.cn)({hidden:!n}),children:(0,c.jsx)(tr.dr,{className:"h-auto w-full justify-start overflow-x-auto rounded-none bg-background p-0 scrollbar-hide",children:d.map(e=>(0,c.jsxs)(tr.SP,{value:e,className:"group relative rounded-none border-r px-2 pl-3 data-[state=active]:!bg-muted-active data-[state=active]:text-foreground hover:bg-muted/50","data-state":n===e?"active":"inactive",children:[(0,c.jsx)("span",{children:e}),(0,c.jsx)("button",{onClick:t=>{t.stopPropagation(),t.preventDefault(),u(d.filter(t=>t!==e)),n===e&&l(d.find(t=>t!==e)||null)},className:"ml-2 opacity-0 transition-opacity group-hover:opacity-100 group-data-[state=active]:opacity-100",children:(0,c.jsx)(er.Z,{name:"close",className:"size-4"})})]},e))})}),(0,c.jsx)("div",{className:(0,el.cn)("flex w-full flex-1 overflow-y-auto bg-muted",tp().editor),children:n&&(0,c.jsx)(tt.ZP,{readOnly:!v,initialState:i[n]?{json:i[n],fields:tE}:void 0,onChange:(e,t)=>{if(n){let e=t.state.toJSON(tE);o(t=>({...t,[n]:e}))}N(n,e)},value:g,className:"flex-1 overflow-y-auto",theme:"dark"===_?tu:tm,extensions:[...tx,tt.tk.editable.of(!!v)]},n)})]})]})}let tP=()=>"dev-mode"===(0,I.Sl)(e=>e.activeView)?(0,c.jsx)(tk,{}):(0,c.jsx)(e9,{}),tD=()=>{let e=(0,eg.My)().refreshPreview,t=()=>e();return(0,c.jsx)(ev.Z,{label:"Refresh page",children:(0,c.jsx)(V.z,{variant:"secondary",size:"icon-sm",onClick:()=>t(),children:(0,c.jsx)(er.Z,{name:"refresh",size:"small"})})})};var tO=s(63611),tT=s(50273),tA=()=>{let e=(0,I.Sl)(e=>e.activeView),{setConsoleContentType:t,setActiveView:s}=(0,I.pE)(),{hasUnsavedChanges:a}=(0,tl.v)(),r=(0,tT.UC)(e=>e.isVisualEditingActive),n=(0,ep.F9)(),l=(0,ep.ty)(),i=a&&"seo"===e||r,o="seo"===e;return l?(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{className:i?"cursor-default":"cursor-pointer",children:n?(0,c.jsx)(V.z,{type:"button",variant:"outline",size:"icon-sm",onClick:()=>{s(o?"preview":"seo"),t(null),o||N.ZP.capture(k.Md.OPEN_TOP_MENU)},"aria-label":"SEO Mode",disabled:i,className:(0,el.cn)("hidden bg-background shadow-none md:flex",{"bg-affirmative-primary text-affirmative-primary-foreground hover:bg-affirmative-primary/90":o}),children:(0,c.jsx)(er.Z,{name:"search",className:"h-4 w-4"})}):(0,c.jsx)("div",{className:"pointer-events-none hidden h-full items-center justify-center md:flex",children:(0,c.jsx)(tO.Z,{disabled:i,"aria-label":"SEO Mode",pressed:o,onPressedChange:e=>{s(e?"seo":"preview"),t(null),e&&N.ZP.capture(k.Md.OPEN_TOP_MENU)},className:(0,el.cn)("pointer-events-auto h-7 rounded-lg bg-muted p-[2px] transition-colors duration-150 ease-in-out",o?"bg-affirmative-primary data-[state=on]:bg-affirmative-primary hover:bg-affirmative-primary/80":"hover:bg-muted-hover"),size:"sm",children:(0,c.jsx)("div",{className:"relative h-full w-10",children:(0,c.jsx)(eZ.E.div,{className:"absolute flex aspect-square h-full items-center justify-center rounded-md bg-background text-foreground shadow-sm",animate:{right:o?0:"unset",left:"preview"===e?0:"unset"},transition:{duration:.15,bounce:0,type:"spring"},children:(0,c.jsx)(er.Z,{name:"search"})})})})})}),(0,c.jsx)(en._v,{children:r?"Exit visual editor to use SEO mode":a?"Please save or discard your changes":"SEO Mode"})]}):null},tZ=()=>{let e=(0,I.Sl)(e=>e.activeView),{setConsoleContentType:t,setActiveView:s}=(0,I.pE)(),{hasUnsavedChanges:a}=(0,tl.v)(),r=t_()?"Code mode":"Code viewer",n=(0,tT.UC)(e=>e.isVisualEditingActive),l=(0,ep.F9)(),i=a&&"dev-mode"===e||n,o="dev-mode"===e;return(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{className:i?"cursor-default":"cursor-pointer",children:l?(0,c.jsx)(V.z,{type:"button",variant:"outline",size:"icon-sm",onClick:()=>{s(o?"preview":"dev-mode"),t(null),N.ZP.capture(k.SL.CODE_EDITOR.DEV_MODE_TOGGLE_PRESSED,{devModeIsActive:o,new_tab:o?"code":"preview"})},"aria-label":r,disabled:i,className:(0,el.cn)("hidden bg-background shadow-none md:flex",{"bg-affirmative-primary text-affirmative-primary-foreground hover:bg-affirmative-primary/90":o}),children:(0,c.jsx)(er.Z,{name:"code",className:"h-4 w-4"})}):(0,c.jsx)("div",{className:"pointer-events-none hidden h-full items-center justify-center md:flex",children:(0,c.jsx)(tO.Z,{disabled:i,"aria-label":r,pressed:o,onPressedChange:e=>{s(e?"dev-mode":"preview"),t(null),N.ZP.capture(k.SL.CODE_EDITOR.DEV_MODE_TOGGLE_PRESSED,{pressed:e,new_tab:e?"code":"preview"})},className:(0,el.cn)("pointer-events-auto h-7 rounded-lg bg-muted p-[2px] transition-colors duration-150 ease-in-out",o?"bg-affirmative-primary data-[state=on]:bg-affirmative-primary hover:bg-affirmative-primary/80":"hover:bg-muted-hover"),size:"sm",children:(0,c.jsx)("div",{className:"relative h-full w-10",children:(0,c.jsx)(eZ.E.div,{className:"absolute flex aspect-square h-full items-center justify-center rounded-md bg-background text-foreground shadow-sm",animate:{right:o?0:"unset",left:"preview"===e?0:"unset"},transition:{duration:.15,bounce:0,type:"spring"},children:(0,c.jsx)(er.Z,{name:"code"})})})})})}),(0,c.jsx)(en._v,{children:n?"Exit visual editor to use code mode":a?"Please save or discard your changes":r})]})};let tL=()=>{let e=(0,ep.Cb)(),t=(0,ep.ty)();return(0,c.jsxs)("div",{className:"flex items-center gap-1",children:[!!e&&(0,c.jsx)(tZ,{}),t&&(0,c.jsx)(tA,{}),!e&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tD,{}),(0,c.jsx)(e4,{variant:"secondary",size:"icon-sm"})]})]})};var tF=s(62380),tM=s(38343),tU=s(6809);let tV=e=>{let{title:t,description:s,badge:a}=e;return(0,c.jsxs)("div",{className:"flex flex-col gap-1 p-4 pb-2",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,c.jsx)("h3",{className:"mt-0 leading-none",children:t}),a]}),s&&(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:s})]})},tW=e=>{let{href:t}=e;return(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",asChild:!0,children:(0,c.jsx)("a",{href:t,target:"_blank",className:"text-muted-foreground",children:(0,c.jsx)(er.Z,{name:"help",size:"small"})})})},tB=e=>[{name:"Manage Users",href:"https://supabase.com/dashboard/project/".concat(e,"/auth/users"),icon:"group"},{name:"SQL Editor",href:"https://supabase.com/dashboard/project/".concat(e,"/editor"),icon:"database"},{name:"Edge Functions",href:"https://supabase.com/dashboard/project/".concat(e,"/functions"),icon:"cloud"},{name:"Manage Secrets",href:"https://supabase.com/dashboard/project/".concat(e,"/settings/functions"),icon:"key"}];var tG=e=>{var t;let{disabled:s=!1}=e,[a,r]=(0,x.useState)(!1),{openSettings:n}=(0,eR.r)(),l=(0,tU.N)(),i=tB(null!==(t=null==l?void 0:l.id)&&void 0!==t?t:"");return(0,c.jsxs)(eu.h_,{open:a,onOpenChange:r,children:[(0,c.jsx)(eu.$F,{disabled:s,children:(0,c.jsx)(tJ,{disabled:s})}),(0,c.jsx)(eu.AW,{collisionPadding:8,className:"z-[1001] min-w-[300px] max-w-[300px] border border-border bg-background p-0",children:l?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tV,{title:"Supabase",badge:(0,c.jsx)(tM.n,{status:l.status})}),(0,c.jsx)(eu.VD,{}),(0,c.jsx)("div",{className:"flex flex-col gap-1 px-2 py-0.5",children:(0,c.jsx)(eu.Xi,{asChild:!0,children:(0,c.jsxs)("a",{href:"https://supabase.com/dashboard/project/".concat(l.id),target:"_blank",rel:"noreferrer",className:"font-medium",children:[(0,c.jsx)(B.xR.Supabase,{className:"h-4 w-4"}),(0,c.jsx)("span",{children:l.name}),(0,c.jsx)(er.Z,{name:"arrow_outward",className:"ml-auto text-muted-foreground",size:"small"})]})})}),(0,c.jsx)(eu.VD,{}),(0,c.jsx)("div",{className:"flex flex-col gap-1 px-2 py-0.5",children:i.map(e=>(0,c.jsx)(eu.Xi,{asChild:!0,children:(0,c.jsxs)("a",{href:e.href,target:"_blank",rel:"noreferrer",className:"font-medium",children:[(0,c.jsx)(er.Z,{name:e.icon,className:"h-4 w-4"}),(0,c.jsx)("span",{children:e.name}),(0,c.jsx)(er.Z,{name:"arrow_outward",className:"ml-auto text-muted-foreground",size:"small"})]})},e.name))}),(0,c.jsx)(eu.VD,{}),(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-2.5 pl-2.5 pr-4 pt-1.5",children:[(0,c.jsx)(tW,{href:"https://docs.lovable.dev/integrations/supabase"}),(0,c.jsx)(V.z,{variant:"default",size:"sm",onClick:()=>{n("supabase"),r(!1)},children:"Configure"})]})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tV,{title:"Supabase",description:"Integrate user authentication, data storage, and backend capabilities."}),(0,c.jsx)(eu.VD,{}),(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-2.5 pl-2.5 pr-4 pt-1.5",children:[(0,c.jsx)(tW,{href:"https://docs.lovable.dev/integrations/supabase"}),(0,c.jsxs)(V.z,{onClick:()=>{n("supabase"),r(!1)},size:"sm",children:[(0,c.jsx)(B.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]})]})]})})]})};let tJ=e=>{let{onClick:t,disabled:s=!1}=e;return(0,c.jsx)(ev.Z,{label:"Manage Supabase",children:(0,c.jsx)(V.z,{id:"supabase-dropdown",className:"",variant:"secondary",size:"icon-sm",onClick:t,disabled:s,children:(0,c.jsx)(tF.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"})})})};var tH=s(48581),tK=s(32129),tq=s(46170),t$=s(23590),tY=s(4310),tX=s(27058),tQ=e=>{var t,s,a,r;let{disabled:n=!1}=e,l=(0,U.iZ)(e=>e.project),i=(null==l?void 0:l.name)?(0,tY.c_)(l.github_repo_name,null==l?void 0:null===(t=l.github_owner)||void 0===t?void 0:t.name):"#",o=(null==l?void 0:null===(s=l.github_owner)||void 0===s?void 0:s.name)+"/"+(null==l?void 0:l.github_repo_name),{openSettings:d}=(0,eR.r)(),u=(null==l?void 0:null===(a=l.github_owner)||void 0===a?void 0:a.name)&&l.github_owner.name!==tY.aR,[m,h]=(0,x.useState)(!1);return(0,c.jsxs)(eu.h_,{open:m,onOpenChange:h,children:[(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(eu.$F,{asChild:!0,disabled:n,children:(0,c.jsxs)(V.z,{variant:"secondary",size:"icon-sm",className:"gap-1.5",children:[(0,c.jsx)(B.xR.GitHub,{className:"size-4"}),(0,c.jsx)("span",{className:"hidden",children:(null==l?void 0:null===(r=l.github_owner)||void 0===r?void 0:r.name)&&!(l.github_owner.name!==tY.aR)?"Sync with GitHub":"Manage GitHub"})]})})}),(0,c.jsx)(en._v,{children:"Sync your project to GitHub"})]}),(0,c.jsx)(eu.AW,{className:"z-[1001] min-w-[300px] max-w-[300px] border border-border bg-background p-0",collisionPadding:8,onCloseAutoFocus:e=>e.preventDefault(),children:l&&!u?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tV,{title:"GitHub",description:"Sync your project 2-way with GitHub to collaborate at source."}),(0,c.jsx)(eu.VD,{}),(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-2.5 pl-2.5 pr-4 pt-1.5",children:[(0,c.jsx)(tW,{href:"https://docs.lovable.dev/integrations/git-integration"}),(0,c.jsxs)(V.z,{variant:"default",size:"sm",onClick:()=>d("github"),children:[(0,c.jsx)(B.xR.GitHub,{className:"size-4"}),(0,c.jsx)("span",{children:"Connect GitHub"})]})]})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tV,{title:"GitHub",badge:(0,c.jsx)(tX.H,{status:"connected"})}),(0,c.jsx)(eu.VD,{}),(0,c.jsx)("div",{className:"px-2 py-0.5",children:(0,c.jsx)(eu.Xi,{asChild:!0,children:(0,c.jsxs)("a",{href:i,target:"_blank",rel:"noreferrer",className:"font-medium",children:[(0,c.jsx)(B.xR.GitHub,{className:"h-4 w-4"}),(0,c.jsx)("span",{children:o}),(0,c.jsx)(er.Z,{name:"arrow_outward",className:"ml-auto text-muted-foreground",size:"small"})]})})}),(0,c.jsx)(eu.VD,{}),(0,c.jsx)("div",{className:"px-2 py-0.5",children:(0,c.jsx)(eu.Xi,{asChild:!0,children:(0,c.jsxs)("a",{href:"https://github.dev/".concat(o,"?").concat((null==l?void 0:l.main_branch)?"tree/".concat(null==l?void 0:l.main_branch):""),target:"_blank",rel:"noreferrer",className:"font-medium",children:[(0,c.jsx)(er.Z,{name:"code",size:"small"}),(0,c.jsx)("span",{children:"Edit in VS Code"}),(0,c.jsx)(er.Z,{name:"arrow_outward",className:"ml-auto text-muted-foreground",size:"small"})]})})}),(0,c.jsx)(eu.VD,{}),(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-2.5 pl-2.5 pr-4 pt-1.5",children:[(0,c.jsx)(tW,{href:"https://docs.lovable.dev/integrations/git-integration"}),(0,c.jsx)(V.z,{variant:"default",size:"sm",onClick:()=>{d("github"),h(!1)},children:"Configure"})]})]})})]})},t0=s(54510),t1=e=>{let{children:t}=e;return(0,c.jsx)("div",{className:"avatars group flex flex-row items-center -space-x-3 md:-space-x-2",children:t})},t2=s(70335),t5=s(17292),t4=s(59625);let t3=()=>(0,t4.Ue)(()=>({userPresences:{}})),t6=(0,x.createContext)(null),t8=e=>{let{children:t,projectId:s}=e,{canRead:a}=(0,_.t)(),r=(0,x.useRef)();r.current||(r.current=t3());let{authUser:n,authState:l}=(0,p.Eu)(),{isSuccess:i}=(0,te.a)(tn.W.presence({projectId:s,authUser:n,enablePresence:a}));(0,x.useEffect)(()=>{if(!s||!n||!i||!a)return;let e=r.current,t=(0,t5.iH)(eW.Fs,"status/".concat(s)),l=(0,t5.jM)(t,t=>{let s=t.val();if(s){let t={};Object.entries(s).filter(e=>{let[t,s]=e;return s.lastSeen&&s.id!==n.uid}).forEach(e=>{let[s,{lastSeen:a,username:r,photoURL:n,id:l,email:i}]=e,o=new Date(a);t[s]={lastSeen:o,id:l,username:r,photoURL:n,email:i}}),e.setState({userPresences:t})}else e.setState({userPresences:{}})},e=>{C.logging.error("Error listening to presence updates",{projectId:s,error:e})});return()=>{l()}},[s,n,l,i,a]);let o={store:r.current};return(0,c.jsx)(t6.Provider,{value:o,children:t})};var t9=s(32800),t7=s(6512),se=s(45659);let st={ADD_EDITOR:"claim.add_editor",ADD_ADMIN:"claim.add_admin",REMOVE_EDITOR:"claim.remove_editor",REMOVE_ADMIN:"claim.remove_admin",MANAGE_MAGIC_LINK:"claim.manage_magic_link",INVITE:"claim.invite"};class ss{generateClaims(){let e=new Set;return this.isFreeWorkspace?(e.add(st.ADD_EDITOR),e.add(st.REMOVE_EDITOR),e.add(st.MANAGE_MAGIC_LINK),e.add(st.INVITE)):this.currentUserIsProjectOwner?(e.add(st.ADD_EDITOR),e.add(st.ADD_ADMIN),e.add(st.REMOVE_EDITOR),e.add(st.REMOVE_ADMIN),e.add(st.MANAGE_MAGIC_LINK),e.add(st.INVITE)):this.isProjectAdmin&&(e.add(st.ADD_EDITOR),e.add(st.REMOVE_EDITOR),e.add(st.MANAGE_MAGIC_LINK),e.add(st.INVITE)),e}hasClaim(e){return this.claims.has(e)}canInvite(){return this.hasClaim(st.INVITE)}canManageMagicLink(){return this.hasClaim(st.MANAGE_MAGIC_LINK)}canEditRole(){var e;return!this.isFreeWorkspace&&((null===(e=this.collaborator)||void 0===e?void 0:e.access_level)==="admin"?this.hasClaim(st.ADD_ADMIN):this.hasClaim(st.ADD_EDITOR))}canRemoveRole(){var e;return this.isCurrentUser?!this.isCollaboratorProjectOwner:(null===(e=this.collaborator)||void 0===e?void 0:e.access_level)==="admin"?this.hasClaim(st.REMOVE_ADMIN):this.hasClaim(st.REMOVE_EDITOR)}isOwner(){return this.isCollaboratorProjectOwner}canManageCollaborator(){return!this.isCollaboratorProjectOwner&&(this.canEditRole()||this.canRemoveRole())}constructor(e){var t,s;this.context=e;let{collaborator:a,currentUserId:r,projectOwnerId:n}=e;this.isCurrentUser=(null==a?void 0:a.id)===r,this.isCollaboratorProjectOwner=n===(null==a?void 0:a.id),this.currentUserIsProjectOwner=r===n,this.isFreeWorkspace=null!==(t=e.isFreeWorkspace)&&void 0!==t&&t,this.isProjectAdmin=null!==(s=e.isProjectAdmin)&&void 0!==s&&s,this.collaborator=a,this.claims=this.generateClaims()}}let sa=e=>new ss(e),sr=e=>(0,x.useMemo)(()=>sa(e),[e.collaborator,e.currentUserId,e.projectOwnerId,e.isFreeWorkspace,e.isProjectAdmin]);var sn=s(82157),sl=s(20984);let si={owner:"Owner",admin:"Admin",write:"Editor",read:"Viewer"};var so=e=>{let{collaborator:t,onRoleChange:s,onRemove:a,permissions:r}=e,n=!t.joined_at,l=r.canManageCollaborator(),i=r.isOwner()?"owner":t.access_level,o=n?"Pending":si[i],d=e=>{e!==t.access_level&&s(t.id,e)};return l?(0,c.jsxs)(eu.h_,{children:[(0,c.jsx)(eu.$F,{asChild:!0,children:(0,c.jsxs)(V.z,{variant:"ghost",size:"sm",className:"text-sm font-medium",children:[o," ",(0,c.jsx)(er.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,c.jsxs)(eu.AW,{align:"end",children:[n&&(0,c.jsx)(sn.w,{label:"Pending",isSelected:!0,disabled:!0}),r.canEditRole()&&!n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sn.w,{label:si.admin,onClick:()=>d(sl.u.ADMIN),isSelected:i===sl.u.ADMIN}),(0,c.jsx)(sn.w,{label:si.write,onClick:()=>d(sl.u.WRITE),isSelected:i===sl.u.WRITE})]}),r.canRemoveRole()&&(0,c.jsx)(sn.w,{label:"Remove",destructive:!0,onClick:()=>{a(t)}})]})]}):(0,c.jsx)(V.z,{variant:"ghost",size:"sm",className:"text-sm font-medium",disabled:!0,children:o})},sc=e=>{let{collaborator:t,onRoleChange:s,onRemove:a,permissionsContext:r}=e,{authUser:n}=(0,p.Eu)(),l=t.id===(null==n?void 0:n.uid),i=sr({...r,collaborator:t}),o=(0,c.jsx)(so,{collaborator:t,onRoleChange:s,onRemove:a,permissions:i});return(0,c.jsx)(se.Q,{id:t.id||"",username:t.username||"",displayName:t.display_name,email:t.email||"",isCurrentUser:l,avatarClassName:"h-6 w-6",actionComponent:o,isInvited:!t.joined_at,showBadge:!1})};let sd=function(){let{copiedText:e="Copied!",resetDelay:t=2e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[s,a]=(0,x.useState)(!1),[r,n]=(0,x.useState)();return{copy:(0,x.useCallback)(async(s,r)=>{if(s)try{await navigator.clipboard.writeText(s),a(!0),r?(n(r),n(e),setTimeout(()=>{n(r),a(!1)},t)):setTimeout(()=>{a(!1)},t)}catch(e){(0,g.Eo)(e)}},[e,t]),isCopied:s,buttonText:r}},su=e=>{let{projectId:t}=e,{createSecretLink:s,isCreatingSecretLink:a}=function(){let e=(0,d.NL)(),{mutate:t,isPending:s}=(0,u.D)({mutationFn:async e=>{let{projectId:t}=e;return(0,j.SJ)().post("/projects/".concat(t,"/magic-codes"),{access_level:"write"})},onSuccess:async(t,s)=>{let a=tn.W.magicCode({projectId:s.projectId}).queryKey;t.id&&e.setQueryData(a,{id:t.id}),h.Am.success("Secret link created")},onError:e=>{(0,g.Eo)(e)},onSettled:(t,s,a)=>{e.invalidateQueries({queryKey:tn.W.magicCode({projectId:a.projectId}).queryKey})}});return{createSecretLink:t,isCreatingSecretLink:s}}(),{deactivateSecretLink:r,isDeactivatingSecretLink:n}=function(){let e=(0,d.NL)(),{mutate:t,isPending:s}=(0,u.D)({mutationFn:async e=>{let{projectId:t,magicCodeId:s}=e;return(0,j.SJ)().delete("/projects/".concat(t,"/magic-codes/").concat(s))},onSuccess:async(t,s)=>{let a=tn.W.magicCode({projectId:s.projectId}).queryKey,r=e.getQueryData(a);(null==r?void 0:r.id)===s.magicCodeId&&e.setQueryData(a,{id:null})},onError:e=>{(0,g.Eo)(e)},onSettled:(t,s,a)=>{e.invalidateQueries({queryKey:tn.W.magicCode({projectId:a.projectId}).queryKey})}});return{deactivateSecretLink:t,isDeactivatingSecretLink:s}}(),{copy:l,buttonText:i}=sd({copiedText:"Copied!",resetDelay:1500}),{data:o,isLoading:m}=(0,te.a)(tn.W.magicCode({projectId:t})),p=(0,x.useMemo)(()=>(null==o?void 0:o.id)?"".concat(window.location.origin,"/projects/").concat(t,"?magic_link=").concat(o.id):null,[t,o]),f=async()=>{try{s({projectId:t})}catch(e){(0,g.Eo)(e)}},v=(0,x.useCallback)(()=>{p&&l(p,"Copy")},[l,p]);if(m)return(0,c.jsxs)("div",{className:"flex animate-pulse gap-5",children:[(0,c.jsx)("div",{className:"h-5 w-5 rounded bg-muted"}),(0,c.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,c.jsx)("div",{className:"h-4 w-2/3 rounded bg-muted"}),(0,c.jsx)("div",{className:"h-3 w-full rounded bg-muted"})]}),(0,c.jsx)("div",{className:"h-9 w-24 rounded bg-muted"})]});if(null==o?void 0:o.id){let e=async()=>{try{r({projectId:t,magicCodeId:o.id})}catch(e){(0,g.Eo)(e)}};return(0,c.jsxs)("div",{className:"align-start flex gap-5",children:[(0,c.jsx)(er.Z,{name:"link",size:"small"}),(0,c.jsxs)("div",{className:"flex flex-col items-start justify-center gap-1",children:[(0,c.jsx)("div",{className:"text-sm font-medium leading-none",children:"Share invite link"}),(0,c.jsx)("div",{className:"text-xs leading-none text-muted-foreground",children:"Anyone with this link can edit"})]}),(0,c.jsxs)("div",{className:"ml-auto flex gap-2",children:[(0,c.jsx)(V.z,{variant:"link",onClick:e,disabled:n,children:"Remove"}),(0,c.jsx)(V.z,{variant:"secondary",onClick:v,children:i||"Copy"})]})]})}return(0,c.jsxs)("div",{className:"flex gap-5",children:[(0,c.jsx)(er.Z,{name:"link",size:"small"}),(0,c.jsxs)("div",{className:"flex flex-col items-start justify-center gap-1",children:[(0,c.jsx)("div",{className:"text-sm font-medium leading-none",children:"Create invite link"}),(0,c.jsx)("div",{className:"text-xs leading-none text-muted-foreground",children:"Anyone with this link can edit"})]}),(0,c.jsx)(V.z,{className:"ml-auto",variant:"outline",size:"sm",onClick:f,disabled:a,children:"Create"})]})};var sm=s(61011),sx=e=>{let{collaboratorName:t,onConfirm:s,onCancel:a}=e;return(0,c.jsx)(sm.Z,{title:"Remove collaborator",targetName:t,descriptionTemplate:"Are you sure you want to remove ".concat(t," from this project? They will no longer have access to this project."),onConfirm:s,onCancel:a})},sh=s(30438);let sp=e=>{let{plan:t}=e,s=(0,tq.Ll)(t.id);if(!(0,sh.c)())return null;let a={title:"",message:"",showContactUs:!1};switch(s){case"enterprise":return null;case"pro":a.title="Upgrade to Enterprise",a.message="For more than 20 collaborators",a.showContactUs=!0;break;default:a.title="Upgrade to Pro",a.message="Permission control & more"}return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t7.Separator,{}),(0,c.jsxs)("div",{className:"mt-1 flex w-full flex-row items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex flex-col items-start justify-center",children:[(0,c.jsx)("p",{className:"text-sm font-medium",children:a.title}),(0,c.jsx)("p",{className:"text-xs text-muted-foreground",children:a.message})]}),(0,c.jsx)(tH.om,{currentPlan:t,context:"billing",children:a.showContactUs?(0,c.jsx)(V.z,{asChild:!0,className:"font-medium",variant:"muted",size:"sm",children:(0,c.jsx)(eC.default,{href:"https://enterpriseform.lovable.app/",target:"_blank",children:"Contact Us"})}):(0,c.jsx)(tK.Z,{size:"sm",variant:"muted",className:"font-medium",children:"Upgrade"})})]})]})};var sf=s(69084);let sv=e=>{let{onDialogClose:t}=e,s=(0,m.usePathname)(),{projectWorkspace:a,memberships:r}=(0,eT.hO)(e=>({projectWorkspace:e.projectWorkspace,memberships:e.memberships})),n=(0,eT.hO)(e=>!0===e.permissions.read);if(!a)return null;let l=r.length;return(0,c.jsxs)("div",{className:"flex flex-wrap items-center gap-3 py-1 md:flex-nowrap",children:[(0,c.jsx)(sf.z,{workspace:a,className:"h-6 w-6"}),(0,c.jsx)("div",{className:"flex flex-shrink items-center gap-2 md:w-full",children:(0,c.jsx)("div",{className:"max-w-[200px] flex-shrink truncate text-sm font-medium",children:a.name})}),(0,c.jsx)("div",{className:"ml-auto flex items-center gap-1",children:n?(0,c.jsxs)(eu.h_,{children:[(0,c.jsx)(eu.$F,{asChild:!0,children:(0,c.jsxs)(V.z,{variant:"ghost",size:"sm",className:"text-sm font-medium",children:[1===l?"1 member":"".concat(l," members"),(0,c.jsx)(er.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,c.jsx)(eu.AW,{align:"end",children:(0,c.jsx)(eu.Xi,{asChild:!0,children:(0,c.jsx)(eC.default,{href:"".concat(s,"?settings=people"),onClick:t,className:"hover:bg-accent",children:"Manage Workspace Access"})})})]}):(0,c.jsxs)(V.z,{variant:"ghost",size:"sm",className:"text-sm font-medium",disabled:!0,children:["Workspace Access",(0,c.jsx)(er.Z,{name:"lock",size:"small",className:"ml-1"})]})})]})},sg=e=>{var t,s,a,r,n,l;let{disabled:i=!1}=e,o=(0,M.z)(sx),[m,h]=(0,x.useState)(!1),{authUser:f}=(0,p.Eu)(),v=(0,eT.hO)(e=>e.projectWorkspace),b=(0,U.iZ)(e=>e.project),y=(0,H.c)(e=>e.collaborators),N=(0,H.c)(e=>e.hasFetchedCollaborators),{isProjectAdmin:C,isProjectOwner:k}=(0,_.t)(),E=!!k,S=(0,tq.B9)(null==v?void 0:v.plan),z=v&&(null==v?void 0:v.plan)=="free"||null==v,I={collaborator:void 0,currentUserId:null==f?void 0:f.uid,projectOwnerId:null!==(t=null==b?void 0:b.user_id)&&void 0!==t?t:"",isFreeWorkspace:!!z,isProjectAdmin:C},R=sr(I),P=(0,x.useMemo)(()=>({write:"Editor",admin:"Admin",owner:"Owner"}),[]),D=(0,x.useMemo)(()=>[{value:"admin",label:P.admin},{value:"write",label:P.write}],[P]),{inviteCollaborator:O,isInvitingCollaborator:T}=function(e){let{projectId:t}=e,s=(0,d.NL)(),{mutateAsync:a,isPending:r}=(0,u.D)({mutationFn:async e=>{let{email:s,inviteRole:a,projectOwnerId:r}=e;return(0,j.SJ)().post("/projects/".concat(t,"/collaborators"),{email:s,access_level:a})},onSuccess:(e,a)=>{let{projectOwnerId:r}=a,n=tn.W.collaborators({projectId:t,projectOwnerId:r}).queryKey,l=s.getQueryData(n)||[];l.some(t=>t.id===e.id)||s.setQueryData(n,(0,tn.b)({collaborators:[...l,e],projectOwnerId:r})),s.invalidateQueries({queryKey:w.iZ.collaborators(t)})},onError:e=>{(0,g.Eo)(e)}});return{inviteCollaborator:a,isInvitingCollaborator:r}}({projectId:null!==(s=null==b?void 0:b.id)&&void 0!==s?s:""}),{deleteCollaborator:A}=function(e){let{projectId:t}=e,s=(0,d.NL)(),{mutateAsync:a}=(0,u.D)({mutationFn:async e=>{let{collaboratorId:s}=e,a=(0,j.SJ)();await a.delete("/projects/".concat(t,"/collaborators/").concat(s))},onSuccess:(e,a)=>{let{projectOwnerId:r,collaboratorId:n}=a;Q(t,n);let l=s.getQueryData(tn.W.collaborators({projectId:t,projectOwnerId:r}).queryKey);l&&s.setQueryData(w.iZ.collaborators(t),l.filter(e=>e.id!==n))},onError:e=>{(0,g.Eo)(e)},onSettled:(e,s,a)=>{Q(t,a.collaboratorId)}});return{deleteCollaborator:a}}({projectId:null!==(a=null==b?void 0:b.id)&&void 0!==a?a:""}),{updateCollaboratorRole:Z}=function(e){let{projectId:t}=e,s=(0,d.NL)(),{mutateAsync:a}=(0,u.D)({mutationFn:async e=>{let{collaboratorId:s,role:a,projectOwnerId:r}=e,n=(0,j.SJ)();await n.put("/projects/".concat(t,"/collaborators/").concat(s),{access_level:a})},onMutate:async e=>{await s.cancelQueries({queryKey:tn.W.collaborators({projectId:t,projectOwnerId:e.projectOwnerId}).queryKey});let a=s.getQueryData(tn.W.collaborators({projectId:t,projectOwnerId:e.projectOwnerId}).queryKey);return s.setQueryData(tn.W.collaborators({projectId:t,projectOwnerId:e.projectOwnerId}).queryKey,t=>{if(!t)return[];let s=t.map(t=>t.id===e.collaboratorId?{...t,access_level:e.role}:t);return(0,tn.b)({collaborators:s,projectOwnerId:e.projectOwnerId})}),{previousCollaborators:a,projectOwnerId:e.projectOwnerId}},onError:(e,a,r)=>{(0,g.Eo)(e),(null==r?void 0:r.previousCollaborators)&&s.setQueryData(tn.W.collaborators({projectId:t,projectOwnerId:r.projectOwnerId}).queryKey,r.previousCollaborators)},onSettled:(e,a,r)=>{Q(t,r.collaboratorId),s.invalidateQueries({queryKey:tn.W.collaborators({projectId:t,projectOwnerId:r.projectOwnerId}).queryKey})}});return{updateCollaboratorRole:a}}({projectId:null!==(r=null==b?void 0:b.id)&&void 0!==r?r:""}),L=async e=>{let{emails:t,role:s}=e;if(!b)return{success:!1};let a=C&&!E?"write":s,r=0;for(let e of t)await O({email:e,inviteRole:a,projectOwnerId:b.user_id}),r++;return{success:r>0}},F=async(e,t)=>{(null==b?void 0:b.id)&&(null==b?void 0:b.user_id)&&await Z({collaboratorId:e,role:t,projectOwnerId:b.user_id})},W=e=>{b&&o({childProps:{collaboratorName:e.display_name,onConfirm:async()=>{await A({collaboratorId:e.id,projectOwnerId:b.user_id}),o(!1)},onCancel:()=>o(!1)}})},B="Collaborators will use credits from the project owner's workspace (".concat(null==v?void 0:v.name,")"),G=(0,c.jsxs)(c.Fragment,{children:["Collaborators will use credits from the project owner's workspace (",null==v?void 0:v.name,"). If you need more than 20 collaborators,"," ",(0,c.jsx)(eC.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"contact us"}),"."]}),J=R.canInvite(),K=R.canManageMagicLink(),q=(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,c.jsx)("p",{className:"text-lg font-medium",children:"Invite"}),(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:z?B:G})]}),J?(0,c.jsx)(t9.s,{onInvite:e=>{let{emails:t,role:s}=e;return L({emails:t,role:s})},isInviting:T,roleOptions:D,defaultRole:"write",canSelectRoles:!z,placeholder:"Invite by email"}):(0,c.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,c.jsx)(eK.I,{disabled:!0,className:"h-8",placeholder:"Invite by email"}),(0,c.jsx)(V.z,{variant:"secondary",disabled:!0,children:"Invite"})]}),(0,c.jsxs)("div",{className:"flex flex-col gap-1",children:[S&&(0,c.jsx)(sv,{onDialogClose:()=>h(!1)}),N?y.map(e=>(0,c.jsx)(sc,{collaborator:e,onRoleChange:F,onRemove:W,permissionsContext:I},e.id)):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sj,{}),(0,c.jsx)(sj,{})]})]}),(null==b?void 0:b.id)&&K&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t7.Separator,{}),(0,c.jsx)(su,{projectId:b.id})]}),(0,c.jsx)(sp,{plan:{id:null!==(n=null==v?void 0:v.plan)&&void 0!==n?n:tq.tJ.FREE,type:null!==(l=null==v?void 0:v.plan_type)&&void 0!==l?l:"monthly"}})]}),$=(0,ep.F9)();return(0,c.jsxs)(eu.h_,{open:m,onOpenChange:h,children:[(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(eu.$F,{asChild:!0,disabled:i,children:$?(0,c.jsxs)(V.z,{variant:"secondary",size:"sm",className:(0,el.cn)("relative flex h-[34px] w-[34px] shrink-0 rounded-full border bg-secondary p-0 shadow-none group-[.avatars]:border-background @2xl:w-auto @2xl:px-2.5 disabled:opacity-100 md:h-[30px] md:w-[30px] md:@2xl:w-auto"),children:[(0,c.jsx)(er.Z,{name:"add",size:"small",className:"flex @2xl:hidden"}),(0,c.jsx)("span",{className:"hidden @2xl:flex",children:"Invite"})]}):(0,c.jsxs)(V.z,{variant:"secondary",size:"sm",className:"flex-shrink-0 gap-1.5",children:[(0,c.jsx)(er.Z,{name:"group_add",size:"small",className:"flex @2xl:hidden"}),(0,c.jsx)("span",{className:"hidden @2xl:flex",children:"Invite"})]})})}),(0,c.jsx)(en._v,{children:"Invite collaborators"})]}),(0,c.jsx)(eu.AW,{className:"z-[1001] flex w-full max-w-[325px] flex-col gap-4 border border-border p-4 shadow-md md:max-w-[400px]",collisionPadding:8,onCloseAutoFocus:e=>e.preventDefault(),children:q})]})},sj=()=>(0,c.jsx)("div",{className:"flex flex-col gap-2",children:(0,c.jsxs)("div",{className:"flex items-center gap-3.5",children:[(0,c.jsx)("div",{className:"h-6 w-6 shrink-0 rounded-full bg-muted"}),(0,c.jsx)("div",{className:"h-4 w-20 rounded-sm bg-muted"}),(0,c.jsx)("div",{className:"h-4 w-32 rounded-sm bg-muted"})]})}),sb=e=>e>new Date(Date.now()-3e5),sy=e=>{var t,s,a;let{hasUnsavedChanges:r}=e,{userPresences:n}=function(e){let{store:t}=function(){let e=(0,x.useContext)(t6);if(!e)throw Error("usePresenceContext must be used within a PresenceProvider");return e}();return t(e)}(e=>e),{userData:l}=(0,O.SE)(),{authUser:i}=(0,p.Eu)(),o=(0,v.Z)("md"),d=(0,x.useMemo)(()=>Object.values(n).filter(e=>e.lastSeen>new Date(Date.now()-864e5)).sort((e,t)=>e.lastSeen.getTime()-t.lastSeen.getTime()).slice(0,o?3:5),[n,o]),u=null!==(a=null!==(s=null==l?void 0:null===(t=l.attributes)||void 0===t?void 0:t.display_name)&&void 0!==s?s:null==i?void 0:i.email)&&void 0!==a?a:null==l?void 0:l.id,m=(0,ep.F9)();return(0,c.jsxs)(t1,{children:[m&&l&&(0,c.jsx)(t2.Y,{user:l,isInteractive:!0,className:(0,el.cn)("h-[34px] w-[34px] md:h-[26px] md:w-[26px]"),tooltipContent:(0,c.jsx)("div",{className:"flex flex-col",children:(0,c.jsxs)("p",{className:"text-xs font-medium",children:[u," ",(0,c.jsx)("span",{className:"font-normal",children:"(You)"})]})})},null==l?void 0:l.id),d.length>0&&(0,c.jsx)(c.Fragment,{children:d.map(e=>{var t;return(0,c.jsx)(t2.Y,{user:{id:e.id,username:null!==(t=e.username)&&void 0!==t?t:e.email},className:(0,el.cn)("h-[34px] w-[34px] md:h-[26px] md:w-[26px]"),photoURL:e.photoURL,isInteractive:!0,tooltipContent:(0,c.jsxs)("div",{className:"flex flex-col",children:[(0,c.jsx)("p",{className:"text-xs font-medium",children:e.username||e.email}),(0,c.jsx)("p",{className:"text-xs text-muted",children:sb(e.lastSeen)?"Now":(0,t0.Q)(e.lastSeen,{addSuffix:!0})})]})},e.id)})}),(0,c.jsx)(sg,{disabled:r})]})};var sw=s(5978),sN=s(61062),s_=s(91576);let sC=e=>{let t=(0,F.D)(),[s,a]=(0,x.useState)(!1),{onClick:r,isPending:n}=(0,s_.hw)({projectId:t,errors:[{id:(0,P.Fd)(),type:sN.N.BUILD,error_message:"Production build error: ".concat(e||""),occurred_at:new Date().toISOString(),created_at:sw.EK.now()}]}),l=(0,R.bk)(e=>e.isSendChatMessageMutationPending);return{handleFix:(0,x.useCallback)(async()=>{if(!s)try{a(!0),await r(),h.Am.success("Fix attempt initiated successfully")}catch(e){console.error("Failed to initiate fix:",e),h.Am.error("Failed to initiate fix. Please try again.")}finally{a(!1)}},[r,s]),isFixing:n||l||s}},sk=e=>{let{open:t,onOpenChange:s,errorMessage:a,isBuildError:r=!1}=e,{handleFix:n,isFixing:l}=sC(a||""),i=(0,x.useCallback)(async()=>{await n(),s(!1)},[n,s]);return(0,c.jsx)(W.Vq,{open:t,onOpenChange:s,children:(0,c.jsxs)(W.cZ,{className:"text-center",children:[(0,c.jsxs)(W.fK,{className:"flex flex-col gap-2 space-y-0",children:[(0,c.jsx)(W.$N,{className:"text-2xl",children:"Oops! \uD83D\uDE22"}),(0,c.jsx)("p",{className:"",children:r?"We couldn't publish your site due to build errors.":"Something went wrong and we couldn't publish your site."}),a&&(0,c.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,c.jsx)("p",{className:"",children:r?"The build failed with the following errors:":"The error message:"}),(0,c.jsx)("p",{className:"font-medium text-destructive-primary",children:a})]})]}),(0,c.jsxs)(W.cN,{className:"",children:[(0,c.jsx)(V.z,{variant:"outline",onClick:()=>s(!1),children:"Close"}),r&&(0,c.jsxs)(V.z,{onClick:i,variant:"default",size:"default",disabled:l,className:"flex items-center gap-2",children:[(0,c.jsx)(er.Z,{name:"build",size:"small"}),l?"Fixing...":"Try to fix"]})]})]})})},sE=e=>{var t;let{project:s,variant:a="dropdown",onActionComplete:r}=e,n=(0,I.Sl)(e=>e.activeView),{setConsoleContentType:l,setActiveView:i}=(0,I.pE)(),{hasUnsavedChanges:o}=(0,tl.v)(),d=(0,tT.UC)(e=>e.isVisualEditingActive),u=(0,ep.ty)(),m=(null==s?void 0:s.latest_commit_sha)===(null==s?void 0:null===(t=s.published_deployment)||void 0===t?void 0:t.commit_sha),x=!!(null==s?void 0:s.url),h=!x||o||d||!m,p="seo"===n,f=()=>{if(h)return;let e="dialog"===a?k.Md.OPEN_PUBLISH:k.Md.OPEN_TOP_MENU;N.ZP.capture(e,{hasProjectUrl:x,isLastEditPublished:m,hasUnsavedChanges:o,isVisualEditingActive:d,context:a}),p?i("preview"):i("seo"),l(null),null==r||r()};return u?"dropdown"===a?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(eu.VD,{}),(0,c.jsx)("div",{className:"px-4 py-2",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex flex-col",children:[(0,c.jsx)("span",{className:"text-sm text-foreground",children:"Page Speed Analysis"}),h&&(0,c.jsx)("span",{className:"text-xs text-muted-foreground",children:x?m?o?"Update first to run analysis on latest version":d?"Exit visual editor first":null:"Publish latest version first to run analysis":"Publish first to run analysis"})]}),(0,c.jsxs)(V.z,{variant:"secondary",size:"sm",disabled:h,onClick:f,children:[(0,c.jsx)(er.Z,{name:"stacked_line_chart",size:"small"}),"Review"]})]})})]}):(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:(0,c.jsx)(er.Z,{name:"stacked_line_chart",size:"small",className:"text-muted-foreground"})}),(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("h3",{className:"text-sm font-medium",children:"Optimize for Search Engines"}),(0,c.jsx)("p",{className:"text-xs text-muted-foreground",children:'"Check your SEO performance and get tips to improve visibility"'})]}),(0,c.jsx)(V.z,{variant:"outline",size:"sm",onClick:f,disabled:h,className:"text-xs",children:"Review SEO"})]}):null},sS=e=>{let{open:t,onOpenChange:s,project:a}=e,[r,n]=(0,x.useState)(!1),l=(0,ep.ty)(),i=null==a?void 0:a.url,o=async()=>{if(!r&&i)try{await navigator.clipboard.writeText(i),n(!0),setTimeout(()=>n(!1),2e3)}catch(e){h.Am.error("Failed to copy link")}},d=e=>{if(!i)return;let t="Check out what I just built with Lovable!",s=encodeURIComponent(i),a=encodeURIComponent(t),r={twitter:"https://twitter.com/intent/tweet?text=".concat(a,"&url=").concat(s),linkedin:"https://www.linkedin.com/sharing/share-offsite/?url=".concat(s),reddit:"https://reddit.com/submit?url=".concat(s,"&title=").concat(a),discord:"https://discord.com/channels/@me"};if("discord"===e){navigator.clipboard.writeText("".concat(t," ").concat(i)),h.Am.success("Copied to clipboard! Paste it in your Discord channel.");return}let n=r[e];n&&window.open(n,"_blank","noopener,noreferrer")};return(0,c.jsx)(W.Vq,{open:t,onOpenChange:s,children:(0,c.jsxs)(W.cZ,{className:"max-w-sm",children:[(0,c.jsx)(W.fK,{children:(0,c.jsx)(W.$N,{className:"sr-only",children:"Project Published Successfully"})}),(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsx)("div",{className:"flex justify-start",children:(0,c.jsx)(B.xx,{className:"h-12"})}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsx)("h2",{className:"text-2xl font-medium",children:"You just shipped!"}),(0,c.jsx)("p",{className:"text-muted-foreground",children:"Let's share your work with the world"})]}),(0,c.jsx)("div",{className:"rounded-lg bg-muted px-3 py-1",children:(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)(er.Z,{name:"link",size:"small",className:"text-muted-foreground"}),(0,c.jsx)(eK.I,{value:i||"",readOnly:!0,className:"flex-1 border-none bg-transparent p-0 shadow-none focus-visible:ring-0",onFocus:e=>e.target.select()}),(0,c.jsx)(V.z,{variant:"outline",size:"sm",onClick:o,children:r?"Copied!":"Copy Link"})]})}),(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Share with your loved ones:"}),(0,c.jsxs)("div",{className:"justify-left flex gap-4",children:[(0,c.jsx)("button",{onClick:()=>d("twitter"),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted transition-colors hover:bg-muted/80",title:"Share on X (Twitter)",children:(0,c.jsx)(B.xR.X,{className:"h-4 w-4"})}),(0,c.jsx)("button",{onClick:()=>d("linkedin"),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted transition-colors hover:bg-muted/80",title:"Share on LinkedIn",children:(0,c.jsx)(B.xR.Linkedin,{className:"h-4 w-4"})}),(0,c.jsx)("button",{onClick:()=>d("reddit"),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted transition-colors hover:bg-muted/80",title:"Share on Reddit",children:(0,c.jsx)(B.xR.Reddit,{className:"h-4 w-4"})}),(0,c.jsx)("button",{onClick:()=>d("discord"),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted transition-colors hover:bg-muted/80",title:"Share on Discord",children:(0,c.jsx)(B.xR.Discord,{className:"h-4 w-4"})})]})]}),l&&(0,c.jsx)("div",{className:"space-y-3 border-t pt-6",children:(0,c.jsx)(sE,{project:a,variant:"dialog",onActionComplete:()=>s(!1)})})]})]})})},sz=e=>{let{open:t,onOpenChange:s,onPublishAnyway:a,onReviewIssues:r}=e;return(0,c.jsx)(W.Vq,{open:t,onOpenChange:s,children:(0,c.jsxs)(W.cZ,{children:[(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{children:"Security Issues Found"}),(0,c.jsx)(W.Be,{children:"Critical vulnerabilities in Supabase integration detected. Review them now or publish anyway."})]}),(0,c.jsxs)(W.cN,{children:[(0,c.jsx)(V.z,{variant:"secondary",onClick:()=>{a(),s(!1)},children:"Publish anyway"}),(0,c.jsx)(V.z,{variant:"affirmative",onClick:()=>{r(),s(!1)},children:"Review Issues"})]})]})})},sI=e=>{let{supabaseProjectId:t,securityWarnings:s}=e,a=s&&0===s.supabase.errors?"?preset=WARN&id=":"",r="".concat("https://supabase.com/dashboard/project/".concat(t,"/advisors/security")).concat(a);return(0,c.jsx)(V.z,{asChild:!0,size:"sm",variant:"affirmative",children:(0,c.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:"Review Errors"})})};var sR=s(93261),sP=s(74225),sD=s(10441);let sO=e=>{let{projectId:t,enabled:s}=e,{data:a,...r}=(0,te.a)(sD.c.domains({projectId:null!=t?t:"",enabled:s&&!!t}));return{customDomains:a,...r}},sT=e=>{let{project:t,onRenameClick:s}=e,{openSettings:a}=(0,eR.r)(),{customDomains:r}=sO({projectId:null==t?void 0:t.id,enabled:!0});return(0,c.jsxs)("div",{className:"my-2 flex flex-col gap-1",children:[(null==t?void 0:t.url)?(0,c.jsx)(V.z,{asChild:!0,variant:"link",className:"mx-0 w-full px-4 font-medium",children:(0,c.jsxs)("a",{href:null==t?void 0:t.url,target:"_blank",rel:"noreferrer",children:[(0,c.jsx)(er.Z,{name:"language",size:"small"}),(0,sP.P)(t.url),(0,c.jsx)(er.Z,{name:"arrow_outward",size:"small",className:"ml-auto text-muted-foreground"})]})}):(0,c.jsxs)("div",{className:"flex min-h-7 items-center gap-2 px-4 py-0.5",children:[(0,c.jsx)(er.Z,{name:"language",size:"small"}),(0,c.jsxs)("p",{className:"text-sm font-medium",children:[null==t?void 0:t.name,".lovable.app"]}),s&&(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",onClick:s,className:"ml-auto h-6 w-6 opacity-70 hover:opacity-100",children:(0,c.jsx)(er.Z,{name:"edit",size:"small"})})]}),null==r?void 0:r.map((e,t)=>(0,c.jsx)("div",{className:"flex items-center px-4 py-0.5",children:(0,c.jsx)(sR.Z,{domain:e,showRemove:!1,showIcon:!0},t)},t)),(0,c.jsx)("div",{className:"flex items-center gap-2 px-4 py-0.5",children:(0,c.jsxs)(V.z,{variant:"link",size:"sm",className:"pl-0 font-normal text-muted-foreground",onClick:()=>a("domains"),children:[(0,c.jsx)(er.Z,{name:"add",size:"small"}),"Custom domains"]})})]})};var sA=s(5460);let sZ=e=>{let{projectId:t,securityWarnings:s,setShowPublishConfirmDialog:a,projectUrl:r}=e,[n,l]=(0,x.useState)(),[i,o]=(0,x.useState)(!1),[c,d]=(0,x.useState)(!1),[m,p]=(0,x.useState)(!1),f=(0,u.D)({mutationFn:async()=>{let e=(0,j.SJ)(),s=await e.post("/projects/".concat(t,"/deployments"),{});return await (0,sA.G)({projectId:t}),{request:s,wasFirstTime:!r}},onSuccess:e=>{let{wasFirstTime:t}=e;t?p(!0):h.Am.success("Project updated!",{description:"Published project updated"})},onError:e=>{if(422===e.status){var t;l((null===(t=e.data)||void 0===t?void 0:t.detail)||null),o(!0)}else l(e.message||e.details||"Unidentified error. Please contact support if this issue persists."),o(!1);d(!0)}});return{errorMessage:n,isBuildError:i,failedDialogOpen:c,successDialogOpen:m,setFailedDialogOpen:d,setSuccessDialogOpen:p,handlePublish:async()=>{if(!t){C.logging.error("project id is missing, can't deploy");return}s&&s.supabase.errors>0?a(!0):f.mutate()},handlePublishAnyway:()=>{a(!1),f.mutate()},publishMutation:f}};var sL=s(49360),sF=s(78079);let sM=e=>{var t;let{project:s,setIsOpen:a,setShowPublishConfirmDialog:r}=e,n=!!(null==s?void 0:null===(t=s.supabase_project_config)||void 0===t?void 0:t.supabase_project_id),l=null==s?void 0:s.id,{data:i,isLoading:o,isError:c}=(0,te.a)(tn.W.securityWarnings({projectId:l,hasSupabaseConfig:n})),d=(0,x.useMemo)(()=>{if(c)return{supabase:{errors:0,warnings:0,success:!1}};if(i){var e,t,s,a;return{supabase:{errors:null!==(s=null===(e=i.supabase)||void 0===e?void 0:e.errors)&&void 0!==s?s:0,warnings:null!==(a=null===(t=i.supabase)||void 0===t?void 0:t.warnings)&&void 0!==a?a:0,success:!0}}}return null},[i,c]),u=(0,sF.m)({projectId:l,onSuccess:()=>{null==a||a(!1)}}),m=u.isPending,h=d&&d.supabase.errors+d.supabase.warnings>0,p=d&&d.supabase.errors>0;return{securityWarnings:d,isLoadingWarnings:o,isSendingSecurityReview:m,handleReviewIssuesInDialog:()=>{var e;if(r(!1),null==s?void 0:null===(e=s.supabase_project_config)||void 0===e?void 0:e.supabase_project_id){let e=s.supabase_project_config.supabase_project_id,t=d&&0===d.supabase.errors?"?preset=WARN&id=":"";window.open("".concat("https://supabase.com/dashboard/project/".concat(e,"/advisors/security")).concat(t),"_blank")}},handleSecurityReview:()=>{if(!l){C.logging.error("project id is missing, can't start security review");return}u.mutate({body:{message:"Please perform a comprehensive security review of my project.",id:(0,sL.Z)(),security_review:!0,chat_only:!0}})},hasSupabaseErrors:p,hasSecurityIssues:h,hasSupabaseConfig:n}},sU=e=>{let t,s,{errors:a,warnings:r,supabaseProjectId:n}=e,l=(0,v.Z)("md"),i=a>0,o=r>0,d=i||o;d?i?(t="bg-destructive-primary",s="".concat(a," Supabase Error").concat(a>1?"s":"")):(t="bg-warning-primary",s="".concat(r," Supabase Warning").concat(r>1?"s":"")):(t="bg-success-primary",s="No Supabase security issues");let u="https://supabase.com/dashboard/project/".concat(n,"/advisors/security").concat(!i&&o?"?preset=WARN&id=":"");return(0,c.jsxs)("a",{href:u,target:"_blank",rel:"noopener noreferrer","aria-label":"View security issues on Supabase",className:(0,el.cn)("mx-0 flex h-10 items-center gap-2 rounded-lg bg-muted px-2 text-base transition-colors duration-100 ease-in-out md:mx-2 md:h-8 md:text-sm",d&&"hover:bg-muted-hover"),children:[(0,c.jsx)("div",{className:"flex w-4 items-center justify-center",children:(0,c.jsx)("span",{className:"h-1.5 w-1.5 shrink-0 rounded-full ".concat(t)})}),(0,c.jsx)("p",{className:(0,el.cn)("flex-grow text-base font-medium leading-none text-primary md:text-sm"),children:s}),d&&(0,c.jsx)(er.Z,{name:"arrow_outward",size:l?"default":"small",className:"text-muted-foreground"})]})},sV=e=>{var t;let{isLoadingSecurityWarnings:s,securityWarnings:a,project:r}=e;return(null==r?void 0:null===(t=r.supabase_project_config)||void 0===t?void 0:t.supabase_project_id)?(0,c.jsx)("div",{className:"pb-2",children:s||!a?(0,c.jsxs)("div",{className:(0,el.cn)("mx-0 flex h-10 items-center gap-2 rounded-lg bg-muted px-2 md:mx-2 md:h-8"),children:[(0,c.jsx)("div",{className:"flex w-4 items-center justify-center",children:(0,c.jsx)(eD.O,{className:"h-1.5 w-1.5 rounded-full"})}),(0,c.jsx)(eD.O,{className:"h-3 max-w-48 flex-grow"})]}):(0,c.jsx)(sU,{errors:a.supabase.errors,warnings:a.supabase.warnings,supabaseProjectId:r.supabase_project_config.supabase_project_id})}):null},sW=e=>{var t;let{disabled:s=!1}=e,[a,r]=(0,x.useState)(!1),[n,l]=(0,x.useState)(!1),[i,o]=(0,x.useState)(!1),u=(0,ep.ty)(),m=(0,U.iZ)(e=>e.project),h=(0,d.NL)(),{securityWarnings:p,isLoadingWarnings:f,hasSupabaseConfig:v,hasSecurityIssues:g,hasSupabaseErrors:j,handleReviewIssuesInDialog:b,handleSecurityReview:y,isSendingSecurityReview:w}=sM({project:m,setIsOpen:r,setShowPublishConfirmDialog:l}),{errorMessage:N,isBuildError:_,failedDialogOpen:C,successDialogOpen:k,setFailedDialogOpen:E,setSuccessDialogOpen:S,handlePublish:z,handlePublishAnyway:I,publishMutation:R}=sZ({projectId:null==m?void 0:m.id,securityWarnings:p,setShowPublishConfirmDialog:l,projectUrl:(null==m?void 0:m.url)||void 0});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(eu.h_,{onOpenChange:r,open:a,children:[(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)(eu.$F,{asChild:!0,disabled:s,children:(0,c.jsxs)(V.z,{id:"publish-menu",variant:"affirmative",size:"sm",className:"gap-1.5",onMouseEnter:()=>{(null==m?void 0:m.id)&&v&&h.prefetchQuery(tn.W.securityWarnings({projectId:m.id,hasSupabaseConfig:v}))},children:[(0,c.jsx)(er.Z,{name:"language",size:"small",className:"flex @2xl:hidden"}),(0,c.jsx)("span",{className:"hidden @2xl:flex",children:"Publish"})]})})}),(0,c.jsx)(en._v,{children:"Publish your project"})]}),(0,c.jsxs)(eu.AW,{className:"z-[1001] min-w-[300px] max-w-[300px] border border-border bg-background p-0 md:max-w-[350px]",align:"end",collisionPadding:8,children:[(0,c.jsx)(tV,{title:(null==m?void 0:m.url)?"Update":"Publish",description:(null==m?void 0:m.url)?"":"Publish your project to make it visible for others on the internet."}),(0,c.jsx)(eu.VD,{}),(0,c.jsx)(sT,{project:m,onRenameClick:()=>o(!0)}),v&&(0,c.jsx)(sV,{isLoadingSecurityWarnings:f,securityWarnings:p,project:m}),u&&(0,c.jsx)(sE,{project:m}),(0,c.jsx)(eu.VD,{}),(0,c.jsxs)("div",{className:"flex items-center justify-between gap-2 pb-2.5 pl-2.5 pr-4 pt-1.5",children:[(0,c.jsx)(tW,{href:"https://docs.lovable.dev/features/deploy"}),(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(V.z,{variant:"secondary",size:"sm",onClick:y,disabled:w,loading:w,className:"relative gap-1.5",children:"Review Security"}),(0,c.jsx)(V.z,{variant:g?"secondary":"affirmative",size:"sm",onClick:z,disabled:f,loading:R.isPending,children:(null==m?void 0:m.url)?"Update":"Publish"}),(null==m?void 0:null===(t=m.supabase_project_config)||void 0===t?void 0:t.supabase_project_id)&&j&&(0,c.jsx)(sI,{supabaseProjectId:m.supabase_project_config.supabase_project_id,securityWarnings:p})]})]})]})]}),(0,c.jsx)(sk,{open:C,onOpenChange:E,errorMessage:N,isBuildError:_}),(0,c.jsx)(sS,{open:k,onOpenChange:S,project:m}),(0,c.jsx)(sz,{open:n,onOpenChange:l,onPublishAnyway:I,onReviewIssues:b}),m&&(0,c.jsx)(eN.i,{project:m,isOpen:i,onClose:()=>o(!1)})]})},sB=(0,x.memo)(function(){var e,t;let s=(0,ep.Cb)(),a=(0,t$.G)(),r=(0,eT.hO)(e=>e.projectWorkspace),{hasUnsavedChanges:n}=(0,tl.v)(),l=null==r?void 0:r.disable_publish,i={id:null!==(e=null==r?void 0:r.plan)&&void 0!==e?e:tq.tJ.FREE,type:null!==(t=null==r?void 0:r.plan_type)&&void 0!==t?t:"monthly"};return(0,c.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,c.jsx)(sy,{hasUnsavedChanges:n}),!s&&(0,c.jsx)(tZ,{}),a&&(0,c.jsx)(tG,{disabled:n}),a&&(0,c.jsx)(tQ,{disabled:n}),(0,c.jsx)(tH.om,{currentPlan:i,context:"billing",children:(0,c.jsx)(tK.Z,{onClick:()=>{N.ZP.capture(k.VL.UPGRADE.BUTTON_CLICKED.NAV_BAR,{context:k.VL.UPGRADE.CONTEXT.BILLING})}})}),(0,c.jsx)(sW,{disabled:n||!!l})]})}),sG={Left:()=>(0,c.jsx)("div",{className:"flex items-center space-x-2",children:(0,c.jsx)(eD.O,{className:"h-6 w-20 md:h-7"})}),Center:()=>(0,c.jsx)("div",{className:"flex items-center justify-center space-x-2",children:(0,c.jsx)(eD.O,{className:"h-6 w-48 md:h-7"})}),Right:()=>(0,c.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,c.jsx)(eD.O,{className:"h-6 w-20 md:h-7"})})},sJ=(0,x.memo)(function(e){let{commitMessage:t}=e;return(0,c.jsxs)("div",{className:"flex h-full min-w-0 items-center gap-2",children:[(0,c.jsx)("span",{className:"text-sm text-muted-foreground",children:"Previewing"}),(0,c.jsx)("div",{className:"flex h-7 min-w-0 items-center rounded-full border border-input px-3 text-sm",children:(0,c.jsx)("p",{className:"min-w-0 max-w-[250px] truncate",children:t})})]})}),sH=()=>{let[e,t]=(0,x.useState)(!1),s=()=>t(!1),{openSettings:a}=(0,eR.r)();return{GithubRequiredDialog:()=>(0,c.jsx)(W.Vq,{open:e,onOpenChange:t,children:(0,c.jsxs)(W.cZ,{size:"sm",children:[(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{children:"GitHub Access Required"}),(0,c.jsx)(W.Be,{children:"This action requires GitHub access. Please connect your GitHub account by clicking the button below."})]}),(0,c.jsxs)(W.cN,{children:[(0,c.jsx)(W.GG,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"secondary",children:"Cancel"})}),(0,c.jsxs)(V.z,{variant:"default",onClick:()=>{s(),a("github")},children:[(0,c.jsx)(B.xR.GitHub,{className:"h-4 w-4"}),"Connect GitHub"]})]})]})}),isOpen:e,open:()=>t(!0),close:s}},sK=e=>{let{activeEdit:t,project:s}=e,{open:a,GithubRequiredDialog:r}=sH();return(null==t?void 0:t.commit_sha)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(V.z,{variant:"secondary",size:"sm",className:"shadow-none",onClick:()=>{var e,r;let n=(0,tY._J)((null==s?void 0:s.github_repo_name)||"",t.commit_sha||"",null==s?void 0:null===(e=s.github_owner)||void 0===e?void 0:e.name);if((null==s?void 0:null===(r=s.github_owner)||void 0===r?void 0:r.name)===tY.aR){a();return}n&&window.open(n,"_blank")},children:[(0,c.jsx)(B.xR.GitHub,{className:"h-3.5 w-3.5"}),(0,c.jsx)("span",{className:"hidden sm:flex",children:"View on GitHub"})]}),(0,c.jsx)(r,{})]}):null},sq=e=>{let{projectId:t}=e,{exitConsole:s}=(0,I.pE)(),a=(0,m.useRouter)();return(0,c.jsx)(V.z,{size:"sm",variant:"secondary",type:"button",onClick:()=>{t&&a.replace("/projects/".concat(t)),s()},className:"shadow-none",children:"Exit"})};var s$=s(78276),sY=s(26237),sX=s(79396);let sQ=(0,x.memo)(function(e){let{activeEdit:t}=e,{exitConsole:s}=(0,I.pE)(),a=(0,sY.C)(),r=(0,R.bk)(e=>e.isSomeRevertMutationPending),{mutate:n,isPending:l}=(0,sX.I)({onSuccess:s}),{disabled:i,disabledTooltip:o}=(0,x.useMemo)(()=>t?r||a?{disabled:!0,disabledTooltip:(0,c.jsx)("p",{className:"max-w-sm",children:"Cannot revert while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete."})}:{disabled:!1,disabledTooltip:void 0}:{disabled:!0,disabledTooltip:(0,c.jsx)("p",{className:"max-w-sm",children:"There is no selected edit to revert to."})},[t,r,a]);return(0,c.jsx)(s$.b,{showTooltip:i,tooltipContent:o,children:(0,c.jsx)(V.z,{variant:"affirmative",className:"gap-1",size:"sm",loading:l,disabled:!t||r||a,type:"button",onClick:()=>n({edit:t}),children:l?(0,c.jsx)("span",{children:"Restoring..."}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:"Restore"}),(0,c.jsx)("span",{className:"hidden sm:flex",children:"this version"})]})})})});sQ.displayName="RestoreCommitButton";let s0=(0,x.memo)(function(e){let{activeEdit:t}=e;return(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)(sq,{}),(0,c.jsx)(sQ,{activeEdit:t})]})}),s1=(0,x.memo)(function(e){let{projectName:t,createdBy:s}=e;return(0,c.jsxs)("div",{className:"flex h-full items-center truncate",children:[(0,c.jsx)("p",{className:"font-medium",children:t}),"\xa0by\xa0",(0,c.jsx)(eC.default,{href:"/@".concat(s),children:(0,c.jsx)("p",{className:"font-medium",children:s})})]})}),s2=(0,x.memo)(function(){let{setIsRemixDialogOpen:e}=(0,U.d2)(),{canEdit:t}=(0,_.t)(),s=(0,U.iZ)(e=>e.project),{isAuthenticated:a}=(0,p.Eu)(),r=(0,m.useRouter)(),n=!!(null==s?void 0:s.is_supabase_enabled)||!!(null==s?void 0:s.supabase_project_config),l=t||!n,i=(0,x.useCallback)(()=>{if(!a){r.push("/login?redirect=".concat(window.location.pathname));return}e(!0)},[a,r,e]);return(0,c.jsxs)(en.u,{instant:!0,children:[(0,c.jsx)(en.aJ,{className:"cursor-default",children:(0,c.jsxs)(V.z,{className:"flex items-center gap-1",onClick:i,disabled:!l,size:"sm",children:[(0,c.jsx)(er.Z,{name:"shuffle",size:"small"}),"Remix"]})}),(0,c.jsx)(en._v,{className:"max-w-xs",children:l?(0,c.jsx)("p",{children:"Remix this project"}):(0,c.jsx)("p",{children:"This project is connected to Supabase. To remix, you must be a collaborator or member of this workspace."})})]})}),s5=()=>{let{canEdit:e,isLoading:t}=(0,_.t)(),s=(0,U.iZ)(e=>e.project),{isAuthenticated:a}=(0,p.Eu)(),r=(0,z.aK)(e=>e.edits),n=(0,I.Sl)(e=>e.activeEditId),l=n?r[n]:null,i=(0,I.Sl)(e=>e.consoleContentType),o=(0,H.c)(e=>e.hasFetchedCollaborators);return(0,x.useMemo)(()=>s?t||a&&!o?{center:(0,c.jsx)(sG.Center,{}),right:(0,c.jsx)(sG.Right,{}),left:(0,c.jsx)(sG.Left,{})}:l&&"snapshot-preview"===i?{center:(0,c.jsx)(sJ,{commitMessage:l.commit_message}),right:(0,c.jsx)(s0,{activeEdit:l}),left:(0,c.jsx)(sK,{activeEdit:l,project:s})}:e?{center:(0,c.jsx)(tP,{}),right:(0,c.jsx)(sB,{}),left:(0,c.jsx)(tL,{})}:{center:(0,c.jsx)(s1,{projectName:s.name,createdBy:s.created_by}),right:(0,c.jsx)(s2,{}),left:null}:{center:null,right:null,left:null},[s,t,a,o,l,i,e])},s4=(0,x.memo)(e=>{let{isSidebarOpen:t,toggleSidebar:s,openSidebar:a,hideButtons:r}=e,[n,l]=(0,ea.QJ)(eW.I8),{left:i,center:o,right:d}=s5(),u=(0,eM.SE)(e=>e.panelSizes)[0],m=(0,v.Z)("md");return(0,c.jsxs)("nav",{className:(0,el.cn)("relative hidden min-h-12 w-full shrink-0 flex-col items-center gap-2 px-4 py-2 md:flex md:h-12 md:flex-row md:gap-0 md:py-0"),children:[(0,c.jsx)(eV,{className:"flex w-full shrink-0 items-center",children:(0,c.jsxs)("div",{className:"relative flex w-full flex-shrink-0 items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-basis-0 flex-grow-1 flex flex-shrink-0 items-center gap-2",style:{width:m||0===u?"auto":"".concat(u||eU.DEFAULT_SIDEBAR_SIZE,"%")},children:[(0,c.jsx)(eF,{}),!r&&(0,c.jsxs)("div",{className:"flex flex-row-reverse gap-2 sm:ml-auto sm:mr-4 md:flex-row",children:[(0,c.jsx)(eo,{openSidebar:a}),(0,c.jsx)(eB,{isSidebarOpen:t,toggleSidebar:s})]})]}),(0,c.jsxs)("div",{className:"relative flex flex-shrink flex-grow justify-between gap-1 overflow-x-auto pl-2 @container md:ml-1 md:gap-2.5 md:pl-0",children:[(0,c.jsx)("div",{className:"hidden w-full md:flex",children:i}),t&&(0,c.jsx)("div",{className:"hidden md:flex",children:o}),(0,c.jsx)("div",{className:"ml-auto flex w-full justify-end md:ml-0",children:d})]})]})}),(0,c.jsxs)("div",{className:"flex min-h-8 w-full justify-between gap-2 md:hidden",children:[(0,c.jsx)("div",{className:"flex min-w-0 flex-1 items-center",children:o}),(0,c.jsx)("div",{className:"flex items-center",children:i})]}),!t&&(0,c.jsx)("div",{className:"absolute left-1/2 top-1/2 hidden -translate-x-1/2 -translate-y-1/2 md:flex",children:o})]})});s4.displayName="EditorNav";var s3=()=>{let e=(0,U.iZ)(e=>e.project),t=(0,R.bk)(e=>e.isSendChatMessageMutationPending),s=null==e?void 0:e.available_project_migrations;return(0,x.useMemo)(()=>null!=s&&!!s.length&&s.length>0&&!t,[s,t])},s6=s(72384);let s8=()=>{let e=(0,U.iZ)(e=>e.project),t=(0,F.D)(),s=(0,R.bk)(e=>e.isSendChatMessageMutationPending),a=(0,R.pY)(),r=null==e?void 0:e.available_project_migrations,[n,l]=(0,x.useState)(!(null==r?void 0:r.length));(0,x.useEffect)(()=>{(null==r?void 0:r.length)||l(!1),(null==r?void 0:r.length)&&!s&&l(!0)},[null==r?void 0:r.length,s]);let{mutateAsync:i,isPending:o}=(0,sF.m)({projectId:t,onSuccess:async()=>{h.Am.success("Project Updated")},onSubmit:()=>{}}),d=async()=>{try{var s;await i({body:{id:(0,P.Fd)(),message:"Please update the project template to the latest Lovable version to enable new features.",mode:s6.S.INSTANT,contains_error:!1,project_migration_ids:null==e?void 0:null===(s=e.available_project_migrations)||void 0===s?void 0:s.map(e=>e.id)},projectId:t})}catch(e){C.logging.error(e),h.Am.error("Error",{description:"There was an error sending the project update request."})}};return e&&n?(0,c.jsxs)(W.cZ,{children:[(0,c.jsx)(W.fK,{children:(0,c.jsx)(W.$N,{className:"text-xl font-medium",children:"Project out of date"})}),(0,c.jsxs)(W.Be,{className:"max-h-[80vh] overflow-y-auto scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[#636575]",children:[r&&(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)("h3",{className:"text-lg font-medium",children:"Available Updates"}),(0,c.jsx)("ul",{className:"space-y-3",children:r.map((e,t)=>(0,c.jsxs)("li",{className:"border-l-2 border-primary/20 pl-4",children:[(0,c.jsx)("h4",{className:"font-medium",children:e.name}),(0,c.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:e.description})]},t))})]}),(0,c.jsx)("p",{className:"mt-4 text-sm first-of-type:mt-0",children:"The AI assistant will guide you through the necessary steps to complete the migration."})]}),(0,c.jsxs)(W.cN,{children:[(0,c.jsx)(W.GG,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"outline",children:"Close"})}),(0,c.jsx)(V.z,{disabled:a,loading:o,onClick:d,children:"Update Project"})]})]}):null};var s9=s(96027),s7=s(23374);let ae=e=>{let{className:t,...s}=e;return(0,c.jsx)(s7.eh,{className:(0,el.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...s})},at=s7.s_,as=e=>{let{tooltip:t,className:s,...a}=e,[r,n]=(0,x.useState)(!1),[l,i]=(0,x.useState)(!1),[o,d]=(0,x.useState)(0),[u,m]=(0,x.useState)(0);return(0,x.useEffect)(()=>{var e;let t;let s=(e=e=>{d(e.clientY)},function(){for(var s=arguments.length,a=Array(s),r=0;r<s;r++)a[r]=arguments[r];clearTimeout(t),t=setTimeout(()=>e.apply(this,a),100)});return window.addEventListener("mousemove",s),()=>{window.removeEventListener("mousemove",s)}},[]),(0,c.jsx)(s7.OT,{className:(0,el.cn)("relative -mr-px mb-[20px] mt-[12px] flex w-[2px] cursor-col-resize items-center justify-center rounded-full transition-colors duration-300 ease-in-out after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 hover:bg-accent-primary focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 [&[data-panel-group-direction=vertical]>div]:rotate-90",s,r?"bg-accent-primary":""),onDragging:e=>{n(e)},...a,children:t&&(0,c.jsxs)(en.u,{disableHoverableContent:!0,open:!r&&l,onOpenChange:e=>{i(e),e&&m(o)},children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)("div",{className:"absolute -left-[2px] -right-[2px] bottom-0 top-0 z-[12000]"})}),(0,c.jsx)(en._v,{side:"right",align:"start",alignOffset:u>0?u-68:0,children:t})]})})};var aa=s(24853),ar=s(26178),an=s(27899),al=s(85474),ai=s(49027),ao=s(61312),ac=s(76818),ad=s(32582),au=s(5635),am=s(92259),ax=s(82959),ah=s(18081),ap=s(93673),af=s(40756),av=s(27339),ag=s(64266),aj=s(36254),ab=s(89651),ay=s(884),aw=s(48541),aN=s(26815),a_=s(9259),aC=s(74991),ak=s(53647),aE=s(19485),aS=s(74950),az=s(7342);let aI=e=>{let{title:t,children:s,disabled:a}=e;return(0,c.jsxs)("div",{className:(0,el.cn)("grid grid-cols-[100px_1fr]",{hidden:a}),children:[(0,c.jsx)("div",{children:(0,c.jsx)("p",{className:"py-2 text-sm font-medium text-muted-foreground",children:t})}),(0,c.jsx)("div",{className:"flex flex-col gap-2",children:s})]})},aR=e=>{let{children:t,disabled:s}=e;return(0,c.jsx)("div",{className:(0,el.cn)("border-px flex flex-col gap-2",{hidden:s}),children:t})};var aP=s(53916);let aD={content:"Content",margin:"Margin",background:"Background",borderRadius:"Border radius",image:"Image",resize:"Resize",fontSize:"Font size",textAlign:"Text align",padding:"Padding",fontWeight:"Font weight",color:"Color",advanced:"Advanced",selectParent:"Select parent",delete:"Delete",Content:"Content"},aO={spacing:[{key:"margin",title:aD.margin},{key:"padding",title:aD.padding}],typography:[{key:"fontSize",title:aD.fontSize},{key:"fontWeight",title:aD.fontWeight}]},aT=Object.values(aD),aA=e=>{let t=Object.values(aD).map(e=>({title:e})),s=new aP.Z(t,{keys:["title"],threshold:.3,includeScore:!0});return t=>!e.trim()||s.search(e).some(e=>e.item.title===t)},aZ=e=>{var t;let{inputValue:s,cursorPosition:a}=e;if(!s.trim()||null===a)return null;let r=s.substring(0,a),n=s.substring(a),l=r.split(/\s+/),i=(l[l.length-1]||"")+((null===(t=n.match(/^[^\s]*/))||void 0===t?void 0:t[0])||"");if(0===i.length)return null;let o=i.lastIndexOf(":");if(-1!==o){let e=i.substring(0,o+1),t=i.substring(o+1),s=t.length>0;return{completeWord:i,hasModifier:!0,modifier:e,classAfterColon:t,hasClassAfterColon:s}}return{completeWord:i,hasModifier:!1,modifier:"",classAfterColon:"",hasClassAfterColon:!1}},aL=e=>{let{wordInfo:t,getAutocomplete:s,limit:a}=e;if(!t)return{suggestions:[],shouldShow:!1};let{hasModifier:r,modifier:n,classAfterColon:l,hasClassAfterColon:i,completeWord:o}=t;if(r){if(i){let e=s(l,a).map(e=>n+e);return{suggestions:e,shouldShow:e.length>0}}return{suggestions:[],shouldShow:!1}}{let e=s(o,a);return{suggestions:e,shouldShow:e.length>0}}},aF=e=>{var t;let{element:s,currentClassName:a,disabled:r,isOpen:n,onUpdateClassName:l}=e,{getAutocomplete:i}=(0,aE.C)(),[o,d]=(0,x.useState)(!1),[u,m]=(0,x.useState)(""),[h,p]=(0,x.useState)(null),[f,v]=(0,x.useState)(""),g=(0,x.useRef)(null),j=(0,x.useRef)(null),b=(0,x.useRef)([]),y=(0,x.useCallback)(e=>{v(e)},[]),w=(0,x.useCallback)(()=>{let e=g.current;e&&p(e.selectionStart||0)},[]);(0,x.useEffect)(()=>{let e=e=>{let t=e.target,s=j.current;!s||s.contains(t)||t instanceof Element&&(t.closest('[role="dialog"]')||t.closest("[cmdk-root]")||t.closest("[data-radix-popper-content-wrapper]"))||d(!1)};if(o)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]);let N=(0,x.useMemo)(()=>aL({wordInfo:aZ({inputValue:u,cursorPosition:h}),getAutocomplete:i,limit:10}).suggestions,[u,h,i]),_=(0,x.useCallback)(e=>{let t=g.current;if(!t||null===h)return;let a=u.substring(0,h),r=u.substring(h),n=a.split(/\s+/),i=n[n.length-1]||"",o=r.match(/^[^\s]*/),c=(null==o?void 0:o[0])||"",x=r.substring(c.length),f=a.substring(0,a.length-i.length),v=(f+e+" "+x).replace(/\s+/g," ");m(v),l({element:s,className:v}),d(!1),setTimeout(()=>{t.focus();let s=f.length+e.length+1;t.setSelectionRange(s,s),p(s)},0)},[u,h,s,l]),C=(0,x.useCallback)(()=>{d(aL({wordInfo:aZ({inputValue:u,cursorPosition:h}),getAutocomplete:i,limit:10}).shouldShow)},[u,h,i]);(0,x.useEffect)(()=>{m(a||"")},[a]),(0,x.useEffect)(()=>{C()},[C]),(0,x.useEffect)(()=>{o&&N.length>0?v(N[0]):v("")},[o,N]);let k=(0,x.useMemo)(()=>N.indexOf(f),[N,f]);return(0,x.useEffect)(()=>{if(k>=0&&b.current[k]){var e;null===(e=b.current[k])||void 0===e||e.scrollIntoView({block:"nearest",behavior:"smooth"})}},[k]),(0,c.jsx)(eZ.E.div,{initial:{opacity:0,height:0},animate:{opacity:n?1:0,height:n?"auto":0},transition:{duration:.15,bounce:0},className:"-mt-3 flex flex-row gap-2",children:(0,c.jsx)("div",{ref:j,className:"relative w-full pt-2",children:(0,c.jsxs)(eq.J2,{open:!0,children:[(0,c.jsx)(eq.xo,{asChild:!0,children:(0,c.jsx)(ac.g,{ref:g,disabled:r,value:u,className:"w-full !resize-none bg-input outline-none ring-offset-background placeholder:text-muted-foreground focus-visible:ring-1 focus-visible:ring-offset-0",placeholder:"Enter Tailwind classes...",onChange:e=>{let t=e.target.value;m(t),l({element:s,className:t}),p(e.target.selectionStart||0)},onKeyUp:w,onClick:w,onSelect:w,onKeyDown:e=>{if("Escape"===e.key)d(!1);else if("Enter"===e.key)f&&N.includes(f)&&(e.preventDefault(),_(f));else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();let t=(N.indexOf(f)+("ArrowDown"===e.key?1:-1)+N.length)%N.length;y(N[t]||"")}setTimeout(w,0)},onFocus:e=>{p(e.currentTarget.selectionStart||0)}})}),(0,c.jsx)(eq.yk,{className:(0,el.cn)("max-h-40 w-full overflow-y-auto p-0",{hidden:!o}),side:"bottom",align:"start",style:{width:null===(t=g.current)||void 0===t?void 0:t.offsetWidth},children:(0,c.jsx)(eH.mY,{autoFocus:!1,value:f,onValueChange:y,children:(0,c.jsx)(eH.e8,{children:(0,c.jsx)(eH.fu,{children:N.map((e,t)=>(0,c.jsx)("div",{ref:e=>{b.current[t]=e},children:(0,c.jsx)(eH.di,{value:e,onSelect:()=>_(e),children:(0,c.jsx)("span",{className:"text-xs",children:e})})},e))})})})})]})})})},aM=e=>{let t,s;if(!e)return;let a=1;if(e.modifier){var r,n;a=(null===(r=e.modifier)||void 0===r?void 0:r.startsWith("["))&&(null===(n=e.modifier)||void 0===n?void 0:n.endsWith("]"))?parseFloat(e.modifier.replace(/[\[\]]/g,"")):parseInt(e.modifier)/100}if("inherit"===e.valueDef.raw)return;"transparent"===e.valueDef.raw&&(a=0),e.valueDef.raw.startsWith("#")?s=e.valueDef.raw:(t=e.valueDef.raw,s=e.value);let l=(0,aw.oo)(s);if(!l)return{name:t,hex:void 0};let i=(0,aw.vq)(l.r,l.g,l.b,a);return{name:t||i,hex:i,hexWithoutAlpha:(0,aw.vq)(l.r,l.g,l.b,1)}},aU={fontSize:{xs:"XS",base:"Body",sm:"Small",md:"Medium",lg:"Large",xl:"XL","2xl":"2XL","3xl":"3XL","4xl":"4XL","5xl":"5XL","6xl":"6XL","7xl":"7XL","8xl":"8XL","9xl":"9XL"},borderRadius:{none:"None",DEFAULT:"Default",sm:"Small",md:"Medium",lg:"Large",xl:"XL","2xl":"2XL","3xl":"3XL",full:"Full"}},aV=e=>{var t,s,a;let{element:r,disabled:n}=e,{authUser:l}=(0,p.Eu)(),{currentClassName:i,ast:o}=(0,tl.v)(),d=(0,tT.UC)(e=>e.searchQuery),u=(0,au.B)(r),{handleImageChange:m,initializeClassName:h,handleUpdateClassName:f,handleUpdateClassNameAdvanced:v}=(0,al.U)();(0,x.useEffect)(()=>{h(r,o)},[r,o,h]);let g=(0,ta.A7)(e=>e.addUpload),{theme:j,getRelevantTwClass:b,parse:y,classname:w}=(0,aE.O)(),_=(0,x.useMemo)(()=>{var e,t,s,a,r,n,l,o,c,d,u,m;if(!i)return;let x=e=>{if(e){if(e.endsWith("px"))return parseFloat(e.replace("px",""));if(e.endsWith("rem"))return 16*parseFloat(e.replace("rem",""))}},h=b(i,"padding"),p=b(i,"paddingY"),f=b(i,"paddingX");return{paddingTop:null!==(n=null!==(r=x(null===(e=b(i,"paddingTop"))||void 0===e?void 0:e.value))&&void 0!==r?r:x(null==p?void 0:p.value))&&void 0!==n?n:x(null==h?void 0:h.value),paddingBottom:null!==(o=null!==(l=x(null===(t=b(i,"paddingBottom"))||void 0===t?void 0:t.value))&&void 0!==l?l:x(null==p?void 0:p.value))&&void 0!==o?o:x(null==h?void 0:h.value),paddingLeft:null!==(d=null!==(c=x(null===(s=b(i,"paddingLeft"))||void 0===s?void 0:s.value))&&void 0!==c?c:x(null==f?void 0:f.value))&&void 0!==d?d:x(null==h?void 0:h.value),paddingRight:null!==(m=null!==(u=x(null===(a=b(i,"paddingRight"))||void 0===a?void 0:a.value))&&void 0!==u?u:x(null==f?void 0:f.value))&&void 0!==m?m:x(null==h?void 0:h.value)}},[b,i]),C=(0,x.useMemo)(()=>{var e,t,s,a,r,n,l,o,c,d,u,m;if(!i)return;let x=e=>{if(e){if(e.endsWith("px"))return parseFloat(e.replace("px",""));if(e.endsWith("rem"))return 16*parseFloat(e.replace("rem",""))}},h=b(i,"margin"),p=b(i,"marginY"),f=b(i,"marginX");return{marginTop:null!==(n=null!==(r=x(null===(e=b(i,"marginTop"))||void 0===e?void 0:e.value))&&void 0!==r?r:x(null==p?void 0:p.value))&&void 0!==n?n:x(null==h?void 0:h.value),marginBottom:null!==(o=null!==(l=x(null===(t=b(i,"marginBottom"))||void 0===t?void 0:t.value))&&void 0!==l?l:x(null==p?void 0:p.value))&&void 0!==o?o:x(null==h?void 0:h.value),marginLeft:null!==(d=null!==(c=x(null===(s=b(i,"marginLeft"))||void 0===s?void 0:s.value))&&void 0!==c?c:x(null==f?void 0:f.value))&&void 0!==d?d:x(null==h?void 0:h.value),marginRight:null!==(m=null!==(u=x(null===(a=b(i,"marginRight"))||void 0===a?void 0:a.value))&&void 0!==u?u:x(null==f?void 0:f.value))&&void 0!==m?m:x(null==h?void 0:h.value)}},[b,i]),k={margin:{horizontal:{property:"marginX",icon:ax.Z,placeholder:"X margin",value:null==C?void 0:C.marginLeft},vertical:{property:"marginY",icon:am.Z,placeholder:"Y margin",value:null==C?void 0:C.marginTop}},padding:{horizontal:{property:"paddingX",icon:ah.Z,placeholder:"X padding",value:null==_?void 0:_.paddingLeft},vertical:{property:"paddingY",icon:ap.Z,placeholder:"Y padding",value:null==_?void 0:_.paddingTop}}},E={fontSize:{property:"fontSize",placeholder:"Select font size",getValue:(e,t)=>{var s;return(null===(s=t(e,"fontSize"))||void 0===s?void 0:s.valueDef.raw)||"base"},options:e=>Object.entries((null==e?void 0:e.fontSize)||{}),nameMap:aU.fontSize},fontWeight:{property:"fontWeight",placeholder:"Select weight",getValue:(e,t)=>{var s;return null===(s=t(e,"fontWeight"))||void 0===s?void 0:s.valueDef.raw},options:e=>Object.entries((null==e?void 0:e.fontWeight)||{}).filter(e=>{let[t]=e;return"black"!==t}),nameMap:null}},S=aM(b(i,"textColor")),z=aM(b(i,"backgroundColor")),[I,R]=(0,ab.Z)("lov_vis_advancedOpen",{defaultValue:!1}),P=(0,x.useRef)({}),[D,O]=(0,x.useState)({}),T=(0,x.useCallback)(e=>{var t;let s=e.property,a=Date.now();O(t=>({...t,[s]:e.value})),P.current[s]&&cancelAnimationFrame(P.current[s].rafId);let n=()=>{let e=P.current[s];if(e){let t=y(w(e.immediateValue));if("error"===t.kind)return;let n=t.valueDef.raw,l=[e.immediateValue];if("backgroundColor"===e.immediateValue.property&&"button"===u&&n.split("-").length>1){let[e,t]=n.split("-"),s=parseInt(t)-100;if((s=100*Math.floor(s/100))>0){let t="".concat(e,"-").concat(s);l.push({property:"backgroundColor",value:t,variants:[{kind:"named",type:"interaction",value:"hover"}]})}}f({element:r,classObj:l}),P.current[s].lastUpdateTime=a,delete P.current[s]}};P.current[s]={rafId:0,lastValue:e,immediateValue:e,lastUpdateTime:(null===(t=P.current[s])||void 0===t?void 0:t.lastUpdateTime)||0},P.current[s].rafId=requestAnimationFrame(()=>{n()})},[w,r,u,f,y]),A=(0,x.useCallback)((e,t)=>{var s;return null!==(s=D[e])&&void 0!==s?s:t},[D]),Z=null===(t=b(i,"textAlign"))||void 0===t?void 0:t.value,L=null!==i,F=aA(d),M=[aD.margin,aD.padding,aD.fontSize,aD.fontWeight,aD.color,aD.textAlign,aD.background,aD.borderRadius,aD.image,aD.resize].some(e=>F(e)),U=aO.spacing.some(e=>F(e.title)),W=aO.typography.some(e=>F(e.title));return(0,c.jsxs)(c.Fragment,{children:[L&&M?(0,c.jsxs)("div",{className:"flex flex-grow flex-col gap-2",children:[U&&(0,c.jsx)(aR,{disabled:"img"===u,children:aO.spacing.filter(e=>F(e.title)).map(e=>{var t,s;let a=k[e.key];return(0,c.jsx)(aI,{title:e.title,children:(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(a_.R,{max:240,className:"flex-grow rounded-md bg-input",value:null!==(t=a.horizontal.value)&&void 0!==t?t:0,placeholder:a.horizontal.placeholder,name:a.horizontal.property,disabled:n,onChange:e=>a.horizontal.value!==e&&T({property:a.horizontal.property,value:"".concat(e,"px")}),leftIcon:(0,c.jsx)(a.horizontal.icon,{className:"size-4 fill-muted-foreground"})}),(0,c.jsx)(a_.R,{max:240,value:null!==(s=a.vertical.value)&&void 0!==s?s:0,className:"flex-grow rounded-md bg-input",placeholder:a.vertical.placeholder,name:a.vertical.property,disabled:n,onChange:e=>a.vertical.value!==e&&T({property:a.vertical.property,value:"".concat(e,"px")}),leftIcon:(0,c.jsx)(a.vertical.icon,{className:"size-4 fill-muted-foreground"})})]})},e.key)})}),W&&(0,c.jsxs)(aR,{disabled:"text"!==u&&"button"!==u,children:[aO.typography.filter(e=>F(e.title)).map(e=>{let t=E[e.key];return F(e.title)?(0,c.jsx)(aI,{title:e.title,children:(0,c.jsxs)(ak.Ph,{name:t.property,disabled:n,onValueChange:e=>{e&&(N.ZP.capture("visual_edits:".concat(t.property,"_changed")),T({property:t.property,value:e}))},onOpenChange:e=>{e||f({element:r,classObj:[{property:t.property,value:t.getValue(i,b)}]})},value:t.getValue(i,b),children:[(0,c.jsx)(ak.i4,{className:"bg-input",name:t.property,children:(0,c.jsx)(ak.ki,{placeholder:t.placeholder})}),(0,c.jsx)(ak.Bw,{className:"fontWeight"===e.key?"visual-edits_font-weight-selector":"",children:t.options(j).map(e=>{var s;let[a,n]=e;return(0,c.jsx)(ak.Ql,{"data-value":a,value:a,onFocus:e=>{let s=e.target.getAttribute("data-value");s&&requestAnimationFrame(()=>{f({element:r,classObj:[{property:t.property,value:s}],preview:!0})})},children:t.nameMap?null!==(s=t.nameMap[a])&&void 0!==s?s:a:(0,c.jsx)("span",{className:"capitalize",children:a})},a)})})]})},e.key):null}),F(aD.color)&&(0,c.jsx)(aI,{title:aD.color,children:(0,c.jsx)(ay.z,{disabled:n,presetColors:null==j?void 0:j.colors,color:A("textColor",null==S?void 0:S.hex)||"transparent",onChange:e=>{e&&(N.ZP.capture("visual_edits:text_color_changed"),T({property:"textColor",value:e||"inherit"}))},children:(0,c.jsxs)(V.z,{variant:"outline",disabled:n,className:"flex h-9 w-full justify-start rounded-md border border-input bg-input px-3 py-1 text-left font-normal shadow-sm transition-colors hover:bg-input",children:[(0,c.jsxs)("div",{className:"relative mr-2 h-4 w-4 overflow-hidden rounded-full",children:[(0,c.jsx)("div",{className:"absolute inset-0",children:(0,c.jsx)(az.V,{})}),(0,c.jsx)("div",{className:"absolute inset-y-0 left-0 w-2",style:{backgroundColor:null==S?void 0:S.hexWithoutAlpha}}),(0,c.jsx)("div",{className:"absolute inset-y-0 right-0 w-2",style:{backgroundColor:null==S?void 0:S.hex}})]}),(0,c.jsx)("span",{className:"truncate",children:(null==S?void 0:S.name)||"Inherit"})]})},"".concat(r.filePath,":").concat(r.lineNumber))}),F(aD.textAlign)&&(0,c.jsx)(aI,{title:aD.textAlign,children:(0,c.jsxs)(aC.E,{className:"flex flex-row justify-end gap-2",value:Z,onValueChange:e=>T({property:"textAlign",value:e}),children:[(0,c.jsxs)(aN.Label,{title:"Left",children:[(0,c.jsx)(aC.m,{value:"left",className:"peer rounded-full p-2",hidden:!0}),(0,c.jsx)(V.z,{variant:"outline",className:(0,el.cn)("bg-input p-2",{"bg-accent":"left"===Z}),onClick:()=>T({property:"textAlign",value:"left"}),children:(0,c.jsx)(ag.Z,{className:"size-4 fill-muted-foreground"})})]}),(0,c.jsxs)(aN.Label,{title:"Center",children:[(0,c.jsx)(aC.m,{value:"center",className:"peer rounded-full p-2",hidden:!0}),(0,c.jsx)(V.z,{variant:"outline",className:(0,el.cn)("bg-input p-2",{"bg-accent":"center"===Z}),onClick:()=>T({property:"textAlign",value:"center"}),children:(0,c.jsx)(af.Z,{className:"size-4 fill-muted-foreground"})})]}),(0,c.jsxs)(aN.Label,{title:"Right",children:[(0,c.jsx)(aC.m,{value:"right",className:"peer rounded-full p-2",hidden:!0}),(0,c.jsx)(V.z,{variant:"outline",className:(0,el.cn)("bg-input p-2",{"bg-accent":"right"===Z}),onClick:()=>T({property:"textAlign",value:"right"}),children:(0,c.jsx)(aj.Z,{className:"size-4 fill-muted-foreground"})})]}),(0,c.jsxs)(aN.Label,{title:"Justify",children:[(0,c.jsx)(aC.m,{value:"justify",className:"peer rounded-full p-2",hidden:!0}),(0,c.jsx)(V.z,{variant:"outline",className:(0,el.cn)("bg-input p-2",{"bg-accent":"justify"===Z}),onClick:()=>T({property:"textAlign",value:"justify"}),children:(0,c.jsx)(av.Z,{className:"size-4 fill-muted-foreground"})})]})]})})]}),(0,c.jsxs)(aR,{disabled:"div"!==u&&"button"!==u,children:[F(aD.background)&&(0,c.jsx)(aI,{title:aD.background,children:(0,c.jsx)(ay.z,{disabled:n,color:A("backgroundColor",null==z?void 0:z.hex)||"transparent",onChange:e=>{e&&(N.ZP.capture("visual_edits:background_color_changed"),T({property:"backgroundColor",value:e||"inherit"}))},presetColors:null==j?void 0:j.colors,children:(0,c.jsxs)(V.z,{variant:"outline",disabled:n,className:"flex h-9 w-full items-center justify-start rounded-md border border-input bg-input px-3 py-1 text-left font-normal shadow-sm transition-colors hover:bg-input",children:[(0,c.jsxs)("div",{className:"relative mr-2 h-4 w-4 overflow-hidden rounded-full",children:[(0,c.jsx)("div",{className:"absolute inset-0",children:(0,c.jsx)(az.V,{})}),(0,c.jsx)("div",{className:"absolute inset-y-0 left-0 w-2",style:{backgroundColor:null==z?void 0:z.hexWithoutAlpha}}),(0,c.jsx)("div",{className:"absolute inset-y-0 right-0 w-2",style:{backgroundColor:null==z?void 0:z.hex}})]}),(0,c.jsx)("span",{className:"truncate",children:(null==z?void 0:z.name)||"Inherit"})]})},"".concat(r.filePath,":").concat(r.lineNumber))}),F(aD.borderRadius)&&(0,c.jsx)(aI,{title:aD.borderRadius,children:(0,c.jsxs)(ak.Ph,{disabled:n,onValueChange:e=>e&&T({property:"borderRadius",value:e}),value:(null===(s=b(i,"borderRadius"))||void 0===s?void 0:s.valueDef.raw)||"none",children:[(0,c.jsx)(ak.i4,{className:"bg-input hover:bg-input",children:(0,c.jsx)(ak.ki,{placeholder:"Select border radius"})}),(0,c.jsx)(ak.Bw,{children:Object.entries((null==j?void 0:j.borderRadius)||{}).map(e=>{var t;let[s,a]=e;return(0,c.jsx)(ak.Ql,{value:s,children:null!==(t=aU.borderRadius[s])&&void 0!==t?t:"Default"},s)})})]})})]}),(0,c.jsxs)(aR,{disabled:"img"!==u,children:[F(aD.image)&&(0,c.jsx)(aI,{title:aD.image,children:(0,ad.cB)(r,o,"src")?(0,c.jsx)(aS.r,{disabled:n||!(0,ad.cB)(r,o,"src"),onUrlSubmitted:e=>m(r,e),onImagesUploaded:e=>{e.length>0&&(N.ZP.capture("visual_edits:image_uploaded"),g({dir_name:l.uid,file_name:e[0].name,type:e[0].type,id:e[0].id}),m(r,"/lovable-uploads/".concat(e[0].name),e[0].downloadUrl))}}):(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:"This element contains dynamic elements and its image cannot be manually edited. Please use the chat to change the image."})}),F(aD.resize)&&(0,c.jsx)(aI,{title:aD.resize,children:(0,c.jsxs)(ak.Ph,{disabled:n,onValueChange:e=>e&&T({property:"objectFit",value:e}),value:((null===(a=b(i,"objectFit"))||void 0===a?void 0:a.valueDef.raw)||"object-none").replace("object-",""),children:[(0,c.jsx)(ak.i4,{className:"bg-input",children:(0,c.jsx)(ak.ki,{placeholder:"Select border radius"})}),(0,c.jsxs)(ak.Bw,{className:"bg-popover",children:[(0,c.jsx)(ak.Ql,{value:"contain",children:"Contain"}),(0,c.jsx)(ak.Ql,{value:"cover",children:"Cover"}),(0,c.jsx)(ak.Ql,{value:"fill",children:"Fill"}),(0,c.jsx)(ak.Ql,{value:"none",children:"None"}),(0,c.jsx)(ak.Ql,{value:"scale-down",children:"Scale down"})]})]})})]})]}):null,L&&F(aD.advanced)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:(0,el.cn)("mt-4 flex flex-row justify-between",{"pb-3":!I}),children:[(0,c.jsxs)(V.z,{variant:"ghost",size:"sm",className:"h-6 py-0.5 pl-0.5 text-xs transition duration-300 hover:bg-secondary",onClick:()=>{R(!I),N.ZP.capture("visual_edits:advanced_clicked")},children:[(0,c.jsx)(er.Z,{name:"chevron_right",size:"small",className:(0,el.cn)("transition-transform duration-150 ease-in-out",{"rotate-90":I})}),"Advanced"]}),(0,c.jsx)("div",{className:(0,el.cn)("flex flex-row gap-2",{"opacity-0":!I}),children:(0,c.jsxs)(en.u,{instant:!0,children:[(0,c.jsx)(en.aJ,{children:(0,c.jsx)(er.Z,{name:"help",size:"small",className:"text-muted-foreground"})}),(0,c.jsx)(en._v,{children:(0,c.jsx)("p",{children:"Enter custom Tailwind classes"})})]})})]}),I&&(0,c.jsx)(aF,{element:r,currentClassName:i,disabled:n,isOpen:I,onUpdateClassName:v})]})]})},aW=e=>{let{element:t,disabled:s=!1}=e,a=(0,au.B)(t),r=(0,tT.UC)(e=>e.searchQuery),{handleTextChange:n,handleRemoveNode:l,handleDuplicateNode:i,undoLastOperation:o,initializeClassName:d}=(0,al.U)(),{ast:u,currentClassName:m}=(0,tl.v)(),h=(0,x.useMemo)(()=>(0,ad.H2)(t,u),[t,u]);(0,x.useEffect)(()=>{d(t,u)},[t,u,d]),(0,x.useEffect)(()=>{let e=e=>{if(e.data.type===aa.C.KEYBIND){let{compositeKey:t}=e.data.payload}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[t,i,l,o]);let p=aA(r),f=[aD.margin,aD.padding,aD.fontSize,aD.fontWeight,aD.color,aD.textAlign,aD.background,aD.borderRadius,aD.image,aD.resize].some(e=>p(e));return(0,x.useMemo)(()=>h||p(aD.content)||p(aD.advanced)||f,[h,f,p])?(0,c.jsxs)("div",{className:"flex flex-grow flex-col gap-2 px-3",children:[h?(0,c.jsx)(c.Fragment,{children:p(aD.content)?(0,c.jsxs)(aI,{title:aD.content,disabled:"text"!==a&&"button"!==a,children:[(0,c.jsx)(ac.g,{value:(0,al.D)(t.textContent||""),disabled:!h||s,className:(0,el.cn)("resize-none text-base leading-snug placeholder-shown:text-ellipsis placeholder-shown:whitespace-nowrap","focus-visible:ring-0 focus-visible:ring-offset-0","max-h-[200px] scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[#636575]","h-auto border bg-input focus:bg-input",!h&&"hidden"),placeholder:"Enter text here",onChange:e=>n(t,e.target.value)}),(0,c.jsx)("p",{className:(0,el.cn)("text-xs text-muted-foreground",{hidden:h}),children:"This element contains dynamic elements so its text cannot be manually edited. Use the chat to change the text."})]}):null}):("text"===a||"button"===a)&&p(aD.Content)&&(0,c.jsx)(aI,{title:"Content",children:(0,c.jsxs)("div",{className:"my-auto flex items-center justify-between",children:[(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:"Change the text by prompting in the chat box, only static text can be edited instantly."}),(0,c.jsxs)(en.u,{instant:!0,children:[(0,c.jsx)(ao.aJ,{children:(0,c.jsx)(er.Z,{name:"help",size:"small",className:"inline-block-translate-y-[1px] ml-auto text-muted-foreground"})}),(0,c.jsx)(en._v,{children:"Content linked to backend or code. Ask AI to edit."})]})]})}),(0,c.jsx)(aV,{element:t,disabled:s||null===m})]}):null};function aB(e){let{element:t,canEdit:s,isSaving:a,handleRemoveNode:r}=e;return(0,c.jsxs)(W.Vq,{children:[(0,c.jsx)(W.hg,{children:(0,c.jsxs)(en.u,{children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsxs)(V.z,{variant:"ghost",disabled:!s||a,className:(0,el.cn)("flex w-full items-center justify-start gap-2 pl-2 text-destructive-primary hover:bg-secondary",{hidden:!t}),children:[(0,c.jsx)(er.Z,{name:"delete",size:"small"})," Delete"]})}),(0,c.jsx)(en._v,{children:(0,c.jsx)("p",{children:"Delete element"})})]})}),(0,c.jsx)(W.cZ,{className:"p-4",size:"sm",children:(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{children:"Delete Element"}),(0,c.jsx)(W.Be,{children:"Are you sure you want to delete this element?"}),(0,c.jsxs)(W.cN,{className:"flex gap-2 pt-4",children:[(0,c.jsx)(ai.GG,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"outline",children:"Cancel"})}),(0,c.jsx)(ai.GG,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"destructive",onClick:()=>r(t),children:"Delete"})})]})]})})]})}function aG(e){let{element:t,canEdit:s,isSaving:a}=e,r=(0,aa.p)(),{handleRemoveNode:n}=(0,al.U)(),l=aA((0,tT.UC)(e=>e.searchQuery)),i=l(aD.selectParent)||l(aD.delete);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(aW,{element:t,disabled:a||!s}),i&&(0,c.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[l(aD.selectParent)&&(0,c.jsxs)(V.z,{className:"flex w-full items-center justify-start pl-2",onClick:()=>{r({type:aa.C.GET_PARENT_ELEMENT,payload:{id:{filePath:t.filePath,lineNumber:t.lineNumber,col:t.col}}})},variant:"ghost",children:[(0,c.jsx)(er.Z,{name:"ink_selection",size:"small"}),"Select parent"]}),l(aD.delete)&&(0,c.jsx)(aB,{element:t,canEdit:s,isSaving:a,handleRemoveNode:n})]})]})}function aJ(e){let{isDiscardDialogOpen:t,setIsDiscardDialogOpen:s,hasUnsavedChanges:a,isSaving:r,handleDiscard:n}=e;return(0,c.jsxs)(W.Vq,{open:t,onOpenChange:s,children:[(0,c.jsx)(W.hg,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"secondary",className:"duration-125 ml-auto transition ease-out hover:bg-secondary",onClick:e=>{a||(e.preventDefault(),e.stopPropagation())},disabled:r||!a,children:"Discard"})}),(0,c.jsx)(W.cZ,{className:"p-4",size:"sm",children:(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{children:"Discard Changes"}),(0,c.jsx)(W.Be,{children:"Are you sure you want to discard your changes?"}),(0,c.jsxs)(W.cN,{className:"flex gap-2 pt-4",children:[(0,c.jsx)(W.GG,{children:(0,c.jsx)(V.z,{variant:"outline",children:"Cancel"})}),(0,c.jsx)(W.GG,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"destructive",onClick:n,children:"Discard"})})]})]})})]})}function aH(e){let{selectedElement:t,prevSelectedElementRef:s,selectedElements:a}=e,r=(0,U.iZ)(e=>e.projectId),{turnOffVisualEditing:n}=(0,tT.S9)(),l=(0,x.useRef)(null),i=(0,tT.UC)(e=>e.searchQuery),{setSearchQuery:o}=(0,tT.S9)(),{hasUnsavedChanges:d}=(0,tl.v)(),u=(0,tT.UC)(e=>e.isVisualEditingActive)&&d;(0,x.useEffect)(()=>{var e,a;t.id!==(null===(e=s.current)||void 0===e?void 0:e.id)&&void 0!==t.id&&(null===(a=l.current)||void 0===a||a.focus())},[t,s]);let m=(0,sF.m)({projectId:r}),p=async e=>{if(e.preventDefault(),i.trim()&&!m.isPending){if(u){h.Am.error("Save the manual edits first.",{duration:6e3});return}await m.mutateAsync({body:{id:(0,P.Fd)(),message:i.trim(),images:[],selected_elements:a,chat_only:!1,agent_mode:void 0},clear:()=>{o(""),n()}})}};return(0,c.jsxs)("form",{className:"flex w-full flex-col gap-1.5",onSubmit:p,children:[(0,c.jsx)(eK.I,{placeholder:"Search or ask for changes...",value:i,onChange:e=>o(e.target.value),className:"border-none p-0 shadow-none focus-visible:ring-0 focus-visible:ring-offset-0",ref:l}),(0,c.jsx)(t7.Separator,{}),i.length>0&&(0,c.jsx)(s$.b,{side:"bottom",showTooltip:u,tooltipContent:(0,c.jsx)("p",{children:"Save the manual edits first."}),children:(0,c.jsxs)("button",{className:"flex w-full items-center gap-1.5 rounded-md bg-secondary px-2.5 py-2 text-sm text-muted-foreground disabled:opacity-50",type:"submit",children:[(0,c.jsx)(er.Z,{name:"lovable_icon",size:"xsmall",className:"mb-0.5"}),(0,c.jsx)("span",{className:"truncate",children:'Ask Lovable "'.concat(i,'"...')}),(0,c.jsx)(er.Z,{name:"arrow_circle_up",className:"ml-auto"})]})})]})}let aK=e=>{let{position:t}=e,{selectedElements:s,canEdit:a}=(0,ar.H)(),{turnOffVisualEditing:r,closeVisualEditsPanel:n}=(0,tT.S9)(),l=s[0],[i,o]=(0,x.useState)(!1),{syncCode:d,generateAst:u,hasUnsavedChanges:m,refreshPreview:h}=(0,tl.v)(),{undoLastOperation:p}=(0,al.U)(),f=(0,ta.A7)(e=>e.clearPendingChanges),v=(0,ta.A7)(e=>e.clearUploads),{snapshot:g}=(0,ta.ag)(),j=(0,x.useRef)(null),b=(0,tT.UC)(e=>e.searchQuery),y=(0,tT.UC)(e=>e.isSaving),{setIsSaving:w}=(0,tT.S9)(),_=(0,eg.f6)(e=>"live"!==e.visibleMode&&"live"===e.targetMode),{hasInitialCode:C}=(0,tl.v)(),k=(0,x.useCallback)(async()=>(N.ZP.capture("visual_edits:save_clicked"),w(!0),d(g.getPendingChanges()).then(()=>{w(!1),r()})),[w,g,d,r]);(0,es.y1)("meta+z",e=>{e.preventDefault(),a&&p()}),(0,es.y1)("meta+enter",e=>{e.preventDefault(),a&&k().finally(()=>{r()})});let E=(0,x.useCallback)(()=>{N.ZP.capture("visual_edits:discard_clicked"),f(),v(),h(),u(),r()},[f,v,u,r,h]);(0,es.y1)("esc",e=>{e.preventDefault(),n()},{enableOnFormTags:!0});let S=(0,x.useRef)(null),z=(0,x.useRef)(null),I=(0,x.useRef)(null);(0,x.useEffect)(()=>{if(l&&I.current&&l.id!==I.current.id){var e;null===(e=z.current)||void 0===e||e.focus(),S.current.scrollTop=0}I.current=l},[S,l]),(0,x.useEffect)(()=>{let e=e=>{if(e.data.type===aa.C.KEYBIND){let{compositeKey:t}=e.data.payload;switch(t){case"Meta+z":a&&p();break;case"Meta+Enter":a&&k()}}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[a,k,m,r,p]);let[R,P]=(0,x.useState)(an.xz),D=(0,x.useCallback)(()=>{P(Math.min(S.current.scrollHeight,an.xz))},[]);(0,x.useEffect)(()=>{D()},[b,l,m,_,D]);let O=_||!C,T=aA(b),A=aT.every(e=>!T(e));return(0,c.jsx)(eZ.E.div,{className:"fixed z-[9999] flex flex-col rounded-xl bg-popover",style:{width:an.hV,left:t.x,top:t.y,boxShadow:"0px 0px 10px 0px rgba(0, 0, 0, 0.1)"},initial:!1,animate:{height:O?an.xz:R},transition:{duration:0},ref:j,children:(0,c.jsxs)("div",{className:(0,el.cn)("relative flex w-full flex-col gap-2 overflow-y-auto rounded-xl bg-popover",{grow:O,"pb-2":!O&&!m,"border border-muted-border":m}),ref:S,children:[(0,c.jsx)("div",{className:(0,el.cn)("sticky left-0 right-0 top-0 z-10 flex flex-col items-center gap-2 bg-popover px-3 pt-[10px]",{"pb-0":A}),children:(0,c.jsx)(aH,{selectedElement:l,prevSelectedElementRef:I,selectedElements:s})}),l?(0,c.jsx)(c.Fragment,{children:O?(0,c.jsxs)("div",{className:"relative flex grow items-center justify-center gap-2 pb-7",children:[(0,c.jsx)("p",{className:"font-medium",children:"Starting live preview..."}),(0,c.jsx)(e6.$,{variant:"ring",size:"default"})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(aG,{element:l,canEdit:a,isSaving:y}),m&&(0,c.jsxs)("div",{className:"sticky bottom-0 left-0 right-0 flex items-center gap-2 border-t border-input bg-popover/40 p-2 backdrop-blur-sm",children:[(0,c.jsx)(aJ,{isDiscardDialogOpen:i,setIsDiscardDialogOpen:o,hasUnsavedChanges:m,isSaving:y,handleDiscard:E}),(0,c.jsx)(V.z,{onClick:k,loading:y,disabled:!m,className:"visual-edits-save",variant:"affirmative",children:"Save"})]})]})}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1",children:[(0,c.jsx)(er.Z,{name:"my_location",className:"h-4 w-4"})," Edit"]}),(0,c.jsx)("div",{className:"flex h-full flex-col items-center justify-center pb-14 text-muted-foreground opacity-80",children:(0,c.jsx)("p",{className:"pt-4 text-center text-sm",children:"Select to edit or ask Lovable to modify"})})]})]})})},aq=()=>{let{handleDeactivatePickAndEdit:e}=(0,ar.H)(),{enableServer:t}=(0,tl.v)(),{setIsPickAndEditActive:s}=(0,tT.S9)();return(0,x.useEffect)(()=>(t(),s(!0),()=>{e()}),[t,e,s]),null},a$=()=>{let e=(0,tT.UC)(e=>e.isVisualEditingActive),t=(0,tT.UC)(e=>e.visualEditsPanelState),{turnOffVisualEditing:s}=(0,tT.S9)();return(0,x.useEffect)(()=>{let e=e=>{if(e.data.type===aa.C.KEYBIND){let{compositeKey:t}=e.data.payload;switch(t){case"Alt+S":case"Alt+\xdf":s()}}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[s]),(0,c.jsxs)(c.Fragment,{children:[e&&(0,c.jsx)(aq,{}),e&&t.isOpen&&(0,c.jsx)(aK,{position:t.position})]})};function aY(){let e=(0,tT.UC)(e=>e.floatingInputState),t=(0,U.iZ)(e=>e.projectId),s=(0,tT.UC)(e=>e.selectedElements),{turnOffVisualEditing:a}=(0,tT.S9)(),{hasUnsavedChanges:r,ast:n}=(0,tl.v)(),[l,i]=(0,x.useState)(""),o=(0,tT.UC)(e=>e.isVisualEditingActive),d=o&&r,u=(0,tT.UC)(e=>{var t;return null===(t=e.selectedElements)||void 0===t?void 0:t[0]}),m=(0,x.useRef)(null),h=(0,sF.m)({projectId:t});if((0,x.useEffect)(()=>{if(o&&(null==s?void 0:s.length)>0&&m.current&&!d&&!(0,ad.H2)(u,n)){var e;null===(e=m.current)||void 0===e||e.focus()}},[s,o,d,u]),(0,x.useEffect)(()=>{let t=e=>{"Escape"===e.key&&(a(),i(""))};if(e.isVisible)return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[e.isVisible,a]),!e.isVisible)return null;let p=async e=>{e.preventDefault(),l.trim()&&!h.isPending&&await h.mutateAsync({body:{id:(0,P.Fd)(),message:l.trim(),images:[],selected_elements:s,optimisticImageUrls:[],chat_only:!1,agent_mode:void 0},clear:()=>{i(""),a()}})};return(0,c.jsxs)("form",{className:"fixed z-[9999] flex items-center gap-2 rounded-3xl border bg-popover px-3 py-6 shadow-xl",style:{width:an.u4,height:an.dY,left:e.position.x,top:e.position.y},onSubmit:p,children:[(0,c.jsx)(eK.I,{type:"text",placeholder:"Ask for quick changes here...",className:"h-auto grow rounded-lg border-none bg-popover p-0 caret-affirmative-primary shadow-none focus-visible:ring-0 md:text-base",ref:m,value:l,onChange:e=>i(e.target.value),disabled:h.isPending}),(0,c.jsx)("button",{type:"submit",className:"flex h-[21px] w-6 items-center justify-center rounded-full bg-affirmative-primary transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",disabled:!l.trim()||h.isPending,children:(0,c.jsx)(er.Z,{name:"arrow_upward_alt_600",size:"default",className:"text-affirmative-primary-foreground"})})]})}var aX=s(30166),aQ=s(88568),a0=s(90045),a1=s(40236),a2=s(23260),a5=s(55214),a4=s.n(a5),a3=s(12752);let a6={add_dependency:{icon:"deployed_code",color:"text-green-500"},remove_dependency:{icon:"deployed_code",color:"text-red-500"},delete:{icon:"scan_delete",color:"text-red-500"},delete_directory:{icon:"scan_delete",color:"text-red-500"},edit:{icon:"note_stack",color:"text-yellow-500"},new:{icon:"note_add",color:"text-green-500"},rename:{icon:"swap_horiz",color:"text-blue-500"},rename_directory:{icon:"swap_horiz",color:"text-blue-500"}},a8=["delete","delete_directory","add_dependency","remove_dependency","rename","rename_directory"],a9=e=>{let{filePath:t,oldFilePath:s,operation:a,className:r,contentToCopy:n}=e,[l,i]=(0,x.useState)(!1),o=async()=>{if(n)try{await navigator.clipboard.writeText(n),i(!0),setTimeout(()=>i(!1),2e3)}catch(e){(0,g.Eo)(e)}};return(0,c.jsxs)("div",{className:(0,el.cn)("flex flex-row items-center gap-2 rounded-t-lg bg-transparent font-mono",r,{"rounded-b-lg":a8.includes(a)}),children:[(0,c.jsx)(er.Z,{name:a6[a].icon,className:a6[a].color,size:"small"}),s&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:s}),(0,c.jsx)(er.Z,{name:"arrow_right",className:"text-muted-foreground",size:"small"})]}),(0,c.jsx)("span",{className:"flex-1",children:t}),n&&(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",onClick:o,className:"ml-auto text-muted-foreground hover:text-foreground",children:(0,c.jsx)(er.Z,{name:l?"check":"content_copy",size:"default"})})]})},a7=e=>{let{className:t,...s}=e;return(0,c.jsx)(a9,{...s,className:(0,el.cn)("border border-border px-3 py-2 text-sm font-medium",t)})},re=e=>{let{code:t,className:a}=e,[r,n]=(0,x.useState)(!0),[l,i]=(0,x.useState)(null),[o,d]=(0,x.useState)(""),[u,m]=(0,x.useState)(1),[h,p]=(0,x.useState)(1),[f,v]=(0,x.useState)({x:0,y:0}),[g,j]=(0,x.useState)(!1),[b,y]=(0,x.useState)({x:0,y:0}),[w,N]=(0,x.useState)(!1),[_,C]=(0,x.useState)(!1),{resolvedTheme:k}=(0,ts.F)(),E=(0,x.useRef)(null),S=(0,x.useRef)(null),z=(0,x.useRef)(null),R=(0,x.useRef)(null),{exitConsole:P}=(0,I.pE)(),D=(0,x.useCallback)(e=>{let t=e.trim();return(t=t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).trim()},[]),O=(0,x.useCallback)(()=>{if(!S.current||!z.current)return;let e=S.current,t=z.current.querySelector("svg");if(!t)return;let s=e.getBoundingClientRect(),a=s.width-40,r=s.height-80,n=t.getBoundingClientRect(),l=n.width/a,i=n.height/r;if(l>=.2&&l<=.9&&i>=.2&&i<=.9){m(1),p(1),C(!0);return}m(.8*Math.min(a/n.width,r/n.height)),p(1),v({x:0,y:0}),C(!0)},[]),T=(0,x.useCallback)(async()=>{if(!(null==t?void 0:t.trim())){i("No diagram code provided"),n(!1);return}try{n(!0),i(null),d(""),C(!1),m(1),p(1),E.current||(E.current=(await Promise.all([s.e(1860),s.e(656)]).then(s.bind(s,50656))).default);let e=E.current;if(!e)throw Error("Failed to load mermaid");let a="dark"===k;e.initialize({startOnLoad:!1,theme:a?"dark":"default",securityLevel:"loose",fontFamily:"Inter, system-ui, sans-serif",suppressErrorRendering:!0});let r=D(t),l="mermaid-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),o=await e.render(l,r);if(o&&o.svg)d(o.svg),n(!1);else throw Error("No SVG content returned from mermaid")}catch(e){i(e instanceof Error?"Diagram syntax error: ".concat(e.message.split("\n")[0]):"Failed to render diagram"),n(!1)}},[t,k,D]),A=u*h,Z=()=>p(e=>Math.min(1.5*e,10)),L=()=>p(e=>Math.max(e/1.5,.1)),F=()=>{p(1),v({x:0,y:0})},M=()=>j(!1);(0,x.useEffect)(()=>{let e=e=>{if(w)switch(e.key){case"+":case"=":e.preventDefault(),Z();break;case"-":e.preventDefault(),L();break;case"0":e.preventDefault(),F();break;case"Escape":e.preventDefault(),N(!1)}};if(w)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[w,h]),(0,x.useEffect)(()=>{T()},[T]),(0,x.useEffect)(()=>{if(o&&!_&&S.current&&z.current){let e=setTimeout(()=>{O()},300);return()=>clearTimeout(e)}},[o,_,O]),(0,x.useEffect)(()=>{let e=R.current;if(!e)return;let t=e=>{if(e.preventDefault(),e.stopPropagation(),!S.current)return;let t=S.current.getBoundingClientRect(),s=e.clientX-t.left,a=e.clientY-t.top,r=-.015*e.deltaY,n=u*h,l=Math.min(Math.max(h*(1+r),.1),10),i=u*l/n,o=t.width/2,c=t.height/2,d=s-o-(s-o-f.x)*i,m=a-c-(a-c-f.y)*i;p(l),v({x:d,y:m})};return e.addEventListener("wheel",t,{passive:!1}),()=>{e.removeEventListener("wheel",t)}},[u,h,f.x,f.y]);let U=(0,c.jsxs)("div",{className:(0,el.cn)("relative flex-1 bg-background",w?"fixed inset-0 z-50 rounded-none":"h-full",a),ref:S,children:[(0,c.jsx)("div",{className:"absolute left-4 top-4 z-10 flex gap-2",children:(0,c.jsxs)(V.z,{variant:"secondary",size:"sm",onClick:()=>{N(!1),P()},children:[(0,c.jsx)(er.Z,{name:"close",size:"small"}),"Close"]})}),o&&(0,c.jsx)("div",{className:"absolute right-4 top-4 z-10 flex gap-2",children:(0,c.jsxs)("div",{className:"flex items-center gap-1 rounded-lg border bg-background/80 px-2 py-1 backdrop-blur-sm",children:[(0,c.jsx)("button",{onClick:L,className:"rounded p-1 hover:bg-accent",title:"Zoom out (-)",children:(0,c.jsx)(er.Z,{name:"remove",size:"small"})}),(0,c.jsxs)("span",{className:"min-w-12 px-2 text-center font-mono text-xs",children:[Math.round(100*h),"%"]}),(0,c.jsx)("button",{onClick:Z,className:"rounded p-1 hover:bg-accent",title:"Zoom in (+)",children:(0,c.jsx)(er.Z,{name:"add",size:"small"})}),(0,c.jsx)("button",{onClick:F,className:"ml-1 rounded p-1 hover:bg-accent",title:"Reset zoom (0)",children:(0,c.jsx)(er.Z,{name:"refresh",size:"small"})})]})}),(0,c.jsxs)("div",{className:"flex h-full flex-col",children:[r&&(0,c.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,c.jsx)("div",{className:"text-sm text-muted-foreground",children:"Rendering diagram..."})}),l&&(0,c.jsxs)("div",{className:"m-4 rounded-lg border border-destructive/20 bg-destructive/5 p-4",children:[(0,c.jsx)("div",{className:"text-sm font-medium text-destructive",children:"Diagram Error"}),(0,c.jsx)("div",{className:"mt-1 text-sm text-destructive/80",children:l}),(0,c.jsxs)("details",{className:"mt-2",children:[(0,c.jsx)("summary",{className:"cursor-pointer text-sm text-muted-foreground",children:"Show diagram code"}),(0,c.jsx)("pre",{className:"mt-2 overflow-x-auto rounded bg-muted p-2 text-xs",children:t})]})]}),o&&(0,c.jsx)("div",{ref:R,className:(0,el.cn)("relative min-h-0 flex-1 overflow-hidden",w?"cursor-grab":"",g?"cursor-grabbing":""),onMouseDown:e=>{e.preventDefault(),j(!0),y({x:e.clientX-f.x,y:e.clientY-f.y})},onMouseMove:e=>{g&&(e.preventDefault(),v({x:e.clientX-b.x,y:e.clientY-b.y}))},onMouseUp:M,onMouseLeave:M,style:{userSelect:"none",overscrollBehavior:"contain"},children:(0,c.jsx)("div",{className:"flex h-full w-full origin-center items-center justify-center",style:{transform:"scale(".concat(A,") translate(").concat(f.x/A,"px, ").concat(f.y/A,"px)")},children:(0,c.jsx)("div",{ref:z,dangerouslySetInnerHTML:{__html:o}})})})]}),w&&(0,c.jsx)("div",{className:"absolute bottom-4 left-4 rounded bg-background/80 px-2 py-1 text-xs text-muted-foreground backdrop-blur-sm",children:"Use +/- to zoom, drag to pan, Esc to exit"})]});return w?(0,c.jsxs)(c.Fragment,{children:[U,(0,c.jsx)("div",{className:"fixed inset-0 z-40 bg-black/50 backdrop-blur-sm"})]}):U},rt=[a2.Z],rs=(0,x.memo)(e=>{let{part:t}=e,{resolvedTheme:s}=(0,ts.F)(),a="dark"===s?tu:tm,r=(0,x.useMemo)(()=>({code(e){let{node:t,className:s,children:r}=e;return/language-(\w+)/.exec(s||"")?(0,c.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,c.jsx)(tt.ZP,{readOnly:!0,value:String(r).replace(/\n$/,""),className:(0,el.cn)("flex-1 overflow-y-auto",tp().editor),theme:a,extensions:tx})}):(0,c.jsx)("span",{className:"rounded bg-muted px-1.5 py-0.5 font-mono text-sm",children:r})}}),[a]);switch(t.type){case"writing_file":return(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)(a7,{filePath:t.file_path,operation:"new",contentToCopy:t.content}),(0,c.jsx)("div",{className:"overflow-hidden rounded-b-lg border-x border-b",children:(0,c.jsx)(tt.ZP,{readOnly:!0,value:t.content,className:(0,el.cn)("flex-1 overflow-y-auto",tp().editor),theme:a,basicSetup:{foldGutter:!1,foldKeymap:!1},extensions:tx})})]});case"text":return(0,c.jsx)("div",{className:"prose prose-zinc prose-markdown mb-2 max-w-full dark:prose-invert ".concat(a4().customProse," prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-ol:my-2 prose-ul:my-2 prose-li:my-0"),children:(0,c.jsx)(a1.UG,{remarkPlugins:rt,components:r,children:t.content})});case"edit":let n=t.search_replace_parts.map(e=>e.replace).join("\n\n");return(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)(a7,{filePath:t.file_path,operation:"edit",contentToCopy:n}),(0,c.jsx)("div",{className:"rounded-b-lg border-x border-b",children:t.search_replace_parts.map((e,t)=>(0,c.jsxs)("div",{className:"mb-1 p-2",children:[(0,c.jsxs)("div",{className:"mb-1 flex text-sm text-foreground",children:[(0,c.jsx)("span",{className:"flex-1",children:"Search"}),(0,c.jsx)("span",{className:"flex-1",children:"Replace"})]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)(tt.ZP,{readOnly:!0,value:e.search,className:(0,el.cn)("flex-1 overflow-y-auto",tp().editor),theme:a,extensions:tx}),(0,c.jsx)(tt.ZP,{readOnly:!0,value:e.replace,className:(0,el.cn)("flex-1 overflow-y-auto",tp().editor),theme:a,extensions:tx})]})]},t))})]});case"delete":return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsx)(a7,{filePath:t.file_path,operation:"delete"})});case"rename":return(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(a7,{filePath:t.new_file_path,oldFilePath:t.original_file_path,operation:"rename"})});case"add_dependency":return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsx)(a7,{filePath:t.dependency,operation:"add_dependency",className:"rounded-lg"})});case"remove_dependency":return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsx)(a7,{filePath:t.removed_dependency,operation:"remove_dependency",className:"rounded-lg"})});case"error":return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsxs)("div",{className:"flex items-center rounded-lg border border-warning-primary p-3 text-sm font-medium",children:[(0,c.jsx)(er.Z,{name:"warning",className:"mr-2 text-warning-foreground",size:"small"}),(0,c.jsx)("span",{children:t.error_message})]})});case"lov-mermaid":if(!t.done)return(0,c.jsxs)("div",{className:"mb-4 flex items-center gap-2 text-sm text-muted-foreground",children:[(0,c.jsx)(er.Z,{name:"progress_activity",size:"small",className:"animate-spin"}),(0,c.jsx)("span",{children:"Generating diagram..."})]});return(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(re,{code:t.mermaidCode})});case"tool_use":var l,i,o,d,u;if("lov-add-dependency"===t.name)return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsx)(a7,{filePath:null!==(l=t.parsedData.package)&&void 0!==l?l:"",operation:"add_dependency",className:"rounded-lg"})});if("lov-remove-dependency"===t.name)return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsx)(a7,{filePath:null!==(i=t.parsedData.package)&&void 0!==i?i:"",operation:"remove_dependency",className:"rounded-lg"})});if("lov-delete"===t.name)return(0,c.jsx)("div",{className:"mb-2",children:(0,c.jsx)(a7,{filePath:null!==(o=t.parsedData.file_path)&&void 0!==o?o:"",operation:"delete"})});if("lov-rename"===t.name)return(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(a7,{filePath:null!==(d=t.parsedData.new_file_path)&&void 0!==d?d:"",oldFilePath:null!==(u=t.parsedData.original_file_path)&&void 0!==u?u:"",operation:"rename"})});return(0,c.jsx)(a3.Y9,{name:t.name,parsedData:t.parsedData,done:t.done,duration:t.duration});default:return null}},(e,t)=>{let s=e.part,a=t.part;if(s.type!==a.type)return!1;switch(s.type){case"text":return s.content===a.content;case"writing_file":return s.file_path===a.file_path&&s.content===a.content;case"edit":if(s.search_replace_parts.length!==a.search_replace_parts.length)return!1;return s.file_path===a.file_path&&s.search_replace_parts.every((e,t)=>{let s=a.search_replace_parts[t];return e.search===s.search&&e.replace===s.replace});case"delete":return s.file_path===a.file_path;case"rename":return s.original_file_path===a.original_file_path&&s.new_file_path===a.new_file_path;case"add_dependency":return s.dependency===a.dependency&&s.isDevDependency===a.isDevDependency;case"remove_dependency":return s.removed_dependency===a.removed_dependency;case"error":return s.error_message===a.error_message;case"lov-mermaid":return s.mermaidCode===a.mermaidCode&&s.done===a.done;case"tool_use":return s.name===a.name&&s.data===a.data&&s.done===a.done&&s.duration===a.duration;default:return!1}});var ra=s(96139);(r=(a=i||(i={})).action||(a.action={})).NEW="new",r.RENAME="rename",r.RENAME_DIRECTORY="rename_directory",r.DELETE="delete",r.DELETE_DIRECTORY="delete_directory",r.EDIT="edit",r.ADD_DEPENDENCY="add_dependency";var rr=e=>{let{oldContent:t,newContent:s,filePath:a,originalFilePath:r,action:n}=e,[l,o]=(0,x.useState)(!0),[d,u]=(0,x.useState)(!1),{resolvedTheme:m}=(0,ts.F)(),h=async()=>{try{await navigator.clipboard.writeText(s),u(!0),setTimeout(()=>u(!1),2e3)}catch(e){(0,g.Eo)(e)}};return(0,c.jsxs)("div",{className:"overflow-hidden rounded-lg border border-border",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)(a7,{filePath:a,className:"border-none",oldFilePath:r,operation:n}),(0,c.jsxs)("div",{className:"flex items-center gap-1",children:[(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",onClick:h,className:"text-muted-foreground hover:text-foreground",title:d?"Copied!":"Copy diff content",children:(0,c.jsx)(er.Z,{name:d?"check":"content_copy",size:"default"})}),n!==i.action.DELETE&&(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",onClick:()=>o(e=>!e),className:"mr-1",children:(0,c.jsx)(er.Z,{name:l?"unfold_less":"unfold_more",size:"default"})})]})]}),s&&(0,c.jsx)(eZ.E.div,{initial:{height:0},animate:{height:l?"auto":0},exit:{height:0},transition:{duration:.25},children:(0,c.jsx)(tt.ZP,{className:(0,el.cn)(tp().editor,"border-t"),readOnly:!0,theme:"dark"===m?tu:tm,extensions:[...tx,tt.tk.editable.of(!1),(0,ra.Z)({original:t,mergeControls:!1})],value:s})})]},a)};function rn(){return(0,c.jsx)("div",{className:"flex flex-col rounded-lg border border-border",children:(0,c.jsx)("div",{className:"flex items-center justify-between p-3",children:(0,c.jsx)("div",{className:"h-3 w-80 animate-pulse rounded bg-muted"})})})}let rl=x.memo(e=>{var t,s;let{activeEdit:a}=e,[r,n]=(0,x.useState)(Math.min(2,(null==a?void 0:null===(t=a.diff)||void 0===t?void 0:t.length)||0)),l=(0,x.useRef)(null);return(0,x.useEffect)(()=>()=>{null!==l.current&&clearTimeout(l.current)},[]),(0,x.useEffect)(()=>{(null==a?void 0:a.diff)&&r<a.diff.length&&(l.current=window.setTimeout(()=>{n(e=>{var t;return Math.min(e+2,(null===(t=a.diff)||void 0===t?void 0:t.length)||0)})},50))},[r,null==a?void 0:a.diff]),(0,c.jsx)("div",{className:"flex flex-col gap-4",children:null==a?void 0:null===(s=a.diff)||void 0===s?void 0:s.map((e,t)=>(0,c.jsx)(x.Fragment,{children:t<r?(0,c.jsx)(rr,{oldContent:e.old_content,newContent:e.new_content,filePath:e.file_path,originalFilePath:e.original_file_path,action:e.action}):(0,c.jsx)(rn,{})},"".concat(e.action,"-").concat(e.file_path,"-").concat(t)))})});rl.displayName="DiffView";let ri=e=>{var t,s,a;let{errors:r,allErrors:n}=e,l=r.find(e=>{var t;return null===(t=e.meta_data)||void 0===t?void 0:t.url}),i=null==l?void 0:null===(t=l.meta_data)||void 0===t?void 0:t.url,o=null==l?void 0:null===(s=l.meta_data)||void 0===s?void 0:s.method,d=null==l?void 0:null===(a=l.meta_data)||void 0===a?void 0:a.origin,u=r.length===n.length?"This":"At least one of these";return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("p",{className:"text-sm",children:[u," is a Cross-Origin Resource Sharing (CORS) error. It means that the HTTP call you made is not allowed by the server. This could be because the server is not configured to accept requests from the client URL. Unfortuantely this is not something that the AI can fix for you since we don't control the server you're trying to communicate with."]}),(0,c.jsx)("p",{className:"text-sm",children:"If you are in control of the server, please configure the server to accept requests from the client URL. If you are not in control of the server, please contact the server administrator to configure the server to accept requests from the client URL. If it's not possible to change the CORS configuration, explore other API services that do allow requests directly from the browser."}),(0,c.jsx)("table",{className:"text-sm",children:(0,c.jsxs)("tbody",{children:[i&&(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"font-medium",children:"URL"}),(0,c.jsx)("td",{children:i})]}),o&&(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"font-medium",children:"Method"}),(0,c.jsx)("td",{children:o})]}),d&&(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"font-medium",children:"Origin"}),(0,c.jsx)("td",{children:d})]})]})})]})};var ro=s(5707),rc=s(40878);let rd=e=>"string"==typeof e?e:(0,e3.l)((0,ro.K)(e.seconds),new Date),ru=e=>{switch(e){case sN.N.CORS_ERROR:return"CORS error";case sN.N.HTTP_SERVER_ERROR:return"HTTP server error";case sN.N.HTTP_CLIENT_ERROR:return"HTTP client error";case sN.N.SUPABASE_EDGE_FUNCTION_ERROR:return"Supabase edge function error";case sN.N.BUILD:return"Build error";case sN.N.RUNTIME:case sN.N.IMMEDIATE_RUNTIME:return"Runtime error";default:return"Error"}};function rm(e){let{errorId:t,hideFn:s}=e,a=(0,F.v)(),{mutate:r,isPending:n}=(0,u.D)({mutationFn:async()=>(s(),(0,j.SJ)().patch("/projects/".concat(a,"/handle-errors"),{error_ids:[t]}))});return(0,c.jsx)(V.z,{variant:"secondary",size:"sm",onClick:()=>r(),disabled:n,children:"Dismiss"})}function rx(e){let{error:t,hideFn:s}=e,a=(0,F.D)(),{onClick:r,isPending:n}=(0,s_.hw)({projectId:a,errors:[t]}),l=(0,R.bk)(e=>e.isSendChatMessageMutationPending),{setShowConsole:i}=(0,I.pE)(),{setView:o}=(0,rc.zp)(),d=(0,v.Z)("md");return(0,c.jsxs)(V.z,{variant:"secondary",size:"sm",disabled:n||l,onClick:()=>{i(null),d&&o(rc.$.CHAT),s(),r()},children:[(0,c.jsx)(er.Z,{name:"bolt",size:"small"}),"Try to fix"]})}let rh=e=>{let{error:t}=e,[s,a]=(0,x.useState)(!1);return s?null:(0,c.jsxs)("div",{className:"mb-4 mt-2 rounded-xl bg-warning",children:[(0,c.jsxs)("div",{className:"flex flex-row items-center justify-between pb-1 pl-3 pr-1.5 pt-1.5",children:[(0,c.jsxs)("div",{className:"flex flex-row items-center text-sm text-warning-foreground",children:[(0,c.jsx)(er.Z,{name:"warning",size:"small",className:"mr-2"}),(0,c.jsx)("p",{className:"mr-2 font-medium",children:ru(t.type)}),(0,c.jsx)("p",{className:"leading-none",children:rd(t.created_at)})]}),(0,c.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,c.jsx)(rm,{errorId:t.id,hideFn:()=>{a(!0)}}),(0,c.jsx)(rx,{error:t,hideFn:()=>{a(!0)}})]})]}),(0,c.jsx)(s_.UL,{errors:[t],roundedTop:!1})]})},rp=e=>{var t,s,a;let{errors:r,allErrors:n}=e;return r.length!==n.length?(0,c.jsx)("p",{className:"text-sm",children:"At least one of these HTTP calls failed which means that the server or API you're trying to communicate with is not working properly. Unfortunately this is not something that the AI can fix for you since we don't control the server that you're trying to communicate with."}):(0,c.jsxs)("p",{className:"text-sm",children:["This is an HTTP server error which means that the server or API you're trying to communicate with is not working properly.",(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),"Unfortunately this is not something that the AI can fix for you since we don't control the server that you're trying to communicate with.",(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(null===(t=r[0].meta_data)||void 0===t?void 0:t.url)&&!(null===(s=r[0].meta_data)||void 0===s?void 0:s.status)&&(0,c.jsxs)(c.Fragment,{children:["Please validate that the url"," ",(0,c.jsx)("pre",{className:"inline-block rounded bg-secondary p-1",children:null===(a=r[0].meta_data)||void 0===a?void 0:a.url})," ","is correct."]})]})},rf=e=>{let{errors:t}=e;if(!s_.t6[t[0].type])return null;let s=[...t].sort((e,t)=>t.created_at.seconds-e.created_at.seconds),a=s.filter(e=>e.type===sN.N.CORS_ERROR),r=s.filter(e=>e.type===sN.N.HTTP_SERVER_ERROR);return(0,c.jsxs)(c.Fragment,{children:[a.length>0&&(0,c.jsx)(ri,{errors:a,allErrors:t}),r.length>0&&(0,c.jsx)(rp,{errors:r,allErrors:t}),t.map(e=>(0,c.jsx)(rh,{error:e},e.id))]})},rv=()=>{let e=(0,I.Sl)(e=>e.activeConsoleErrorContent),t=(0,F.v)();if(!t)throw Error("Project ID is required and should always be set here");return e&&0!==e.length?(0,c.jsx)(rf,{errors:e,projectId:t}):null},rg=(0,aX.default)(()=>s.e(5941).then(s.bind(s,5941)).then(e=>e.ConsoleDebug),{loadableGenerated:{webpack:()=>[5941]},loading:()=>(0,c.jsx)("div",{className:"flex h-full items-center justify-center",children:"Loading debug view..."})}),rj=(0,aX.default)(()=>s.e(4273).then(s.bind(s,24273)).then(e=>e.ConsoleAnnotation),{loadableGenerated:{webpack:()=>[24273]},loading:()=>(0,c.jsx)("div",{className:"flex h-full items-center justify-center",children:"Loading annotation view..."})}),rb=(e,t)=>{let s="".concat(t,"-");switch(e.type){case"text":let a=e.content.trim().substring(0,20)||"empty-text";s+="text-".concat(a);break;case"writing_file":s+="file-".concat(e.file_path);break;case"edit":s+="edit-".concat(e.file_path);break;case"delete":s+="delete-".concat(e.file_path);break;case"rename":s+="rename-".concat(e.original_file_path,"-").concat(e.new_file_path);break;case"add_dependency":s+="add-dep-".concat(e.dependency);break;case"remove_dependency":s+="remove-dep-".concat(e.removed_dependency);break;case"error":let r=e.error_message.trim().substring(0,20)||"empty-error";s+="error-".concat(r);break;case"lov-mermaid":let n=e.mermaidCode.trim().substring(0,20)||"empty-mermaid";s+="mermaid-".concat(n);break;case"tool_use":s+="tool-use-".concat(e.name,"-").concat(e.data.substring(0,20));break;default:s+="unknown-".concat(Math.random().toString(36).substring(2,9))}return s},ry=e=>{var t;let{scrollContainerRef:s}=e,a=(0,I.Sl)(e=>e.activeConsoleCodeContent),r=(0,a0.hT)(e=>e.codeViewType),n=(0,I.Sl)(e=>e.activeEditId),l=(0,z.aK)(e=>e.edits),i=n?l[n]:null,o=(0,x.useRef)(null),d=(0,x.useRef)(),u=(0,x.useRef)(!0),m=(0,x.useRef)(!1),h=(0,x.useCallback)(()=>{if(s.current){let{scrollTop:e,scrollHeight:t,clientHeight:a}=s.current;u.current=t-e-a<10}},[s]),p=(0,x.useCallback)(e=>{e.deltaY<0?m.current=!0:m.current=!1},[]),f=(0,x.useCallback)(()=>{m.current=!0},[]),v=(0,x.useCallback)(()=>{m.current=!1},[]);return((0,x.useEffect)(()=>{let e=s.current;return e&&(e.addEventListener("scroll",h),e.addEventListener("wheel",p),e.addEventListener("touchstart",f),e.addEventListener("touchend",v)),()=>{e&&(e.removeEventListener("scroll",h),e.removeEventListener("wheel",p),e.removeEventListener("touchstart",f),e.addEventListener("touchend",v))}},[s,h,p,f,v]),(0,x.useEffect)(()=>{var e,t,a;d.current!==(null===(e=s.current)||void 0===e?void 0:e.scrollHeight)&&(d.current=null===(t=s.current)||void 0===t?void 0:t.scrollHeight,u.current&&!m.current&&(null===(a=o.current)||void 0===a||a.scrollIntoView({behavior:"auto"})))},[a,s]),r===a0.es.DIFF)?(0,c.jsx)(rl,{activeEdit:i},null==i?void 0:i.id):(0,c.jsxs)(c.Fragment,{children:[a&&(null===(t=a.parts)||void 0===t?void 0:t.length)>0?a.parts.map((e,t)=>(0,c.jsx)(rs,{part:e},rb(e,t))):null,(0,c.jsx)("div",{ref:o})]})},rw=()=>{let e=(0,I.Sl)(e=>e.activeEditId),t=(0,z.aK)(e=>e.edits),s=e?t[e]:null,a=(0,U.iZ)(e=>e.project),r=(0,x.useMemo)(()=>{if(s&&a)return(0,e2.t)({projectId:null==a?void 0:a.id,sha:s.commit_sha})},[s,a]);return(0,c.jsx)("iframe",{id:"preview-panel",src:"".concat(r,"?forceHideBadge=true"),sandbox:aQ.h,allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",className:"min-h-full w-full flex-grow"})},rN=()=>{let e=(0,I.Sl)(e=>e.activeConsoleMermaidContent);return e?e.mermaidCode?(0,c.jsx)("div",{className:"flex h-full flex-col",children:(0,c.jsx)("div",{className:"min-h-0 flex-1",children:(0,c.jsx)(re,{code:e.mermaidCode,className:"h-full"})})}):(0,c.jsx)("p",{className:"mt-4 text-center text-red-500",children:"Mermaid data found but no code property."}):(0,c.jsx)("p",{className:"mt-4 text-center",children:"No mermaid diagram selected."})},r_=e=>{let{scrollContainerRef:t}=e;switch((0,I.Sl)(e=>e.consoleContentType)){case"error":case"code":return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)(rv,{})}),(0,c.jsx)(ry,{scrollContainerRef:t})]});case"snapshot-preview":return(0,c.jsx)(rw,{});case"mermaid":return(0,c.jsx)(rN,{});case"debug":return(0,c.jsx)(rg,{});case"annotation":return(0,c.jsx)(rj,{});default:return(0,c.jsx)("p",{className:"mt-4 text-center",children:"Click on a code chip in the chat to inspect the code output."})}},rC=()=>{let e=(0,I.Sl)(e=>e.consoleContentType),t=(0,x.useRef)(null);return(0,c.jsx)("div",{className:(0,el.cn)("absolute inset-0 z-50 overflow-y-auto rounded-b-none bg-background p-4 pb-10",{"p-0":"snapshot-preview"===e||"mermaid"===e,"overflow-hidden":"mermaid"===e}),ref:t,children:(0,c.jsx)(r_,{scrollContainerRef:t})})};var rk=s(61563),rE=s(96771);let rS=e=>{let{diffAvailable:t}=e,s=(0,a0.hT)(e=>e.codeViewType),{setCodeViewType:a}=(0,a0.VK)(),r=(0,I.Sl)(e=>e.activeEditId),n=(0,z.aK)(e=>e.edits),l=r?n[r]:null;return(0,c.jsxs)(rk.t,{className:"ml-auto",type:"single",variant:"outline",value:s,defaultValue:a0.es.RAW,onValueChange:e=>{e&&(a(e),e===a0.es.RAW?N.ZP.capture(k.SL.PREVIEW.RAW_TAB_CLICKED):e===a0.es.DIFF&&N.ZP.capture(k.SL.PREVIEW.DIFF_TAB_CLICKED))},children:[(null==l?void 0:l.type)!==rE.I.type.REVERT&&(0,c.jsx)(rk.G,{size:"sm",value:a0.es.RAW,children:"Raw"}),(0,c.jsx)(rk.G,{size:"sm",disabled:!t,value:a0.es.DIFF,children:"Diff"})]})};var rz=e=>{let{label:t,score:s,lastUpdated:a,issueCount:r=0,isSelected:n=!1,isLoading:l=!1,onClick:i,onRun:o,onForceRefresh:d}=e,u=e=>e>=90?"#10b981":e>=50?"#f59e0b":"#ef4444";return(0,c.jsxs)("div",{className:"relative flex cursor-pointer flex-col items-center rounded-lg border p-4 transition-all ".concat(n?"border-primary bg-primary/5 ring-2 ring-primary/20":"border-gray-200 bg-white hover:border-gray-300"),onClick:i,children:[void 0!==s&&d&&(0,c.jsx)(V.z,{size:"sm",variant:"ghost",className:"absolute right-1 top-1 h-6 w-6 p-0 opacity-60 hover:opacity-100",onClick:e=>{e.stopPropagation(),d()},disabled:l,title:"Force refresh",children:(0,c.jsx)(er.Z,{name:"refresh",size:"small"})}),(0,c.jsx)("div",{className:"relative mb-2 h-16 w-16",children:void 0!==s?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("svg",{className:"h-16 w-16 -rotate-90 transform",viewBox:"0 0 36 36",children:[(0,c.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e5e7eb",strokeWidth:"2"}),(0,c.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:u(s),strokeWidth:"2",strokeDasharray:"".concat(s,", 100")})]}),(0,c.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,c.jsx)("span",{className:"font-bold text-sm",style:{color:u(s)},children:Math.round(s)})})]}):(0,c.jsx)("div",{className:"flex h-16 w-16 items-center justify-center",children:(0,c.jsx)(V.z,{size:"sm",variant:"outline",className:"h-12 w-12 rounded-full p-0",onClick:e=>{e.stopPropagation(),null==o||o()},disabled:l,children:l?(0,c.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-gray-300 border-t-gray-600"}):(0,c.jsx)(er.Z,{name:"play_circle",size:"small"})})})}),(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("span",{className:"block text-xs font-medium",children:t}),a&&(0,c.jsx)("span",{className:"mt-1 block text-xs text-muted-foreground",children:(e=>{let t=Math.floor((Date.now()-e)/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let s=Math.floor(t/60);return s<24?"".concat(s,"h ago"):"".concat(Math.floor(s/24),"d ago")})(a)}),void 0!==s&&r>0&&(0,c.jsxs)("div",{className:"mt-1 flex items-center justify-center gap-1",children:[(0,c.jsx)(er.Z,{name:"warning",size:"small",className:"text-amber-500"}),(0,c.jsxs)("span",{className:"text-xs font-medium text-amber-600",children:[r," issue",1!==r?"s":""]})]}),void 0!==s&&0===r&&(0,c.jsxs)("div",{className:"mt-1 flex items-center justify-center gap-1",children:[(0,c.jsx)(er.Z,{name:"check",size:"small",className:"text-green-500"}),(0,c.jsx)("span",{className:"text-xs font-medium text-green-600",children:"No issues"})]})]})]})};let rI=(e,t,s)=>{let a=(0,F.D)(),[r,n]=(0,x.useState)(!1),{onClick:l,isPending:i}=(0,s_.hw)({projectId:a,errors:[{id:(0,P.Fd)(),type:sN.N.BUILD,error_message:"SEO Audit Issue (".concat(e.severity,"): ").concat(e.title,"\n\nDescription: ").concat(e.description).concat(e.explanation&&e.explanation!==e.description?"\n\nExplanation: ".concat(e.explanation):"").concat(void 0!==e.score?"\n\nCurrent Score: ".concat(e.score):"").concat(e.savings?"\n\nEstimated savings: ".concat(e.savings):"").concat(e.errorMessage?"\n\nError: ".concat(e.errorMessage):"").concat(e.details?"\n\nAdditional Details: ".concat(JSON.stringify(e.details,null,2)):"","\n\nIMPORTANT INSTRUCTIONS FOR FIXING THIS SEO ISSUE:\n- STRICTLY preserve the existing functional behavior, design, and UX of the application\n- ONLY make changes that are absolutely necessary to fix this specific SEO issue\n- DO NOT modify the application's visual design, layout, or user experience unless it's essential for the SEO fix\n- If the audit requires changes that might affect functionality or UX, be extremely cautious and make minimal changes\n- If you cannot clearly determine how to fix this issue safely without risking application functionality, simply provide the analysis in chat mode instead of making code changes\n- Focus on technical SEO fixes like meta tags, HTML structure, accessibility attributes, etc. that don't affect the user experience\n\nPlease analyze this SEO issue and implement only the minimal necessary changes to improve the website's SEO performance without affecting the application's functionality or user experience."),occurred_at:new Date().toISOString(),created_at:sw.EK.now()}]}),o=(0,R.bk)(e=>e.isSendChatMessageMutationPending);return{handleFix:(0,x.useCallback)(async()=>{if(!r)try{n(!0),N.ZP.capture(k.Md.TRY_FIX,{strategy:t,category:s,auditId:e.id,auditSeverity:e.severity,auditTitle:e.title}),await l(),h.Am.success("SEO fix attempt initiated successfully")}catch(e){C.logging.error("Failed to initiate SEO fix:",{error:e}),h.Am.error("Failed to initiate SEO fix. Please try again.")}finally{n(!1)}},[l,r,t,s,e.id,e.severity,e.title]),isFixing:i||o||r}};var rR=e=>{let{audit:t,strategy:s,category:a}=e,{handleFix:r,isFixing:n}=rI(t,s,a),l=(0,x.useCallback)(async()=>{await r()},[r]);return(0,c.jsxs)(V.z,{onClick:l,variant:"outline",size:"sm",disabled:n,className:"flex items-center gap-2",children:[(0,c.jsx)(er.Z,{name:"build",size:"small"}),n?"Fixing...":"Try to fix"]})},rP=e=>{let{audit:t,strategy:s,category:a}=e,r={error:{container:"bg-red-50 border-red-200",dot:"bg-red-500",title:"text-red-800",text:"text-red-700"},warning:{container:"bg-yellow-50 border-yellow-200",dot:"bg-yellow-500",title:"text-yellow-800",text:"text-yellow-700"},info:{container:"bg-gray-50 border-gray-200",dot:"bg-gray-500",title:"text-gray-800",text:"text-gray-700"},minor:{container:"bg-orange-50 border-orange-200",dot:"bg-orange-500",title:"text-orange-800",text:"text-orange-700"}}[t.severity];return(0,c.jsx)("div",{className:"rounded-lg border p-4 ".concat(r.container),children:(0,c.jsxs)("div",{className:"flex items-start justify-between",children:[(0,c.jsxs)("div",{className:"flex flex-1 items-start",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)("div",{className:"mt-2 h-2 w-2 rounded-full ".concat(r.dot)})}),(0,c.jsxs)("div",{className:"ml-3 flex-1",children:[(0,c.jsx)("h5",{className:"font-medium ".concat(r.title),children:t.title}),(0,c.jsxs)("p",{className:"mt-1 text-sm ".concat(r.text),children:[t.description,t.savings&&(0,c.jsxs)("span",{children:[" Est. savings: ",t.savings]})]})]})]}),(0,c.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,c.jsx)(rR,{audit:t,strategy:s,category:a})})]})})},rD=s(66070),rO=()=>(0,c.jsx)("div",{className:"flex h-full w-full items-center justify-center p-6",children:(0,c.jsx)(rD.Zb,{className:"w-full max-w-md",children:(0,c.jsxs)(rD.aY,{className:"space-y-6 p-8 text-center",children:[(0,c.jsx)("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:(0,c.jsx)(er.Z,{name:"globe",size:"large",className:"text-muted-foreground"})}),(0,c.jsx)("div",{className:"space-y-2",children:(0,c.jsx)("h2",{className:"font-semibold text-xl",children:"Publish First to Analyze SEO"})}),(0,c.jsx)("div",{className:"space-y-3",children:(0,c.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Click the ",(0,c.jsx)("strong",{children:"Publish"})," button in the top right corner to make your project live."]})}),(0,c.jsx)("div",{className:"border-t pt-4",children:(0,c.jsx)("p",{className:"text-xs text-muted-foreground",children:"Once published, you'll be able to run comprehensive SEO analysis including performance, accessibility, best practices, and SEO score checks."})})]})})}),rT=e=>{let{screenshotData:t}=e;return t?(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsx)("h4",{className:"text-md mb-4 font-medium",children:"Page Screenshot"}),(0,c.jsx)("div",{className:"flex justify-center",children:(0,c.jsx)("img",{src:t,alt:"Page screenshot",className:"h-auto max-w-full rounded-lg border shadow-sm",style:{maxHeight:"400px"}})})]}):null},rA=s(8164);let rZ={error:0,warning:1,minor:2,info:3},rL=e=>[...e].sort((e,t)=>{let s=rZ[e.severity]-rZ[t.severity];return 0!==s?s:e.title.localeCompare(t.title)}),rF={all:["pageSpeed"],project:e=>[...rF.all,e],combination:(e,t,s)=>[...rF.project(e),t,s]},rM=e=>{var t,s;if(!(null==e?void 0:null===(s=e.results)||void 0===s?void 0:null===(t=s.lighthouseResult)||void 0===t?void 0:t.audits))return[];let a=e.results.lighthouseResult.audits,r=[];return Object.entries(a).forEach(e=>{let[t,s]=e;if("number"!=typeof s.score||s.score>=1)return;let a="info";s.score<.5?a="error":s.score<.7?a="warning":s.score<.9&&(a="minor"),r.push({id:s.id||t,severity:a,title:s.title||t,description:s.description||s.explanation||"No description available",score:s.score,scoreDisplayMode:s.scoreDisplayMode,displayValue:s.displayValue,explanation:s.explanation,errorMessage:s.errorMessage,warnings:s.warnings,details:s.details,savings:s.displayValue})}),r},rU=(e,t)=>{var s,a;let r=null==e?void 0:null===(a=e.results)||void 0===a?void 0:null===(s=a.lighthouseResult)||void 0===s?void 0:s.categories;if(!r)return null;let n=r[({performance:"performance",accessibility:"accessibility","best-practices":"best-practices",seo:"seo"})[t]];return n?{label:({performance:"Performance",accessibility:"Accessibility","best-practices":"Best Practices",seo:"SEO"})[t],score:Math.round(100*(n.score||0)),category:t}:null},rV=(e,t,s)=>{var a,r,n,l,i;let o=rU(e,s);return o?{strategy:t,category:s,score:o,audits:rM(e),screenshot:null==e?void 0:null===(i=e.results)||void 0===i?void 0:null===(l=i.lighthouseResult)||void 0===l?void 0:null===(n=l.audits)||void 0===n?void 0:null===(r=n["final-screenshot"])||void 0===r?void 0:null===(a=r.details)||void 0===a?void 0:a.data,timestamp:Date.now()}:null},rW=function(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{queryKey:rF.combination(e,t,s),queryFn:async()=>{let a=(0,j.SJ)();return rV(await a.post("/projects/".concat(e,"/preview-page-speed"),{url_source:"publish",strategy:t,categories:[s]}),t,s)},staleTime:a?0:9e5,gcTime:36e5,enabled:!!e}},rB=function(e,t,s){var a;let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=(0,te.a)(rW(e,t,s,r)),l=(0,x.useCallback)(async()=>n.refetch(),[n]),i=(0,x.useCallback)(async()=>n.refetch(),[n]);return{data:n.data,isLoading:n.isLoading,error:n.error,runAnalysis:l,forceRefresh:i,isStale:n.isStale,lastUpdated:null===(a=n.data)||void 0===a?void 0:a.timestamp}},rG=(e,t)=>{var s;let a=(0,rA.h)({queries:t.map(t=>{let{strategy:s,category:a}=t;return rW(e,s,a)})}),r=a.map(e=>e.data).filter(Boolean),n=a.some(e=>e.isLoading);return{data:r,isLoading:n,error:null===(s=a.find(e=>e.error))||void 0===s?void 0:s.error,runAnalysis:(0,x.useCallback)(async(e,s)=>{let r=t.findIndex(t=>t.strategy===e&&t.category===s);if(-1!==r)return a[r].refetch()},[a,t]),forceRefresh:(0,x.useCallback)(async(e,s)=>{let r=t.findIndex(t=>t.strategy===e&&t.category===s);if(-1!==r)return a[r].refetch()},[a,t]),queries:a}},rJ=(e,t)=>{let{data:s,isLoading:a,error:r,runAnalysis:n,forceRefresh:l}=rG(e,["performance","accessibility","best-practices","seo"].map(e=>({strategy:t,category:e})));return{scores:s.map(e=>e.score),data:s,isLoading:a,error:r,runAnalysis:n,forceRefresh:l}};var rH=()=>{var e,t;let[s,a]=(0,x.useState)("mobile"),[r,n]=(0,x.useState)("performance"),[l,i]=(0,x.useState)(new Set),o=(0,F.D)(),d=(0,U.iZ)(e=>e.project),u=!!(null==d?void 0:d.url),m=(null==d?void 0:d.latest_commit_sha)!==(null==d?void 0:null===(e=d.published_deployment)||void 0===e?void 0:e.commit_sha),{scores:h,data:p,isLoading:f,error:v,runAnalysis:g,forceRefresh:j}=rJ(o,s),{data:b,isLoading:y,error:w,runAnalysis:_,forceRefresh:C}=rB(o,s,r),E=(0,x.useMemo)(()=>(null==b?void 0:b.audits)?rL(b.audits):[],[null==b?void 0:b.audits]),S=e=>{n(e),N.ZP.capture(k.Md.CATEGORY_SELECTED,{category:e,strategy:s})},z=e=>{a(e),N.ZP.capture(k.Md.STRATEGY_SELECTED,{strategy:e})},I=async e=>{i(t=>new Set([...t,e]));try{await g(s,e)}finally{i(t=>{let s=new Set(t);return s.delete(e),s})}},R=async e=>{i(t=>new Set([...t,e]));try{e===r&&await C(),await j(s,e)}finally{i(t=>{let s=new Set(t);return s.delete(e),s})}},P=async()=>{let e=["performance","accessibility","best-practices","seo"];N.ZP.capture(k.Md.REGENERATE,{strategy:s,categories:e,context:"all"}),i(new Set(e));try{await Promise.all(e.map(e=>j(s,e))),e.includes(r)&&await C()}finally{i(new Set)}},D=e=>{let t=h.find(t=>t.category===e);return null==t?void 0:t.score},O=e=>{var t;let s=p.find(t=>t.category===e);return(null==s?void 0:null===(t=s.audits)||void 0===t?void 0:t.length)||0},T=e=>p.some(t=>t.category===e),A=e=>{let t=p.find(t=>t.category===e);return null==t?void 0:t.timestamp},Z=e=>f||l.has(e),L=f||y||l.size>0,M=y||l.has(r),W=v||w;return u?(0,c.jsxs)("div",{className:"flex h-full w-full flex-col overflow-auto p-6",children:[(0,c.jsxs)("div",{className:"mb-1",children:[(0,c.jsx)("h1",{className:"font-semibold mb-4 text-2xl",children:"Page Speed Analysis"}),m&&(0,c.jsx)("div",{className:"mb-6 rounded-lg border border-amber-200 bg-amber-50 p-4",children:(0,c.jsxs)("div",{className:"flex items-start justify-between",children:[(0,c.jsxs)("div",{className:"flex items-start gap-3",children:[(0,c.jsx)(er.Z,{name:"warning",className:"mt-0.5 text-amber-500",size:"small"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-amber-800",children:"Results may be outdated"}),(0,c.jsx)("p",{className:"mt-1 text-sm text-amber-700",children:"Your latest changes haven't been published yet. The current analysis is based on the previously published version."})]})]}),(0,c.jsxs)(V.z,{size:"sm",variant:"outline",onClick:P,disabled:L,className:"gap-2",children:[(0,c.jsx)(er.Z,{name:"refresh",size:"small"}),"Regenerate"]})]})}),(0,c.jsxs)("div",{className:"mb-6 flex gap-2",children:[(0,c.jsx)(V.z,{variant:"mobile"===s?"default":"outline",size:"sm",onClick:()=>z("mobile"),children:"Mobile"}),(0,c.jsx)(V.z,{variant:"desktop"===s?"default":"outline",size:"sm",onClick:()=>z("desktop"),children:"Desktop"})]}),(0,c.jsx)("div",{className:"mb-6 grid grid-cols-2 gap-4 md:grid-cols-4",children:[{key:"performance",label:"Performance"},{key:"accessibility",label:"Accessibility"},{key:"best-practices",label:"Best Practices"},{key:"seo",label:"SEO"}].map(e=>{let t=D(e.key),a=O(e.key),n=T(e.key),l=A(e.key),i=Z(e.key);return(0,c.jsx)(rz,{label:e.label,score:t,issueCount:a,lastUpdated:l,isSelected:r===e.key,isLoading:i,onClick:()=>S(e.key),onRun:n?void 0:()=>I(e.key),onForceRefresh:()=>R(e.key)},"".concat(s,"-").concat(e.key))})})]}),W&&(0,c.jsxs)("div",{className:"mb-6 rounded-lg border border-red-200 bg-red-50 p-4",children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,c.jsx)("p",{className:"mt-1 text-sm text-red-700",children:(null===(t=v||w)||void 0===t?void 0:t.message)||"Failed to fetch page speed data"})]}),M&&(0,c.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,c.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,c.jsx)(e6.$,{size:"large"}),(0,c.jsxs)("p",{className:"text-lg text-muted-foreground",children:["Loading ",r," data for ",s,"..."]})]})}),b&&!M&&(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"mb-8",children:[(0,c.jsxs)("h4",{className:"text-md mb-4 font-medium",children:["Issues to Fix - ",b.score.label," (",s,")",E.length>0&&(0,c.jsxs)("span",{className:"ml-2 text-sm font-normal text-muted-foreground",children:["(",E.length," ",1===E.length?"issue":"issues",")"]})]}),E.length>0&&(0,c.jsx)("div",{className:"mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4",children:(0,c.jsxs)("div",{className:"flex items-start gap-3",children:[(0,c.jsx)(er.Z,{name:"info",className:"mt-0.5 text-blue-500",size:"small"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Important Information"}),(0,c.jsx)("p",{className:"mt-1 text-sm text-blue-700",children:'Please note that not all performance issues can be automatically fixed by our AI. Some issues may persist even after applying the "Try Fix" feature. We recommend carefully reviewing the detailed analysis and suggestions provided in the chat. After any fixes are applied, you\'ll need to re-publish your application and regenerate the page speed analysis to see the updated results.'})]})]})}),(0,c.jsxs)("div",{className:"space-y-4",children:[E.map((e,t)=>(0,c.jsx)(rP,{audit:e,strategy:s,category:r},"".concat(e.id,"-").concat(t))),0===E.length&&(0,c.jsx)("div",{className:"py-8 text-center",children:(0,c.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,c.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:(0,c.jsx)(er.Z,{name:"check",className:"text-green-600",size:"small"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"mb-1 text-lg font-medium text-green-800",children:"No Issues Found!"}),(0,c.jsxs)("p",{className:"text-sm text-green-600",children:[b.score.label," category is performing excellently. Great job!"]})]})]})})]})]}),b.screenshot&&"performance"===r&&(0,c.jsx)(rT,{screenshotData:b.screenshot})]}),!b&&!M&&!W&&(0,c.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsxs)("p",{className:"mb-4 text-muted-foreground",children:['Select a category above and click "Run" to analyze your project\'s'," ",r," performance"]}),(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:"Analysis results are cached for each strategy and category combination"})]})})]}):(0,c.jsx)(rO,{})};let rK=e=>{let{children:t,device:s,className:a}=e,r=(0,x.useMemo)(()=>{switch(s){case"mobile":return{width:"375px",height:"100%"};case"tablet":return{width:"768px",height:"100%"};default:return{width:"100%",height:"100%"}}},[s]);return(0,c.jsx)("div",{className:(0,el.cn)("flex flex-col transition-all ease-in-out",a),style:{width:r.width,height:r.height},children:t})},rq=e=>{let{hotkey:t,className:s}=e;return(0,c.jsx)("kbd",{className:(0,el.cn)("border-current/30 ml-1 flex h-4 items-center rounded-sm border px-1 text-[9px] font-medium text-inherit transition-colors group-hover:border-foreground",s),children:t.toUpperCase()})},r$=x.forwardRef((e,t)=>{let{hidden:s=!1,disabled:a=!1,hotkey:r,showHotkey:n=!1,onClick:l,hotkeyOptions:i,className:o,...d}=e;return((0,es.y1)(r||"",e=>{e.preventDefault(),l&&l(e)},{enabled:!a,...i},[l]),s)?null:(0,c.jsxs)(V.z,{ref:t,disabled:a,onClick:l,...d,className:(0,el.cn)("group",o),children:[d.children,n&&r&&(0,c.jsx)(rq,{hotkey:r})]})});r$.displayName="HotkeyButton";var rY=s(52089);let rX=e=>{let{projectId:t,errors:s,allErrors:a,setErrors:r,canAIFix:n}=e,{onClick:l,isPending:i}=(0,s_.hw)({projectId:t,errors:a}),o=(0,I.Sl)(e=>e.consoleContentType),[d,u]=(0,x.useState)(!1),[m,h]=(0,x.useState)(!1),p=(0,R.bk)(e=>e.isSendChatMessageMutationPending),{setShowConsole:f,setConsoleErrorContent:v}=(0,I.pE)(),g=(0,I.Sl)(e=>null!==e.consoleContentType),j=(0,rY.qV)({projectId:t,errorIds:s.map(e=>e.id),setErrors:r});return(0,x.useEffect)(()=>{s&&0!==s.length?u(!0):u(!1)},[s]),(0,c.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 overflow-hidden",style:{height:"100%"},children:(0,c.jsx)("div",{className:(0,el.cn)("pointer-events-auto absolute bottom-0 left-1/2 mb-36 w-5/6 max-w-[440px] -translate-x-1/2 transform rounded-lg shadow-lg transition-all duration-500 ease-in-out md:mb-4 ".concat(d?"translate-y-0 opacity-100":"translate-y-full opacity-0")),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:(0,c.jsxs)(rD.Zb,{className:"overflow-hidden p-1",children:[(0,c.jsx)(rD.aY,{className:"p-4",children:(0,c.jsx)("div",{className:"flex w-full flex-col items-start justify-start",children:(0,c.jsxs)("div",{className:"flex w-full items-end justify-between gap-6",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"mb-1 flex items-center",children:[(0,c.jsx)(er.Z,{name:"warning",size:"default",className:"mr-2"}),(0,c.jsx)("p",{className:"text-base font-medium",children:"Error"})]}),(0,c.jsx)("div",{className:"flex flex-col",children:(0,c.jsx)("p",{className:"text-sm text-muted-foreground",children:s_.v7[s[0].type]})})]}),(0,c.jsxs)("div",{className:"flex flex-col items-end justify-end gap-2",children:[(0,c.jsx)(r$,{variant:"outline",onClick:()=>{v(a),f("error"===o?null:"error")},hotkey:"L",showHotkey:!0,children:"Show logs"}),n&&(0,c.jsx)(r$,{variant:"default",className:"w-full",onClick:()=>{r([]),l()},disabled:i||p||g,hotkey:"F",showHotkey:!0,children:"Try to fix"})]})]})})}),m&&(0,c.jsx)("div",{className:"absolute right-0 top-0",children:(0,c.jsx)(V.z,{variant:"ghost",size:"icon",onClick:()=>{j.mutate()},className:"h-6 w-6",children:(0,c.jsx)(er.Z,{name:"close",size:"default"})})})]})})})},rQ=e=>{let{projectId:t}=e,{errors:s,setErrors:a}=(0,rY.hT)({projectId:t}),r=null==s?void 0:s.filter(e=>!e.message_id);if(!r||0===r.length||!s)return null;let n=(0,s_.Sv)(r).includes(s_.eX.AI_FIX);return(0,c.jsx)(rX,{projectId:t,allErrors:s,errors:r,setErrors:a,canAIFix:n})},r0=()=>{let e=(0,F.v)();return e?(0,c.jsx)(rQ,{projectId:e}):(C.logging.error("projectId is not defined, this should not happen"),null)},r1=e=>{let{children:t}=e;return(0,c.jsxs)(c.Fragment,{children:[t,(0,c.jsx)(r0,{})]})},r2=[{icon:"dock_to_right",text:"Chat with AI in the sidebar"},{icon:"location_searching",text:"Select specific elements to modify"},{icon:"imagesmode",text:"Upload images as a reference"},{icon:"preview",text:"Instantly preview your changes"},{icon:"school",text:"Set custom knowledge for every edit"},{icon:"database",text:"Connect Supabase for backend"},{icon:"code_blocks",text:"Collaborate at source, via GitHub"},{icon:"globe",text:"Deploy when you're ready"}],r5=e=>{let{text:t="Setting up..."}=e,s=(0,x.useRef)(null);return(0,x.useEffect)(()=>{let e=s.current;if(!e)return;let t=()=>{e.style.transform="translateY(0)"};return e.addEventListener("animationiteration",t),()=>e.removeEventListener("animationiteration",t)},[]),(0,c.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-8",children:[(0,c.jsx)(er.Z,{name:"lovable_icon",className:"h-[100px] w-[100px] text-muted-foreground/50"}),(0,c.jsx)("span",{children:t}),(0,c.jsxs)("div",{className:"w-100 relative mx-auto h-48 overflow-hidden rounded-lg bg-muted/50",children:[(0,c.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 z-10 h-12 bg-gradient-to-b from-muted to-transparent"}),(0,c.jsx)("div",{ref:s,className:"animate-slide-up",children:[...r2,...r2].map((e,t)=>(0,c.jsxs)("div",{className:"flex items-center gap-3 p-4 transition-colors",children:[(0,c.jsx)(er.Z,{name:e.icon,className:"h-5 w-5 text-muted-foreground"}),(0,c.jsx)("span",{className:"text-muted-foreground",children:e.text})]},t))}),(0,c.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-10 h-12 bg-gradient-to-t from-muted to-transparent"})]}),(0,c.jsx)("div",{id:"onboarding-start",className:"absolute bottom-0 right-[12.5rem] h-3 w-3"})]})};function r4(e){let{message:t,level:s}=e;return void 0===s&&(s="info"),(0,c.jsx)("div",{className:(0,el.cn)("absolute bottom-0 flex w-full flex-grow items-center justify-center pb-36 md:pb-2"),children:(0,c.jsxs)("div",{className:(0,el.cn)("flex min-w-[300px] flex-row items-center justify-between gap-2 rounded-lg border-border px-6 py-4 shadow-lg shadow-black/25","error"===s&&"bg-warning","info"===s&&"bg-background"),children:[(0,c.jsx)("p",{className:"font-medium",children:t})," ",(0,c.jsx)(e6.$,{variant:"ring",size:"default"})]})})}function r3(e){let{activeView:t}=e,s=(0,eg.f6)(e=>e.visibleMode),a=(0,U.iZ)(e=>{var t;return!!(null===(t=e.project)||void 0===t?void 0:t.preview_build_commit_sha)}),r=(0,U.iZ)(e=>!!e.project);return(0,c.jsxs)("div",{className:(0,el.cn)("relative h-full w-full",{invisible:"console"===t||"dev-mode"===t||"seo"===t}),children:[r&&!a&&(0,c.jsx)("div",{className:"absolute inset-0",children:(0,c.jsx)("div",{className:"flex h-full w-full flex-col items-center justify-center"})}),(0,c.jsx)("div",{className:(0,el.cn)("absolute inset-0",{"pointer-events-none invisible":"static"!==s||!a,active:"static"===s}),children:(0,c.jsx)(eg.g9,{})}),(0,c.jsx)("div",{className:(0,el.cn)("absolute inset-0",{"pointer-events-none invisible":"live"!==s,active:"live"===s}),children:(0,c.jsx)(eg.i5,{})}),(0,c.jsx)(r6,{visibleMode:s,hasPreviewBuild:a})]})}function r6(e){let{visibleMode:t,hasPreviewBuild:s}=e,a=(0,eg.f6)(e=>e.error),r=(0,R.bk)(e=>e.isSendChatMessageMutationPending),n=(0,eg.f6)(e=>null!==e.error&&"dev_server"===e.error.type),{agentModeEnabled:l}=(0,ek.v)(),i=(0,eg.f6)(e=>e.targetMode),o=(0,R.bk)(e=>e.isBuildErrorOccurredDuringStream);return"live"!==i?null:s&&o&&r&&l?(0,c.jsx)(r4,{message:"An error occurred, trying to fix automatically",level:"error"}):"live"===t?null:n?(0,c.jsx)("div",{className:"absolute inset-0 flex w-full flex-grow items-center justify-center pb-2",children:(0,c.jsx)(r8,{message:null==a?void 0:a.message,traceId:null==a?void 0:a.traceId})}):s?(0,c.jsx)(r4,{message:"Starting live preview..."}):r?(0,c.jsx)("div",{className:"absolute inset-0 flex flex-grow items-center justify-center bg-muted",children:(0,c.jsx)(r9,{})}):null}function r8(e){let{restartLiveMode:t,revertToStaticMode:s}=(0,eg.My)();return(0,c.jsxs)("div",{className:"absolute flex min-w-[300px] flex-col items-center justify-between gap-6 rounded-lg border-border bg-background px-12 py-6 shadow-lg shadow-black/25",children:[(0,c.jsx)("p",{className:"font-medium",children:e.message}),(0,c.jsx)(V.z,{variant:"accent",onClick:()=>{t(!0)},children:"Try again"}),(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",className:"absolute right-2 top-2 z-10 hover:bg-transparent hover:opacity-75",onClick:()=>s(),children:(0,c.jsx)(er.Z,{name:"close",size:"default"})}),e.traceId&&(0,c.jsx)("code",{className:"absolute bottom-2 right-2 break-all rounded px-[0.2rem] font-mono text-muted-foreground/70",children:e.traceId})]})}function r9(){return(0,c.jsx)("div",{className:"absolute inset-0 flex flex-grow items-center justify-center bg-muted",children:(0,c.jsx)(r5,{text:"Spinning up preview..."})})}let r7=e=>{var t;let{openGithubRequiredDialog:s}=e,{exitConsole:a}=(0,I.pE)(),r=(0,I.Sl)(e=>e.activeEditId),n=(0,z.aK)(e=>r?e.edits[r]:null),l=(0,U.iZ)(e=>e.project),{setActiveView:i}=(0,I.pE)();return(0,c.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,c.jsxs)(r$,{variant:"ghost",size:"sm",onClick:()=>{N.ZP.capture(k.SL.CONSOLE.EXITED_VIA_BUTTON),a(),i("preview")},className:"flex items-center gap-2",hotkey:"esc",showHotkey:!0,hotkeyOptions:{enableOnFormTags:!0},children:[(0,c.jsx)(er.Z,{name:"chevron_left",size:"small"}),"Exit"]}),(null==n?void 0:n.commit_sha)&&(0,c.jsx)(r$,{variant:"ghost",size:"sm",onClick:()=>{var e,t;let a=(0,tY._J)((null==l?void 0:l.github_repo_name)||"",n.commit_sha||"",null==l?void 0:null===(e=l.github_owner)||void 0===e?void 0:e.name);if((null==l?void 0:null===(t=l.github_owner)||void 0===t?void 0:t.name)===tY.aR){s();return}a&&window.open(a,"_blank")},hotkey:"G",showHotkey:!0,children:"View on GitHub"}),(0,c.jsx)(rS,{diffAvailable:!!(null==n?void 0:null===(t=n.diff)||void 0===t?void 0:t.length)})]})},ne=e=>{let{projectId:t,activeView:s}=e,a=(0,ep.ty)();return(0,c.jsx)(tv,{children:(0,c.jsxs)(eA.M,{mode:"wait",children:["console"===s&&(0,c.jsx)(eZ.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 z-10 bg-background",children:(0,c.jsx)(rC,{})},"console"),"dev-mode"===s&&(0,c.jsx)(eZ.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 z-10 flex bg-background",children:(0,c.jsx)(tR,{projectId:t})},"code"),"seo"===s&&a&&(0,c.jsx)(eZ.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 z-10 flex bg-background",children:(0,c.jsx)(rH,{})},"seo")]})})};function nt(e){let{projectId:t}=e,{open:s,GithubRequiredDialog:a}=sH(),r=(0,eg.f6)(e=>e.device),n=(0,I.Sl)(e=>e.activeView),l=(0,I.Sl)(e=>e.consoleContentType),i=(0,v.Z)("md");return(0,c.jsxs)("div",{className:(0,el.cn)("flex flex-grow flex-col overflow-hidden rounded-xl border",{"rounded-none border-none":i}),children:[(0,c.jsx)(a,{}),"console"===n&&("code"===l||"error"===l)&&(0,c.jsx)("div",{className:(0,el.cn)("hidden h-12 w-full items-center justify-between overflow-hidden border-b bg-muted px-3 md:flex"),children:(0,c.jsx)(r7,{openGithubRequiredDialog:s})}),(0,c.jsxs)("div",{className:"relative flex flex-grow flex-col items-center",children:[(0,c.jsx)(rK,{device:r,className:"justify-center",children:(0,c.jsx)(r1,{children:(0,c.jsx)(r3,{activeView:n})})}),(0,c.jsx)(ne,{projectId:t,activeView:n})]})]})}var ns=s(69522);let na=e=>(0,c.jsx)(W.Vq,{...e,children:(0,c.jsx)(W.cZ,{className:"py-16 text-center",children:(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{className:"text-center text-2xl",children:"This project has been deprecated."}),(0,c.jsx)("p",{className:"text-center",children:"This project is no longer supported, as it's using Gitlab. Please consider migrating the code to a new GitHub project."})]})})});var nr=s(19060);let nn=e=>{let t=(0,U.iZ)(e=>e.project),{canEdit:s}=(0,_.t)(),[a,r]=x.useState(!1),n=!!(null==t?void 0:t.is_supabase_enabled)||!!(null==t?void 0:t.supabase_project_config),l=s||!n;return(0,c.jsx)(W.Vq,{...e,children:(0,c.jsxs)(W.cZ,{size:"sm",children:[(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{className:"flex items-center gap-2",children:"Remix this project"}),(0,c.jsxs)(W.Be,{children:[(0,c.jsx)("p",{children:"By remixing a project, you will create a copy that you own."}),!l&&(0,c.jsx)("p",{children:"You do not have permission to remix this project because it uses Supabase."})]})]}),(0,c.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[(0,c.jsx)(nr.X,{id:"include-history",disabled:!s||e.isRemixing,checked:a,onCheckedChange:e=>r(e)}),(0,c.jsx)(aN.Label,{htmlFor:"include-history",children:"Include project history"})]}),(0,c.jsxs)(W.cN,{children:[(0,c.jsx)(W.GG,{asChild:!0,children:(0,c.jsx)(V.z,{variant:"outline",children:"Cancel"})}),(0,c.jsxs)(V.z,{disabled:!l,onClick:()=>e.onRemix({includeHistory:a}),className:"flex items-center gap-1",loading:e.isRemixing,children:[!e.isRemixing&&(0,c.jsx)(er.Z,{name:"shuffle",size:"small"}),e.isRemixing?"Remixing...":"Remix"]})]})]})})};var nl=s(81677),ni=s(33910);(l=(n=o||(o={})).accessibility||(n.accessibility={})).REPO_ACCESSIBLE="repo_accessible",l.REPO_NOT_ACCESSIBLE="repo_not_accessible",l.INSTALLATION_NOT_FOUND="installation_not_found",l.INSTALLATION_SUSPENDED="installation_suspended",l.REPO_NOT_FOUND="repo_not_found",l.INSUFFICIENT_PERMISSIONS="insufficient_permissions";let no=e=>{let{project:t}=e,s=(0,f.C)(),[a,r]=(0,x.useState)(!1),n=t.github_owner,l=t.name;(0,x.useEffect)(()=>{(null==s?void 0:s.accessibility)&&(null==s?void 0:s.accessibility)!==o.accessibility.REPO_ACCESSIBLE&&r(!0)},[null==s?void 0:s.accessibility]);let{authUser:i}=(0,p.Eu)(),{installations:d}=(0,ni.D)({enabled:!!i}),u=(0,f.C)(),m=(0,x.useMemo)(()=>{if(!n||!d)return null;let e=d.find(e=>n.name===e.account.login);return e?e.html_url:null},[n,d]),[h,v]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{u&&("repo_accessible"===u.accessibility?r(!1):h||(r(!0),v(!0)))},[u,r,h,v]),(0,c.jsx)(W.Vq,{open:a,onOpenChange:r,children:(0,c.jsxs)(W.cZ,{children:[(0,c.jsx)(W.fK,{children:(0,c.jsx)(W.$N,{className:"text-2xl",children:"We can't access your repository"})}),(()=>{switch(null==u?void 0:u.accessibility){case"repo_not_accessible":return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{className:"text-l",children:"If you want to keep using Lovable to improve your project:"}),(0,c.jsxs)("ol",{className:"mt-4 list-inside list-decimal",children:[(0,c.jsxs)("li",{children:["Go to the"," ",m?(0,c.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:"GitHub App settings"}):(0,c.jsx)("strong",{children:" GitHub App settings"})]}),(0,c.jsxs)("li",{children:["Grant ",(0,c.jsx)("strong",{children:"Repository access"})," to"," ",n&&l?(0,c.jsxs)("strong",{children:[n.name,"/",l]}):(0,c.jsx)("strong",{children:"your project"}),"."]})]}),(0,c.jsx)(nc,{appSettingsUrl:m})]});case"installation_not_found":return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("p",{className:"text-l",children:["We couldn't find the Lovable GitHub app installation for your"," ",(null==n?void 0:n.type)==="Organization"?"organization":"account",". To resolve this issue, please connect the GitHub app again."]}),(0,c.jsx)("div",{className:"mt-4 flex justify-center",children:(0,c.jsx)(V.z,{className:"ml-2",size:"lg",onClick:()=>{(0,nl.Mn)({githubOwner:null!=n?n:null})},children:"Install GitHub App"})})]});case"insufficient_permissions":return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{className:"text-l",children:"We don't have the necessary permissions to access your repository. Please uninstall and reinstall the Lovable GitHub app."}),(0,c.jsx)(nc,{appSettingsUrl:m})]});case"installation_suspended":return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("p",{className:"text-l",children:["The GitHub app installation for your"," ",(null==n?void 0:n.type)==="Organization"?"organization":"account"," ","has been suspended."," ",m?(0,c.jsxs)(c.Fragment,{children:["To resolve this issue, visit your"," ",(0,c.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:"GitHub App settings"})," ","and unsuspend the Lovable GitHub app installation."]}):(0,c.jsx)(c.Fragment,{children:"Please navigate to your GitHub App settings and unsuspend the Lovable app installation. You can find it under your GitHub account or organization's settings."})]}),(0,c.jsx)(nc,{appSettingsUrl:m})]});case"repo_not_found":return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{className:"text-l",children:"We couldn't find the specified repository in your GitHub account. Please reach out to our support team for further assistance:"}),m&&(0,c.jsxs)("p",{children:["If you removed our app's access to your repository, you can"," ",(0,c.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-affirmative-primary hover:underline",children:"reinstate it here."})]}),(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(V.z,{variant:"outline",asChild:!0,children:(0,c.jsx)(eC.default,{href:"/support",children:"Reach out to Support"})})})]});default:return null}})()]})})},nc=e=>{let{appSettingsUrl:t}=e;return(0,c.jsx)("div",{className:"mt-4 flex justify-center",children:t&&(0,c.jsx)(V.z,{className:"ml-2",size:"lg",onClick:()=>{window.open(t,"_blank")},children:"App settings"})})},nd=e=>{let{project:t}=e,s=(0,m.useRouter)(),a=(0,U.iZ)(e=>e.isRemixDialogOpen),{setIsRemixDialogOpen:r}=(0,U.d2)(),{canEdit:n}=(0,_.t)(),{mutate:l,isPending:i}=(0,ns.G)({onSubmit:()=>r(!0)}),o=t.id,d=(0,x.useCallback)(e=>{let{includeHistory:t}=e;l({projectId:o,includeHistory:t})},[l,o]);return(0,c.jsxs)(c.Fragment,{children:[t&&!t.git_on_s3&&!t.is_github&&(0,c.jsx)(na,{open:!0,onOpenChange:()=>s.push("/")}),n&&t&&(0,c.jsx)(no,{project:t}),(0,c.jsx)(nn,{onRemix:d,isRemixing:i,open:a,onOpenChange:r})]})};var nu=s(74456),nm=s(35194),nx=s(93061);let nh=(0,x.memo)(()=>{let{setSelectedImageUrl:e}=(0,z.mx)(),t=(0,z.aK)(e=>e.selectedImageUrl),s=(0,b.Eh)(e=>e.images),a=(0,x.useCallback)(()=>{e(void 0)},[e]),r=(0,x.useCallback)(e=>{e.target===e.currentTarget&&a()},[a]),n=s.find(e=>e.url===t),l=(null==n?void 0:n.name)||"",i=(0,x.useRef)(null);return(0,c.jsx)(ai.Vq,{open:void 0!==t,onOpenChange:a,children:(0,c.jsxs)(ai.PK,{children:[(0,c.jsx)(ai.t9,{className:"fixed inset-0 z-[10000] bg-black/70 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,c.jsxs)(ai.cZ,{className:"fixed inset-0 z-[10000] flex flex-col items-center justify-center gap-2 bg-transparent data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95",onClick:r,children:[(0,c.jsx)("div",{className:"relative inline-block max-h-[85dvh] max-w-[90vw]",ref:i,children:(0,c.jsx)("img",{onLoad:e=>{let t=e.target;t&&i.current&&(i.current.style.aspectRatio="".concat(t.naturalWidth," / ").concat(t.naturalHeight))},className:"h-full w-full rounded-xl object-contain shadow-modal",src:t,alt:"Fullscreen Image"})}),l&&(0,c.jsx)("p",{className:"mt-2 min-w-0 max-w-[80vw] truncate text-center text-sm text-white",children:l}),(0,c.jsx)(W.GG,{asChild:!0,className:"absolute right-4 top-2.5 text-white",children:(0,c.jsx)(V.z,{variant:"ghost",size:"icon-sm",className:"hover:text-foreground",children:(0,c.jsx)(er.Z,{name:"close"})})})]})]})})});nh.displayName="ImagePreviewDialogV2";var np=s(88746);let nf=[{targetId:"onboarding-start",title:"Take a quick tour while waiting?",description:"Great job on your first prompt! Let's take a quick tour and learn about visual edits, integrations and publishing.",side:"top",showBorder:!1,showTooltip:!1,index:1,eventName:k.SL.ONBOARDING_TOUR.STEP_VIEWED_ONBOARDING_START},{targetId:"visual-editor-toggle",title:"Visual edits",description:"Click directly in your preview to make quick precision changes to fonts, colors or text. Visual edits are free!",side:"top",showBorder:!1,showTooltip:!0,index:2,eventName:k.SL.ONBOARDING_TOUR.STEP_VIEWED_VISUAL_EDITOR_TOGGLE},{targetId:"main-menu",title:"Control your project",description:"Click the project title and open the drop down to rename, duplicate, or adjust settings for your app.",side:"bottom",showBorder:!1,showTooltip:!0,index:3,eventName:k.SL.ONBOARDING_TOUR.STEP_VIEWED_MAIN_MENU},{targetId:"preview-url-bar",title:"Navigate pages or view on mobile",description:"If your app has multiple pages you can navigate between them here, or toggle mobile view to test your design on smaller screens.",side:"bottom",showBorder:!1,showTooltip:!0,index:4,eventName:k.SL.ONBOARDING_TOUR.STEP_VIEWED_PREVIEW_URL_BAR},{targetId:"supabase-dropdown",title:"Connect to database",description:"Supabase automatically stores everything your project needs — like user names, messages, or notes.",side:"bottom",showBorder:!1,showTooltip:!0,index:5,eventName:k.SL.ONBOARDING_TOUR.STEP_VIEWED_SUPABASE_DROPDOWN},{targetId:"publish-menu",title:"Publish your app",description:'Ready to share? Hit "Publish" to go live. You can also connect a custom domain.',side:"bottom",showBorder:!1,showTooltip:!0,index:6,eventName:k.SL.ONBOARDING_TOUR.STEP_VIEWED_SHARE_MENU}],nv=()=>{let e=!(0,v.Z)("md"),{userData:t}=(0,O.SE)(),s=(0,ep.uR)(),a=(0,eg.f6)(e=>e.targetMode),r=s&&e&&!(null==t?void 0:t.has_seen_onboarding_tour)&&"live"===a,[n,l]=(0,x.useState)(0),[i,o]=(0,x.useState)(!0),[d,m]=(0,x.useState)(null),[h,p]=(0,x.useState)(!1),f=(0,u.D)({mutationFn:async()=>{if(!t)return;let e=(0,j.SJ)();await e.put("/user/".concat(t.id),{has_seen_onboarding_tour:!0})}});(0,x.useEffect)(()=>{var e;if(!i)return;let t=document.getElementById(null===(e=nf[n])||void 0===e?void 0:e.targetId);t&&(m(t),t.scrollIntoView({behavior:"smooth",block:"center"}))},[n,i]),(0,x.useEffect)(()=>{if(0===n){let e=setTimeout(()=>{p(!0)},1e3);return()=>clearTimeout(e)}},[n]),(0,x.useEffect)(()=>{var e,t;i&&N.ZP.capture(nf[n].eventName,{step:n+1,stepTitle:null===(e=nf[n])||void 0===e?void 0:e.title,stepTargetId:null===(t=nf[n])||void 0===t?void 0:t.targetId})},[n,i]);let g=()=>{n<nf.length-1?l(n+1):(o(!1),N.ZP.capture(k.SL.ONBOARDING_TOUR.COMPLETED,{totalSteps:nf.length}),f.mutate())},b=()=>{var e,t;o(!1),N.ZP.capture(k.SL.ONBOARDING_TOUR.SKIPPED,{step:n+1,stepTitle:null===(e=nf[n])||void 0===e?void 0:e.title,stepTargetId:null===(t=nf[n])||void 0===t?void 0:t.targetId}),f.mutate()},y=(0,eg.f6)(e=>"live"===e.visibleMode);return r&&(0!==n||!y)&&i&&d?(0,c.jsxs)(en.u,{open:!0,defaultOpen:!0,instant:!0,children:[(0,c.jsx)(en.aJ,{asChild:!0,children:(0,c.jsx)("div",{className:"pointer-events-none fixed",style:{top:d.getBoundingClientRect().top,left:d.getBoundingClientRect().left,width:d.offsetWidth,height:d.offsetHeight,boxShadow:0===n?"none":"0 0 0 9999px rgba(0, 0, 0, 0.5)",zIndex:9998,border:!1!==nf[n].showBorder?"1px solid #3b82f6":"none",borderRadius:getComputedStyle(d).borderRadius||"4px"}})}),(0,c.jsxs)(en._v,{side:nf[n].side,className:"z-[9999] w-[383px] rounded-lg border border-muted-border bg-background p-4 text-foreground opacity-0 shadow-lg transition-opacity duration-300 ".concat(0===n&&h?"opacity-100":n>0?"opacity-100":""),sideOffset:5,avoidCollisions:!0,sticky:"always",children:[nf[n].showTooltip&&(0,c.jsx)(ao.Eh,{className:"z-[10000] h-3 w-3 fill-background"}),(0,c.jsx)("div",{className:"flex flex-col gap-6",children:0===n?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"flex flex-row items-center justify-between",children:(0,c.jsx)("h3",{className:"text-base font-medium text-foreground",children:nf[n].title})}),(0,c.jsx)("p",{className:"text-base text-foreground/80",children:nf[n].description}),(0,c.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,c.jsx)(V.z,{variant:"ghost",size:"sm",onClick:b,className:"text-foreground/60 hover:text-foreground",children:"No thanks"}),(0,c.jsx)(V.z,{size:"sm",onClick:g,className:"bg-affirmative-primary text-affirmative-primary-foreground hover:bg-affirmative-primary/80",children:"Let's go"})]})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,c.jsx)("h3",{className:"text-base font-medium text-foreground",children:nf[n].title}),(0,c.jsx)(V.z,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0 hover:bg-background/10",onClick:b,children:(0,c.jsx)(er.Z,{name:"close",size:"small",className:"text-foreground"})})]}),(0,c.jsx)("p",{className:"text-base text-foreground/80",children:nf[n].description}),(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("p",{className:"text-base text-foreground/60",children:[n," of ",nf.length-1]}),(0,c.jsxs)("div",{className:"flex gap-2",children:[n>1&&(0,c.jsx)(V.z,{variant:"outline",size:"sm",onClick:()=>{n>0&&l(n-1)},className:"hover:affirmative border-0 bg-background text-foreground",children:"Back"}),(0,c.jsx)(V.z,{size:"sm",onClick:g,className:"bg-affirmative-primary text-affirmative-primary-foreground hover:bg-affirmative-primary/80",children:n===nf.length-1?"Done":"Next"})]})]})]})})]})]}):null},ng=()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(np.Y,{}),(0,c.jsx)(nx.WorkspacePaymentFailedDialog,{}),(0,c.jsx)(nm.CreateWorkspaceDialog,{}),(0,c.jsx)(nu.default,{}),(0,c.jsx)(nv,{}),(0,c.jsx)(nh,{}),(0,c.jsx)(M.RootDialog,{})]}),nj=e=>{var t;let{children:s,projectId:a}=e,[r,n]=(0,x.useState)(!0),l=(0,U.iZ)(e=>e.project),{isAuthenticated:i}=(0,p.Eu)();(0,x.useEffect)(()=>{(null==l?void 0:l.name)&&(document.title="".concat(l.name," - Lovable"))},[null==l?void 0:l.name]);let{canEdit:o,isLoading:d}=(0,_.t)(),u=(0,H.c)(e=>e.hasFetchedCollaborators),m=!d&&(!i||!!u)&&!1===o,f=(0,x.useRef)(null),v=(0,ep.xR)(),g=(0,x.useCallback)(()=>{n(!1)},[]),j=(0,x.useCallback)(()=>{n(!0)},[]),b=(0,x.useCallback)(()=>{n(!r)},[r]);(0,x.useEffect)(()=>{var e,t;r?null===(e=y.current)||void 0===e||e.expand():null===(t=y.current)||void 0===t||t.collapse()},[r]),(0,x.useEffect)(()=>{m&&g()},[g,m]),(0,es.y1)("mod+b",e=>{e.preventDefault(),b()},{enableOnFormTags:!0},[b]);let y=(0,x.useRef)(null),w=(0,eM.I_)(),N=(0,eM.k6)(),C=(0,eM.SE)(e=>e.panelSizes),k=(0,eM.SE)(e=>e.updatePanelSizes),E=(0,M.z)(s8),S=s3();return(0,x.useEffect)(()=>{if(S){let e=h.Am.warning("Update Project",{description:"Your project is out of date",duration:1/0,action:(0,c.jsx)(V.z,{className:"ml-auto",variant:"accent",onClick:()=>{E({childProps:{}})},children:"Update project"})});return()=>{h.Am.dismiss(e)}}},[S,E]),(0,c.jsxs)("div",{className:"flex h-dvh flex-col",children:[(0,c.jsx)("div",{className:"sticky top-0 z-50 w-full",children:(0,c.jsx)(s9.E,{})}),(0,c.jsxs)("div",{className:"flex min-h-0 flex-1 flex-col bg-background",children:[l&&(0,c.jsx)(nd,{project:l}),(0,c.jsx)(ng,{}),v?(0,c.jsx)(a$,{}):(0,c.jsx)(aY,{}),(0,c.jsx)(s4,{isSidebarOpen:r,toggleSidebar:b,openSidebar:j,hideButtons:m}),(0,c.jsx)("main",{className:"relative isolate flex min-h-0 flex-1",ref:f,children:(0,c.jsx)("div",{className:"hidden min-h-0 flex-1 md:flex",children:(0,c.jsxs)(ae,{direction:"horizontal",className:"relative flex min-h-0 flex-1 flex-row",autoSaveId:"editor-resizable-panels",onLayout:e=>{e&&(e[0]>0&&(document.cookie="react-resizable-panels:layout=".concat(JSON.stringify(e),"; path=/projects")),k(e))},children:[(0,c.jsx)(at,{collapsible:!0,onExpand:j,onCollapse:g,defaultSize:null!==(t=C[0])&&void 0!==t?t:eU.DEFAULT_SIDEBAR_SIZE,minSize:w,maxSize:N,collapsedSize:0,className:(0,el.cn)("relative inset-y-0 z-40 mr-0 flex h-full min-h-0 overflow-x-hidden bg-background"),ref:y,children:s}),(0,c.jsx)(as,{className:"z-[10000] ml-2",tooltip:"Drag to resize"}),(0,c.jsx)(at,{minSize:40,defaultSize:C[1]||100-eU.DEFAULT_SIDEBAR_SIZE,className:"relative flex flex-1 flex-col pb-2 pr-2",id:"preview-panel",children:(0,c.jsx)(nt,{projectId:a})})]})})})]})]})};var nb=s(2784);let ny=()=>{let{refreshPreview:e}=(0,eg.My)(),[t,s]=(0,x.useState)(!1),a=(0,x.useRef)(null),{pages:r}=eY(),n=(0,e$.u)(e=>e.setCurrentPage),l=(0,eg.My)().refreshPreview,i=(0,eg.f6)(e=>e.currentPath);(0,x.useEffect)(()=>{n(i||"/"),h(i||"/")},[i,n]),(null==r?void 0:r.find(e=>e.path===i))||null==r||r.find(e=>eQ(i,e.path));let o=e0(i),[d,u]=(0,x.useState)(!1),[m,h]=(0,x.useState)(o),p=null==r?void 0:r.filter(e=>e&&e.path.toLowerCase().includes(m.toLowerCase())),f="preview"!==(0,I.Sl)(e=>e.activeView),v=(0,rc.gu)(e=>e.view),[g,j]=(0,x.useState)(!0);(0,x.useEffect)(()=>{let e=0,t=t=>{if("SCROLL_POSITION"===t.data.type){let{scrollY:s}=t.data.payload,a=s-e;a>20?j(!1):a<-1&&j(!0),e=s}};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[]);let b=(0,rc.gu)(e=>e.isPreviewDocked),{setIsPreviewDocked:y}=(0,rc.zp)(),w={visible:{opacity:v===rc.$.PREVIEW?1:0,scale:v===rc.$.PREVIEW?1:.9},hidden:{opacity:0,scale:.5}};return(0,c.jsx)("div",{className:"relative h-10 w-full",children:(0,c.jsxs)(eZ.E.div,{className:(0,el.cn)("absolute inset-x-0 bottom-0 flex w-full flex-col overflow-hidden rounded-3xl border bg-background shadow-modal",!b&&"border-transparent",b&&"shadow-transparent"),style:{transition:"box-shadow 0.2s ease-out"},initial:{opacity:0,scale:.9},animate:b?"visible":g?"visible":"hidden",variants:w,transition:{duration:.2,type:"spring",bounce:.15},children:[(0,c.jsxs)(eZ.E.div,{className:"flex max-h-[200px] w-full flex-col gap-1 overflow-hidden overflow-y-auto px-2",initial:{height:0,paddingTop:0,paddingBottom:0},animate:{height:d?"auto":0,paddingTop:d?12:0,paddingBottom:d?12:0},transition:{duration:.3,type:"spring",bounce:.1},children:[null==p?void 0:p.slice(0,9).map((e,t)=>(0,c.jsx)(eZ.E.button,{className:(0,el.cn)("flex w-full flex-col rounded-full px-4 py-1 text-left active:bg-muted",0===t&&"bg-muted"),onClick:()=>{n(e.path),h(e.path),l(e.path),u(!1)},children:(0,c.jsx)("p",{className:"text-lg",children:nw(e.path,m)})},e.path)),(null==p?void 0:p.length)===0&&(0,c.jsxs)("p",{className:"px-4 py-1 text-lg text-muted-foreground",children:['No pages found matching "',m,'"']})]}),(0,c.jsx)("div",{id:"preview-url-bar",className:(0,el.cn)("flex h-10 items-center bg-background pl-2",d&&"border-t"),children:(0,c.jsxs)("form",{className:"relative flex h-full min-h-10 flex-grow items-center",onSubmit:e=>{var t,s,r,i;e.preventDefault(),(null==p?void 0:p[0])&&(n((null==p?void 0:null===(t=p[0])||void 0===t?void 0:t.path)||""),l((null==p?void 0:null===(s=p[0])||void 0===s?void 0:s.path)||""),h((null==p?void 0:null===(r=p[0])||void 0===r?void 0:r.path)||""),u(!1),null===(i=a.current)||void 0===i||i.blur())},children:[r&&r.length>1?(0,c.jsx)(eK.I,{ref:a,type:"text",value:f?"Pages unavailable":m,onChange:e=>h(e.target.value),placeholder:"Search pages",onBlur:()=>u(!1),className:"h-full border-none bg-transparent px-4 py-3 text-lg shadow-none outline-none ring-0 focus-visible:outline-none focus-visible:ring-0",disabled:f,onFocus:e=>{u(!0),setTimeout(()=>{var e;null===(e=a.current)||void 0===e||e.select()},0),/Android/i.test(navigator.userAgent)&&setTimeout(()=>{e.target.scrollIntoView({behavior:"smooth",block:"center"})},200)}}):(0,c.jsx)("p",{className:"flex h-full items-center px-4 text-lg",children:o}),(0,c.jsxs)("div",{className:"absolute inset-y-0 right-0 flex items-center gap-0.5",children:[d&&(0,c.jsx)(V.z,{variant:"ghost",className:"mr-2 h-8 w-8 p-1",type:"button",onPointerDown:e=>{h("/"),e.preventDefault()},children:(0,c.jsx)(er.Z,{name:"close"})}),!d&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e4,{variant:"ghost",type:"button",className:"h-8 w-8 p-1"}),(0,c.jsx)(V.z,{variant:"ghost",className:"h-8 w-8 p-1",type:"button",onClick:()=>{s(!0),e(),setTimeout(()=>{s(!1)},1e3)},disabled:t,children:(0,c.jsx)(er.Z,{name:"refresh",className:t?"animate-spin":""})}),(0,c.jsx)("button",{className:(0,el.cn)("h-full pl-2 pr-4",b&&"bg-accent-primary text-accent-primary-foreground"),onClick:()=>{y(e=>!e),j(!0)},children:(0,c.jsx)(er.Z,{name:b?"dock_to_bottom_fill":"dock_to_bottom"})})]})]})]})})]})})},nw=(e,t)=>{if(!t||"/"===t)return(0,c.jsx)("span",{children:e});let s=e.startsWith("/")?e.slice(1):e,a=t.startsWith("/")?t.slice(1):t,r=a.toLowerCase();if(!s.toLowerCase().includes(r))return(0,c.jsx)("span",{children:e});let n=s.toLowerCase().indexOf(r),l=s.slice(0,n),i=s.slice(n,n+a.length),o=s.slice(n+a.length);return(0,c.jsxs)("span",{children:[e.startsWith("/")&&"/",l&&(0,c.jsx)("span",{className:"text-muted-foreground",children:l}),(0,c.jsx)("span",{children:i}),o&&(0,c.jsx)("span",{className:"text-muted-foreground",children:o})]})};var nN=s(74026),n_=s(97752),nC=s(71830),nk=s(61160),nE=s(87751),nS=s(21399),nz=s(57492);let nI=()=>{let e=(0,a0.hT)(e=>e.chatMode)===a0.jE.CHAT_ONLY,{setChatMode:t}=(0,a0.VK)(),{isAgentModeDefault:s}=(0,ek.v)();return(0,c.jsx)(eA.M,{children:e&&(0,c.jsx)(nR,{className:"bg-affirmative-primary text-affirmative-primary-foreground",icon:"emoji_objects",onClick:()=>{t(s?a0.jE.AGENT:a0.jE.DEFAULT)}})})},nR=e=>{let{className:t,icon:s,onClick:a}=e;return(0,c.jsxs)(eZ.E.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,type:"spring",bounce:0},className:(0,el.cn)("flex h-10 shrink-0 items-center justify-center gap-2 rounded-full px-2.5 py-1",t),type:"button",onClick:a,children:[(0,c.jsx)(er.Z,{name:s}),(0,c.jsx)(er.Z,{name:"close",className:"opacity-50"})]})},nP=e=>{let[t,s]=(0,x.useState)(!1),a=(0,F.v)(),{setSelectedImageUrl:r}=(0,z.mx)(),{message:n,sendChatMessage:l,isSendingDisabled:i,AuthDialogComponent:o}=(0,nS.i)(),d=(0,x.useCallback)(async()=>{if((0,nz.Go)(n)){N.ZP.capture("api_key_detected",{project_id:a}),s(!0);return}await l()},[a,l,n]);return(0,c.jsxs)("div",{className:"flex w-full items-start justify-between gap-2",children:[(0,c.jsx)(nE.s,{isOpen:t,onDismiss:()=>s(!1),onConfirm:()=>{s(!1),l(),N.ZP.capture("api_key_warning_dismissed",{project_id:a})}}),(0,c.jsxs)(nN.x,{className:"relative w-full flex-1 border-none bg-transparent p-0 md:mr-0",onSubmit:d,AuthDialogComponent:o,children:[(0,c.jsx)(n_.T,{setSelectedImageUrl:r}),(0,c.jsxs)("div",{className:"flex flex-1 items-start gap-2",children:[(0,c.jsx)(nC.E,{autoSize:!0,minHeight:40,forceShowPlaceholder:!1,placeholder:"Ask Lovable...",enableSlashCommands:!1,isChatModeActive:!1,className:"text-lg",shouldAutoFocus:!1}),(0,c.jsx)(nI,{})]}),(0,c.jsx)(nk.y,{})]}),(0,c.jsx)("div",{className:"mt-1"})]})},nD=e=>{let{view:t}=e;return(0,c.jsxs)("div",{className:"relative z-10",children:[t===rc.$.PREVIEW&&(0,c.jsx)(ny,{}),t===rc.$.CHAT&&(0,c.jsx)(nP,{})]})};var nO=s(96233);let nT=e=>{let{}=e,t=(0,a0.hT)(e=>e.chatMode)===a0.jE.CHAT_ONLY,{setChatMode:s}=(0,a0.VK)(),{isAgentModeDefault:a}=(0,ek.v)();return(0,c.jsx)("div",{className:"flex flex-col gap-1",children:(0,c.jsxs)("div",{className:"flex items-center gap-2 py-2",children:[(0,c.jsx)(er.Z,{name:"emoji_objects",className:"h-5 w-5"}),(0,c.jsx)("p",{className:"flex-1 text-lg",children:"Chat Mode"}),(0,c.jsx)(eS.r,{checked:t,onCheckedChange:()=>s(t?a?a0.jE.AGENT:a0.jE.DEFAULT:a0.jE.CHAT_ONLY),className:"h-6 w-10",thumbClassName:"h-5 w-5"})]})})};var nA=s(16054);let nZ=e=>{let{closeSheet:t}=e,{getInputProps:s}=(0,nA.j)({portalTargetRef:null,onDropAccepted:t});return(0,c.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,c.jsxs)("label",{className:"flex cursor-pointer flex-col items-center justify-center gap-2 rounded-xl border border-input p-4 active:bg-muted",children:[(0,c.jsx)("input",{className:"hidden",...s({capture:"environment"})}),(0,c.jsx)(er.Z,{name:"add_a_photo"}),(0,c.jsx)("p",{children:"Camera"})]}),(0,c.jsxs)("label",{className:"flex flex-col items-center justify-center gap-2 rounded-xl border border-input p-4 active:bg-muted",children:[(0,c.jsx)("input",{className:"hidden",...s()}),(0,c.jsx)(er.Z,{name:"add_photo_alternate"}),(0,c.jsx)("p",{children:"Images"})]})]})},nL=e=>{let{children:t}=e,[s,a]=(0,x.useState)(!1);return(0,c.jsxs)(nO.yo.Root,{license:"commercial",presented:s,onPresentedChange:a,children:[(0,c.jsx)(nO.yo.Trigger,{asChild:!0,children:t}),(0,c.jsx)(nO.yo.Portal,{children:(0,c.jsxs)(nO.yo.View,{className:"z-[10000]",children:[(0,c.jsx)(nO.yo.Backdrop,{themeColorDimming:"auto"}),(0,c.jsxs)(nO.yo.Content,{className:"flex h-auto flex-col gap-4 rounded-t-2xl p-4",children:[(0,c.jsx)(nO.yo.BleedingBackground,{className:"rounded-t-2xl border-t bg-background"}),(0,c.jsx)(nZ,{closeSheet:()=>{a(!1)}}),(0,c.jsx)(nT,{})]})]})})]})};var nF=s(66431),nM=s(86843);let nU=e=>{let{children:t}=e,s=(0,ei.z)(e=>e.showHistory),{setShowHistory:a}=(0,ei.VF)();return(0,c.jsxs)(nO.yo.Root,{license:"commercial",presented:s,onPresentedChange:a,children:[(0,c.jsx)(nO.yo.Trigger,{asChild:!0,children:t}),(0,c.jsx)(nO.yo.Portal,{children:(0,c.jsxs)(nO.yo.View,{className:"z-[10000] h-[max(100dvh,100%)]",detents:["50vh"],swipeOvershoot:!1,children:[(0,c.jsx)(nO.yo.Backdrop,{themeColorDimming:"auto"}),(0,c.jsxs)(nO.yo.Content,{className:"flex h-[calc(max(100dvh,100%)-20px)] flex-col rounded-t-2xl border-t bg-background p-4 pb-0",children:[(0,c.jsx)(nO.yo.Title,{children:"History"}),(0,c.jsx)(nO.yo.Description,{className:"text-muted-foreground",children:"View and restore past edits"}),(0,c.jsx)(nO.Xs.Root,{asChild:!0,className:"w-full",children:(0,c.jsx)(nO.Xs.View,{className:"mt-4 flex min-h-0 w-full flex-1 [&>div]:w-full",children:(0,c.jsx)(nO.Xs.Content,{asChild:!0,className:"w-full",children:(0,c.jsx)("div",{className:"flex min-h-0 w-full flex-1 flex-col @container/chat",children:(0,c.jsx)(nM.p,{})})})})}),(0,c.jsx)(nF.A,{})]})]})})]})},nV=eZ.E.create(V.z),nW=()=>{let e=(0,ei.z)(e=>e.showHistory),t=(0,rc.gu)(e=>e.isPreviewDocked);return(0,c.jsx)(nU,{children:(0,c.jsx)(nV,{variant:t?"outline":"secondary",size:"mobile-round",className:(0,el.cn)("bg-secondary !shadow-modal hover:bg-secondary md:hover:bg-accent-primary/75 md:hover:text-accent-primary-foreground",e&&"bg-accent-primary text-accent-primary-foreground hover:bg-accent-primary md:hover:bg-accent-primary/75",!t&&"!shadow-modal",t&&"!shadow-transparent"),initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},style:{transition:"box-shadow 0.2s ease-out"},children:(0,c.jsx)(er.Z,{name:"history"})})})};var nB=s(96279);let nG=e=>{let{children:t}=e,s=(0,F.v)(),{message:a,sendChatMessage:r,isSendingDisabled:n}=(0,nS.i)(),{showStopAction:l,mutation:i}=(0,nB.q)({projectId:null!=s?s:void 0}),o=(0,x.useCallback)(async()=>{await i.mutateAsync()},[i]);return s&&(l||i.isPending)?(0,c.jsx)(eZ.E.button,{type:"button",className:(0,el.cn)("h-10 w-10 rounded-full transition-opacity duration-150 disabled:cursor-not-allowed disabled:opacity-50"),disabled:i.isPending,onClick:o,initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"stop_circle",size:"2xlarge"})},"stop-button"):a.length>0?(0,c.jsx)(eZ.E.button,{id:"chatinput-send-message-button",type:"submit",className:(0,el.cn)("h-10 w-10 rounded-full transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50"),disabled:n,onClick:r,initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"arrow_circle_up",size:"2xlarge"})},"send-button"):t};var nJ=s(37053);let nH=(0,x.forwardRef)((e,t)=>{let{children:s,className:a,asChild:r=!1,...n}=e,l=r?nJ.g7:"div";return(0,c.jsx)(l,{ref:t,className:(0,el.cn)("flex items-center gap-2 py-2 transition-colors duration-150 ease-in-out active:text-muted-foreground",a),...n,children:s})});nH.displayName="MobileMenuOption";let nK=e=>{let{project:t}=e,{openSettings:s}=(0,eR.r)(),{customDomains:a}=sO({projectId:null==t?void 0:t.id,enabled:!0});return(0,c.jsxs)("div",{className:"my-4 flex flex-col gap-2",children:[(null==t?void 0:t.url)?(0,c.jsx)(nH,{asChild:!0,children:(0,c.jsxs)("a",{href:null==t?void 0:t.url,target:"_blank",rel:"noreferrer",className:"font-medium",children:[(0,c.jsx)(er.Z,{name:"language"}),(0,sP.P)(t.url),(0,c.jsx)(er.Z,{name:"arrow_outward",className:"ml-auto text-muted-foreground"})]})}):(0,c.jsxs)(nH,{children:[(0,c.jsx)(er.Z,{name:"language"}),(0,c.jsxs)("p",{className:"font-medium",children:[null==t?void 0:t.name,".lovable.app"]})]}),null==a?void 0:a.map((e,t)=>(0,c.jsx)("div",{className:"flex items-center px-4 py-0.5",children:(0,c.jsx)(sR.Z,{domain:e,showRemove:!1,showIcon:!0},t)},t)),(0,c.jsxs)(nH,{onClick:()=>s("domains"),children:[(0,c.jsx)(er.Z,{name:"add"}),"Custom domains"]})]})},nq=e=>{let{children:t}=e,[s,a]=(0,x.useState)(!1),{setView:r}=(0,rc.zp)(),n=()=>{a(!1)},[l,i]=(0,x.useState)(!1),o=(0,U.iZ)(e=>e.project),d=(0,U.iZ)(e=>e.projectId),{securityWarnings:u,isLoadingWarnings:m,hasSupabaseConfig:h,hasSecurityIssues:p,handleReviewIssuesInDialog:f,handleSecurityReview:v,isSendingSecurityReview:g}=sM({project:o,setIsOpen:a,setShowPublishConfirmDialog:i}),{errorMessage:j,isBuildError:b,failedDialogOpen:y,setFailedDialogOpen:w,handlePublish:N,handlePublishAnyway:_,publishMutation:C}=sZ({projectId:d,securityWarnings:u,setShowPublishConfirmDialog:i});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(nO.yo.Root,{license:"commercial",presented:s,onPresentedChange:a,children:[(0,c.jsx)(nO.yo.Trigger,{asChild:!0,children:t}),(0,c.jsx)(nO.yo.Portal,{children:(0,c.jsxs)(nO.yo.View,{className:"z-[10000]",children:[(0,c.jsx)(nO.yo.Backdrop,{themeColorDimming:"auto"}),(0,c.jsxs)(nO.yo.Content,{className:"h-auto rounded-t-2xl p-4",children:[(0,c.jsx)(nO.yo.Title,{children:(null==o?void 0:o.url)?"Update":"Publish"}),(0,c.jsx)(nO.yo.Description,{className:"text-muted-foreground",children:(null==o?void 0:o.url)?"Update your project to make your changes live.":"Publish your project to make it visible for others on the internet."}),(0,c.jsx)(nK,{project:o}),h&&(0,c.jsx)(sV,{isLoadingSecurityWarnings:m,securityWarnings:u,project:o}),(0,c.jsxs)("div",{className:"mt-8 flex items-center gap-2",children:[(0,c.jsx)(V.z,{variant:"secondary",onClick:()=>{r(rc.$.CHAT),v(),n()},disabled:g,loading:g,className:"relative h-10 flex-1 gap-1.5 text-base",children:"Review Security"}),(0,c.jsx)(V.z,{variant:p?"secondary":"affirmative",onClick:N,disabled:m,loading:C.isPending,className:"h-10 flex-1 text-base",children:(null==o?void 0:o.url)?"Update":"Publish"})]}),(0,c.jsx)(nO.yo.BleedingBackground,{className:"rounded-t-2xl border-t bg-background"})]})]})})]}),(0,c.jsx)(sk,{open:y,onOpenChange:w,errorMessage:j,isBuildError:b}),(0,c.jsx)(sz,{open:l,onOpenChange:i,onPublishAnyway:_,onReviewIssues:f})]})},n$=eZ.E.create(V.z),nY=()=>{let{activeView:e,consoleContentType:t}=(0,I.Sl)(e=>({activeView:e.activeView,consoleContentType:e.consoleContentType})),s=(0,z.aK)(e=>e.edits),a=(0,I.Sl)(e=>e.activeEditId),r=a?s[a]:null,{openSettings:n}=(0,eR.r)();return"preview"===e?(0,c.jsx)(nQ,{}):"console"===e&&"snapshot-preview"===t?(0,c.jsx)(nX,{activeEdit:r}):(0,c.jsx)(n$,{variant:"outline",size:"mobile-round",onClick:()=>n(),initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"settings"})},"settings-button")},nX=e=>{let{activeEdit:t}=e,{setView:s}=(0,rc.zp)(),{exitConsole:a}=(0,I.pE)(),r=(0,sY.C)(),n=(0,R.bk)(e=>e.isSomeRevertMutationPending),{mutate:l,isPending:i}=(0,sX.I)({onSuccess:a}),o=(0,rc.gu)(e=>e.isPreviewDocked);return(0,c.jsx)(n$,{variant:o?"outline":"secondary",size:"mobile-round",className:(0,el.cn)("animate-text-shimmer px-0 text-lg text-affirmative-primary hover:bg-secondary focus-visible:bg-secondary active:bg-secondary",!o&&"!shadow-modal",o&&"!shadow-transparent"),style:{transition:"box-shadow 0.2s ease-out"},disabled:!t||r||n||i,onClick:()=>{l({edit:t}),s(rc.$.CHAT)},initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"restart_alt",className:i?"animate-spin-reverse":""})},"restore-button")},nQ=()=>{let e=(0,rc.gu)(e=>e.isPreviewDocked);return(0,c.jsx)(nq,{children:(0,c.jsx)(n$,{variant:e?"outline":"secondary",size:"mobile-round",className:(0,el.cn)("px-0 text-lg text-affirmative-primary hover:bg-secondary focus-visible:bg-secondary active:bg-secondary",!e&&"!shadow-modal",e&&"!shadow-transparent"),style:{transition:"box-shadow 0.2s ease-out"},initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"language"})},"publish-button")})},n0=()=>{let{view:e}=(0,rc.gu)(e=>e),{setView:t}=(0,rc.zp)(),s=(0,x.useRef)(null),a=(0,rc.gu)(e=>e.isPreviewDocked);return(0,c.jsxs)(eZ.E.div,{ref:s,className:(0,el.cn)("relative grid h-10 flex-1 grid-cols-2 rounded-full bg-muted text-lg",e===rc.$.PREVIEW&&!a&&"shadow-modal",a&&"shadow-transparent"),style:{transition:"box-shadow 0.2s ease-out"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,type:"spring",bounce:0},children:[(0,c.jsx)("div",{onClick:()=>t(rc.$.CHAT),className:(0,el.cn)("relative flex h-full cursor-pointer items-center justify-center rounded-full px-4"),"data-testid":"mobile-view-chat-button",children:(0,c.jsx)("span",{className:"pointer-events-none relative z-10 select-none",children:"Chat"})}),(0,c.jsx)("div",{onClick:()=>t(rc.$.PREVIEW),className:(0,el.cn)("relative flex h-full cursor-pointer items-center justify-center rounded-full px-4"),"data-testid":"mobile-view-preview-button",children:(0,c.jsx)("span",{className:"pointer-events-none relative z-10 select-none",children:"Preview"})}),(0,c.jsx)(eZ.E.div,{className:"absolute inset-y-[2px] w-1/2 rounded-full bg-background shadow-md","data-testid":"mobile-view-pill","data-view":e,initial:{left:e===rc.$.CHAT?"2px":"calc(50% - 2px)"},animate:{left:e===rc.$.CHAT?"2px":"calc(50% - 2px)"},transition:{type:"spring",duration:.4,bounce:0},layoutId:"mobile-view-switcher-pill",drag:"x",dragConstraints:s,dragElastic:0,dragMomentum:!0,dragTransition:{bounceStiffness:80,bounceDamping:10},dragSnapToOrigin:!0,onDragEnd:(e,a)=>{if(!s.current)return;let r=a.offset.x;Math.abs(r)>40&&(r>0?t(rc.$.PREVIEW):t(rc.$.CHAT))}},"pill-".concat(e))]},"mobile-view-switcher")},n1=()=>(0,c.jsxs)("div",{className:"absolute inset-0 translate-y-[30%] [&>div]:absolute [&>div]:inset-0",style:{bottom:"calc(-1 * env(safe-area-inset-bottom))"},children:[(0,c.jsx)("div",{style:{zIndex:2,WebkitBackdropFilter:"blur(1px)",backdropFilter:"blur(1px)",WebkitMask:"linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgb(255, 255, 255) 12.5%, rgb(255, 255, 255) 37.5%, rgba(255, 255, 255, 0) 50%)"}}),(0,c.jsx)("div",{style:{zIndex:3,WebkitBackdropFilter:"blur(2px)",backdropFilter:"blur(2px)",WebkitMask:"linear-gradient(to bottom, rgba(255, 255, 255, 0) 12.5%, rgb(255, 255, 255) 37.5%, rgb(255, 255, 255) 50%, rgba(255, 255, 255, 0) 62.5%)"}}),(0,c.jsx)("div",{style:{WebkitBackdropFilter:"blur(4px)",backdropFilter:"blur(4px)",WebkitMask:"linear-gradient(to bottom, rgba(255, 255, 255, 0) 37.5%, rgb(255, 255, 255) 50%, rgb(255, 255, 255) 62.5%, rgba(255, 255, 255, 0) 75%)"}}),(0,c.jsx)("div",{style:{zIndex:5,WebkitMask:"linear-gradient(to bottom, rgba(255, 255, 255, 0) 50%, rgb(255, 255, 255) 62.5%, rgb(255, 255, 255) 75%, rgba(255, 255, 255, 0) 87.5%)",WebkitBackdropFilter:"blur(8px)",backdropFilter:"blur(8px)"}})]}),n2=eZ.E.create(V.z),n5=()=>{let{view:e}=(0,rc.gu)(e=>e),{setView:t}=(0,rc.zp)(),{setShowConsole:s,exitConsole:a}=(0,I.pE)(),{openSettings:r}=(0,eR.r)(),n=(0,rc.gu)(e=>e.isPreviewDocked),l=(0,I.Sl)(e=>e.consoleContentType);return"preview"===(0,I.Sl)(e=>e.activeView)||"snapshot-preview"===l||e===rc.$.CHAT||null===l?(0,c.jsxs)("div",{className:(0,el.cn)("relative z-10 -mx-px flex w-[calc(100%+2px)] flex-col gap-2 rounded-t-2xl border-l border-r border-t bg-background p-4",e===rc.$.PREVIEW&&"gap-2 rounded-none bg-transparent transition-colors duration-150 ease-in-out",!n&&e===rc.$.PREVIEW&&"border-none"),children:[!n&&(0,c.jsx)(n1,{}),(0,c.jsx)(nD,{view:e}),(0,c.jsxs)("div",{className:"z-20 flex w-full items-center justify-between gap-2",children:[(0,c.jsx)("div",{className:"flex justify-start gap-2",children:(0,c.jsxs)(eA.M,{children:[e===rc.$.CHAT&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(nL,{children:(0,c.jsx)(n2,{variant:"outline",size:"mobile-round",initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"add"})})})}),e===rc.$.PREVIEW&&(0,c.jsx)(nW,{})]})}),(0,c.jsx)(n0,{}),(0,c.jsx)("div",{className:"flex justify-end gap-2",children:(0,c.jsxs)(eA.M,{children:[e===rc.$.CHAT&&(0,c.jsx)(nG,{children:(0,c.jsx)(n2,{variant:"outline",size:"mobile-round",onClick:()=>r(),initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},transition:{duration:.2,type:"spring",bounce:.4},children:(0,c.jsx)(er.Z,{name:"settings"})},"settings-button")}),e===rc.$.PREVIEW&&(0,c.jsx)(nY,{})]})})]})]}):(0,c.jsx)(n4,{consoleContentType:l,setView:t,exitConsole:a})},n4=e=>{let{consoleContentType:t,setView:s,exitConsole:a}=e;return(0,c.jsxs)("div",{className:"relative -mx-px flex w-[calc(100%+2px)] items-center justify-between overflow-hidden rounded-t-2xl border-x border-t bg-background px-4 py-4",children:[(0,c.jsx)(V.z,{variant:"outline",onClick:()=>{s(rc.$.CHAT),a()},size:"mobile-round",children:(0,c.jsx)(er.Z,{name:"chevron_left"})}),(0,c.jsxs)("p",{className:"absolute left-1/2 -translate-x-1/2 whitespace-nowrap text-center font-medium",children:["Viewing ",I.vD[t]]})]})},n3=e=>{let{onSelect:t}=e;return(0,c.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,c.jsx)(n6,{value:"system",label:"System",icon:"contrast",onSelect:t}),(0,c.jsx)(n6,{value:"light",label:"Light",icon:"light_mode",onSelect:t}),(0,c.jsx)(n6,{value:"dark",label:"Dark",icon:"dark_mode",onSelect:t})]})},n6=e=>{let{value:t,label:s,icon:a,onSelect:r}=e,{theme:n,setTheme:l}=(0,ts.F)(),i=e=>{("light"===e||"dark"===e||"system"===e)&&(l(e),null==r||r())};return(0,c.jsxs)("div",{className:(0,el.cn)("flex cursor-pointer flex-col items-center justify-center gap-2 rounded-xl border border-input bg-background p-4 active:bg-muted-active",n===t&&"border-primary"),onClick:()=>i(t),children:[(0,c.jsx)(er.Z,{name:a}),(0,c.jsx)("p",{children:s})]})},n8=e=>{let{children:t}=e,{authUser:s}=(0,p.Eu)(),{theme:a}=(0,ts.F)(),[r,n]=(0,x.useState)(!1),l=(0,eT.hO)(e=>e.projectWorkspace),i=!!(s&&l&&(null==s?void 0:s.uid)===(null==l?void 0:l.owner_id)),o=(0,U.iZ)(e=>e.project),{canEdit:d}=(0,_.t)(),[u,m]=(0,x.useState)(!1),[h,f]=(0,x.useState)("initial"),{openSettings:v}=(0,eR.r)();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(nO.yo.Root,{license:"commercial",presented:r,onPresentedChange:e=>{n(e),f("initial")},className:"flex min-w-0",children:[(0,c.jsx)(nO.yo.Trigger,{asChild:!0,children:t}),(0,c.jsx)(nO.yo.Portal,{children:(0,c.jsxs)(nO.yo.View,{className:"z-[10000]",children:[(0,c.jsx)(nO.yo.Backdrop,{themeColorDimming:"auto"}),(0,c.jsxs)(nO.yo.Content,{className:"relative flex h-auto min-h-[20vh] flex-col overflow-hidden rounded-t-2xl",children:[(0,c.jsxs)("div",{className:"relative flex-1 overflow-hidden rounded-t-2xl",children:[(0,c.jsxs)(eZ.E.div,{className:"rounded-t-2xl bg-background p-4",initial:{x:"0%"},animate:{x:"initial"===h?"0%":"-20%"},transition:{duration:.4,type:"spring",bounce:.1},children:[d&&l&&(0,c.jsx)(eb.H,{workspace:l,isOwnerOfWorkspace:i}),(0,c.jsxs)("div",{className:"flex flex-col gap-1 py-4",children:[d&&(0,c.jsxs)(nH,{onClick:()=>{n(!1),v("project")},children:[(0,c.jsx)(er.Z,{name:"settings"}),(0,c.jsx)("p",{children:"Project settings"})]}),d&&o&&(0,c.jsxs)(nH,{onClick:()=>{n(!1),m(!0)},children:[(0,c.jsx)(er.Z,{name:"edit"}),(0,c.jsx)("span",{children:"Rename project"})]}),(0,c.jsxs)(nH,{onClick:()=>f("appearance"),children:[(0,c.jsx)(er.Z,{name:"contrast"}),(0,c.jsx)("span",{children:"Appearance"}),(0,c.jsxs)("div",{className:"ml-auto flex items-center gap-1 text-muted-foreground",children:[(0,c.jsx)("span",{className:"capitalize",children:a}),(0,c.jsx)(er.Z,{name:"chevron_right"})]})]})]})]}),(0,c.jsxs)(eZ.E.div,{className:"absolute inset-0 flex flex-col gap-4 rounded-t-2xl bg-muted p-4",initial:{x:"100%"},animate:{x:"appearance"===h?"0%":"100%"},transition:{duration:.4,type:"spring",bounce:.1},children:[(0,c.jsxs)("div",{className:"relative flex w-full justify-center",children:[(0,c.jsxs)("button",{className:"absolute left-0 top-0 flex items-center gap-1 duration-150 ease-in-out active:text-muted-foreground",onClick:()=>f("initial"),children:[(0,c.jsx)(er.Z,{name:"chevron_left"}),(0,c.jsx)("span",{children:"Back"})]}),(0,c.jsx)("p",{className:"text-center font-medium",children:"Appearance"})]}),(0,c.jsx)(n3,{onSelect:()=>f("initial")})]})]}),(0,c.jsx)(nO.yo.BleedingBackground,{className:"rounded-t-2xl border-t bg-background"})]})]})})]}),o&&(0,c.jsx)(eN.i,{project:o,isOpen:u,onClose:()=>m(!1)})]})},n9=e=>{let{canEdit:t=!0,isLoadingPermissions:s=!1}=e,a=(0,U.iZ)(e=>e.project),r=!!(null==a?void 0:a.is_supabase_enabled)||!!(null==a?void 0:a.supabase_project_config);return(0,c.jsxs)("div",{className:"relative z-10 flex h-12 w-full shrink-0 items-center justify-between gap-4 bg-background pr-4",children:[(0,c.jsx)(V.z,{variant:"ghost",asChild:!0,className:"h-full hover:bg-transparent focus-visible:bg-transparent active:bg-transparent",children:(0,c.jsx)(eC.default,{href:"/",children:(0,c.jsx)(er.Z,{name:"chevron_left"})})}),(0,c.jsx)(n8,{children:(0,c.jsxs)("h1",{className:"absolute left-1/2 top-1/2 flex min-w-0 max-w-[50vw] -translate-x-1/2 -translate-y-1/2 items-center gap-1 truncate text-lg font-medium",children:[(null==a?void 0:a.name)?(0,c.jsx)("span",{className:"truncate",children:a.name}):(0,c.jsx)(eD.O,{className:"h-4 w-36"}),(0,c.jsx)(er.Z,{name:"chevron_right",className:"rotate-90"})]})}),(0,c.jsx)(n7,{canEdit:t,isLoadingPermissions:s,isSupabaseEnabled:r})]})},n7=e=>{let{canEdit:t,isLoadingPermissions:s,isSupabaseEnabled:a}=e,{setIsRemixDialogOpen:r}=(0,U.d2)(),{isAuthenticated:n}=(0,p.Eu)(),l=(0,m.useRouter)(),i=(0,x.useCallback)(()=>{if(!n){l.push("/login?redirect=".concat(window.location.pathname));return}r(!0)},[n,l,r]);return s?(0,c.jsx)("div",{className:"h-4 w-10"}):t?(0,c.jsx)(sy,{hasUnsavedChanges:!1}):(0,c.jsx)(V.z,{className:"flex items-center gap-1",onClick:i,disabled:!(t||!a),size:"sm",children:"Remix"})},le=e=>{let{children:t,projectId:s}=e,{view:a}=(0,rc.gu)(e=>e),r=(0,U.iZ)(e=>e.project),n=(0,rc.gu)(e=>e.isPreviewDocked),{setIsPreviewDocked:l}=(0,rc.zp)();(0,x.useEffect)(()=>{window.addEventListener("message",e=>{"SCROLLABLE"===e.data.type&&l(!1)})},[l]);let[i,o]=(0,x.useState)(!1),{canEdit:d,isLoading:u}=(0,_.t)();return((0,x.useEffect)(()=>{a===rc.$.PREVIEW&&o(!0)},[a]),d)?(0,c.jsxs)("div",{className:"flex h-dvh min-h-0 max-w-[100vw] flex-1 flex-col overflow-hidden md:hidden",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[(0,c.jsxs)("div",{className:(0,el.cn)("relative min-h-0 flex-1"),children:[(0,c.jsxs)(eZ.E.div,{animate:{x:a===rc.$.CHAT?0:"-100vw"},transition:{duration:.5,type:"spring",bounce:.15},className:(0,el.cn)("absolute inset-0 flex min-h-0 max-w-[100vw] flex-1 flex-col will-change-transform",a!==rc.$.CHAT&&"pointer-events-none"),"aria-hidden":a!==rc.$.CHAT,tabIndex:a!==rc.$.CHAT?-1:0,inert:a!==rc.$.CHAT,children:[(0,c.jsx)(n9,{}),t]},rc.$.CHAT),(i||a===rc.$.PREVIEW)&&(0,c.jsx)(eZ.E.div,{initial:{x:"100vw"},animate:{x:a===rc.$.PREVIEW?0:"100vw"},transition:{duration:.5,type:"spring",bounce:.15},className:(0,el.cn)("absolute inset-0 flex max-w-[100vw] flex-1 flex-col overflow-y-auto overflow-x-hidden will-change-transform",a!==rc.$.PREVIEW&&"pointer-events-none",n?"h-auto":"h-dvh"),"aria-hidden":a!==rc.$.PREVIEW,tabIndex:a!==rc.$.PREVIEW?-1:0,inert:a!==rc.$.PREVIEW,children:(0,c.jsx)(nt,{projectId:s})},rc.$.PREVIEW)]}),(0,c.jsx)(nb.t,{children:(0,c.jsx)(n5,{})}),r&&(0,c.jsx)(nd,{project:r}),(0,c.jsx)(ng,{})]}):(0,c.jsx)(lt,{projectId:s,isLoadingPermissions:u})},lt=e=>{let{projectId:t,isLoadingPermissions:s}=e,a=(0,U.iZ)(e=>e.project);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"relative flex h-dvh min-h-0 max-w-[100vw] flex-1 flex-col overflow-hidden md:hidden",children:[(0,c.jsx)(n9,{canEdit:!1,isLoadingPermissions:s}),(0,c.jsx)("div",{className:(0,el.cn)("absolute inset-0 flex h-dvh flex-1 flex-col"),children:(0,c.jsx)(nt,{projectId:t})})]}),a&&(0,c.jsx)(nd,{project:a}),(0,c.jsx)(ng,{})]})};function ls(){let e=(0,F.D)(),{refreshPreview:t}=(0,eg.My)(),{errors:s}=(0,rY.hT)({projectId:e}),a=(0,R.bk)(e=>e.isSendChatMessageMutationPending),r=(0,x.useRef)(!1);(0,x.useEffect)(()=>{a?s&&s.length>0&&(r.current=!0):(r.current&&t(),r.current=!1)},[s,t,a])}var la=s(84350),lr=s(78844);function ln(e){let{open:t,onOpenChange:s}=e,a=(0,F.v)(),{handleConnect:r}=(0,lr.hb)(a||"");return(0,c.jsx)(W.Vq,{open:t,onOpenChange:s,children:(0,c.jsxs)(W.cZ,{size:"md",children:[(0,c.jsxs)(W.fK,{children:[(0,c.jsx)(W.$N,{children:"We got an update for you!"}),(0,c.jsx)(W.Be,{children:"To make Supabase integration more robust, Lovable can now read your project logs. Please re-authenticate with Supabase to continue."})]}),(0,c.jsx)("div",{className:"mt-4 flex flex-col gap-4",children:(0,c.jsx)(V.z,{onClick:()=>{s(!1),r()},className:"w-full",children:"Re-authenticate with Supabase"})})]})})}var ll=s(72253),li=s(79804);let lo=e=>{var t;let{children:s}=e,a=(0,U.iZ)(e=>e.projectId);ls();let r=(0,d.NL)(),n=(0,sY.C)(),{canEdit:l,isProjectAdmin:i}=(0,_.t)(),u=(0,sF.m)({projectId:a,onRepoInaccessible:()=>{r.setQueryData(li.V.repoAccessibility({projectId:a,userProjectPermissions:{admin:i,edit:l}}).queryKey,()=>({accessibility:o.accessibility.REPO_NOT_ACCESSIBLE}))}}),{userData:m}=(0,O.SE)(),[h,p]=(0,x.useState)(!1),f=(0,U.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.supabase_project_config}),v=(0,U.iZ)(e=>e.project),g=(0,ll.S)({workspaceId:null!==(t=null==v?void 0:v.workspace_id)&&void 0!==t?t:""}),j=(0,x.useCallback)(async e=>{var t,s,r,n;let{body:l,options:i}=e;null==i||null===(t=i.clear)||void 0===t||t.call(i),N.LJ.capture(k.SL.CHAT.MESSAGE_SENT,{project_id:a,selected_element:(null===(s=l.selected_elements)||void 0===s?void 0:s.length)||null});let o=null==f?void 0:f.supabase_organization_id,c=(null==v?void 0:v.workspace_id)?null==g?void 0:null===(r=g.supabaseOrganizations)||void 0===r?void 0:r.find(e=>e.id===(null==v?void 0:v.workspace_id)):null==m?void 0:null===(n=m.supabase)||void 0===n?void 0:n.find(e=>e.supabase_org_id===o);if(f&&c&&!c.has_analytics_scope){p(!0);return}await u.mutateAsync({body:l,restore:null==i?void 0:i.restore,clear:null==i?void 0:i.clear})},[null==v?void 0:v.workspace_id,a,u,f,null==g?void 0:g.supabaseOrganizations,null==m?void 0:m.supabase]);return(0,c.jsxs)(la.x,{onSendChatMessage:j,hasActiveLock:n,children:[(0,c.jsx)(ln,{open:h,onOpenChange:p}),s]})},lc="joinedViaInviteLink";function ld(e){var t;let{children:s}=e,{project_id:a}=(0,m.useParams)(),r=(0,m.useSearchParams)(),n=null!==(t=null==r?void 0:r.get("messageId"))&&void 0!==t?t:void 0;return(0,c.jsx)(b.qG,{localStorageKey:a,children:(0,c.jsx)(U.jI,{projectId:a,children:(0,c.jsx)(y.m,{children:(0,c.jsx)(eT.c8,{children:(0,c.jsx)(H.h,{projectId:a,children:(0,c.jsx)(ei.f6,{children:(0,c.jsx)(rc.eP,{children:(0,c.jsx)(a0.cb,{children:(0,c.jsx)(tT.NE,{children:(0,c.jsx)(ta.TO,{projectId:a,children:(0,c.jsx)(R.vw,{children:(0,c.jsx)(I.BV,{children:(0,c.jsx)(z.aM,{projectId:a,messageId:n,children:(0,c.jsx)(eg.wF,{children:(0,c.jsx)(lu,{children:s})})})})})})})})})})})})})})})}function lu(e){let{children:t}=e,s=(0,U.iZ)(e=>e.projectId),a=(0,m.useSearchParams)(),r=(0,m.useRouter)(),n=(0,m.usePathname)(),l=(0,U.iZ)(e=>e.project),i=(0,x.useRef)(new Set),o=(0,d.NL)(),{authUser:v}=(0,p.Eu)(),b=()=>{let e=new URLSearchParams(a.toString());e.delete(lc);let t=e.toString(),s=t?"".concat(n,"?").concat(t):n;r.replace(s)},{mutate:y}=(0,u.D)({mutationFn:async e=>(0,j.SJ)().put("/projects/".concat(e,"/collaborators/accept-invite")),onSuccess:()=>{i.current.has(s)||h.Am.success("You've been added to \"".concat(null==l?void 0:l.name,'"'),{description:"You now have access to this project"}),i.current.add(s),b()},onError:e=>{(0,g.Eo)(e)},onSettled:()=>{o.invalidateQueries({queryKey:w.iZ.collaborators(s)})}});return(0,x.useEffect)(()=>{let e=a.get(lc);if(!v&&e){r.replace("/login");return}e&&l&&!i.current.has(s)&&y(s)},[a,s,n,r,l,y,v]),!function(e){let{projectId:t}=e,{canEdit:s}=(0,_.t)(),{setIsSendChatMessageMutationPending:a}=(0,R.Xr)(),{setShouldShowTipsAndTricksOnDevServerStart:r}=(0,I.pE)(),{updateConsoleStateOnStreaming:n}=(0,S.k)({autoSwitchToCode:!1}),{createChatRequestPerformanceMeasurer:l}=(0,Z.t)(),{updateMessage:i,setLatestStreamedMessage:o,snapshot:{getUserMessageCount:c,getLastUserMessage:d}}=(0,z.mx)(),{playAudioOnGenerationComplete:u}=A(),{handleChatStreamingError:m}=(0,D.Z)(),h=(0,x.useRef)(null),p=(0,x.useRef)(!1),f=(0,x.useRef)(""),v=(0,x.useCallback)(e=>{if("message"!==e.type){C.logging.error("received_unknown_chat_sse",{event_type:e.type,event_data:e.data});return}let s=e.data;h.current!=s.message_id&&(f.current="",p.current=!1),h.current=s.message_id;let m=!p.current&&!s.is_final,x=p.current&&s.is_final;if(p.current=!s.is_final,m&&(a(!0),f.current=""),x){var v,g;a(!1),o(void 0),r(!1),f.current="";let{measureTimeToLastToken:e}=l({projectId:t});e();let s=1>=c(),n=null!==(g=null===(v=d())||void 0===v?void 0:v.chatOnly)&&void 0!==g&&g;s&&N.ZP.capture(k.SL.CREATION.DONE_AND_RETAINED_VIEW,{project_id:t}),u({isCreation:s,isChatOnly:n});return}f.current+=s.content;let j={id:s.message_id,content:f.current,created_at:s.created_at,role:E.r.role.AI,tag:E.r.tag.INSTANT_MODE_MESSAGE,status:"running",stopped:!1,thinking_time_ms:s.thinking_time_ms,graph_id:s.graph_id,exclude_from_history:!1},b={...j,stopped:!!j.stopped,status:"running"};o(b);let y=(0,P.AR)(b);y&&("aiMessage"===y.type||"userMessage"===y.type)&&i(j.id,y,!0),n(j)},[o,n,a,r,l,t,c,d,u,i]);(0,x.useEffect)(()=>{let e=new AbortController,a=async()=>{let s=(0,j.SJ)();try{await s.getWithStreaming({url:"/projects/".concat(t,"/latest-message"),onMessage:v,signal:e.signal,reconnectOptions:{onReconnect:()=>{p.current=!1}}})}catch(e){var a,r;m(e,{lastUserMessageId:null!==(r=null===(a=d())||void 0===a?void 0:a.id)&&void 0!==r?r:""})}};return s&&a(),()=>{e.abort()}},[s,t])}({projectId:s}),et(),(0,c.jsx)(f.$,{projectId:s,children:(0,c.jsx)(t8,{projectId:s,children:(0,c.jsx)(lm,{children:t})})})}let lm=e=>{let{children:t}=e,s=(0,U.iZ)(e=>e.projectId);ls();let a=(0,v.Z)("md");return(0,c.jsx)(lo,{children:(0,c.jsx)(tl.P,{children:a?(0,c.jsx)(le,{projectId:s,children:t}):(0,c.jsx)(nj,{projectId:s,children:t})})})}},56613:function(e,t,s){"use strict";s.d(t,{I_:function(){return u},PanelStoreProvider:function(){return c},SE:function(){return d},k6:function(){return m}});var a=s(57437),r=s(2265),n=s(59625),l=s(33699),i=s(37545);let o=(0,r.createContext)(null);function c(e){let{initialPanelSizes:t,children:s}=e,n=(0,r.useRef)();return n.current||(n.current=(0,l.b)(t)),(0,a.jsx)(o.Provider,{value:n.current,children:s})}function d(e){let t=(0,r.useContext)(o);if(!t)throw Error("usePanelStore must be used within a PanelStoreProvider");return(0,n.oR)(t,e)}let u=()=>{let{width:e}=(0,i.Z)();return e?325/e*100:20},m=()=>{let{width:e}=(0,i.Z)();return e?600/e*100:60}},33699:function(e,t,s){"use strict";s.d(t,{DEFAULT_SIDEBAR_SIZE:function(){return n},b:function(){return r}});var a=s(59625);let r=e=>(0,a.Ue)(t=>({panelSizes:e||[n,100-n],updatePanelSizes:e=>t({panelSizes:e})})),n=30},95670:function(e,t,s){"use strict";var a=s(57437),r=s(33145),n=s(27648),l=s(55721),i=s(57346),o=s(94508);t.Z=e=>{let{title:t,iconName:s,imageSrc:c,onClick:d,internalHref:u,externalHref:m,className:x,iconClassName:h}=e,p=(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)(i.Z,{name:s,className:"shrink-0 text-foreground ".concat(h)}),c&&(0,a.jsx)(r.default,{alt:"icon",src:c,width:"14",height:"14"}),(0,a.jsx)("span",{className:"truncate text-primary",children:t})]});return(0,a.jsx)(l.Xi,{className:(0,o.cn)("",x),asChild:!0,children:u?(0,a.jsx)(n.default,{href:u,children:p}):m?(0,a.jsxs)("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:[p,(0,a.jsx)(i.Z,{name:"arrow_outward",className:"ml-auto h-4 w-4 text-foreground"})]}):(0,a.jsx)("div",{onClick:()=>{d&&d()},children:p})})}},93061:function(e,t,s){"use strict";s.d(t,{WorkspacePaymentFailedDialog:function(){return m}});var a=s(57437),r=s(99376),n=s(2265),l=(s(14438),s(61922)),i=s(108),o=s(7309),c=s(62869),d=s(65269);let u=[...o.qI.planOptions],m=()=>{let[e,t]=(0,n.useState)(!1),[s,i]=(0,n.useState)(),o=(0,r.useSearchParams)(),c=(0,r.useRouter)(),u=(0,r.usePathname)(),m=(0,n.useCallback)(()=>{let e=new URLSearchParams(o.toString());e.delete("payment_status"),e.delete("plan_id");let t=u+"?"+e.toString();c.replace(t,{scroll:!1})},[c,o,u]),h=(0,l.aS)(e=>e.currentWorkspace);return(0,n.useEffect)(()=>{i(o.get("plan_id")),"failed"===o.get("payment_status")&&t(!0)},[o]),(0,a.jsx)(d.v,{title:"Payment Failed",description:"Payment couldn’t complete or has lapsed on this workspace.",open:e,onOpenChange:e=>{t(e),!e&&(o.has("payment_status")||o.has("plan_id"))&&m()},children:(0,a.jsx)(x,{closeDialog:()=>{t(!1),m()},currentWorkspace:h,planId:s})})},x=e=>{let{closeDialog:t,currentWorkspace:s,planId:r}=e,{createPortalSession:n,isCreatePortalSessionLoading:l,checkoutLoading:o,toCheckout:d}=(0,i.m)(),m=u.find(e=>e.id===r),x=async()=>{s&&m&&await d({plan:m,workspaceId:s.id})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6",children:[(0,a.jsx)(c.z,{className:"flex-1",variant:"secondary",onClick:t,children:"Go Back"}),(0,a.jsx)(c.z,{onClick:x,className:"flex-1",disabled:!m||!!o||l,loading:o===r,children:"Retry payment"})]})})}},15345:function(e){e.exports={editor:"CodeEditor_editor__SnrZP"}}},function(e){e.O(0,[5095,6175,4358,7481,1413,5878,8310,5002,7150,6401,7528,6693,2972,4240,6348,4438,6732,1115,9291,441,2078,3347,6008,8350,4988,9636,2536,237,6873,9339,4827,8692,5598,5365,236,7359,2698,5543,8995,6579,2287,2660,3852,1922,8885,287,3210,390,1028,2410,3384,3506,991,2971,4649,1744],function(){return e(e.s=49383)}),_N_E=e.O()}]);