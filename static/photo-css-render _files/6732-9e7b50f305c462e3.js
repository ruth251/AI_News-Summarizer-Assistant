try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c52f721d-fbb8-4a61-9e2b-bbfd5a6ad0a1",e._sentryDebugIdIdentifier="sentry-dbid-c52f721d-fbb8-4a61-9e2b-bbfd5a6ad0a1")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6732],{45819:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AuthRequestHandler=t.AbstractAuthRequestHandler=t.FIREBASE_AUTH_LIST_USERS_INFO=t.FIREBASE_AUTH_SIGN_UP_NEW_USER=t.FIREBASE_AUTH_SET_ACCOUNT_INFO=t.FIREBASE_AUTH_DELETE_ACCOUNT=t.FIREBASE_AUTH_GET_ACCOUNT_INFO=t.FIREBASE_AUTH_CREATE_SESSION_COOKIE=t.ApiSettings=void 0,t.getSdkVersion=d,t.convertMultiFactorInfoToServerFormat=p;let n=r(93347),o=r(3337),i=r(332),a=r(17303),s=r(85934);class c{endpoint;httpMethod;constructor(e,t="POST"){this.endpoint=e,this.httpMethod=t}getEndpoint(){return this.endpoint}getHttpMethod(){return this.httpMethod}}function d(){return"11.2.0"}t.ApiSettings=c;let l={"X-Client-Version":`Node/Admin/${d()}`,Accept:"application/json","Content-Type":"application/json"};class u{version;credential;urlFormat;constructor(e="v1",t){this.version=e,this.credential=t,(0,i.useEmulator)()?this.urlFormat=(0,a.formatString)("http://{host}/identitytoolkit.googleapis.com/{version}/projects/{projectId}{api}",{host:(0,i.emulatorHost)()}):this.urlFormat="https://identitytoolkit.googleapis.com/{version}/projects/{projectId}{api}"}async getUrl(e,t){let r={version:this.version,projectId:await this.credential.getProjectId(),api:e||""},n=(0,a.formatString)(this.urlFormat,r);return(0,a.formatString)(n,t||{})}}t.FIREBASE_AUTH_CREATE_SESSION_COOKIE=new c(":createSessionCookie","POST"),t.FIREBASE_AUTH_GET_ACCOUNT_INFO=new c("/accounts:lookup","POST"),t.FIREBASE_AUTH_DELETE_ACCOUNT=new c("/accounts:delete","POST"),t.FIREBASE_AUTH_SET_ACCOUNT_INFO=new c("/accounts:update","POST"),t.FIREBASE_AUTH_SIGN_UP_NEW_USER=new c("/accounts","POST"),t.FIREBASE_AUTH_LIST_USERS_INFO=new c("/accounts:batchGet","GET");class h{options;authUrlBuilder;getToken;static getErrorCode(e){return(0,s.isNonNullObject)(e)&&e.error&&e.error.message||null}constructor(e,t={}){this.options=t,this.getToken=(0,i.useEmulator)()?()=>Promise.resolve({accessToken:"owner",expirationTime:1/0}):(0,n.getFirebaseAdminTokenProvider)(e).getToken}prepareRequest(e){return this.options.tenantId?{...e,tenantId:this.options.tenantId}:e}getAccountInfoByUid(e){return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_GET_ACCOUNT_INFO,{localId:[e]})}deleteAccount(e){return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_DELETE_ACCOUNT,{localId:e})}getAccountInfoByEmail(e){return(0,s.isEmail)(e)?this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_GET_ACCOUNT_INFO,{email:[e]}):Promise.reject(new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,"Invalid e-mail address"))}createNewAccount(e){let r={...e};if(void 0!==r.photoURL&&(r.photoUrl=r.photoURL,delete r.photoURL),void 0!==r.uid&&(r.localId=r.uid,delete r.uid),r.multiFactor){if(Array.isArray(r.multiFactor.enrolledFactors)&&r.multiFactor.enrolledFactors.length>0){let e=[];try{r.multiFactor.enrolledFactors.forEach(t=>{if("enrollmentTime"in t)throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,'"enrollmentTime" is not supported when adding second factors via "createUser()"');if("uid"in t)throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,'"uid" is not supported when adding second factors via "createUser()"');e.push(p(t))})}catch(e){return Promise.reject(e)}r.mfaInfo=e}delete r.multiFactor}return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_SIGN_UP_NEW_USER,r).then(e=>e.localId)}createSessionCookie(e,r){return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_CREATE_SESSION_COOKIE,{idToken:e,validDuration:r/1e3}).then(e=>e.sessionCookie)}updateExistingAccount(e,r){let n={...r,deleteAttribute:[],localId:e},o={displayName:"DISPLAY_NAME",photoURL:"PHOTO_URL"};for(let e in n.deleteAttribute=[],o)null===n[e]&&(n.deleteAttribute.push(o[e]),delete n[e]);if(0===n.deleteAttribute.length&&delete n.deleteAttribute,null===n.phoneNumber&&(n.deleteProvider?n.deleteProvider.push("phone"):n.deleteProvider=["phone"],delete n.phoneNumber),void 0!==n.providerToLink&&(n.linkProviderUserInfo={...n.providerToLink},delete n.providerToLink,n.linkProviderUserInfo.rawId=n.linkProviderUserInfo.uid,delete n.linkProviderUserInfo.uid),void 0!==n.providersToUnlink&&(Array.isArray(n.deleteProvider)||(n.deleteProvider=[]),n.deleteProvider=n.deleteProvider.concat(n.providersToUnlink),delete n.providersToUnlink),void 0!==n.photoURL&&(n.photoUrl=n.photoURL,delete n.photoURL),void 0!==n.disabled&&(n.disableUser=n.disabled,delete n.disabled),n.multiFactor){if(null===n.multiFactor.enrolledFactors)n.mfa={};else if(Array.isArray(n.multiFactor.enrolledFactors)){n.mfa={enrollments:[]};try{n.multiFactor.enrolledFactors.forEach(e=>{n.mfa.enrollments.push(p(e))})}catch(e){return Promise.reject(e)}0===n.mfa.enrollments.length&&delete n.mfa.enrollments}delete n.multiFactor}return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_SET_ACCOUNT_INFO,n).then(e=>e.localId)}setCustomUserClaims(e,r){null===r&&(r={});let n={localId:e,customAttributes:JSON.stringify(r)};return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_SET_ACCOUNT_INFO,n).then(e=>e.localId)}listUsers(e,r){return this.invokeRequestHandler(this.getAuthUrlBuilder(),t.FIREBASE_AUTH_LIST_USERS_INFO,{nextPageToken:e,maxResults:r})}getSearchParams(e){let t=new URLSearchParams;for(let r in e)e[r]&&t.append(r,e[r]);return t}decorateUrlWithParams(e,t){let r=this.getSearchParams(t).toString();return r?`${e}?${r}`:e}async invokeRequestHandler(e,t,r,n){let i=await e.getUrl(t.getEndpoint(),n),a=await this.getToken(),s={method:t.getHttpMethod(),headers:{...l,Authorization:`Bearer ${a.accessToken}`}};r&&!["GET","HEAD"].includes(t.getHttpMethod())&&(s.body=JSON.stringify(this.prepareRequest(r))),r&&["GET","HEAD"].includes(t.getHttpMethod())&&(i=this.decorateUrlWithParams(i,this.prepareRequest(r)));let c=await fetch(i,s);if(!c.ok){let e=await c.json(),t=h.getErrorCode(e);if(!t)throw new o.AuthError(o.AuthErrorCode.INTERNAL_ERROR,`Error returned from server: ${JSON.stringify(e)}.`);throw new o.AuthError(o.AuthErrorCode.INTERNAL_ERROR,`Error returned from server: ${JSON.stringify(e)}. Code: ${t}`)}return await c.json()}getAuthUrlBuilder(){return this.authUrlBuilder||(this.authUrlBuilder=this.newAuthUrlBuilder()),this.authUrlBuilder}}t.AbstractAuthRequestHandler=h;class f extends h{credential;authResourceUrlBuilder;constructor(e,t){super(e,t),this.credential=e,this.authResourceUrlBuilder=new u("v2",e)}newAuthUrlBuilder(){return new u("v1",this.credential)}}function p(e){let t;if(void 0!==e.enrollmentTime){if(function(e){try{return!!e&&new Date(e).toUTCString()===e}catch{return!1}}(e.enrollmentTime))t=new Date(e.enrollmentTime).toISOString();else throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,`The second factor "enrollmentTime" for "${e.uid}" must be a valid UTC date string.`)}if("phone"===e.factorId){let r={mfaEnrollmentId:e.uid,displayName:e.displayName,phoneInfo:e.phoneNumber,enrolledAt:t};for(let e in r)void 0===r[e]&&delete r[e];return r}throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,`Unsupported second factor "${JSON.stringify(e)}" provided.`)}t.AuthRequestHandler=f},65296:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.filterStandardClaims=t.STANDARD_CLAIMS=void 0,t.STANDARD_CLAIMS=["aud","auth_time","email","email_verified","exp","firebase","source_sign_in_provider","iat","iss","name","phone_number","picture","sub","uid","user_id"],t.filterStandardClaims=(e={})=>{let r={};return Object.keys(e).forEach(n=>{t.STANDARD_CLAIMS.includes(n)||(r[n]=e[n])}),r}},93347:function(e,t,r){var n=r(25566);Object.defineProperty(t,"__esModule",{value:!0}),t.getFirebaseAdminTokenProvider=t.ComputeEngineCredential=t.ServiceAccountCredential=void 0,t.getExplicitProjectId=function(){return n.env.GOOGLE_CLOUD_PROJECT||n.env.GCLOUD_PROJECT||null};let o=r(57550),i=r(17303),a=new Map;class s{projectId;privateKey;clientEmail;constructor(e){this.projectId=e.projectId,this.privateKey=e.privateKey,this.clientEmail=e.clientEmail}async fetchAccessToken(e){let t=await this.createJwt();return c(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${t}`,Accept:"application/json"},body:"grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion="+t})}getProjectId(){return Promise.resolve(this.projectId)}getServiceAccountEmail(){return Promise.resolve(this.clientEmail)}async fetchAndCacheAccessToken(e){let t=await this.fetchAccessToken(e);return a.set(e.toString(),t),t}async getAccessToken(e){let t="https://accounts.google.com/o/oauth2/token";if(e)return this.fetchAndCacheAccessToken(t);let r=a.get(t);return!r||r.expirationTime-Date.now()<=3e5?this.fetchAndCacheAccessToken(t):r}async createJwt(){let e=Math.floor(Date.now()/1e3),t={aud:"https://accounts.google.com/o/oauth2/token",iat:e,exp:e+3600,iss:this.clientEmail,sub:this.clientEmail,scope:"https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/firebase.database https://www.googleapis.com/auth/firebase.messaging https://www.googleapis.com/auth/identitytoolkit https://www.googleapis.com/auth/userinfo.email"};return(0,o.sign)({payload:t,privateKey:this.privateKey})}}async function c(e,t){let r=await (0,i.fetchJson)(e,t);if(!r.access_token||!r.expires_in)throw Error(`Unexpected response while fetching access token: ${JSON.stringify(r)}`);return{accessToken:r.access_token,expirationTime:Date.now()+1e3*r.expires_in}}t.ServiceAccountCredential=s;let d="metadata.google.internal";async function l(e,t){let r=await (0,i.fetchText)(e,t);if(!r)throw Error("Unexpected response while fetching id token: response.text is undefined");return r}class u{projectId;accountId;cachedToken;constructor(){}async getAccessToken(e=!1){let t=`http://${d}/computeMetadata/v1/instance/service-accounts/default/token`,r=this.buildRequest();return this.cachedToken&&!e&&this.cachedToken.expirationTime-Date.now()<=3e5?this.cachedToken:this.cachedToken=await c(t,r)}getIDToken(e){return l(`http://${d}/computeMetadata/v1/instance/service-accounts/default/identity?audience=${e}`,this.buildRequest())}async getProjectId(){if(this.projectId)return Promise.resolve(this.projectId);let e=`http://${d}/computeMetadata/v1/project/project-id`,t=this.buildRequest();try{let r=await (0,i.fetchText)(e,t);return this.projectId=r,this.projectId}catch(e){throw Error(`Failed to determine project ID: ${e}`)}}async getServiceAccountEmail(){if(this.accountId)return Promise.resolve(this.accountId);let e=`http://${d}/computeMetadata/v1/instance/service-accounts/default/email`,t=this.buildRequest();try{let r=await (0,i.fetchText)(e,t);return this.accountId=r,this.accountId}catch(e){throw Error(`Failed to determine service account email: ${e}`)}}buildRequest(){return{method:"GET",headers:{"Metadata-Flavor":"Google"}}}}t.ComputeEngineCredential=u,t.getFirebaseAdminTokenProvider=e=>({getToken:async function(t=!1){return e.getAccessToken(t)}})},2255:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationDefault=void 0;let n=r(93347);t.getApplicationDefault=()=>new n.ComputeEngineCredential},332:function(e,t,r){var n=r(25566);function o(){if(void 0!==n)return n.env.FIREBASE_AUTH_EMULATOR_HOST}Object.defineProperty(t,"__esModule",{value:!0}),t.CLIENT_CERT_URL=t.FIREBASE_AUDIENCE=void 0,t.emulatorHost=o,t.useEmulator=function(){return!!o()},t.FIREBASE_AUDIENCE="https://identitytoolkit.googleapis.com/google.identity.identitytoolkit.v1.IdentityToolkit",t.CLIENT_CERT_URL="https://www.googleapis.com/robot/v1/metadata/x509/securetoken@system.gserviceaccount.com"},71856:function(e,t,r){var n=r(25566),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.customTokenToIdAndRefreshTokens=T,t.createAnonymousAccount=I,t.isUserNotFoundError=function(e){return e?.code===l.AuthErrorCode.USER_NOT_FOUND},t.isInvalidCredentialError=function(e){return e?.code===l.AuthErrorCode.INVALID_CREDENTIAL},t.handleExpiredToken=R,t.getFirebaseAuth=function(e,t,r){return e.privateKey&&e.projectId&&e.clientEmail?S({credential:new c.ServiceAccountCredential(e),apiKey:t,tenantId:r}):S({credential:e.serviceAccount?new c.ServiceAccountCredential(e.serviceAccount):(0,d.getApplicationDefault)(),apiKey:e.apiKey,tenantId:e.tenantId,serviceAccountId:e.serviceAccountId,enableCustomToken:e.enableCustomToken})};let a=r(97917),s=r(45819),c=r(93347),d=r(2255),l=r(3337),u=r(332),h=r(68943),f=r(76184),p=r(24716),m=r(65296);i(r(66586),t),i(r(3337),t);let A=e=>{if((0,u.useEmulator)()&&n.env.FIREBASE_AUTH_EMULATOR_HOST){let t="http://";return n.env.FIREBASE_AUTH_EMULATOR_HOST.startsWith("http://")&&(t=""),`${t}${n.env.FIREBASE_AUTH_EMULATOR_HOST}/identitytoolkit.googleapis.com/v1/accounts:signInWithCustomToken?key=${e}`}return`https://identitytoolkit.googleapis.com/v1/accounts:signInWithCustomToken?key=${e}`},E=e=>`https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=${e}`,y=e=>{if((0,u.useEmulator)()&&n.env.FIREBASE_AUTH_EMULATOR_HOST){let t="http://";return n.env.FIREBASE_AUTH_EMULATOR_HOST.startsWith("http://")&&(t=""),`${t}${n.env.FIREBASE_AUTH_EMULATOR_HOST}/securetoken.googleapis.com/v1/token?key=${e}`}return`https://securetoken.googleapis.com/v1/token?key=${e}`};async function T(e,t,r){let n={"Content-Type":"application/json",...r.referer?{Referer:r.referer}:{}},o={token:e,returnSecureToken:!0};r.appCheckToken&&(n["X-Firebase-AppCheck"]=r.appCheckToken),r.tenantId&&(o.tenantId=r.tenantId);let i=await fetch(A(t),{method:"POST",headers:n,body:JSON.stringify(o)}),a=await i.json();if(!i.ok)throw Error(`Problem getting a refresh token: ${JSON.stringify(a)}`);return{idToken:a.idToken,refreshToken:a.refreshToken}}async function I(e,t={}){let r={"Content-Type":"application/json",...t.referer?{Referer:t.referer}:{}},n={returnSecureToken:!0};t.appCheckToken&&(r["X-Firebase-AppCheck"]=t.appCheckToken),t.tenantId&&(n.tenantId=t.tenantId);let o=await fetch(E(e),{method:"POST",headers:r,body:JSON.stringify(n)});return await o.json()}let g=e=>e?.error?.code===400&&e?.error?.message==="USER_NOT_FOUND",w=async(e,t)=>{let r=await fetch(y(t.apiKey),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",...t.referer?{Referer:t.referer}:{}},body:`grant_type=refresh_token&refresh_token=${e}`});if(!r.ok){let e=await r.json(),t=`Error fetching access token: ${JSON.stringify(e.error)} ${e.error_description?`(${e.error_description})`:""}`;if(g(e))throw new l.AuthError(l.AuthErrorCode.USER_NOT_FOUND);throw new l.AuthError(l.AuthErrorCode.INVALID_CREDENTIAL,t)}let n=await r.json();return{idToken:n.id_token,refreshToken:n.refresh_token}};async function _(e,t,r){try{return await t(e)}catch(e){return r(e)}}async function R(e,t,r,n){try{return await e()}catch(e){switch(e?.code){case l.AuthErrorCode.NO_MATCHING_KID:if(n)return _(e,async e=>{let r=await t(e);return(0,a.debug)("experimental_refresh_on_expired_kid: Successfully refreshed token after kid has expired"),r},e=>((0,a.debug)("experimental_refresh_on_expired_kid: Error when trying to refresh token after kid has expired",{message:e?.message,stack:e?.stack}),r(e)));return r(e);case l.AuthErrorCode.TOKEN_EXPIRED:return _(e,t,r);default:return r(e)}}}let v={referer:""};function S(e){let t=e.credential??(0,d.getApplicationDefault)(),r=e.tenantId,n=new s.AuthRequestHandler(t,{tenantId:r}),o=(0,h.createFirebaseTokenGenerator)(t,r),i=async(t,r={})=>{let{idToken:n,refreshToken:o}=await w(t,{apiKey:e.apiKey,referer:r.referer}),i=await E(n,{referer:r.referer});if(!r.enableCustomToken)return{decodedIdToken:i,idToken:n,refreshToken:o};let a=await y(i.uid,{email_verified:i.email_verified,source_sign_in_provider:i.firebase.sign_in_provider});return{decodedIdToken:i,idToken:n,refreshToken:o,customToken:a}};async function c(e,t){return r&&await E(e),n.createSessionCookie(e,t)}async function u(e){return n.getAccountInfoByUid(e).then(e=>e.users?.length?new p.UserRecord(e.users[0]):null)}async function A(e){return u(e.sub).then(t=>{if(!t)throw new l.AuthError(l.AuthErrorCode.USER_NOT_FOUND);if(t.disabled)throw new l.AuthError(l.AuthErrorCode.USER_DISABLED);if(t.tokensValidAfterTime&&1e3*e.auth_time<new Date(t.tokensValidAfterTime).getTime())throw new l.AuthError(l.AuthErrorCode.TOKEN_REVOKED);return e})}async function E(e,n=v){let o=await t.getProjectId(),i=(0,f.createIdTokenVerifier)(o,r),a=await i.verifyJWT(e,n);return n.checkRevoked?A(a):a}function y(e,t){return o.createCustomToken(e,t)}async function g(t,r=v){let n=await E(t,{referer:r.referer}),o=(0,m.filterStandardClaims)(n);r.dynamicCustomClaimsKeys?.length&&r.dynamicCustomClaimsKeys.forEach(e=>{delete o[e]});let i=await y(n.uid,{...o,email_verified:n.email_verified,source_sign_in_provider:n.firebase.sign_in_provider});return(0,a.debug)("Generated custom token based on provided idToken",{customToken:i}),{...await T(i,e.apiKey,{tenantId:e.tenantId,appCheckToken:r.appCheckToken,referer:r.referer}),customToken:i}}async function _(e){return n.createNewAccount(e).then(e=>u(e)).then(e=>{if(!e)throw new l.AuthError(l.AuthErrorCode.INTERNAL_ERROR,"Could not get recently created user from database. Most likely it was deleted.");return e})}async function S(e,t){return n.updateExistingAccount(e,t).then(e=>u(e)).then(e=>{if(!e)throw new l.AuthError(l.AuthErrorCode.INTERNAL_ERROR,"Could not get recently updated user from database. Most likely it was deleted.");return e})}return{verifyAndRefreshExpiredIdToken:async function(t,r=v){return await R(async()=>{let e=await E(t.idToken,r);return{idToken:t.idToken,decodedIdToken:e,refreshToken:t.refreshToken,customToken:t.customToken}},async()=>{if(t.refreshToken){let n=await i(t.refreshToken,{referer:r.referer,enableCustomToken:e.enableCustomToken});return await r.onTokenRefresh?.(n),n}throw new l.InvalidTokenError(l.InvalidTokenReason.MISSING_REFRESH_TOKEN)},async e=>{if(e instanceof l.AuthError&&e.code===l.AuthErrorCode.NO_MATCHING_KID)throw l.InvalidTokenError.fromError(e,l.InvalidTokenReason.INVALID_KID);throw l.InvalidTokenError.fromError(e,l.InvalidTokenReason.INVALID_CREDENTIALS)},r.experimental_enableTokenRefreshOnExpiredKidHeader??!1)},verifyIdToken:E,createCustomToken:y,getCustomIdAndRefreshTokens:g,handleTokenRefresh:i,deleteUser:async function(e){await n.deleteAccount(e)},setCustomUserClaims:async function(e,t){await n.setCustomUserClaims(e,t)},getUser:u,getUserByEmail:async function(e){return n.getAccountInfoByEmail(e).then(e=>{if(!e.users||!e.users.length)throw new l.AuthError(l.AuthErrorCode.USER_NOT_FOUND);return new p.UserRecord(e.users[0])})},updateUser:S,createUser:_,createAnonymousUser:async function(e){return I(e)},listUsers:async function(e,t){return n.listUsers(e,t).then(e=>{let t={users:e.users.map(e=>new p.UserRecord(e))};return e.nextPageToken&&(t.nextPageToken=e.nextPageToken),t})},createSessionCookie:c}}},51748:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IAMSigner=t.ServiceAccountSigner=t.EmulatorSigner=void 0,t.createEmulatorToken=s;let n=r(61430),o=r(17303),i=r(57550),a=r(64414);function s(e){return`${n.base64url.encode(JSON.stringify({alg:"none",typ:"JWT"}))}.${n.base64url.encode(JSON.stringify(e))}.${n.base64url.encode("")}`}class c{tenantId;constructor(e){this.tenantId=e}async sign(e){return this.tenantId&&(e.tenant_id=this.tenantId),s(e)}getAccountId(){return Promise.resolve("firebase-auth-emulator@example.com")}}t.EmulatorSigner=c;class d{credential;tenantId;constructor(e,t){this.credential=e,this.tenantId=t}async sign(e){return this.tenantId&&(e.tenant_id=this.tenantId),(0,i.sign)({payload:e,privateKey:this.credential.privateKey})}getAccountId(){return Promise.resolve(this.credential.clientEmail)}}t.ServiceAccountSigner=d;class l{algorithm=a.ALGORITHM_RS256;credential;tenantId;serviceAccountId;constructor(e,t,r){this.credential=e,this.tenantId=t,this.serviceAccountId=r}async sign(e){this.tenantId&&(e.tenant_id=this.tenantId);let t=await this.getAccountId(),r=await this.credential.getAccessToken();return(0,i.signBlob)({accessToken:r.accessToken,serviceAccountId:t,payload:e})}async getAccountId(){if(this.serviceAccountId)return this.serviceAccountId;let e=await this.credential.getAccessToken(),t={method:"GET",headers:{"Metadata-Flavor":"Google",Authorization:`Bearer ${e.accessToken}`}};return this.serviceAccountId=await (0,o.fetchText)("http://metadata/computeMetadata/v1/instance/service-accounts/default/email",t)}}t.IAMSigner=l},57550:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.sign=s,t.signBlob=l;let n=r(61430),o=r(3337),i=r(17303),a=r(64414);async function s({payload:e,privateKey:t,keyId:r}){let i;try{i=await (0,n.importPKCS8)(t,a.ALGORITHM_RS256)}catch(e){throw o.AuthError.fromError(e,o.AuthErrorCode.INVALID_ARGUMENT,"It looks like the value provided for `serviceAccount.privateKey` is incorrectly formatted. Please double-check if private key has correct format. See https://github.com/awinogrodzki/next-firebase-auth-edge/issues/246#issuecomment-2321559620 for details")}return new n.SignJWT(e).setProtectedHeader({alg:a.ALGORITHM_RS256,kid:r}).sign(i)}function c(e){return e.replace(/\//g,"_").replace(/\+/g,"-").replace(/=+$/,"")}function d(e){let t=JSON.stringify(e);return c(n.base64url.encode(t))}async function l({payload:e,serviceAccountId:t,accessToken:r}){let o=`https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/${t}:signBlob`,s={alg:a.ALGORITHM_RS256,typ:"JWT"},l=`${d(s)}.${d(e)}`,u={method:"POST",headers:{Authorization:`Bearer ${r}`},body:JSON.stringify({payload:n.base64url.encode(l)})},h=await (0,i.fetchAny)(o,u),f=await h.blob(),{signedBlob:p}=JSON.parse(await f.text());return`${l}.${c(p)}`}},64414:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ALGORITHM_RS256=void 0,t.getPublicCryptoKey=s,t.verify=c;let n=r(61430),o=r(332);t.ALGORITHM_RS256="RS256";let i=new Map;async function a(e){return e.startsWith("-----BEGIN CERTIFICATE-----")?(0,n.importX509)(e,t.ALGORITHM_RS256):(0,n.importSPKI)(e,t.ALGORITHM_RS256)}async function s(e){let t=i.get(e);if(t)return t;let r=await a(e);return i.set(e,r),r}async function c(e,t,r){let i=r.currentDate??new Date,a=i.getTime()/1e3,s=(0,n.decodeJwt)(e);if(!(0,o.useEmulator)()){let{payload:r}=await (0,n.jwtVerify)(e,await t(),{currentDate:i});return r}if(void 0!==s.nbf){if("number"!=typeof s.nbf)throw new n.errors.JWTInvalid("invalid nbf value");if(s.nbf>a)throw new n.errors.JWTExpired("jwt not active: "+new Date(1e3*s.nbf).toISOString(),s)}if(void 0!==s.exp){if("number"!=typeof s.exp)throw new n.errors.JWTInvalid("invalid exp value");if(a>=s.exp)throw new n.errors.JWTExpired("token expired: "+new Date(1e3*s.exp).toISOString(),s)}return s}},45890:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKeySignatureVerifier=t.JWKSSignatureVerifier=t.UrlKeyFetcher=void 0,t.fetchPublicKey=f;let n=r(61430),o=r(97917),i=r(3337),a=r(332),s=r(64414),c=r(85934),d=new Map;class l{clientCertUrl;constructor(e){if(this.clientCertUrl=e,!(0,c.isURL)(e))throw Error("The provided public client certificate URL is not a valid URL.")}async fetchPublicKeysResponse(e){let t=await fetch(e),r={};if(t.headers.forEach((e,t)=>{r[t]=e}),(0,o.debug)("Public keys fetched",{responseHeaders:r,cryptoRuntime:n.cryptoRuntime}),!t.ok){let e="Error fetching public keys for Google certs: ",r=await t.json();throw r.error?(e+=`${r.error}`,r.error_description&&(e+=" ("+r.error_description+")")):e+=`${await t.text()}`,Error(e)}let i=await t.json();if(i.error)throw Error("Error fetching public keys for Google certs: "+i.error);return{keys:i,expiresAt:function(e){if(!e.headers.has("cache-control"))return 0;let t=e.headers.get("cache-control").split(",").reduce((e,t)=>{let r=t.trim().split("=");return"max-age"===r[0]?+r[1]:e},0);return Date.now()+1e3*t}(t)}}async fetchAndCachePublicKeys(e){(0,o.debug)("No public keys found in cache. Fetching public keys from Google...",{cryptoRuntime:n.cryptoRuntime});let t=await this.fetchPublicKeysResponse(e);return d.set(e.toString(),t),(0,o.debug)("Public keys cached",{cacheKey:e.toString(),expiresAt:t.expiresAt,cryptoRuntime:n.cryptoRuntime}),t.keys}async fetchPublicKeys(){let e=new URL(this.clientCertUrl),t=d.get(e.toString());if(!t)return this.fetchAndCachePublicKeys(e);let{keys:r,expiresAt:i}=t,a=Date.now();return((0,o.debug)("Get public keys from cache",{expiresAt:i,now:a,cryptoRuntime:n.cryptoRuntime}),i<=a)?this.fetchAndCachePublicKeys(e):r}}t.UrlKeyFetcher=l;class u{options;jwksUrl;constructor(e,t){if(this.options=t,!(0,c.isURL)(e))throw Error("The provided JWKS URL is not a valid URL.");this.jwksUrl=new URL(e)}async getPublicKey(e){return(0,n.createRemoteJWKSet)(this.jwksUrl,this.options)(e)}async verify(e,t){let r=(0,n.decodeProtectedHeader)(e);try{await (0,s.verify)(e,()=>this.getPublicKey(r),t)}catch(r){if(r instanceof n.errors.JWKSMultipleMatchingKeys){for await(let o of r)try{await (0,s.verify)(e,()=>Promise.resolve(o),t);return}catch(e){if(e instanceof n.errors.JWSSignatureVerificationFailed)continue;throw e}throw new n.errors.JWSSignatureVerificationFailed}throw r}}}t.JWKSSignatureVerifier=u;class h{keyFetcher;constructor(e){if(this.keyFetcher=e,!(0,c.isNonNullObject)(e))throw Error("The provided key fetcher is not an object or null.")}static withCertificateUrl(e){return new h(new l(e))}async getPublicKey(e){return(0,a.useEmulator)()?{type:"none"}:f(this.keyFetcher,e).then(s.getPublicCryptoKey)}async verify(e,t){let r=(0,n.decodeProtectedHeader)(e);try{await (0,s.verify)(e,()=>this.getPublicKey(r),t)}catch(r){if(r instanceof i.AuthError&&r.code===i.AuthErrorCode.NO_KID_IN_HEADER){await this.verifyWithoutKid(e,t);return}throw r}}async verifyWithoutKid(e,t){let r=await this.keyFetcher.fetchPublicKeys();return this.verifyWithAllKeys(e,r,t)}async verifyWithAllKeys(e,t,r){let o=[];return Object.values(t).forEach(t=>{let i=(0,s.verify)(e,async()=>(0,s.getPublicCryptoKey)(t),r).then(()=>!0).catch(e=>{if(e instanceof n.errors.JWTExpired)throw e;return!1});o.push(i)}),Promise.all(o).then(e=>{if(e.every(e=>!1===e))throw new i.AuthError(i.AuthErrorCode.INVALID_SIGNATURE)})}}async function f(e,t){if(!t.kid)throw new i.AuthError(i.AuthErrorCode.NO_KID_IN_HEADER);let r=t.kid,n=await e.fetchPublicKeys();if(!Object.prototype.hasOwnProperty.call(n,r))throw new i.AuthError(i.AuthErrorCode.NO_MATCHING_KID);return n[r]}t.PublicKeySignatureVerifier=h},68943:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseTokenGenerator=t.BLACKLISTED_CLAIMS=void 0,t.cryptoSignerFromCredential=d,t.createFirebaseTokenGenerator=function(e,t,r){return new c((0,s.useEmulator)()?new i.EmulatorSigner(t):d(e,t,r))};let n=r(93347),o=r(3337),i=r(51748),a=r(85934),s=r(332);t.BLACKLISTED_CLAIMS=["acr","amr","at_hash","aud","auth_time","azp","cnf","c_hash","exp","iat","iss","jti","nbf","nonce"];class c{signer;constructor(e){this.signer=e}createCustomToken(e,r){let n;if(e.length>128?n="`uid` argument must a uid with less than or equal to 128 characters.":c.isDeveloperClaimsValid_(r)||(n="`developerClaims` argument must be a valid, non-null object containing the developer claims."),n)throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,n);let i={};if(void 0!==r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)){if(-1!==t.BLACKLISTED_CLAIMS.indexOf(e))throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,`Developer claim "${e}" is reserved and cannot be specified.`);i[e]=r[e]}}return this.signer.getAccountId().then(async t=>{let r=Math.floor(Date.now()/1e3),n={aud:"https://identitytoolkit.googleapis.com/google.identity.identitytoolkit.v1.IdentityToolkit",iat:r,exp:r+3600,iss:t,sub:t,uid:e};return Object.keys(i).length>0&&(n.claims=i),this.signer.sign(n)})}static isDeveloperClaimsValid_(e){return void 0===e||(0,a.isNonNullObject)(e)}}function d(e,t,r){return e instanceof n.ServiceAccountCredential?new i.ServiceAccountSigner(e,t):new i.IAMSigner(e,t,r)}t.FirebaseTokenGenerator=c},76184:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseTokenVerifier=void 0,t.createIdTokenVerifier=function(e,t){return new l(i.CLIENT_CERT_URL,"https://securetoken.google.com/",e,t)};let n=r(61430),o=r(3337),i=r(332),a=r(64414),s=r(45890),c=r(17303),d=r(85934);class l{issuer;projectId;tenantId;signatureVerifier;constructor(e,t,r,n){if(this.issuer=t,this.projectId=r,this.tenantId=n,!(0,d.isURL)(e))throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,"The provided public client certificate URL is an invalid URL.");this.signatureVerifier=s.PublicKeySignatureVerifier.withCertificateUrl(e)}async verifyJWT(e,t){let r=await this.decodeAndVerify(e,this.projectId,t),n=(0,c.mapJwtPayloadToDecodedIdToken)(r.payload);if(this.tenantId&&n.firebase.tenant!==this.tenantId)throw new o.AuthError(o.AuthErrorCode.MISMATCHING_TENANT_ID);return n}async decodeAndVerify(e,t,r){let o=(0,n.decodeProtectedHeader)(e),i=(0,n.decodeJwt)(e);return this.verifyContent({header:o,payload:i},t),await this.verifySignature(e,r),{header:o,payload:i}}verifyContent(e,t){let r;let n=e&&e.header,s=e&&e.payload;if((0,i.useEmulator)()||void 0!==n.kid?(0,i.useEmulator)()||n.alg===a.ALGORITHM_RS256?s.iss!==this.issuer+t?r=`idToken has incorrect "iss" (issuer) claim. Expected ${this.issuer}${t}, but got ${s.iss}`:""===s.sub?r='idToken has an empty string "sub" (subject) claim.':"string"==typeof s.sub&&s.sub.length>128&&(r='idToken has "sub" (subject) claim longer than 128 characters.'):r=`Incorrect algorithm. ${a.ALGORITHM_RS256} expected, ${n.alg} provided`:r=s.aud===i.FIREBASE_AUDIENCE?"idToken was expected, but custom token was provided":'idToken has no "kid" claim.',r)throw new o.AuthError(o.AuthErrorCode.INVALID_ARGUMENT,r)}verifySignature(e,t){return this.signatureVerifier.verify(e,t).catch(e=>{throw this.mapJoseErrorToAuthError(e)})}mapJoseErrorToAuthError(e){return e instanceof n.errors.JWTExpired?o.AuthError.fromError(e,o.AuthErrorCode.TOKEN_EXPIRED,e.message):e instanceof n.errors.JWSSignatureVerificationFailed?o.AuthError.fromError(e,o.AuthErrorCode.INVALID_SIGNATURE):e instanceof o.AuthError?e:o.AuthError.fromError(e,o.AuthErrorCode.INTERNAL_ERROR,e.message)}}t.FirebaseTokenVerifier=l},66586:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},24716:function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.UserRecord=t.UserInfo=t.UserMetadata=t.MultiFactorSettings=t.PhoneMultiFactorInfo=t.MultiFactorInfo=void 0;let o=r(17303),i=r(85934),a=r(61430),s=r(3337),c=a.base64url.encode("REDACTED");function d(e){try{let t=new Date(parseInt(e,10));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}return null}(n||(n={})).Phone="phone";class l{uid;displayName;factorId;enrollmentTime;static initMultiFactorInfo(e){let t=null;try{t=new u(e)}catch{return null}return t}constructor(e){this.initFromServerResponse(e)}toJSON(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}}initFromServerResponse(e){let t=e&&this.getFactorId(e);if(!t||!e||!e.mfaEnrollmentId)throw new s.AuthError(s.AuthErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Invalid multi-factor info response");(0,o.addReadonlyGetter)(this,"uid",e.mfaEnrollmentId),(0,o.addReadonlyGetter)(this,"factorId",t),(0,o.addReadonlyGetter)(this,"displayName",e.displayName),e.enrolledAt?(0,o.addReadonlyGetter)(this,"enrollmentTime",new Date(e.enrolledAt).toUTCString()):(0,o.addReadonlyGetter)(this,"enrollmentTime",null)}}t.MultiFactorInfo=l;class u extends l{phoneNumber;constructor(e){super(e),(0,o.addReadonlyGetter)(this,"phoneNumber",e.phoneInfo)}toJSON(){return Object.assign(super.toJSON(),{phoneNumber:this.phoneNumber})}getFactorId(e){return e&&e.phoneInfo?n.Phone:null}}t.PhoneMultiFactorInfo=u;class h{enrolledFactors;constructor(e){let t=[];if((0,i.isNonNullObject)(e))e.mfaInfo&&e.mfaInfo.forEach(e=>{let r=l.initMultiFactorInfo(e);r&&t.push(r)});else throw new s.AuthError(s.AuthErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Invalid multi-factor response");(0,o.addReadonlyGetter)(this,"enrolledFactors",Object.freeze(t))}toJSON(){return{enrolledFactors:this.enrolledFactors.map(e=>e.toJSON())}}}t.MultiFactorSettings=h;class f{creationTime;lastSignInTime;lastRefreshTime;constructor(e){(0,o.addReadonlyGetter)(this,"creationTime",d(e.createdAt)),(0,o.addReadonlyGetter)(this,"lastSignInTime",d(e.lastLoginAt));let t=e.lastRefreshAt?new Date(e.lastRefreshAt).toUTCString():null;(0,o.addReadonlyGetter)(this,"lastRefreshTime",t)}toJSON(){return{lastSignInTime:this.lastSignInTime,creationTime:this.creationTime,lastRefreshTime:this.lastRefreshTime}}}t.UserMetadata=f;class p{uid;displayName;email;photoURL;providerId;phoneNumber;constructor(e){if(!e.rawId||!e.providerId)throw new s.AuthError(s.AuthErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Invalid user info response");(0,o.addReadonlyGetter)(this,"uid",e.rawId),(0,o.addReadonlyGetter)(this,"displayName",e.displayName),(0,o.addReadonlyGetter)(this,"email",e.email),(0,o.addReadonlyGetter)(this,"photoURL",e.photoUrl),(0,o.addReadonlyGetter)(this,"providerId",e.providerId),(0,o.addReadonlyGetter)(this,"phoneNumber",e.phoneNumber)}toJSON(){return{uid:this.uid,displayName:this.displayName,email:this.email,photoURL:this.photoURL,providerId:this.providerId,phoneNumber:this.phoneNumber}}}t.UserInfo=p;class m{uid;email;emailVerified;displayName;photoURL;phoneNumber;disabled;metadata;providerData;passwordHash;passwordSalt;customClaims;tenantId;tokensValidAfterTime;multiFactor;constructor(e){if(!e.localId)throw new s.AuthError(s.AuthErrorCode.INTERNAL_ERROR,"INTERNAL ASSERT FAILED: Invalid user response");(0,o.addReadonlyGetter)(this,"uid",e.localId),(0,o.addReadonlyGetter)(this,"email",e.email),(0,o.addReadonlyGetter)(this,"emailVerified",!!e.emailVerified),(0,o.addReadonlyGetter)(this,"displayName",e.displayName),(0,o.addReadonlyGetter)(this,"photoURL",e.photoUrl),(0,o.addReadonlyGetter)(this,"phoneNumber",e.phoneNumber),(0,o.addReadonlyGetter)(this,"disabled",e.disabled||!1),(0,o.addReadonlyGetter)(this,"metadata",new f(e));let t=[];for(let r of e.providerUserInfo||[])t.push(new p(r));(0,o.addReadonlyGetter)(this,"providerData",t),e.passwordHash===c?(0,o.addReadonlyGetter)(this,"passwordHash",void 0):(0,o.addReadonlyGetter)(this,"passwordHash",e.passwordHash),(0,o.addReadonlyGetter)(this,"passwordSalt",e.salt),e.customAttributes&&(0,o.addReadonlyGetter)(this,"customClaims",JSON.parse(e.customAttributes));let r=null;void 0!==e.validSince&&(r=d(1e3*parseInt(e.validSince,10))),(0,o.addReadonlyGetter)(this,"tokensValidAfterTime",r||void 0),(0,o.addReadonlyGetter)(this,"tenantId",e.tenantId);let n=new h(e);n.enrolledFactors.length>0&&(0,o.addReadonlyGetter)(this,"multiFactor",n)}toJSON(){let e={uid:this.uid,email:this.email,emailVerified:this.emailVerified,displayName:this.displayName,photoURL:this.photoURL,phoneNumber:this.phoneNumber,disabled:this.disabled,metadata:this.metadata.toJSON(),passwordHash:this.passwordHash,passwordSalt:this.passwordSalt,customClaims:(0,o.deepCopy)(this.customClaims),tokensValidAfterTime:this.tokensValidAfterTime,tenantId:this.tenantId};for(let t of(this.multiFactor&&(e.multiFactor=this.multiFactor.toJSON()),e.providerData=[],this.providerData))e.providerData.push(t.toJSON());return e}}t.UserRecord=m},17303:function(e,t){async function r(e){let t=await e.json();if(!t)return"Missing error payload";let r="string"==typeof t.error?t.error:t.error?.message??"Missing error payload";return t.error_description&&(r+=" ("+t.error_description+")"),r}async function n(e,t){return(await i(e,t)).json()}async function o(e,t){return(await i(e,t)).text()}async function i(e,t){let n=await fetch(e,t);if(!n.ok)throw Error(await r(n));return n}function a(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(let r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;let n=e;n[r]=a(n[r],n[r])}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.formatString=function(e,t){let r=e;return Object.keys(t||{}).forEach(e=>{r=r.replace(RegExp("{"+e+"}","g"),t[e])}),r},t.fetchJson=n,t.fetchText=o,t.fetchAny=i,t.mapJwtPayloadToDecodedIdToken=function(e){return e.uid=e.sub,e},t.addReadonlyGetter=function(e,t,r){Object.defineProperty(e,t,{value:r,writable:!1,enumerable:!0})},t.deepCopy=function(e){return a(void 0,e)},t.deepExtend=a,t.toUint8Array=function(e){return s.encode(e)};let s=new TextEncoder},85934:function(e,t){function r(e){return"object"==typeof e&&!n(e)}function n(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=r,t.isArray=n,t.isNonNullObject=function(e){return r(e)&&null!==e},t.isEmail=function(e){return"string"==typeof e&&/^[^@]+@[^@]+$/.test(e)},t.isURL=function(e){if("string"!=typeof e||/[^a-z0-9:/?#[\]@!$&'()*+,;=.\-_~%]/i.test(e))return!1;try{let t=new URL(e),r=t.protocol,n=t.hostname,o=t.pathname;if("http:"!==r&&"https:"!==r||!n||!/^[a-zA-Z0-9]+[\w-]*([.]?[a-zA-Z0-9]+[\w-]*)*$/.test(n)||o&&"/"!==o&&!/^(\/[\w\-.~!$'()*+,;=:@%]+)*\/?$/.test(o))return!1}catch{return!1}return!0}},97917:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.enableDebugMode=function(){r=!0},t.debug=function(e,t){if(r&&(console.log("ⓘ next-firebase-auth-edge:",e),t))for(let e in t)t[e]&&console.log("	",`${e}:`,t[e])};let r=!1},99376:function(e,t,r){var n=r(35475);r.o(n,"RedirectType")&&r.d(t,{RedirectType:function(){return n.RedirectType}}),r.o(n,"notFound")&&r.d(t,{notFound:function(){return n.notFound}}),r.o(n,"redirect")&&r.d(t,{redirect:function(){return n.redirect}}),r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},40864:function(e,t,r){r.d(t,{t:function(){return c}}),new TextEncoder;let n=new TextDecoder;var o=e=>{if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};class i extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class a extends i{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class s extends i{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}function c(e){let t,r;if("string"!=typeof e)throw new a("JWTs must use Compact JWS serialization, JWT must be a string");let{1:i,length:s}=e.split(".");if(5===s)throw new a("Only JWTs using Compact JWS serialization can be decoded");if(3!==s)throw new a("Invalid JWT");if(!i)throw new a("JWTs must contain a payload");try{t=function(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof e?e:n.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=n.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return function(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(e);let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}(t)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}(i)}catch{throw new a("Failed to base64url decode the payload")}try{r=JSON.parse(n.decode(t))}catch{throw new a("Failed to parse the decoded payload as JSON")}if(!o(r))throw new a("Invalid JWT Claims Set");return r}}}]);