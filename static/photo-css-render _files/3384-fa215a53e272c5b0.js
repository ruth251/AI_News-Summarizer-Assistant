try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="28726d14-54c6-4fdd-a666-00906f15506f",e._sentryDebugIdIdentifier="sentry-dbid-28726d14-54c6-4fdd-a666-00906f15506f")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3384],{34319:function(e,s,t){t.d(s,{v:function(){return l}});var a=t(57437),n=t(94508),r=t(46170);let l=e=>{let{plan:s,className:t}=e,l=(0,r.ZN)(s);return(0,a.jsx)("span",{className:(0,n.cn)("rounded-full px-2 py-px text-[10px] font-medium uppercase transition-colors duration-150 ease-in-out","free"===s?"bg-muted text-muted-foreground":"bg-brand-twilight-primary text-brand-twilight-primary-foreground",t),children:l})}},60616:function(e,s,t){t.d(s,{A:function(){return N}});var a=t(57437),n=t(92850),r=t(49852),l=t(33145),i=t(46214),o=t(2265),c=t(14438),d=t(61922),u=t(82176),m=t(62869),h=t(26110),p=t(57346),x=t(95186),g=t(93022),f=t(49284),j=t(10531),v=t(89668);let b=["This offer is for new Lovable users only (gotta share the magic with fresh eyes).","Rewards are unlocked once your invite actually publishes an app. No ghost referrals, please.","We reserve the right to change, pause, or end this program anytime. We're experimental like that.","Don't spam or post your link where it doesn't belong. Let's keep it classy.","If we suspect sketchy behavior, we may withhold rewards or deactivate your link.","One reward per new user invited. No stacking loopholes - we're nerds, we'll catch it."],y=e=>{let{back:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)(h.fK,{className:"flex flex-col gap-4",children:[(0,a.jsxs)(m.z,{onClick:s,variant:"ghost",className:"w-fit px-2",children:[(0,a.jsx)(p.Z,{name:"arrow_left_alt"}),"Back"]}),(0,a.jsx)(h.$N,{children:"Terms and conditions"})]}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)("ul",{className:"flex max-h-[15rem] list-disc flex-col gap-2 overflow-auto px-5",children:b.map((e,s)=>(0,a.jsx)("li",{children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:e})},s))})})]})},w=[{icon:"bolt",children:"Share your invite link"},{icon:"crown",children:(0,a.jsxs)(a.Fragment,{children:["They sign up and get ",(0,a.jsx)("b",{children:"extra 10 credits"})]})},{icon:"chat",children:(0,a.jsxs)(a.Fragment,{children:["You get ",(0,a.jsx)("b",{children:"10 credits"})," once they publish their first website"]})}],N=e=>{var s,t,b;let{onSuccess:N}=e,[_,k]=(0,o.useState)(!1),C=(0,d.aS)(e=>e.currentWorkspace),[S,E]=(0,o.useState)(!1),z=null!==(b=(0,u.dl)(j.P.ReferralCopyConfetti))&&void 0!==b&&b,A=(0,n.a)(v.t.referralCode({referralCode:null==C?void 0:C.referral_code,workspaceId:null==C?void 0:C.id})),P=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.zIndex="10001",e.style.pointerEvents="none",document.body.appendChild(e),P.current=new r.Z({canvas:e}),()=>{document.body.removeChild(e)}},[]);let O=window.location.protocol+"//"+window.location.host,D="".concat(O,"/invite/").concat(null===(s=A.data)||void 0===s?void 0:s.referral_code),I=async()=>{if(!_)try{if(await navigator.clipboard.writeText(D),k(!0),z){var e;null===(e=P.current)||void 0===e||e.addConfetti({emojis:["❤️","\uD83D\uDC96","\uD83D\uDC9D","\uD83D\uDC97","\uD83D\uDC93"],emojiSize:58})}i.ZP.capture(f.PU.COPIED_LINK,{method:"button",did_confetti:z}),setTimeout(()=>{k(!1)},2e3)}catch(e){c.Am.error("Failed to copy link")}};return(0,a.jsxs)(h.cZ,{hideCloseButton:!0,className:"pointer-events-auto flex max-h-[95vh] flex-col gap-4 overflow-y-auto border-none bg-background outline-none",children:[(0,a.jsx)(h.$N,{className:"sr-only",children:"Refer & Earn"}),S?(0,a.jsx)(y,{back:()=>E(!1)}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.fK,{children:(0,a.jsxs)("div",{className:"relative h-fit overflow-hidden rounded-xl",children:[(0,a.jsx)("button",{onClick:N,className:"absolute right-4 top-4 z-10 bg-transparent",tabIndex:-1,children:(0,a.jsx)(p.Z,{name:"close",className:"h-5 w-5 cursor-pointer text-muted-foreground"})}),(0,a.jsx)(l.default,{src:"/img/referral/dark-spread.png",alt:"Referral",className:"hidden w-full object-contain dark:block",width:406,height:188,priority:!0}),(0,a.jsx)(l.default,{src:"/img/referral/light-spread.png",alt:"Lovable 2.0",className:"block w-full object-contain dark:hidden",width:406,height:188,priority:!0})]})}),(0,a.jsxs)("div",{className:"md:py-2",children:[(0,a.jsx)("div",{className:"mb-3 text-base font-normal text-muted-foreground",children:"How it works:"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:w.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(p.Z,{name:e.icon,className:"h-5 w-5"}),(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("span",{className:"text-base font-normal text-foreground",children:e.children})})]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-3 text-base font-normal text-muted-foreground",children:"Your invite link:"}),A.isLoading?(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(g.O,{className:"h-12 w-full rounded-xl"})}):(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2 rounded-xl bg-muted p-2 sm:flex-row sm:space-y-0",children:[(0,a.jsxs)("div",{className:"flex w-full flex-1 items-center px-2",children:[(0,a.jsx)(p.Z,{name:"link",className:"mr-2 h-5 w-5 text-muted-foreground"}),(0,a.jsx)(x.I,{onCopy:()=>{i.ZP.capture(f.PU.COPIED_LINK,{method:"input_copy",did_confetti:z})},value:A.error?"Error fetching the link, sorry":D,tabIndex:-1,readOnly:!0,className:"border-none shadow-none focus:outline-none focus:ring-0 focus-visible:ring-0"})]}),(0,a.jsx)(m.z,{onClick:I,className:"w-full rounded-xl sm:w-24",variant:"default",disabled:A.isLoading||!(null===(t=A.data)||void 0===t?void 0:t.referral_code),children:_?"Copied!":"Copy link"})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(m.z,{variant:"link",className:"h-fit w-fit py-0 text-xs font-normal text-muted-foreground underline",onClick:()=>E(!0),children:"View Terms and Conditions"})})]})]})}},96027:function(e,s,t){t.d(s,{E:function(){return g}});var a=t(57437),n=t(5978),r=t(2265),l=t(27648),i=t(99376),o=t(46214),c=t(94508),d=t(15492),u=t(62869),m=t(57346),h=t(25566),p=e=>{let{type:s,message:t,persistDismiss:n=!1,storageKey:p,bgColor:x,href:g,onClick:f,className:j,darkCloseIcon:v=!1}=e,b=(0,i.usePathname)(),y=(0,r.useRef)(null),[w,N]=(0,d.B)(p||"default-banner-key",{defaultValue:!0}),[_,k]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{S(!0),k(!0)},[]);let E=(null==b?void 0:b.startsWith("/projects/"))&&["ph-launch-banner","rebrand-banner"].includes(p||""),z=!E&&(n?w:_);if(E)return null;if(n&&!p)return console.error("storageKey is required when persistDismiss is true"),null;if(!z||h.env.TEST_E2E)return null;let A=(0,a.jsxs)("div",{ref:y,className:(0,c.cn)("z-[1050] hidden w-full items-center justify-between px-2 py-2 text-sm text-white transition-opacity duration-300 md:px-4 md:text-base",x||("error"===s?"bg-destructive-primary":"bg-background"),j,C&&"flex"),children:[(0,a.jsx)("div",{className:"flex flex-grow items-center justify-center space-x-4 pr-6 md:text-center",children:t}),(0,a.jsx)(u.z,{variant:"ghost",size:"icon",className:(0,c.cn)("hover:bg-transparent md:absolute md:right-2",v?"text-primary-foreground hover:text-primary-foreground":"text-primary"),onClick:e=>{e.stopPropagation(),n?N(!1):k(!1),o.ZP.capture("banner_dismissed",{banner_type:s,message:t,persisted:n})},children:(0,a.jsx)(m.Z,{name:"close_small"})})]});return g?(0,a.jsx)(l.default,{href:g,target:"_blank",rel:"noopener noreferrer",onClick:f,className:"transition-opacity hover:opacity-90",children:A}):A},x=t(78099);let g=e=>{let{className:s}=e,[t,l]=(0,r.useState)({showStatusBanner:!1,statusBannerContent:""});return((0,r.useEffect)(()=>{(async()=>{let e=(0,n.JU)(x.db,"system","info"),s=await (0,n.QT)(e);s.exists()&&l(s.data())})()},[]),t.showStatusBanner&&t.statusBannerContent)?(0,a.jsx)(p,{message:t.statusBannerContent,type:"error",className:s}):null}},32429:function(e,s,t){t.d(s,{G:function(){return c},h:function(){return o}});var a=t(57437),n=t(92850),r=t(2265),l=t(51408);let i=(0,r.createContext)(null);function o(e){let{children:s,user:t}=e,{data:o,isLoading:c}=(0,n.a)(l.V.experimentalFeatures({user:t})),d=(0,r.useMemo)(()=>({features:o||null,isLoading:c}),[o,c]);return(0,a.jsx)(i.Provider,{value:d,children:s})}function c(){let e=(0,r.useContext)(i);if(!e)throw Error("LabsFeaturesContext not found");return e}},93261:function(e,s,t){var a=t(57437),n=t(59040),r=t(2265),l=t(14438),i=t(62869),o=t(26110),c=t(57346),d=t(64040),u=t(49131),m=t(21288),h=t(77113);let p=e=>{try{return(0,n.xX)(e)}catch(s){return m.logging.error("Failed to get UTF-8 domain",{domain:e,error:s}),e}};s.Z=e=>{let{domain:s,showRemove:t,showIcon:n,refetchDomains:m}=e,[x,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),y=(0,h.iZ)(e=>e.project),w=async e=>{b(!0);try{let s=(0,u.SJ)();await s.delete("/projects/".concat(null==y?void 0:y.id,"/domains/").concat(e)),null==m||m(),b(!1),g(!1),l.Am.success("Domain removed",{description:'Your custom domain "'.concat(e,'" was successfully removed from the project.')})}catch(e){b(!1),(0,d.Eo)(e)}},N=()=>{j(!0),null==m||m(),setTimeout(()=>j(!1),1e3)},_=p(s.domain);return(0,a.jsxs)("li",{className:"flex min-h-7 w-full items-center gap-2 text-sm",children:["active"!==s.status?(0,a.jsxs)("span",{className:"flex-grow truncate text-muted-foreground",title:"The domain ".concat(_," is still being configured..."),onClick:()=>N(),children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),_,(0,a.jsxs)("span",{className:"relative ml-2 mr-1 inline-flex size-2",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-primary opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex size-2 rounded-full bg-primary"})]})]}):(0,a.jsxs)("span",{className:"flex-grow truncate",title:s.domain,children:[n&&(0,a.jsx)(c.Z,{name:"language",className:"mr-2 inline w-4",size:"small"}),_]}),t&&(0,a.jsxs)(o.Vq,{open:x,onOpenChange:g,children:[(0,a.jsx)(o.hg,{asChild:!0,children:(0,a.jsx)(i.z,{variant:"ghost",size:"icon-sm",type:"button",className:"ml-auto",children:(0,a.jsx)(c.Z,{name:"delete",size:"small"})})}),(0,a.jsxs)(o.cZ,{children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{children:["Remove ",_,"?"]}),(0,a.jsx)(o.Be,{children:"This will disconnect the domain from this project. You will need to reconfigure it if you will want to use it with this project in the future."})]}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>{g(!1)},children:"Cancel"}),(0,a.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>w(s.domain),loading:v,children:"Remove"})]})]})]}),"active"!==s.status?(0,a.jsx)("span",{title:"Refresh status",className:"ml-auto cursor-pointer",onClick:()=>N(),children:(0,a.jsx)(c.Z,{name:"refresh",size:"small",className:f?"animate-spin":""})}):(0,a.jsx)("a",{href:"https://".concat(s.domain),target:"_blank",title:"Open in a new tab",rel:"noopener noreferrer",className:"ml-auto text-muted-foreground",children:(0,a.jsx)(c.Z,{name:"arrow_outward",size:"small"})})]})}},69084:function(e,s,t){t.d(s,{z:function(){return l}});var a=t(57437),n=t(92825),r=t(79858);let l=e=>{var s;let{isInteractive:t=!1,className:l,workspace:i,...o}=e,c=(0,r.Q)(null==i?void 0:i.id),d=null==i?void 0:i.name,u=null!==(s=null==i?void 0:i.image_url)&&void 0!==s?s:void 0;return(0,a.jsx)(n.N,{name:d,isInteractive:t,photoSrc:u,userColor:c,className:l,isWorkspace:!0,...o})}},14411:function(e,s,t){t.d(s,{H:function(){return j}});var a=t(57437),n=t(57346),r=t(27132),l=t(94508),i=t(79358);let o=e=>{let{bonusCredits:s}=e,t=(0,r.Z)("md");return(0,a.jsxs)("div",{className:(0,l.cn)("flex items-center justify-between gap-2 rounded-md bg-muted p-3 text-base md:text-sm"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.Z,{name:"rewarded_ads",size:t?"default":"small"}),(0,a.jsx)("p",{children:"Bonus Credits"})]}),(0,a.jsx)("p",{className:"text-sm md:text-xs",children:(0,i.H)(s)})]})};var c=t(55157),d=t(32759),u=t(81103),m=t(66491),h=t(63070),p=t(31091);let x=e=>{let{progress:s,label:t,description:r,tooltip:o,showUpgrade:x}=function(e){let{dailyLimit:s,dailyUsed:t,billingPeriodEndDate:a,type:n}=e,r=s-t,l=r>0;switch(n){case"free":{let a=e.totalCreditsUsedInBillingPeriod>=30,n=a?100:t/s*100,r=a?(0,i.u)(30,30):(0,i.u)(t,s),o=a?"You've used all your free monthly credits":l?"".concat((0,i.H)(t)," of your daily credits used"):"Your daily credits renew at midnight UTC",c="on ".concat((0,m.WU)((0,h.N)((0,p.z)(new Date,1)),"MMMM d"));return{progress:n,label:r,description:o,tooltip:a?"You'll receive new credits ".concat(c," (at midnight UTC)."):"You get 5 free credits daily (up to 30 per month).",showUpgrade:a||!l}}case"paidWithMonthlyLimit":{let s=e.billingLimit-e.billingUsed>0,t=e.billingUsed/e.billingLimit*100,n=(0,i.u)(e.billingUsed,e.billingLimit),o=l?"You have ".concat((0,i.H)(r)," daily ").concat(1===r?"credit":"credits"," to use first"):"".concat((0,i.H)(e.billingUsed)," of your monthly credits used"),c=a?"on ".concat((0,m.WU)(a,"MMMM d")," at ").concat((0,m.WU)(a,"HH:mm")):"each month";return{progress:t,label:n,description:o,tooltip:l?"Daily credits are used before monthly credits.":s?"Your daily credits renew at midnight UTC.":"Your monthly credits will renew ".concat(c,". You will still receive 5 daily credits."),showUpgrade:!s}}case"paidWithoutMonthlyLimit":{let e=t/s*100,a=(0,i.u)(t,s);return{progress:e,label:a,description:l?"".concat((0,i.H)(t)," of your daily credits used"):"Your daily credits renew at midnight UTC",tooltip:"You get ".concat(s," credits daily"),showUpgrade:!1}}default:return n}}(e),{isOwnerOfWorkspace:g}=e,{openSettings:f}=(0,c.r)();return(0,a.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-1 rounded-xl bg-muted p-4 md:rounded-md md:p-3",{}),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:(0,l.cn)("text-base font-medium md:text-sm",{}),children:"Credits Used"}),g&&(0,a.jsx)("p",{className:(0,l.cn)("cursor-pointer text-sm font-medium text-muted-foreground transition-opacity duration-150 ease-in-out hover:opacity-80 md:text-xs",{"text-muted-foreground":x}),onClick:()=>{f("billing")},children:x?"Upgrade":"Manage"})]}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,a.jsx)(d.E,{value:s,className:"h-[7px] min-w-0 flex-1"}),(0,a.jsx)("p",{className:(0,l.cn)("text-sm text-muted-foreground md:text-xs",{}),children:t})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)("p",{className:(0,l.cn)("max-w-[35ch] text-wrap text-sm text-muted-foreground md:text-xs",{}),children:r}),(0,a.jsxs)(u.u,{instant:!0,children:[(0,a.jsx)(u.aJ,{className:"hidden text-muted-foreground sm:flex",children:(0,a.jsx)(n.Z,{name:"info",className:"h-3.5 w-3.5"})}),(0,a.jsx)(u._v,{className:"max-w-[25ch]",children:o})]})]})]})};var g=t(59053),f=t(46170);let j=e=>{let{workspace:s,isOwnerOfWorkspace:t,className:n}=e,{billingPeriodCreditLimit:r,billingPeriodCreditsUsed:i,dailyCreditLimit:c,dailyCreditsUsed:d,bonusCredits:u,totalCreditsUsedInBillingPeriod:m,billingPeriodEndDate:h}=(0,g.O)({projectWorkspace:s}),p=void 0!==r&&void 0!==i&&r>0,j=void 0!==c&&void 0!==d&&c>0,v=s.plan,b="free"===v,y="ktlo"===v,w=(0,f.B9)(v),N=(0,f.fA)(v),_=w||N||"ambassador"===v||"enterprise"===v||y;return"inactive"===v?null:(0,a.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-1",n),children:[(b||y)&&j&&(0,a.jsx)(x,{dailyLimit:c,dailyUsed:d,isOwnerOfWorkspace:t,totalCreditsUsedInBillingPeriod:m||0,billingPeriodEndDate:h,type:"free"}),_&&!y&&p&&j&&(0,a.jsx)(x,{dailyLimit:c,dailyUsed:d,billingLimit:r,billingUsed:i,isOwnerOfWorkspace:t,billingPeriodEndDate:h,type:"paidWithMonthlyLimit"}),_&&!y&&!p&&j&&(0,a.jsx)(x,{dailyLimit:c,dailyUsed:d,isOwnerOfWorkspace:t,billingPeriodEndDate:h,type:"paidWithoutMonthlyLimit"}),void 0!==u&&u>0&&(0,a.jsx)(o,{bonusCredits:u})]})}},47483:function(e,s,t){t.d(s,{r:function(){return u}});var a=t(57437),n=t(88391),r=t(57346),l=t(60616),i=t(55721),o=t(46214),c=t(49284),d=t(3813);let u=()=>{let e=(0,d.SK)(),s=(0,n.z)(l.A);return e?(0,a.jsxs)(i.Xi,{onClick:()=>{o.ZP.capture(c.PU.OPENED_DIALOG,{button_used:"menu_item"}),s({childProps:{onSuccess:()=>s(!1)}})},children:[(0,a.jsx)(r.Z,{name:"featured_seasonal_and_gifts",size:"small"}),(0,a.jsx)("span",{children:"Get free credits"})]}):null}},32800:function(e,s,t){t.d(s,{s:function(){return h}});var a=t(57437),n=t(2265),r=t(44481),l=t(14438),i=t(62869),o=t(55721),c=t(57346),d=t(54616),u=t(30811);let m=e=>{var s,t;let{selectedRole:r,onRoleChange:l,roleOptions:d,disabled:u=!1}=e,[m,h]=(0,n.useState)(!1);return u?(0,a.jsx)(i.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",disabled:!0,children:null===(t=d.find(e=>e.value===r))||void 0===t?void 0:t.label}):(0,a.jsxs)(o.h_,{open:m,onOpenChange:h,children:[(0,a.jsx)(o.$F,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",children:[null===(s=d.find(e=>e.value===r))||void 0===s?void 0:s.label,(0,a.jsx)(c.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,a.jsx)(o.AW,{children:(0,a.jsx)(o._x,{value:r,onValueChange:e=>{l(e),h(!1)},children:d.map(e=>(0,a.jsx)(o.qB,{value:e.value,className:"hover:bg-accent",children:e.label},e.value))})})]})},h=e=>{let{onInvite:s,isInviting:t,roleOptions:o,defaultRole:c,canSelectRoles:h=!0,placeholder:p="Add emails",completelyDisabled:x=!1,onInputChange:g}=e,[f,j]=(0,n.useState)([]),[v,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(c),N=f.length>0||""!==v.trim(),_=async()=>{let e=[...f],t=v.trim();if(""===t||f.includes(t)||(e.push(t),j(e),b("")),0===e.length)return;if(e.length>0&&!e.every(e=>(0,d.Jh)(e))){1===e.length?l.Am.error("Invalid email address",{description:"Please check the email address and try again."}):l.Am.error("Invalid email address",{description:"One or more email addresses are invalid. Please check and try again."});return}let{success:a}=await s({emails:e,role:y});a&&(j([]),b(""),null==g||g(""))};(0,r.y1)("mod+enter",e=>{e.preventDefault(),t||_()},{enableOnFormTags:!0});let k=""===v.trim()&&0===f.length;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.B,{tags:f,setTags:j,inputValue:v,setInputValue:e=>{b(e),null==g||g(e)},placeholder:p,disabled:x,className:"min-w-0 flex-1"}),N&&(0,a.jsx)(m,{selectedRole:y,onRoleChange:w,roleOptions:o,disabled:!h||x}),(0,a.jsx)(i.z,{onClick:_,variant:"affirmative",className:"flex-shrink-0",disabled:t||k||x,loading:t,children:"Invite"})]})}},45659:function(e,s,t){t.d(s,{Q:function(){return i}});var a=t(57437),n=t(70335),r=t(35974),l=t(94508);let i=e=>{let{id:s,username:t,displayName:i,photoURL:o,avatarClassName:c,actionComponent:d,email:u,isCurrentUser:m=!1,isInvited:h=!1,showBadge:p=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3 py-1 md:flex-nowrap",children:[(0,a.jsx)(n.Y,{className:(0,l.cn)(c,h&&"opacity-60"),user:{id:s,username:null!=i?i:u},photoURL:o,isInteractive:!1}),(0,a.jsx)("div",{className:"flex min-w-0 flex-shrink items-center gap-4 ".concat(h&&"opacity-60"),children:(0,a.jsxs)("div",{className:"flex min-w-0 flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex-shrink truncate text-sm font-medium leading-tight",children:[i," ",m&&(0,a.jsx)("span",{className:"font-normal",children:"(you)"})]}),(0,a.jsx)("span",{className:"max-w-[150px] flex-shrink truncate text-xs text-muted-foreground",children:u})]})}),h&&p&&(0,a.jsx)(r.C,{variant:"outline",className:"hidden gap-1 bg-muted text-xs font-medium text-muted-foreground md:flex",children:"Invite sent"}),d&&(0,a.jsx)("div",{className:"ml-auto flex-shrink-0",children:d})]})}},12285:function(e,s,t){t.d(s,{O:function(){return C}});var a=t(57437),n=t(2265),r=t(34319),l=t(6812),i=t(77113),o=t(71759),c=t(62869),d=t(26110),u=t(53647),m=t(29827),h=t(21770),p=t(14438),x=t(52558),g=t(64040),f=t(49131),j=t(21288),v=t(97318);let b=e=>{let{onSettled:s}=e,{authUser:t}=(0,x.Eu)(),a=(0,m.NL)(),{mutate:n,isPending:r}=(0,h.D)({mutationFn:async e=>{let{projectId:s,workspaceId:a}=e;if(!t)throw Error("User must be logged in to move projects");let n=(0,f.SJ)();await n.put("/projects/".concat(s,"/move-to-workspace"),{workspace_id:a})},onSuccess:async(e,s)=>{a.invalidateQueries({queryKey:v.iZ.detail(s.projectId)}).catch(e=>{j.logging.error("Failed to invalidate project query after transfer",{error:e})}),p.Am.success("Project moved successfully",{description:"Moved project to ".concat(s.workspaceName||"new workspace")})},onError:e=>{(0,g.Eo)(e)},onSettled:()=>{null==s||s()}});return{moveProjectToWorkspace:n,isMovingProject:r}};var y=t(94508),w=t(46170),N=t(69084),_=t(65613),k=t(57346);function C(e){let{trigger:s,projectId:t,projectName:m,open:h,setOpen:p,isRootDialog:x=!1}=e,g=(0,l.Q)(e=>e.workspaces),{moveProjectToWorkspace:f,isMovingProject:j}=b({onSettled:()=>{E(!1),P("")}}),v=(0,o.hO)(e=>e.projectWorkspace),[C,S]=(0,n.useState)(!1),E=p||S,z=async e=>{t&&f({projectId:t,workspaceId:e.id,workspaceName:e.name})},[A,P]=(0,n.useState)(""),O=(0,l.Q)(e=>e.setShowCreateWorkspaceDialog),D=g.find(e=>e.id===A),I=(0,i.iZ)(e=>e.project);if(!v)return null;let T=(0,w.B9)(null==D?void 0:D.plan)?"private":(null==D?void 0:D.plan)==="free"?"public":null;return(0,a.jsxs)(d.Vq,{open:p?h:C,onOpenChange:E,children:[!x&&(0,a.jsx)(d.hg,{asChild:!0,children:s||(0,a.jsx)(c.z,{variant:"default",children:"Transfer project"})}),(0,a.jsxs)(d.cZ,{size:"sm",children:[(0,a.jsxs)(d.fK,{children:[(0,a.jsxs)(d.$N,{className:"text-left",children:["Transfer ",m||"Project"]}),(0,a.jsxs)(d.Be,{className:"text-left",children:[(0,a.jsx)("p",{children:D?(0,a.jsxs)("span",{children:["Moving this project to"," ",(0,a.jsx)("span",{className:"font-medium",children:D.name})," ","will:"]}):(0,a.jsx)("span",{children:"Moving this project to a new workspace will:"})}),(0,a.jsxs)("ul",{className:"list-disc pl-4 text-sm",children:[(0,a.jsxs)("li",{children:["Remove access for members of"," ",(0,a.jsx)("span",{className:"font-medium",children:v.name})]}),(0,a.jsxs)("li",{children:["Grant access to members of"," ",D?(0,a.jsx)("span",{className:"font-medium",children:null==D?void 0:D.name}):(0,a.jsx)("span",{children:"the new workspace"})]}),(0,a.jsx)("li",{children:"Preserve access for anyone directly invited to the project"}),(0,a.jsx)("li",{children:"May require you to re-link GitHub and Supabase organizations/projects"})]}),(0,a.jsxs)(_.bZ,{className:(0,y.cn)((!T||T===(null==I?void 0:I.visibility))&&"hidden","text-sm","mt-4"),children:[(0,a.jsx)(k.Z,{name:"info",className:"h-4 w-4"}),(0,a.jsx)(_.Cd,{children:"Warning"}),(0,a.jsxs)(_.X,{className:"text-sm",children:["This action will turn the project"," ",(0,a.jsx)("span",{className:"font-medium",children:"private"===T?"private":"public"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"From"}),(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded-md border px-2 py-1.5 opacity-70",children:[(0,a.jsx)(N.z,{workspace:v,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{className:"text-sm",children:null==v?void 0:v.name}),(0,a.jsx)(r.v,{plan:null==v?void 0:v.plan})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"min-w-[60px] text-sm font-medium",children:"To"}),(0,a.jsxs)(u.Ph,{value:A,onValueChange:P,children:[(0,a.jsx)(u.i4,{className:"px-2 py-1.5",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(u.ki,{placeholder:"Select a workspace",className:"mr-auto"})})}),(0,a.jsxs)(u.Bw,{children:[g.map(e=>{var s,t,n,l;return(0,a.jsx)(u.Ql,{value:e.id,disabled:e.id===v.id||(null===(s=e.membership)||void 0===s?void 0:s.role)!=="owner"&&(null===(t=e.membership)||void 0===t?void 0:t.role)!=="admin",className:"focus:bg-accent/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.z,{workspace:e,className:"h-5 w-5 rounded-[6px]"}),(0,a.jsx)("p",{children:e.name}),e.plan&&(0,a.jsx)(r.v,{plan:e.plan}),(null===(n=e.membership)||void 0===n?void 0:n.role)!=="owner"&&(null===(l=e.membership)||void 0===l?void 0:l.role)!=="admin"&&(0,a.jsx)("span",{className:"text-sm text-destructive-foreground",children:"(Not admin)"})]})},e.id)}),(0,a.jsxs)("button",{className:"flex w-full items-center gap-2 rounded-sm px-2 py-1.5 text-sm hover:bg-accent",onClick:()=>{O(!0)},children:[(0,a.jsx)("div",{className:"flex h-5 w-5 items-center justify-center",children:(0,a.jsx)(k.Z,{name:"add",size:"small"})}),"Create new"]})]})]})]})]}),(0,a.jsxs)(d.cN,{className:"gap-2",children:[(0,a.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)(c.z,{disabled:!D,variant:"affirmative",size:"sm",onClick:()=>{D&&z(D)},loading:j,children:j?"Transferring...":"Confirm transfer"})]})]})]})}},61011:function(e,s,t){var a=t(57437),n=t(2265),r=t(62869),l=t(26110);s.Z=e=>{let{title:s="Remove",targetName:t,descriptionTemplate:i="Are you sure you want to remove {name}? They will no longer have access.",confirmButtonText:o="Remove",cancelButtonText:c="Cancel",onConfirm:d,onCancel:u}=e,[m,h]=(0,n.useState)(!1),p=async()=>{h(!0);try{await d()}finally{h(!1)}},x=i.replace("{name}",t);return(0,a.jsxs)(l.cZ,{size:"sm",children:[(0,a.jsxs)(l.fK,{children:[(0,a.jsx)(l.$N,{children:s}),(0,a.jsx)(l.Be,{children:x})]}),(0,a.jsxs)(l.cN,{className:"gap-2 sm:justify-end",children:[(0,a.jsx)(r.z,{variant:"outline",onClick:u,disabled:m,children:c}),(0,a.jsx)(r.z,{variant:"destructive",onClick:p,disabled:m,loading:m,children:m?"Removing...":o})]})]})}},27058:function(e,s,t){t.d(s,{H:function(){return l}});var a=t(57437),n=t(35974),r=t(94508);let l=e=>{let{status:s}=e;return(0,a.jsxs)(n.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,r.cn)("h-1.5 w-1.5 rounded-full","connected"===s?"bg-success-primary":"bg-warning-primary")}),"connected"===s?"Connected":"Not connected"]})}},93459:function(e,s,t){t.d(s,{_:function(){return c}});var a=t(2265),n=t(14438),r=t(78079),l=t(10867),i=t(64040),o=t(72384);let c=(e,s)=>{let{mutateAsync:t,isPending:c}=(0,r.m)({projectId:e,onSuccess:()=>{n.Am.success("Supabase connected",{description:"Follow the instructions in the chat to complete the integration."}),null==s||s()}});return{handleProjectSelect:(0,a.useCallback)(async s=>{if(s)try{await t({body:{id:(0,l.Fd)(),message:"Please connect my supabase project `".concat(s.name,"`"),mode:o.S.INSTANT,contains_error:!1,integrate_supabase_project_id:s.id,integrate_supabase_org_id:s.organization_id},projectId:e},{})}catch(e){(0,i.Eo)(e)}},[t,e]),isConnecting:c}}},38343:function(e,s,t){t.d(s,{c:function(){return S},n:function(){return P}});var a=t(57437),n=t(7237),r=t(56873),l=t(82176),i=t(74751),o=t(32165),c=t(2265),d=t(55721),u=t(78276),m=t(57346),h=t(56922),p=t(22876);let x=e=>{let{onProjectSelect:s,triggerComponent:t,supabaseOrganizations:n,handleConnect:r,isConnectLoading:l,isWorkspaceAdmin:i,align:o="start"}=e,[x,g]=(0,c.useState)(!1);return(0,a.jsx)(h.D,{setSelectedProject:s,setOpen:g,children:(0,a.jsxs)(d.h_,{open:x,onOpenChange:g,children:[t,(0,a.jsxs)(d.AW,{className:"w-48",align:o,children:[(0,a.jsx)(d.Ju,{className:"text-xs font-medium text-muted-foreground",children:"Supabase organizations"}),n.map(e=>(0,a.jsx)(p.K,{organization:e},e.id)),(0,a.jsx)(d.VD,{}),(0,a.jsx)(u.b,{showTooltip:!i,tooltipContent:"You are not an admin of this workspace",children:(0,a.jsxs)(d.Xi,{onClick:r,className:"text-sm",disabled:l||!i,children:[(0,a.jsx)(m.Z,{name:"add",size:"small"}),"Add organization"]})})]})]})})};var g=t(27559),f=t(35974),j=t(62869),v=t(53647),b=t(27132),y=t(65666),w=t(10531),N=t(22853),_=t(94508),k=t(37675),C=t(93459);let S=e=>{let{supabaseOrganizations:s,connectedSupabaseProject:t,setShowConnectDialog:n,isWorkspaceAdmin:r}=e,i=(0,y.D)(),c=(0,k.bk)(e=>e.isSendChatMessageMutationPending),{handleProjectSelect:d,isConnecting:u}=(0,C._)(i),m=null==t?void 0:t.status,h=null!==t&&!s.some(e=>e.id===(null==t?void 0:t.organization_id)),p=(0,l.dl)(w.P.SupabaseOnCreation);return(0,a.jsx)(o.P,{label:"Project",description:"Choose the Supabase project to sync with.",justify:"end",customBadge:(0,a.jsx)(P,{status:m||"not-connected"}),children:p?(0,a.jsx)(E,{connectedProjectIsInUnconnectedOrganization:h,supabaseOrganizations:s,isConnecting:u,isSendChatMessageMutationPending:c,isWorkspaceAdmin:r,setShowConnectDialog:n,handleProjectSelect:d,connectedSupabaseProject:t}):(0,a.jsx)(z,{connectedProjectIsInUnconnectedOrganization:h,supabaseOrganizations:s,isConnecting:u,isSendChatMessageMutationPending:c,isWorkspaceAdmin:r,setShowConnectDialog:n,handleProjectSelect:d,connectedSupabaseProject:t})})},E=e=>{let{connectedProjectIsInUnconnectedOrganization:s,supabaseOrganizations:t,isConnecting:r,isSendChatMessageMutationPending:l,isWorkspaceAdmin:i,setShowConnectDialog:o,handleProjectSelect:c,connectedSupabaseProject:d}=e;return(0,a.jsx)(x,{align:"end",onProjectSelect:e=>{e&&c(e)},triggerComponent:(0,a.jsx)(u.b,{showTooltip:!d&&l,tooltipContent:"Edits ongoing...",children:(0,a.jsx)(n.$F,{asChild:!0,children:(0,a.jsx)(j.z,{disabled:!!d||r||l,size:"sm",variant:"outline",loading:r,children:d?d.name:s?"Project not found":"Connect a project"})})}),supabaseOrganizations:t,handleConnect:()=>o(!0),isConnectLoading:r,isWorkspaceAdmin:i})},z=e=>{let{connectedSupabaseProject:s,connectedProjectIsInUnconnectedOrganization:t,supabaseOrganizations:n,isConnecting:l,isSendChatMessageMutationPending:o,isWorkspaceAdmin:c,setShowConnectDialog:d,handleProjectSelect:h}=e,p=(0,b.Z)("md");return(0,a.jsxs)(v.Ph,{value:t?void 0:(null==s?void 0:s.id)||void 0,onValueChange:e=>{let s=n.flatMap(e=>e.projects).find(s=>s.id===e);s&&h(s)},disabled:l||o||t,children:[(0,a.jsx)(u.b,{showTooltip:l||o,tooltipContent:l?"Connecting to Supabase...":"Edits ongoing...",children:(0,a.jsx)(v.i4,{className:"group relative h-7 w-auto gap-2 bg-muted px-3 py-2 font-medium text-foreground data-[placeholder]:text-foreground","data-state":s&&!(0,g.u)(s)?"checked":"",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{name:"progress_activity",className:"animate-spin",size:"small"}),(0,a.jsx)("span",{children:"Connecting..."})]}):(0,a.jsx)(v.ki,{placeholder:t?"Project not found":"Connect a project"})})}),(0,a.jsxs)(v.Bw,{align:p?"start":"end",children:[n.map(e=>{let s=[...e.projects].sort((e,s)=>(0,g.u)(e)&&!(0,g.u)(s)?-1:(0,g.u)(s)&&!(0,g.u)(e)?1:0);return(0,a.jsxs)(v.DI,{className:"w-full",children:[(0,a.jsx)(v.n5,{className:"text-xs text-muted-foreground",children:e.name}),s.map(e=>{let s=(0,g.u)(e);return(0,a.jsx)(u.b,{showTooltip:!s,tooltipContent:"Check project status in Supabase.",side:"left",instant:!0,children:(0,a.jsxs)(v.Ql,{value:e.id,disabled:!s,className:"group flex w-full items-center",children:[(0,a.jsx)("span",{className:"group-data-[state=checked]:mr-3",children:e.name}),!s&&(0,a.jsx)(m.Z,{name:"warning_fill",className:"pointer-events-auto absolute right-2 top-1/2 h-4 w-4 -translate-y-1/2 text-destructive-primary group-data-[state=checked]:right-7"})]})},e.id)}),(0,a.jsx)(j.z,{variant:"ghost",className:"flex w-full items-center justify-between gap-2 rounded-sm px-2 py-1.5 text-left font-normal hover:bg-accent",asChild:!0,children:(0,a.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",rel:"noreferrer",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{name:"add",size:"small"}),(0,a.jsx)("span",{className:"text-sm",children:"Create project"})]}),(0,a.jsx)(m.Z,{name:"arrow_outward",size:"small"})]})}),(0,a.jsx)(r.Z0,{className:"my-1"})]},e.id)}),(0,a.jsx)(u.b,{showTooltip:!c,tooltipContent:"You need to be an admin to add an organization.",side:"left",instant:!0,children:(0,a.jsxs)(j.z,{variant:"ghost",className:"flex w-full items-center justify-start gap-2 rounded-sm px-2 py-1.5 text-left font-normal hover:bg-accent",onClick:()=>d(!0),disabled:!c,children:[(0,a.jsx)(m.Z,{name:"add",size:"small"}),(0,a.jsx)("span",{className:"text-sm",children:"Add organization"}),!c&&(0,a.jsx)(i.p,{badge:"admin",className:"flex md:hidden"})]})})]})]},(null==s?void 0:s.id)||"disconnected")},A={[N.k.ACTIVE_HEALTHY]:{label:"Connected",className:"bg-success-primary"},[N.k.ACTIVE_UNHEALTHY]:{label:"Issues detected",className:"bg-warning-primary"},[N.k.COMING_UP]:{label:"Starting up",className:"bg-affirmative-primary"},[N.k.GOING_DOWN]:{label:"Shutting down",className:"bg-destructive-primary"},[N.k.INACTIVE]:{label:"Inactive",className:"bg-destructive-primary"},[N.k.INIT_FAILED]:{label:"Setup failed",className:"bg-destructive-primary"},[N.k.REMOVED]:{label:"Removed",className:"bg-destructive-primary"},[N.k.RESTARTING]:{label:"Restarting",className:"bg-warning-primary"},[N.k.UNKNOWN]:{label:"Unknown",className:"bg-destructive-primary"},[N.k.UPGRADING]:{label:"Upgrading",className:"bg-warning-primary"},[N.k.PAUSING]:{label:"Pausing",className:"bg-warning-primary"},[N.k.RESTORING]:{label:"Restoring",className:"bg-warning-primary"},[N.k.RESTORE_FAILED]:{label:"Restore failed",className:"bg-destructive-primary"},[N.k.PAUSE_FAILED]:{label:"Pause failed",className:"bg-destructive-primary"},"not-connected":{label:"Not connected",className:"bg-warning-primary"}},P=e=>{let{status:s}=e,t=A[s];return(0,a.jsxs)(f.C,{className:"flex w-auto items-center gap-1.5 bg-secondary text-xs text-foreground shadow-none hover:bg-secondary",children:[(0,a.jsx)("span",{className:(0,_.cn)("h-1.5 w-1.5 rounded-full",t.className)}),t.label]})}},74456:function(e,s,t){t.d(s,{default:function(){return rp}});var a,n,r,l,i=t(57437),o=t(2265),c=t(44481),d=t(52558),u=t(61922),m=t(92850),h=t(66870),p=t(33187),x=t(60936),g=t(66491),f=t(14376),j=t(5481),v=t(56940),b=t(97059),y=t(62994),w=t(23263),N=t(22287),_=t(47625),k=t(8147),C=t(22190),S=t(94508);let E={light:"",dark:".dark"},z=o.createContext(null);function A(e){let{id:s,className:t,children:a,config:n,...r}=e,l=o.useId(),c="chart-".concat(s||l.replace(/:/g,""));return(0,i.jsx)(z.Provider,{value:{config:n},children:(0,i.jsxs)("div",{"data-slot":"chart","data-chart":c,className:(0,S.cn)("[&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-surface]:outline-hidden flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent",t),...r,children:[(0,i.jsx)(P,{id:c,config:n}),(0,i.jsx)(_.h,{children:a})]})})}let P=e=>{let{id:s,config:t}=e,a=Object.entries(t).filter(e=>{let[,s]=e;return s.theme||s.color});return a.length?(0,i.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(E).map(e=>{let[t,n]=e;return"\n".concat(n," [data-chart=").concat(s,"] {\n").concat(a.map(e=>{var s;let[a,n]=e,r=(null===(s=n.theme)||void 0===s?void 0:s[t])||n.color;return r?"  --color-".concat(a,": ").concat(r,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},O=k.u;function D(e){let{active:s,payload:t,className:a,indicator:n="dot",hideLabel:r=!1,hideIndicator:l=!1,label:c,labelFormatter:d,labelClassName:u,formatter:m,color:h,nameKey:p,labelKey:x}=e,{config:g}=function(){let e=o.useContext(z);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}(),f=o.useMemo(()=>{var e;if(r||!(null==t?void 0:t.length))return null;let[s]=t,a="".concat(x||(null==s?void 0:s.dataKey)||(null==s?void 0:s.name)||"value"),n=I(g,s,a),l=x||"string"!=typeof c?null==n?void 0:n.label:(null===(e=g[c])||void 0===e?void 0:e.label)||c;return d?(0,i.jsx)("div",{className:(0,S.cn)("font-medium",u),children:d(l,t)}):l?(0,i.jsx)("div",{className:(0,S.cn)("font-medium",u),children:l}):null},[c,d,t,r,u,g,x]);if(!s||!(null==t?void 0:t.length))return null;let j=1===t.length&&"dot"!==n;return(0,i.jsxs)("div",{className:(0,S.cn)("grid min-w-32 items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[j?null:f,(0,i.jsx)("div",{className:"grid gap-1.5",children:t.map((e,s)=>{let t="".concat(p||e.name||e.dataKey||"value"),a=I(g,e,t),r=h||e.payload.fill||e.color;return(0,i.jsx)("div",{className:(0,S.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:m&&(null==e?void 0:e.value)!==void 0&&e.name?m(e.value,e.name,e,s,e.payload):(0,i.jsxs)(i.Fragment,{children:[(null==a?void 0:a.icon)?(0,i.jsx)(a.icon,{}):!l&&(0,i.jsx)("div",{className:(0,S.cn)("border-(--color-border) bg-(--color-bg) shrink-0 rounded-[2px]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":j&&"dashed"===n}),style:{"--color-bg":r,"--color-border":r}}),(0,i.jsxs)("div",{className:(0,S.cn)("flex flex-1 justify-between leading-none",j?"items-end":"items-center"),children:[(0,i.jsxs)("div",{className:"grid gap-1.5",children:[j?f:null,(0,i.jsx)("span",{className:"text-muted-foreground",children:(null==a?void 0:a.label)||e.name})]}),e.value&&(0,i.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}function I(e,s,t){if("object"!=typeof s||null===s)return;let a="payload"in s&&"object"==typeof s.payload&&null!==s.payload?s.payload:void 0,n=t;return s&&t in s&&"string"==typeof s[t]?n=s[t]:a&&t in a&&"string"==typeof a[t]&&(n=a[t]),n in e?e[n]:e[t]}C.D;let T={totalVisits:"Visitors",totalPageviews:"Pageviews",pageviewsPerVisit:"Pageviews Per Visit"};function L(e){let s=Math.floor(e/3600),t=Math.floor(e%3600/60),a="";return s>0&&(a+="".concat(s,"h ")),(t>0||s>0)&&(a+="".concat(t,"m ")),(a+="".concat(Math.floor(e%60),"s")).trim()}let R=e=>e<1e3?e.toString():e<1e6?"".concat((e/1e3).toFixed(1).replace(/\.0$/,""),"k"):"".concat((e/1e6).toFixed(1).replace(/\.0$/,""),"m");var F=t(56942),M=t(7641),Z=t(64975),q=t(63070);let U=e=>{if(e)try{return Intl.DateTimeFormat(void 0,{timeZone:e}),e}catch(s){console.error("Invalid timezone: ".concat(e,", falling back to local timezone"))}return Intl.DateTimeFormat().resolvedOptions().timeZone},W=(e,s)=>(0,f.Nm)(e,s).toISOString(),K=(e,s)=>{let t=(0,f.zW)(e,s),a=(0,F.b)(t);return(0,f.Nm)(a,s)},G=(e,s)=>{let t=(0,f.zW)(e,s),a=(0,M.i)(t);return(0,f.Nm)(a,s)},V=e=>{let s=U(e),t=new Date;return{startDate:W(new Date(t.getTime()-6048e5),s),endDate:W(t,s),granularity:"daily",preset:"7d"}},B={today:{label:"Today",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W(K(t,s),s),endDate:W(G(t,s),s),granularity:"hourly",preset:"today"}}},yesterday:{label:"Yesterday",getTimePeriod:e=>{let s=U(e),t=(0,Z.k)(new Date,1);return{startDate:W(K(t,s),s),endDate:W(G(t,s),s),granularity:"hourly",preset:"yesterday"}}},"24h":{label:"Last 24 hours",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W((0,Z.k)(t,1),s),endDate:W(t,s),granularity:"hourly",preset:"24h"}}},"7d":{label:"Last 7 days",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W((0,Z.k)(t,7),s),endDate:W(t,s),granularity:"daily",preset:"7d"}}},"14d":{label:"Last 14 days",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W((0,Z.k)(t,14),s),endDate:W(t,s),granularity:"daily",preset:"14d"}}},"30d":{label:"Last 30 days",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W((0,Z.k)(t,30),s),endDate:W(t,s),granularity:"daily",preset:"30d"}}},"90d":{label:"Last 90 days",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W((0,Z.k)(t,90),s),endDate:W(t,s),granularity:"daily",preset:"90d"}}},month:{label:"This month",getTimePeriod:e=>{let s=U(e),t=new Date;return{startDate:W((0,q.N)(t),s),endDate:W(t,s),granularity:"daily",preset:"month"}}}},H={value:{label:"Views"}},J=e=>{let{data:s,valueType:t="number",granularity:a,selectedMetric:n,isLoading:r,userTimezone:l}=e,c=(0,o.useCallback)((e,s)=>{let t=(0,x.D)(e),a=(0,f.zW)(t,U(l));return(0,g.WU)(a,s)},[l]);return(0,i.jsx)("div",{className:"w-full rounded-xl border bg-muted p-4",children:r?(0,i.jsx)("div",{className:"flex h-[200px] w-full items-center justify-center md:h-[400px]",children:(0,i.jsx)(N.$,{})}):(0,i.jsx)(A,{config:H,className:"h-[200px] w-full md:h-[400px]",children:(0,i.jsxs)(j.T,{data:s,margin:{left:"time"===t?0:-15,right:10,top:20,bottom:5},children:[(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:"fillGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,i.jsx)("stop",{offset:"5%",stopColor:"var(--chart-1)",stopOpacity:.2}),(0,i.jsx)("stop",{offset:"95%",stopColor:"var(--chart-1)",stopOpacity:.02})]})}),(0,i.jsx)(v.q,{horizontal:!0,vertical:!1,stroke:"hsl(var(--muted-border))"}),(0,i.jsx)(b.K,{dataKey:"date",tickLine:!1,tickMargin:10,tickCount:5,tickFormatter:e=>{switch(a){case"hourly":return c(e,"HH:mm");case"daily":return c(e,"d MMM")}}}),(0,i.jsx)(y.B,{dataKey:"value",tickLine:!1,axisLine:!1,tickMargin:10,tickCount:5,tickFormatter:e=>{switch(t){case"number":return R(e);case"percentage":return"".concat(e,"%");case"time":return L(e)}}}),(0,i.jsx)(w.u,{dataKey:"value",strokeWidth:2,stroke:"var(--chart-1)",dot:!1,fill:"url(#fillGradient)",animationDuration:500,animationEasing:"ease-in-out"}),(0,i.jsx)(O,{cursor:!1,content:(0,i.jsx)(D,{formatter:e=>(0,i.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,i.jsx)("span",{className:"mr-1 h-3 w-3 rounded-full bg-chart-1"})," ",(0,i.jsx)("span",{className:"font-medium",children:e})," ",(0,i.jsx)("span",{className:"",children:T[n]})]}),labelFormatter:e=>{let s="";return s="hourly"===a?c(e,"d MMM, HH:mm"):c(e,"d MMM"),(0,i.jsx)("p",{className:"text-sm",children:s})}})})]})})})};var Q=t(93022),Y=t(81103);let X=/./g,$=e=>e.toUpperCase().replace(X,e=>String.fromCodePoint(127397+e.charCodeAt(0))),ee=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";try{return new Intl.DisplayNames([s],{type:"region"}).of(e.toUpperCase())||e}catch(s){return e}},es=e=>{let{type:s,label:t}=e;switch(s){case"country":return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"origin-left scale-[1.35] transform",children:$(t)}),(0,i.jsx)("span",{children:ee(t)})]});case"device":return t.charAt(0).toUpperCase()+t.slice(1);default:return t}},et=e=>{switch(e){case"country":return"The top countries your visitors are from.";case"device":return"The most used devices by your visitors.";case"source":return"The most common sources of traffic to your app.";case"page":return"The most viewed pages in your app."}},ea=e=>{let{type:s,value:t,total:a}=e;if("device"===s){let e=t/a*100;return"".concat(e.toFixed(1),"%")}return R(t)},en=e=>{let{data:s,type:t,metric:a,color:n,isLoading:r}=e,l=Math.max(...s.map(e=>e.value)),o=s.sort((e,s)=>s.value-e.value),c=s.reduce((e,s)=>e+s.value,0);return(0,i.jsxs)("div",{className:"flex flex-col gap-4 rounded-xl border border-border bg-muted p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm font-medium",children:[(0,i.jsxs)(Y.u,{instant:!0,children:[(0,i.jsx)(Y.aJ,{children:(0,i.jsx)("p",{className:"capitalize",children:t})}),(0,i.jsx)(Y._v,{children:et(t)})]}),(0,i.jsx)("p",{children:a})]}),!r&&o.length>0&&o.map(e=>{let s=e.value/l*100,r=es({type:t,label:e.label}),o=ea({type:t,value:e.value,total:c});return(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4 text-sm",children:[(0,i.jsxs)("div",{className:"relative flex-1 px-2 py-1",children:[(0,i.jsx)("div",{className:"absolute inset-y-0 left-0 rounded-md bg-accent",style:{width:"".concat(s,"%"),minWidth:"10px",backgroundColor:n}}),(0,i.jsx)("p",{className:"relative z-10 flex items-center gap-3",children:r})]}),(0,i.jsxs)(Y.u,{delayDuration:0,children:[(0,i.jsx)(Y.aJ,{children:(0,i.jsx)("p",{children:o})}),(0,i.jsx)(Y._v,{children:(0,i.jsxs)("p",{children:[e.value," ",a]})})]})]},e.label)}),!r&&0===o.length&&(0,i.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:"No data found for this time period."}),r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)(Q.O,{className:"h-6 flex-1"}),(0,i.jsx)(Q.O,{className:"h-6 w-8"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)(Q.O,{className:"h-6 w-1/2"}),(0,i.jsx)(Q.O,{className:"h-6 w-8"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,i.jsx)(Q.O,{className:"h-6 w-1/4"}),(0,i.jsx)(Q.O,{className:"h-6 w-8"})]})]})]})};var er=t(57346);let el=e=>{let{title:s,value:t,valueType:a="number",changePercentage:n,onClick:r,isSelected:l,isLoading:o}=e,c=n&&n>0,d=n&&0===n;return(0,i.jsxs)(Y.u,{delayDuration:0,children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsxs)("div",{className:(0,S.cn)("group flex cursor-pointer flex-col gap-2 rounded-xl border bg-muted p-4",l&&"border-accent-primary/50"),onClick:r,children:[(0,i.jsx)("p",{className:(0,S.cn)("text-sm font-medium group-hover:text-accent-primary",l&&"text-accent-primary"),children:s}),(0,i.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.jsx)("p",{className:"h-5 font-medium",children:o?(0,i.jsx)(Q.O,{className:"h-full w-8"}):(()=>{switch(a){case"number":return R(t);case"percentage":return"".concat(t,"%");case"time":return L(t)}})()}),n&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:(0,S.cn)("flex items-center gap-1",c?"text-success-primary":d?"text-warning-primary":"text-destructive-primary"),children:[(0,i.jsx)(er.Z,{name:c?"trending_up":d?"trending_flat":"trending_down",size:"small"}),(0,i.jsxs)("p",{className:"text-sm",children:[n,"%"]})]})})]})]})}),(0,i.jsx)(Y._v,{className:"",children:(0,i.jsxs)("p",{children:[(0,i.jsx)("span",{className:"font-medium",children:t})," ",(0,i.jsx)("span",{className:"",children:s.toLowerCase()})]})})]})};var ei=t(62869),eo=t(55721),ec=t(27132);let ed=e=>{let{selectedTimePeriod:s,setSelectedTimePeriod:t,userTimezone:a}=e,n=(0,ec.Z)("md"),r=(0,o.useMemo)(()=>Object.entries(B).map(e=>{let[s,t]=e,n=t.getTimePeriod(a);return{key:s,label:t.label,timePeriod:n}}),[a]),l=B[s.preset].label;return(0,i.jsxs)(eo.h_,{children:[(0,i.jsx)(eo.$F,{asChild:!0,children:(0,i.jsxs)(ei.z,{variant:"outline",className:"justify-between text-foreground md:min-w-32 md:px-3",size:n?"sm":"default",children:[l,(0,i.jsx)(er.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,i.jsx)(eo.AW,{align:"end",className:"min-w-32",children:r.map(e=>(0,i.jsx)(eo.Xi,{onClick:()=>t(e.timePeriod),children:e.label},e.key))})]})},eu=e=>{var s,t,a,n,r,l,c,d;let{project:u}=e,[x,g]=(0,o.useState)("totalVisits"),[f,j]=(0,o.useState)(V),{data:v,isLoading:b}=(0,m.a)(p.W.analytics({projectId:u.id,timePeriod:f}));return u.url?(0,i.jsxs)(h.tM,{title:"Analytics",value:"analytics",description:(0,i.jsxs)("p",{children:["Measure how your published project is performing. View"," ",(0,i.jsx)("a",{href:null!==(s=u.url)&&void 0!==s?s:"".concat(u.name,".lovable.app"),target:"_blank",rel:"noopener noreferrer",className:"font-medium hover:underline",children:"your app live."})]}),descriptionAction:(0,i.jsx)(ed,{selectedTimePeriod:f,setSelectedTimePeriod:j}),children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-6 md:grid-cols-3",children:[(0,i.jsx)(el,{title:"Visitors",value:null!==(t=null==v?void 0:v.timeSeries.visitors.total)&&void 0!==t?t:0,onClick:()=>g("totalVisits"),isSelected:"totalVisits"===x,isLoading:b}),(0,i.jsx)(el,{title:"Pageviews",value:null!==(a=null==v?void 0:v.timeSeries.pageviews.total)&&void 0!==a?a:0,onClick:()=>g("totalPageviews"),isSelected:"totalPageviews"===x,isLoading:b}),(0,i.jsx)(el,{title:"Pageviews Per Visit",value:null!==(n=null==v?void 0:v.timeSeries.pageviewsPerVisit.total)&&void 0!==n?n:0,onClick:()=>g("pageviewsPerVisit"),isSelected:"pageviewsPerVisit"===x,isLoading:b})]}),(0,i.jsx)(J,{data:(()=>{if(!v)return[];switch(x){case"totalVisits":default:return v.timeSeries.visitors.data;case"totalPageviews":return v.timeSeries.pageviews.data;case"pageviewsPerVisit":return v.timeSeries.pageviewsPerVisit.data}})(),valueType:"number",granularity:f.granularity,selectedMetric:x,isLoading:b}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,i.jsx)(en,{data:null!==(r=null==v?void 0:v.lists.source.data)&&void 0!==r?r:[],type:"source",metric:"Visitors",isLoading:b}),(0,i.jsx)(en,{data:null!==(l=null==v?void 0:v.lists.page.data)&&void 0!==l?l:[],type:"page",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:b}),(0,i.jsx)(en,{data:null!==(c=null==v?void 0:v.lists.country.data)&&void 0!==c?c:[],type:"country",metric:"Visitors",color:"hsl(var(--brand-twilight))",isLoading:b}),(0,i.jsx)(en,{data:null!==(d=null==v?void 0:v.lists.device.data)&&void 0!==d?d:[],type:"device",metric:"Visitors",isLoading:b})]})]}):(0,i.jsx)(h.tM,{title:"Analytics",value:"analytics",description:"Measure how your published project is performing.",children:(0,i.jsx)("div",{className:"flex w-full justify-center",children:(0,i.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:"To view analytics, you first need to publish your project."})})})};var em=t(22048),eh=t(58912),ep=t.n(eh),ex=t(27648),eg=t(46214),ef=t(14438),ej=t(76678),ev=t(82176),eb=t(60256),ey=t(93261),ew=t(88391),eN=t(32165),e_=t(49131);let ek=e=>{let s="development"===e?"185.158.133.10":"185.158.133.1";return{domain:[{type:"A",host:"@",value:s,ttl:300},{type:"A",host:"www",value:s,ttl:300}],subDomain:[{type:"A",host:"{SUBDOMAIN}",value:s,ttl:300}]}};var eC=t(21288),eS=t(10531),eE=t(10441),ez=t(74225),eA=t(5460),eP=t(71759),eO=e=>{let{project:s}=e,{userData:t}=(0,eb.SE)(),{data:a,refetch:n}=(0,m.a)(eE.c.domains({projectId:s.id})),r=(0,eP.hO)(e=>e.projectWorkspace),[l,c]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{let e=(0,e_.SJ)();c(await e.get("/entri/token"))})(),ep().load()},[]);let d=(0,ew.z)(ej.g),u=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("free"===(null==r?void 0:r.plan)){d({childProps:{dialogDescription:"You need to be on a pro plan to connect a domain."}});return}if(!(null==s?void 0:s.url)){(0,e_.SJ)().post("/projects/".concat(null==s?void 0:s.id,"/deployments"),{}).catch(e=>{eC.logging.error("Error publishing project",e),ef.Am.error("Error when publishing your project",{description:e.message}),em.Tb(e)});try{await (0,eA.G)({projectId:null==s?void 0:s.id})}catch(e){eC.logging.error("Error updating last deployment ID",e),ef.Am.error("Error when updating deployment cache. Please report this.",{description:e.message}),em.Tb(e)}}if(null===l)return;let a={...l,dnsRecords:ek("production"),userId:null==s?void 0:s.id,monitor:!0,sellVersion:"v3",whiteLabel:{customCopy:{initialScreen:{title:{en:"Use your domain with Lovable"}}},theme:{primary:"#000000",secondary:"#000000",onSecondary:"#FFFFFF",headerBackground:"#000000"},logo:"https://lovable.dev/apple-icon.png",sell:{partnerName:"Lovable",partnerLogo:"https://lovable.dev/img/lovable-logo-text-nav.png",partnerUrl:"https://lovable.dev",overlayScreenHeight:"75%",flowTarget:"_blank"}}};try{"buy"===e?(a.prefilledDomain=(null==s?void 0:s.name)+".com",ep().purchaseDomain(a)):ep().showEntri(a)}catch(s){if(!t){let s=(0,e_.SJ)();c(await s.get("/entri/token")),u(e,!0)}}eg.ZP.capture("domain_connecting_attempt",{mode:e})},h=async e=>{if(e.detail.success){let t=ef.Am.success("Connecting domain...",{description:"Hold on while we were mapping ".concat(e.detail.domain," to your project.")});try{let t=(0,e_.SJ)();await t.post("/projects/".concat(null==s?void 0:s.id,"/domains"),{domain:e.detail.domain}),n(),ef.Am.success("Domain connected!",{description:"The domain ".concat(e.detail.domain," is now mapped to your project. It might take a few minutes to propagate.")}),eg.ZP.capture("domain_connected",{mode:"purchase"===e.detail.setupType?"buy":"connect"})}catch(e){ef.Am.info("Domain not connected",{description:"There was an error while connecting your domain. Please try again."}),em.Tb(e)}ef.Am.dismiss(t)}};(0,o.useEffect)(()=>(window.addEventListener("onEntriClose",h,!1),()=>{window.removeEventListener("onEntriClose",h)}),[]);let p=(0,ev.dl)(eS.P.CustomDomainsBuy)||!1;return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(eN.P,{label:"Connected Domains",description:"View or remove domains linked to your project.",justify:"end",children:(0,i.jsxs)("ul",{className:"flex flex-col gap-2",children:[(null==s?void 0:s.url)?(0,i.jsx)(ey.Z,{showRemove:!1,showIcon:!0,domain:{domain:(0,ez.P)(null==s?void 0:s.url),status:"active"}}):(0,i.jsx)("li",{className:"flex items-center",children:(0,i.jsxs)("span",{className:"flex-grow text-sm text-muted-foreground",title:"You have to publish your project for this domain to work",children:[null==s?void 0:s.name,".lovable.app"]})}),null==a?void 0:a.map((e,s)=>(0,i.jsx)(ey.Z,{domain:e,showRemove:!0,showIcon:!0,refetchDomains:n},s))]})}),(0,i.jsx)(eN.P,{label:"Add Existing Domain",description:"Connect a domain you already own.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(ei.z,{variant:"outline",size:"sm",type:"button",onClick:()=>u("connect"),className:"whitespace-nowrap",children:a&&0===a.length?"Connect Domain":"Connect Another Domain"})}),p&&(0,i.jsx)(eN.P,{label:"Purchase New Domain",description:"Buy a new domain through Ionos.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(ei.z,{variant:"outline",size:"sm",type:"button",onClick:()=>u("buy"),className:"whitespace-nowrap",children:"Buy Domain"})}),(0,i.jsx)("div",{className:"flex justify-end",children:(0,i.jsx)(ei.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,i.jsxs)(ex.default,{href:"https://docs.lovable.dev/tips-tricks/custom-domain",target:"_blank",children:["How Domains Work ",(0,i.jsx)(er.Z,{name:"arrow_outward",size:"small"})]})})})]})},eD=t(76818),eI=t(49284),eT=t(77113),eL=()=>{let[e,s]=(0,o.useState)(""),t=(0,eT.iZ)(e=>e.project);(0,o.useEffect)(()=>{(null==t?void 0:t.custom_instructions)&&s(t.custom_instructions)},[t]);let{updateProject:a}=(0,eT.d2)(),n=async()=>{try{a({custom_instructions:e},{onSuccess:()=>{eg.ZP.capture(eI.SL.KNOWLEDGE.SAVED),ef.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),l(!1)}catch(e){ef.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}},[r,l]=(0,o.useState)(!1),c=e.length,d=c>1e5;return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"mb-2 flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-base font-medium",children:"Instructions & Guidelines"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Provide guidelines and context to improve your project’s edits. Use this space to:"}),(0,i.jsxs)("ul",{className:"list-disc pl-6 text-sm text-muted-foreground",children:[(0,i.jsx)("li",{children:"Set project-specific rules or best practices."}),(0,i.jsx)("li",{children:"Set coding style preferences (e.g. indentation, naming conventions)."}),(0,i.jsx)("li",{children:"Include external documentation or style guides."})]})]}),(0,i.jsx)(eD.g,{value:e,onChange:e=>{s(e.target.value),e.target.value!==(null==t?void 0:t.custom_instructions)?l(!0):l(!1)},placeholder:"Enter your instructions here...",className:(0,S.cn)("resize-none"),rows:14}),(0,i.jsx)("div",{className:(0,S.cn)("flex justify-end",r&&"mb-12"),children:(0,i.jsx)(ei.z,{variant:"outline",size:"sm",type:"button",asChild:!0,children:(0,i.jsxs)(ex.default,{href:"https://docs.lovable.dev/features/knowledge",target:"_blank",children:["Get Inspiration ",(0,i.jsx)(er.Z,{name:"arrow_outward",size:"small"})]})})}),r&&(0,i.jsxs)(eN.j,{className:"justify-end gap-3",children:[d&&(0,i.jsxs)("div",{className:"mr-auto text-sm text-destructive-foreground",children:["Message is too long. Exceeded by ",c-1e5," ","characters."]}),(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{s((null==t?void 0:t.custom_instructions)||""),l(!1)},children:"Cancel"}),(0,i.jsx)(ei.z,{onClick:n,variant:"affirmative",disabled:d,children:"Save"})]})]})},eR=t(29827),eF=t(53647);let eM=e=>{let{project:s,onCategoryChange:t,disabled:a=!1}=e;return(0,i.jsx)(eN.P,{label:"Project Category",description:"Categorize your project to help others find it.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsxs)(eF.Ph,{defaultValue:(null==s?void 0:s.category)||"",onValueChange:e=>{t(e)},disabled:a,children:[(0,i.jsx)(eF.i4,{className:"w-[180px] border-none",children:(0,i.jsx)(eF.ki,{placeholder:"Select category"})}),(0,i.jsxs)(eF.Bw,{children:[(0,i.jsx)(eF.Ql,{value:"internal_tools",children:"Internal Tools"}),(0,i.jsx)(eF.Ql,{value:"website",children:"Website"}),(0,i.jsx)(eF.Ql,{value:"personal",children:"Personal"}),(0,i.jsx)(eF.Ql,{value:"consumer_app",children:"Consumer App"}),(0,i.jsx)(eF.Ql,{value:"b2b_app",children:"B2B App"}),(0,i.jsx)(eF.Ql,{value:"prototype",children:"Prototype"})]})]})})};var eZ=t(6812),eq=t(6512);let eU={Title:e=>{let{title:s,description:t,className:a,...n}=e;return(0,i.jsxs)("div",{className:(0,S.cn)("flex flex-col",a),...n,children:[(0,i.jsx)("h2",{children:s}),t&&(0,i.jsx)("p",{className:"text-muted-foreground",children:t})]})},Entry:e=>{let{label:s,value:t}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,i.jsx)("p",{className:"font-medium",children:s}),"string"==typeof t?(0,i.jsx)("p",{className:"text-muted-foreground",children:t}):t]})},Separator:eq.Separator};var eW=t(12285),eK=t(59702),eG=t(79117),eV=t(1828),eB=t(2043),eH=t(97318),eJ=t(46170),eQ=t(3813),eY=t(55157),eX=t(78276);let e$=e=>{let{visibility:s,setVisibility:t,redirectToSubscription:a=!1,workspacePlan:n,className:r,disabled:l,disabledTooltipContent:o}=e,c=(0,eQ.sp)(),d=(0,eb.dF)({workspacePlan:n}),{openSettings:u}=(0,eY.r)(),m=(0,ew.z)(ej.g);return(0,i.jsx)(eX.b,{showTooltip:!!(l&&o),tooltipContent:(0,i.jsx)("p",{children:o}),children:(0,i.jsxs)(eF.Ph,{value:s,onValueChange:e=>{"private"!==e||d?t(e):a?u("billing"):m({childProps:{dialogDescription:"You need to be on a pro plan to make your project private."}})},disabled:l,children:[(0,i.jsx)(eF.i4,{className:(0,S.cn)("w-[180px]",r),children:(0,i.jsx)(eF.ki,{placeholder:"Select visibility"})}),(0,i.jsxs)(eF.Bw,{children:[(0,i.jsx)(eF.Ql,{value:"public",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(er.Z,{name:"globe",size:"small"}),(0,i.jsx)("span",{children:"Public"})]})}),(0,i.jsx)(eF.Ql,{value:"private",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(er.Z,{name:"group",size:"small"}),(0,i.jsx)("span",{children:"Workspace"})]})}),!!c&&(0,i.jsx)(eF.Ql,{value:"draft",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(er.Z,{name:"lock",size:"small"}),(0,i.jsx)("span",{children:"Draft"})]})})]})]})})},e0=e=>{let{className:s,isAdmin:t}=e,a=(0,eP.hO)(e=>{var s;return(null===(s=e.projectWorkspace)||void 0===s?void 0:s.plan)||null}),n=(0,eT.iZ)(e=>{var s;return null===(s=e.project)||void 0===s?void 0:s.visibility}),[r,l]=(0,o.useState)(void 0),{setVisibilityMutation:c}=(0,eT.d2)(),{disableChangeVisibility:d,disabledTooltipContent:u}=(0,o.useMemo)(()=>t?{disableChangeVisibility:!1,disabledTooltipContent:void 0}:{disableChangeVisibility:!0,disabledTooltipContent:"You need to be an admin to change the visibility of your project."},[t]);return(0,o.useEffect)(()=>{n&&l(n)},[n]),(0,i.jsx)(e$,{disabled:d||c.isPending,disabledTooltipContent:u,workspacePlan:a,visibility:r||n||void 0,setVisibility:e=>{l(e),c.mutateAsync(e)},className:s})},e1=e=>{var s;let{isPaidUser:t,className:a}=e,{setBadgeVisibility:n}=(0,eT.d2)(),r=(0,eT.iZ)(e=>e.project),l=(0,ew.z)(ej.g),[c,d]=(0,o.useState)(null!==(s=null==r?void 0:r.hide_badge)&&void 0!==s&&s);return(0,i.jsx)(eV.r,{checked:c,onCheckedChange:e=>{if(!t){l({childProps:{dialogDescription:'You need to be on a pro plan to hide the "Edit with Lovable" badge.'}});return}n(e),d(e)},disabled:!1,className:(0,S.cn)("",a)})};var e2=t(21770),e4=t(64040);let e5=e=>{let{projectId:s,initialFeatured:t,className:a}=e,[n,r]=(0,o.useState)(t),l=(0,e2.D)({mutationFn:e=>{let{featured:t}=e;return(0,e_.SJ)().put("/projects/".concat(s,"/featured"),{featured:t})},onSuccess:(e,s)=>{let{featured:t}=s;r(t),ef.Am.success("Featured status updated",{description:"Project is now ".concat(t?"featured":"not featured",".")})},onError:e=>{(0,e4.Eo)(e)}});return(0,i.jsx)(eV.r,{disabled:l.isPending,checked:n,onCheckedChange:e=>{l.mutate({featured:e})},className:(0,S.cn)("",a)})},e6=e=>(null==e?void 0:e.seconds)?(0,g.WU)(new Date(1e3*e.seconds),"yyyy-MM-dd HH:mm:ss"):void 0;var e3=e=>{var s,t,a,n;let{projectId:r}=e,{isProjectAdmin:l,canEdit:c}=(0,eB.t)(),[d,u]=(0,o.useState)(!1),[m,h]=(0,o.useState)(!1),p=(0,eP.hO)(e=>e.projectWorkspace),x=(0,eP.hO)(e=>{var s;return(null===(s=e.projectWorkspace)||void 0===s?void 0:s.plan)||null}),g=(0,ev.dl)(eS.P.Templates)||!1,f=(0,eT.iZ)(e=>e.project),{userData:j}=(0,eb.SE)(),v=!!(null==f?void 0:f.is_supabase_enabled)||!!(null==f?void 0:f.supabase_project_config),b=c||!v,{updateProject:y,setIsRemixDialogOpen:w}=(0,eT.d2)(),N=(0,eR.NL)(),_=async()=>{y({is_template:!(null==f?void 0:f.is_template)},{onSuccess:()=>{N.invalidateQueries({queryKey:eH.E.libraries((null==p?void 0:p.id)||"")})}})},k=(0,ew.z)(ej.g),C=(0,eZ.Q)(e=>e.workspaces).length>1,S=(0,eJ.XB)(null!=x?x:void 0),E=(0,o.useMemo)(()=>(0,i.jsx)("span",{onClick:()=>{k({childProps:{dialogDescription:"Upgrade to Pro to unlock this feature."}})},className:"cursor-pointer text-sm text-muted-foreground underline transition-opacity duration-150 ease-in-out hover:opacity-75",children:"Upgrade your plan"}),[k]);return(0,i.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,i.jsx)("p",{className:"col-span-full font-medium",children:"Overview"}),(0,i.jsx)(eU.Entry,{label:"Project name",value:null==f?void 0:f.name}),(0,i.jsx)(eU.Entry,{label:"Owner",value:(null==f?void 0:f.created_by)&&(0,i.jsxs)(ex.default,{className:"break-words text-sm text-muted-foreground underline",target:"_blank",href:"/@".concat(f.created_by),children:["@",f.created_by]})}),(0,i.jsx)(eU.Entry,{label:"Created at",value:e6(null==f?void 0:f.created_at)}),(null==f?void 0:null===(s=f.creation_options)||void 0===s?void 0:s.tech_stack)&&(0,i.jsx)(eU.Entry,{label:"Tech stack",value:null==f?void 0:null===(t=f.creation_options)||void 0===t?void 0:t.tech_stack}),(0,i.jsx)(eU.Entry,{label:"Messages count",value:(null==f?void 0:null===(a=f.user_message_count)||void 0===a?void 0:a.toString())||"0"}),(0,i.jsx)(eU.Entry,{label:"AI Edits count",value:(null==f?void 0:null===(n=f.edit_count)||void 0===n?void 0:n.toString())||"0"})]}),(0,i.jsx)(eU.Separator,{}),(0,i.jsx)(eN.P,{label:"Private Project",description:S?"Keep your project hidden and prevent others from remixing it.":(0,i.jsxs)("p",{children:[E," to keep your project hidden and prevent others from remixing it."]}),mobileLayout:"vertical",justify:"end",badges:["pro"],children:(0,i.jsx)(e0,{isAdmin:l})}),(0,i.jsx)(eN.P,{label:'Hide "Lovable" Badge',description:S?'Remove the "Edit with Lovable" badge from your published work.':(0,i.jsxs)("p",{children:[E,' to remove the \'"Edit with Lovable" badge from your published work.']}),mobileLayout:"horizontal",justify:"end",badges:["pro"],children:(0,i.jsx)(e1,{isPaidUser:S})}),f&&(null==j?void 0:j.is_admin)&&(0,i.jsx)(eN.P,{label:"Feature Project",description:"Highlight this project on the homepage.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(e5,{projectId:r,initialFeatured:!!f.featured})}),f&&c&&(0,i.jsx)(eN.P,{label:"Rename Project",description:"Update your project's title.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(ei.z,{onClick:()=>u(!0),children:"Rename project"})}),f&&(0,i.jsx)(eN.P,{label:"Remix Project",description:"Remix this project.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsxs)(ei.z,{onClick:()=>w(!0),disabled:!b,children:["Remix this project",!b&&(0,i.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:"(Unavailable for Supabase projects)"})]})}),f&&l&&(0,i.jsx)(eN.P,{label:"Delete Project",description:"Delete this project.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(ei.z,{variant:"destructive",onClick:()=>h(!0),children:"Delete this project"})}),l&&C&&(0,i.jsx)(eN.P,{label:"Transfer Project",description:"Move the project to a different workspace.",mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(eW.O,{projectId:r,currentWorkspaceId:null==f?void 0:f.workspace_id})}),g&&(0,i.jsx)(eN.P,{label:"Publish as a Library",description:(0,i.jsxs)("p",{children:["Publish to"," ",(0,i.jsx)("span",{className:"font-medium",children:(null==p?void 0:p.name)?p.name:"your workspace"})," ","to use this project to start new projects."]}),mobileLayout:"horizontal",justify:"end",children:(0,i.jsx)(eV.r,{defaultChecked:(null==f?void 0:f.is_template)||!1,onCheckedChange:_})}),f&&(0,i.jsx)(eM,{project:f,onCategoryChange:e=>y({category:e}),disabled:!c}),f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eG.i,{project:f,isOpen:d,onClose:()=>u(!1)}),(0,i.jsx)(eK.p,{project:f,isOpen:m,onClose:()=>h(!1)})]})]})},e8=t(49027),e7=t(95098),e9=t(26110),se=t(4216);let ss=e=>{let{shouldScaleBackground:s=!0,...t}=e;return(0,i.jsx)(se.dy.Root,{shouldScaleBackground:s,...t})};ss.displayName="Drawer",se.dy.Trigger;let st=se.dy.Portal;se.dy.Close;let sa=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(se.dy.Overlay,{ref:s,className:(0,S.cn)("fixed inset-0 z-[10000] bg-black/80",t),...a})});sa.displayName=se.dy.Overlay.displayName;let sn=o.forwardRef((e,s)=>{let{className:t,children:a,...n}=e;return(0,i.jsxs)(st,{children:[(0,i.jsx)(sa,{}),(0,i.jsxs)(se.dy.Content,{ref:s,className:(0,S.cn)("fixed inset-x-0 bottom-0 z-[10000] mt-24 flex h-auto flex-col rounded-t-[24px] border bg-background",t),...n,children:[(0,i.jsx)("div",{className:"mx-auto mt-4 h-1.5 w-[60px] rounded-full bg-muted"}),a]})]})});sn.displayName="DrawerContent";let sr=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(se.dy.Title,{ref:s,className:(0,S.cn)("text-lg font-medium leading-none tracking-tight",t),...a})});sr.displayName=se.dy.Title.displayName;let sl=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(se.dy.Description,{ref:s,className:(0,S.cn)("text-sm text-muted-foreground",t),...a})});sl.displayName=se.dy.Description.displayName;let si=e=>{let{children:s,open:t,onOpenChange:a}=e;return(0,ec.Z)("md")?(0,i.jsx)(ss,{open:t,onOpenChange:a,children:(0,i.jsx)(sc,{children:s})}):(0,i.jsx)(e9.Vq,{open:t,onOpenChange:a,children:(0,i.jsx)(so,{children:s})})},so=e=>{let{children:s,className:t,...a}=e;return(0,i.jsxs)(e9.cZ,{hideCloseButton:!0,className:(0,S.cn)("flex h-[90dvh] max-h-[640px] w-[95dvw] flex-1 flex-col items-start px-0 py-0",t),size:"xl",...a,"aria-describedby":"Settings dialog",children:[(0,i.jsxs)(e7.TX,{children:[(0,i.jsx)(e9.Be,{children:"Settings dialog"}),(0,i.jsx)(e8.$N,{children:"Settings dialog"})]}),(0,i.jsx)(e8.GG,{asChild:!0,children:(0,i.jsx)(ei.z,{variant:"ghost",size:"icon-sm",className:"absolute right-2 top-2 z-10 hover:bg-transparent hover:opacity-75",children:(0,i.jsx)(er.Z,{name:"close",size:"small"})})}),s]})},sc=e=>{let{children:s,className:t,...a}=e;return(0,i.jsxs)(sn,{className:(0,S.cn)("flex h-[90dvh] flex-col items-start px-0 py-0",t),...a,children:[(0,i.jsxs)(e7.TX,{children:[(0,i.jsx)(sl,{children:"Settings drawer"}),(0,i.jsx)(sr,{children:"Settings drawer"})]}),s]})};var sd=t(5103),su=t(67817),sm=t(69084),sh=t(41135),sp=t(32429),sx=t(23664),sg=t(51408);function sf(e){let{title:s,description:t,featureKey:a,checked:n}=e,{authUser:r}=(0,d.Eu)(),l=(0,sx.U0)(),o=(0,eR.NL)(),{mutate:c}=(0,e2.D)({mutationFn:async e=>{let s=(0,e_.SJ)();return await s.patch("/users/".concat(null==r?void 0:r.uid,"/experimental-features"),{feature:a,enabled:e})},onMutate:e=>{o.cancelQueries({queryKey:sg.V.experimentalFeatures({user:r}).queryKey});let s=o.getQueryData(sg.V.experimentalFeatures({user:r}).queryKey);return o.setQueryData(sg.V.experimentalFeatures({user:r}).queryKey,s=>s?{...s,[a]:e}:null),{previousFeatures:s}},onSuccess:(e,s)=>{l.capture("lab-feature-toggled",{feature:a,checked:n})},onError:(e,s,t)=>{o.setQueryData(sg.V.experimentalFeatures({user:r}).queryKey,e=>{var s;return e?{...e,[a]:null==t?void 0:null===(s=t.previousFeatures)||void 0===s?void 0:s[a]}:null}),(0,e4.Eo)(e)}});return(0,i.jsx)(eN.P,{label:s,description:t,mobileLayout:"horizontal",children:(0,i.jsx)(eV.r,{checked:n,onCheckedChange:c,disabled:!r,className:"ml-auto"})})}let sj=()=>{let{isLoading:e,features:s}=(0,sp.G)(),t=(0,u.aS)(e=>{var s;return null===(s=e.currentWorkspace)||void 0===s?void 0:s.plan}),a=(0,eJ.XB)(t),n=(0,ev.dl)(eS.P.CodeEditorWrite);return(0,i.jsx)(h.tM,{value:"labs",title:"Labs",description:"These are experimental features, that might be modified or removed.",docsLink:"https://docs.lovable.dev/features/labs",children:e?(0,i.jsx)(Q.O,{className:"h-10 w-full"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sf,{title:"GitHub Branch Switching",description:"Select the branch to make edits to in your GitHub repository.",featureKey:"git_branch_switching",checked:!!(null==s?void 0:s.git_branch_switching)}),a&&!n&&(0,i.jsx)(sf,{title:"Code Editing in Code Mode",description:(0,i.jsx)(i.Fragment,{children:"Enable code edits in Code Mode."}),featureKey:"code_editor",checked:!!(null==s?void 0:s.code_editor)})]})})};var sv=t(92825),sb=t(79858);let sy=e=>{var s;let{isInteractive:t=!1,className:a,authUser:n,userData:r,...l}=e,o=(0,sb.Q)(null==r?void 0:r.id),c=(null==r?void 0:null===(s=r.attributes)||void 0===s?void 0:s.display_name)||(null==n?void 0:n.email)||r.username;return(0,i.jsx)(sv.N,{name:c,isInteractive:t,photoSrc:void 0,userColor:o,className:a,...l})},sw=e=>{let{userData:s,authUser:t}=e;return(0,i.jsx)(eN.P,{label:"Your Avatar",description:"Your avatar is automatically generated based on your account.",mobileLayout:"horizontal",children:(0,i.jsx)(sy,{className:"ml-auto h-10 w-10 md:ml-0",userData:s,authUser:t})})};var sN=t(2124);let s_=e=>{var s;let{isLast:t}=e,{userData:a}=(0,eb.SE)(),n=null!==(s=null==a?void 0:a.default_project_visibility)&&void 0!==s?s:void 0,[r,l]=(0,o.useState)(n);(0,o.useEffect)(()=>{l(n)},[n]);let c=(0,e2.D)({mutationFn:async e=>(0,e_.SJ)().put("/user/".concat(a.id),{default_project_visibility:e}),onSuccess:(e,s)=>{l(s),ef.Am.success("Default project visibility updated",{description:"Default project visibility is now ".concat(s)})},onError:e=>{(0,e4.Eo)(e),l(n)}});return(0,i.jsx)(eN.P,{label:"Default Project Visibility",description:"Set whether new projects are publicly accessible by default. You can always change visibility settings later per project.",isLast:t,children:a?(0,i.jsx)(sN.F,{workspacePlan:null,visibility:r,setVisibility:e=>{l(e),c.mutate(e)},disabled:c.isPending,redirectToSubscription:!0}):(0,i.jsx)(Q.O,{className:"h-10 w-full"})})};var sk=t(95186);let sC=e=>{var s;let{authUser:t}=e;return(0,i.jsx)(eN.P,{label:"Email",description:"Your email address associated with your account.",children:(0,i.jsx)(sk.I,{value:null!==(s=null==t?void 0:t.email)&&void 0!==s?s:"",disabled:!0,className:"w-full",placeholder:"No email available"})})};var sS=t(13590),sE=t(29501),sz=t(91115),sA=t(19060),sP=t(15681);let sO=sz.z.object({display_name:sz.z.string().optional(),bio:sz.z.string().optional(),location:sz.z.string().optional(),link:sz.z.string().optional(),hide_profile_pictures:sz.z.boolean().optional()}),sD=e=>{var s,t,a,n,r,l,o,c,d,u;let{userData:m,avatarExists:h}=e,p=(0,sE.cI)({defaultValues:{display_name:null!==(l=null===(s=m.attributes)||void 0===s?void 0:s.display_name)&&void 0!==l?l:"",bio:null!==(o=null===(t=m.attributes)||void 0===t?void 0:t.bio)&&void 0!==o?o:"",location:null!==(c=null===(a=m.attributes)||void 0===a?void 0:a.location)&&void 0!==c?c:"",link:null!==(d=null===(n=m.attributes)||void 0===n?void 0:n.link)&&void 0!==d?d:"",hide_profile_pictures:null!==(u=null===(r=m.attributes)||void 0===r?void 0:r.hide_profile_pictures)&&void 0!==u&&u},resolver:(0,sS.F)(sO)}),x=(0,eR.NL)(),{mutate:g,isPending:f}=(0,e2.D)({mutationFn:async e=>(0,e_.SJ)().put("/user/".concat(m.id),{attributes:e}),onSuccess:(e,s)=>{ef.Am.success("Success",{description:"Account settings updated successfully"}),p.reset(s),x.invalidateQueries({queryKey:eH.E.all})},onError:e=>{(0,e4.Eo)(e)}});return(0,i.jsx)(sP.l0,{...p,children:(0,i.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:p.handleSubmit(e=>{g(e)}),children:[(0,i.jsx)(eN.P,{label:"Name",description:"Your full name, as visible to others.",children:(0,i.jsx)(sP.Wi,{control:p.control,name:"display_name",render:e=>{let{field:s}=e;return(0,i.jsxs)(sP.xJ,{className:"w-full",children:[(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{...s})}),(0,i.jsx)(sP.zG,{})]})}})}),(0,i.jsx)(eN.P,{label:"Description",description:"A short description of yourself or your work.",children:(0,i.jsx)(sP.Wi,{control:p.control,name:"bio",render:e=>{let{field:s}=e;return(0,i.jsxs)(sP.xJ,{className:"w-full",children:[(0,i.jsx)(sP.NI,{children:(0,i.jsx)(eD.g,{className:"resize-none border bg-background",rows:3,...s})}),(0,i.jsx)(sP.zG,{})]})}})}),(0,i.jsx)(eN.P,{label:"Location",description:"Where you're based.",children:(0,i.jsx)(sP.Wi,{control:p.control,name:"location",render:e=>{let{field:s}=e;return(0,i.jsxs)(sP.xJ,{className:"w-full",children:[(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{...s})}),(0,i.jsx)(sP.zG,{})]})}})}),(0,i.jsx)(eN.P,{label:"Link",description:"Add a link to your personal website or portfolio.",children:(0,i.jsx)(sP.Wi,{control:p.control,name:"link",render:e=>{let{field:s}=e;return(0,i.jsxs)(sP.xJ,{className:"w-full",children:[(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{...s})}),(0,i.jsx)(sP.zG,{})]})}})}),h&&(0,i.jsx)(eN.P,{label:"Hide Profile Picture",mobileLayout:"horizontal",className:"last:border-b",children:(0,i.jsx)(sP.Wi,{control:p.control,name:"hide_profile_pictures",render:e=>{let{field:s}=e;return(0,i.jsxs)(sP.xJ,{className:"ml-auto flex flex-row items-center space-x-2 space-y-0",children:[(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sA.X,{checked:s.value,onCheckedChange:s.onChange})}),(0,i.jsx)(sP.zG,{})]})}})}),p.formState.isDirty&&(0,i.jsxs)(eN.j,{className:"justify-end gap-2",children:[(0,i.jsx)(ei.z,{type:"button",variant:"secondary",onClick:()=>{p.reset()},children:"Cancel"}),(0,i.jsx)(ei.z,{type:"submit",loading:f,variant:"affirmative",children:"Update"})]})]})})},sI=sz.z.object({username:sz.z.string().min(3,{message:"Username must be at least 3 characters"}).max(16,{message:"Username must be at most 16 characters"}).regex(/^[a-z]/,{message:"Username must start with a letter"}).regex(/^[a-z0-9_]+$/,{message:"Username can only contain lowercase letters, numbers, and underscores"})}),sT=e=>{let s=(0,sE.cI)({resolver:(0,sS.F)(sI)}),t=(0,e2.D)({mutationFn:async e=>{let{username:s}=e;return(0,e_.SJ)().put("/user/username",{username:s})},onSuccess:()=>{var s;ef.Am.success("Success",{description:"Username updated successfully"}),null===(s=e.onOpenChange)||void 0===s||s.call(e,!1)},onError:e=>{(0,e4.Eo)(e)}});return(0,i.jsx)(e9.Vq,{...e,children:(0,i.jsxs)(e9.cZ,{children:[(0,i.jsx)(e9.$N,{children:"Set Username"}),(0,i.jsx)(e9.Be,{children:"Please enter your desired username. You can not change your username once you have set it."}),(0,i.jsx)("form",{onSubmit:s.handleSubmit(e=>{t.mutate(e)}),children:(0,i.jsxs)(sP.l0,{...s,children:[(0,i.jsx)(sP.Wi,{control:s.control,name:"username",render:e=>{let{field:s}=e;return(0,i.jsxs)(sP.xJ,{className:"w-full",children:[(0,i.jsx)(sP.lX,{children:"Username"}),(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{...s})}),(0,i.jsx)(sP.zG,{})]})}}),(0,i.jsx)(e9.cN,{className:"mt-4",children:(0,i.jsx)(ei.z,{loading:t.isPending,type:"submit",children:"Save"})})]})})]})})},sL=e=>{let{username:s,userId:t}=e,[a,n]=(0,o.useState)(!1),r=!!t&&s===t;return(0,i.jsxs)(eN.P,{label:"Username",description:"Your public identifier and profile URL.",children:[(0,i.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,i.jsx)("div",{className:"flex items-center justify-start gap-2",children:(0,i.jsx)(sk.I,{placeholder:"Username",className:"w-full",value:null!=s?s:"",disabled:!r,onClick:()=>{s&&n(!0)}})}),(0,i.jsxs)("p",{className:"flex items-center gap-1 break-all text-sm text-muted-foreground underline transition-colors duration-150 ease-in-out hover:text-muted-foreground/80",children:[s?(0,i.jsxs)(ex.default,{className:"",href:"".concat(window.location.origin,"/@").concat(s),target:"_blank",rel:"noreferrer",children:["lovable.dev/@",s]}):"lovable.dev/@<username>",(0,i.jsx)(er.Z,{name:"arrow_outward",size:"small"})]})]}),(0,i.jsx)(sT,{open:a,onOpenChange:n})]})};var sR=t(61312);let sF=e=>{let{data:s={}}=(0,m.a)({...sg.V.contributions({userData:e}),enabled:!!(null==e?void 0:e.username)});return new Map(Object.entries(s))},sM=Math.ceil(365/7),sZ=e=>{let{}=e,{userData:s}=(0,eb.SE)(),t=sF(s),a=(0,o.useMemo)(()=>{let e=new Date,s=[];for(let a=0;a<sM;a++){let n=[];for(let s=0;s<7;s++){let r=(0,Z.k)(e,(sM-a-1)*7+(7-s-1)),l=(0,g.WU)(r,"yyyy-MM-dd"),i=t.get(l)||0;n.push({date:r,count:i})}s.push(n)}return s},[t]),n=(0,o.useRef)(null),[r,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=()=>{let e=n.current;e&&(l(e.scrollLeft>0),d(e.scrollLeft+e.clientWidth<e.scrollWidth-1))},s=n.current;if(s)return s.scrollLeft=s.scrollWidth,l(s.scrollLeft>0),d(s.scrollWidth>s.clientWidth&&s.scrollLeft+s.clientWidth<s.scrollWidth-1),s.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{s.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let u=(0,o.useMemo)(()=>Math.max(...Array.from(t.values()),0),[t]),m=(0,o.useMemo)(()=>e=>{if(0===e||0===u)return"bg-muted";let s=e/u;return s<=.25?"bg-muted-hover":s<=.5?"bg-muted-active":s<=.75?"bg-muted-foreground":"bg-foreground"},[u]);return(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-base font-medium",children:"Your Activity"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{ref:n,className:"overflow-x-auto pb-2 scrollbar-thin scrollbar-track-background scrollbar-thumb-background",children:(0,i.jsx)("div",{className:"inline-block min-w-[600px] max-w-[760px] rounded-xl border border-input bg-card p-2",children:(0,i.jsx)("div",{className:"flex gap-[2px]",children:a.map((e,s)=>(0,i.jsx)("div",{className:"flex flex-col gap-[2px]",children:e.map((e,s)=>(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)("div",{className:(0,S.cn)("size-2.5 rounded-[2px] transition-colors duration-200",m(e.count))})}),(0,i.jsxs)(Y._v,{side:"top",align:"center",children:["".concat((0,g.WU)(e.date,"MMM d, yyyy"),": ").concat(e.count>0?e.count:"No"," activity"),(0,i.jsx)(sR.Eh,{className:"fill-primary"})]})]},s))},s))})})}),r&&(0,i.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-6 bg-gradient-to-r from-background via-background/80 to-transparent"}),c&&(0,i.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-6 bg-gradient-to-l from-background via-background/80 to-transparent"})]})]})},sq=()=>{let{userData:e}=(0,eb.SE)();return(0,e2.D)({mutationFn:async s=>{let t=(0,e_.SJ)();return await t.put("/user/".concat(e.id),{sound_effect_active:s})},onSuccess:(e,s)=>{ef.Am.success("Sound effect settings updated",{description:"Sound effects will now play ".concat("firstgen"===s?"on first generation":"always"===s?"on all generations":"never")})},onError:e=>{(0,e4.Eo)(e)}})};var sU=t(26815),sW=t(74991);let sK=e=>{let{active:s,setActive:t,onClick:a,disabled:n}=e;return(0,i.jsxs)(sW.E,{className:"flex w-full flex-col gap-4",disabled:n,defaultValue:s,onValueChange:e=>{t(e)},children:[(0,i.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,i.jsx)(sW.m,{value:"firstgen",id:"firstgen",onClick:()=>{null==a||a()}}),(0,i.jsx)(sU.Label,{htmlFor:"firstgen",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(er.Z,{size:"small",name:"stacked_line_chart",className:"text-muted-foreground"}),"First Generation"]})})]}),(0,i.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,i.jsx)(sW.m,{value:"always",id:"always",onClick:()=>{null==a||a()}}),(0,i.jsx)(sU.Label,{htmlFor:"always",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(er.Z,{size:"small",name:"volume_up",className:"text-muted-foreground"}),"Always"]})})]}),(0,i.jsxs)("div",{className:"flex w-full items-start space-x-2",children:[(0,i.jsx)(sW.m,{value:"never",id:"never",onClick:()=>{null==a||a()}}),(0,i.jsx)(sU.Label,{htmlFor:"never",className:"flex w-full cursor-pointer flex-col gap-2",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,i.jsx)(er.Z,{size:"small",name:"volume_off",className:"text-muted-foreground"}),"Never"]})})]})]})},sG=()=>{var e;let{userData:s}=(0,eb.SE)(),t=sq(),a=null!==(e=null==s?void 0:s.sound_effect_active)&&void 0!==e?e:"firstgen";return(0,i.jsx)(eN.P,{label:"Generation complete sound",description:"Plays a satisfying sound notification when a generation is finished.",isLast:!0,children:s?(0,i.jsx)(sK,{active:a,setActive:e=>{t.mutate(e)}}):(0,i.jsx)(Q.O,{className:"h-10 w-full"})})};var sV=()=>{var e;let{authUser:s}=(0,d.Eu)(),{userData:t}=(0,eb.SE)(),a=(0,u.aS)(e=>{var s;return!!(null===(s=e.currentWorkspace)||void 0===s?void 0:s.id)}),n=null!==(e=(0,ev.dl)(eS.P.GithubContribution))&&void 0!==e&&e;return t?(0,i.jsxs)(h.tM,{value:"account",title:"Account Settings",description:"Personalize how others see and interact with you on Lovable.",children:[n&&(0,i.jsx)(sZ,{}),(0,i.jsx)(sw,{userData:t,authUser:s}),(0,i.jsx)(sL,{userId:t.id,username:t.username}),(0,i.jsx)(sC,{authUser:s}),(0,i.jsx)(sD,{userData:t,avatarExists:!!(null==s?void 0:s.photoURL)}),!a&&(0,i.jsx)(s_,{isLast:!1}),(0,i.jsx)(sG,{}),(0,i.jsx)("div",{className:"mb-12"})]}):null},sB=t(4310),sH=t(33910),sJ=t(89668);let sQ=e=>{var s,t,a;let{userData:n}=(0,eb.SE)(),r=null==n?void 0:null===(s=n.github)||void 0===s?void 0:s.encrypted_access_token,l=(0,o.useRef)(r),i=(0,m.a)(sJ.t.workspaceGithubInstallations({workspaceId:e}));return(0,o.useEffect)(()=>{l.current!==r&&(i.refetch().catch(()=>{}),l.current=r)},[r,i]),{installations:null===(t=i.data)||void 0===t?void 0:t.installations,requiredAction:null===(a=i.data)||void 0===a?void 0:a.required_action}};var sY=t(20653),sX=t(81677);let s$=e=>{let{isLoading:s,hasAccessToken:t,hasValidAccessToken:a,githubUsername:n,onGithubConnected:r,isWorkspaceAdmin:l}=e;return(0,o.useEffect)(()=>{let e=e=>{"githubAppAuthenticated"===e.data&&r()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[r]),(0,i.jsx)(eN.P,{label:"Connected Account",description:"Add your GitHub account to manage connected organizations.",justify:"end",badges:["admin"],children:s?(0,i.jsx)(Q.O,{className:"h-7 w-32"}):t&&a?(0,i.jsxs)(ei.z,{disabled:!0,variant:"outline",size:"sm",children:[(0,i.jsx)(sh.xR.GitHub,{className:"h-4 w-4"}),null!=n?n:"Connected"]}):(0,i.jsx)(s0,{isWorkspaceAdmin:l})})},s0=e=>{let{isWorkspaceAdmin:s}=e;return(0,i.jsxs)(ei.z,{variant:"default",size:"sm",onClick:sX.Hp,disabled:!s,children:[(0,i.jsx)(sY.wGg,{className:"size-4"}),"Connect GitHub"]})};var s1=t(57054),s2=t(39484);function s4(e){let{projectId:s,main_branch:t,searchTerm:a,setSearchTerm:n,switchBranchMutation:r}=e,{data:l,isPending:c,error:d}=(0,m.a)({queryKey:eH.iZ.branches(s),queryFn:async()=>(0,e_.SJ)().get("/projects/".concat(s,"/github/branches"))}),u=(0,o.useMemo)(()=>null==l?void 0:l.some(e=>e.name===t),[l,t]),{branchesWithCurrentFirst:h,filteredBranches:p}=(0,o.useMemo)(()=>{if(!l)return{branchesWithCurrentFirst:[],filteredBranches:[]};let e=l.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())),s=e.find(e=>e.name===t);return s?{branchesWithCurrentFirst:[s,...e.filter(e=>e.name!==t)],filteredBranches:e}:{branchesWithCurrentFirst:e,filteredBranches:e}},[l,t,a]);return(0,i.jsxs)("div",{className:"relative flex flex-col gap-3 p-4",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,i.jsx)("h4",{children:"Switch or create branch"}),(0,i.jsx)(s1.xp,{className:"absolute right-2 top-2",asChild:!0,children:(0,i.jsx)(ei.z,{variant:"ghost",size:"icon-sm",children:(0,i.jsx)(er.Z,{name:"close",size:"small"})})})]}),(0,i.jsx)("div",{children:c?(0,i.jsx)(s2.T,{text:"Loading branches from GitHub..."}):d?(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive-primary",children:[(0,i.jsx)(er.Z,{name:"warning_fill",size:"small"}),d.message]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"",children:(0,i.jsx)(sk.I,{type:"text",placeholder:"Find or create a branch...",value:a,onChange:e=>n(e.target.value)})}),(0,i.jsxs)("div",{className:"branches-list flex max-h-[40vh] flex-col gap-2 overflow-y-auto pt-2",children:[h.map(e=>(0,i.jsxs)(ei.z,{className:"branch-item flex w-full items-center justify-between px-3 text-left",onClick:()=>r.mutate(e.name),variant:e.name===t?"default":"ghost",disabled:r.isPending||e.name===t,loading:r.isPending&&r.variables===e.name,children:[(0,i.jsx)("span",{children:r.isPending&&r.variables===e.name?"Switching to "+e.name:e.name}),e.name===t&&(0,i.jsx)(er.Z,{name:"check"})]},e.name)),a&&!p.some(e=>e.name===a)&&(0,i.jsx)(eX.b,{showTooltip:!u,tooltipContent:"Your current branch does not exist on GitHub. Please switch to an existing branch first, then create your new branch.",children:(0,i.jsxs)(ei.z,{className:(0,S.cn)("h-auto w-full items-center justify-start"),onClick:()=>r.mutate(a),variant:"outline",disabled:r.isPending||!u,loading:r.isPending,children:[(0,i.jsx)(er.Z,{name:"add",className:"text-muted-foreground",size:"small"}),(0,i.jsxs)("p",{className:"text-wrap text-left",children:["Create branch ",(0,i.jsx)("strong",{children:a})," from"," ",(0,i.jsx)("strong",{children:t})]})]})})]})]})})]})}let s5=e=>{let{mainBranch:s,projectId:t}=e,[a,n]=(0,o.useState)(""),[r,l]=(0,o.useState)(!1),c=(0,eT.iZ)(e=>{var s;return(null===(s=e.project)||void 0===s?void 0:s.main_branch)||"main"}),d=(0,ec.Z)("md"),u=(0,eR.NL)(),m=(0,e2.D)({mutationFn:async e=>{await (0,e_.SJ)().post("/projects/".concat(t,"/github/branches"),{branch_name:e})},onSuccess:(e,s)=>{u.invalidateQueries({queryKey:eH.iZ.branches(t)}),ef.Am.success("Lovable is now using branch: ".concat(s)),n(""),l(!1)},onError:e=>{(0,e4.Eo)(e)}});return(0,i.jsx)(eN.P,{label:"Branch",description:"Choose the GitHub branch you want to work on inside Lovable.",justify:"end",badges:["labs"],children:(0,i.jsxs)(s1.J2,{open:r,onOpenChange:l,children:[(0,i.jsx)(s1.xo,{asChild:!0,children:(0,i.jsxs)(ei.z,{variant:"outline",size:"sm",loading:m.isPending,children:[(0,i.jsx)(er.Z,{name:"graph_1",className:"h-4 w-4"}),s,(0,i.jsx)(er.Z,{name:"chevron_right",size:"small",className:"rotate-90"})]})}),(0,i.jsx)(s1.yk,{className:"p-0",align:d?"start":"end",children:(0,i.jsx)(s4,{projectId:t,main_branch:c,searchTerm:a,setSearchTerm:n,switchBranchMutation:m})})]})})};var s6=t(12339),s3=t(6478);let s8=e=>{let{label:s,value:t}=e;return(0,i.jsx)(s6.SP,{className:"rounded-none border-b border-transparent px-0 py-0.5 text-xs data-[state=active]:border-b-border data-[state=active]:font-medium data-[state=active]:shadow-none",value:t,children:s})},s7=e=>{let{url:s}=e,t=(0,o.forwardRef)((e,s)=>(0,i.jsx)(ei.z,{ref:s,...e,variant:"ghost",className:"-mr-2 h-8 hover:text-primary",size:"icon-sm",children:(0,i.jsx)(er.Z,{name:"content_copy",className:"h-4 w-4"})}));t.displayName="TriggerComponent";let a=(0,s3.F)()({TriggerComponent:t,textToCopy:s});return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(sk.I,{className:"h-8 flex-1 p-2 font-mono text-muted-foreground focus:text-primary md:text-xs",value:s,onFocus:e=>e.target.select(),readOnly:!0}),(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{children:a}),(0,i.jsx)(Y._v,{children:"Copy to clipboard"})]})]})},s9=e=>{var s,t;let{project:a}=e,n=(null==a?void 0:a.github_repo_name)?(0,sB.c_)(a.github_repo_name,null==a?void 0:null===(s=a.github_owner)||void 0===s?void 0:s.name):"#",r=(null==a?void 0:null===(t=a.github_owner)||void 0===t?void 0:t.name)+"/"+(null==a?void 0:a.github_repo_name);return(0,i.jsx)(eN.P,{label:"Clone",description:"Copy this repository to your local environment.",justify:"end",children:(0,i.jsxs)(s6.mQ,{defaultValue:"https",className:"w-full pb-2",children:[(0,i.jsxs)(s6.dr,{className:"gap-2 px-0 pb-0 pt-0",children:[(0,i.jsx)(s8,{value:"https",label:"HTTPS"}),(0,i.jsx)(s8,{value:"ssh",label:"SSH"}),(null==a?void 0:a.is_github)&&(0,i.jsx)(s8,{value:"githubcli",label:"GitHub CLI"})]}),(0,i.jsx)(s6.nU,{value:"https",className:"mt-0",children:(0,i.jsx)(s7,{url:"".concat(n,".git")})}),(0,i.jsx)(s6.nU,{value:"ssh",className:"mt-0",children:(0,i.jsx)(s7,{url:"git@github.com:".concat(r,".git")})}),(0,i.jsx)(s6.nU,{value:"githubcli",className:"mt-0",children:(0,i.jsx)(s7,{url:"gh repo clone ".concat(r)})})]})})};var te=t(74751);let ts=e=>{let{children:s}=e;return(0,i.jsx)(e9.cZ,{className:"max-h-[80vh] gap-0 overflow-y-auto p-0",size:"lg",children:s})},tt=e=>{let{title:s,description:t,badge:a}=e;return(0,i.jsxs)(e9.fK,{className:"px-6 py-6",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(e9.$N,{className:"font-medium",children:s}),a&&(0,i.jsx)(te.p,{badge:a})]}),(0,i.jsx)(e9.Be,{className:"text-sm text-muted-foreground",children:t})]})},ta=e=>{let{children:s}=e;return(0,i.jsx)("div",{className:"flex gap-4 px-6 py-4",children:s})},tn=e=>{let{workspace:s}=e;return(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Workspace"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(sm.z,{workspace:s,className:"h-7 w-7"}),(0,i.jsx)("p",{className:"font-medium",children:s.name})]})]})};var tr=t(16831);let tl=e=>{let s=(0,eR.NL)(),{mutate:t,isPending:a}=(0,e2.D)({mutationFn:async s=>{let{githubInstallation:t}=s,a=(0,e_.SJ)();return await a.post("/workspaces/".concat(e,"/github-installations"),{github_installation_id:t.id})},onSuccess:async(t,a)=>{let n=eH.E.workspaceGithubInstallations(e),r=s.getQueryData(n);r&&s.setQueryData(n,{...r,installations:[...r.installations,a.githubInstallation]}),ef.Am.success("Added GitHub Organization",{description:"You can now transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,e4.Eo)(e)},onSettled:()=>{s.invalidateQueries({queryKey:eH.E.workspaceGithubInstallations(e)})}});return{addGithubTarget:t,isAddGithubTargetLoading:a}},ti=e=>{let s=(0,eR.NL)(),{mutate:t,isPending:a}=(0,e2.D)({mutationFn:async s=>{let{githubInstallation:t}=s;return(0,e_.SJ)().delete("/workspaces/".concat(e,"/github-installations/").concat(t.id))},onSuccess:async(t,a)=>{let n=eH.E.workspaceGithubInstallations(e),r=s.getQueryData(n);r&&s.setQueryData(n,{...r,installations:r.installations.filter(e=>e.id!==a.githubInstallation.id)}),ef.Am.success("Removed GitHub Organization",{description:"You can no longer transfer projects in this workspace to ".concat(a.githubInstallation.account.login)})},onError:e=>{(0,e4.Eo)(e)},onSettled:()=>{s.invalidateQueries({queryKey:eH.E.workspaceGithubInstallations(e)})}});return{deleteGithubTarget:t,isDeleteGithubTargetLoading:a}},to=e=>{let{setStep:s,installations:t,workspaceInstallations:a,workspace:n}=e,r=a.filter(e=>!t.some(s=>s.id===e.id)),{addGithubTarget:l,isAddGithubTargetLoading:o}=tl(n.id),c=e=>{l({githubInstallation:e})},{deleteGithubTarget:d,isDeleteGithubTargetLoading:u}=ti(n.id),m=e=>{d({githubInstallation:e})},h=a.length>0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tt,{title:"Link your workspace to GitHub",description:"Anyone in your Lovable workspace can add Lovable projects to GitHub organizations.",badge:"admin"}),(0,i.jsx)(eq.Separator,{}),(0,i.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,i.jsx)(tn,{workspace:n}),(0,i.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),t.map(e=>{let s=a.find(s=>s.id===e.id);return(0,i.jsx)(tc,{installation:e,workspaceInstallation:s,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id)}),r.length>0&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-medium",children:"Other users have added the following organizations:"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"If unlinked, you can not add them back."}),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:r.map(e=>(0,i.jsx)(tc,{installation:e,workspaceInstallation:e,addWorkspaceInstallation:c,disabled:o||u,deleteGithubTarget:m},e.id))})]})}),(0,i.jsx)(ei.z,{variant:t.length>0?"outline":"default",size:"sm",onClick:()=>(0,sX.Mn)({githubOwner:null,workspaceId:n.id}),className:"mt-auto",children:"Add Organizations"})]})]}),(0,i.jsx)(eq.Separator,{}),(0,i.jsx)(ta,{children:(0,i.jsx)(eX.b,{tooltipContent:"Please add and enable at least one organization to continue.",showTooltip:!h,className:"ml-auto",children:(0,i.jsx)(ei.z,{disabled:!h,onClick:()=>s("transfer"),size:"sm",className:"ml-auto",children:"Continue"})})})]})},tc=e=>{let{installation:s,workspaceInstallation:t,addWorkspaceInstallation:a,disabled:n,deleteGithubTarget:r}=e,l=(null==t?void 0:t.id)===s.id;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(tr.qE,{className:"h-7 w-7 border",children:(0,i.jsx)(tr.F$,{src:s.account.avatar_url})}),(0,i.jsx)("span",{className:"font-medium",children:s.account.login})]}),(0,i.jsx)(eV.r,{disabled:n,onCheckedChange:e=>{e?a(s):r(s)},checked:l})]})};var td=t(35974);let tu=e=>{let{setStep:s,installations:t,isTransferProjectLoading:a,isWorkspaceAdmin:n,onTransfer:r}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tt,{title:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync."}),(0,i.jsx)(eq.Separator,{}),(0,i.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),t.map(e=>(0,i.jsx)(tm,{installation:e,disabled:a||!n&&!!e.suspended_at,onTransfer:r,isWorkspaceAdmin:n,isLoading:a},e.account.login))]}),(0,i.jsx)(eq.Separator,{}),(0,i.jsx)(ta,{children:(0,i.jsx)(ei.z,{disabled:a,variant:"secondary",onClick:()=>s("organizations"),size:"sm",children:"Back"})})]})},tm=e=>{let{installation:s,disabled:t,onTransfer:a,isWorkspaceAdmin:n,isLoading:r}=e,[l,c]=(0,o.useState)(!1),d=r&&l;return(0,i.jsxs)("div",{className:"flex w-full items-center justify-start gap-2",children:[(0,i.jsx)(tr.qE,{className:"h-7 w-7 border",children:(0,i.jsx)(tr.F$,{src:s.account.avatar_url})}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("p",{className:"truncate font-medium",children:s.account.login}),s.suspended_at&&(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(td.C,{className:"inline",variant:"destructive",children:"Suspended"})})}),(0,i.jsx)(Y._v,{children:n?(0,i.jsx)("p",{children:"This account is suspended. Reconnect to continue."}):(0,i.jsx)("p",{children:"This account is suspended. Talk to your workspace owner to reconnect."})})]})]}),(0,i.jsx)(ei.z,{onClick:()=>{if(s.suspended_at){window.open(s.html_url,"_blank");return}a(s),c(!0)},disabled:t,className:"ml-auto",size:"sm",variant:s.suspended_at?"outline":"default",loading:d,children:s.suspended_at?"Reconnect":d?"Connecting":"Connect"})]},s.account.login)},th=e=>{let{isTransferProjectLoading:s,installations:t,isWorkspaceAdmin:a,onTransfer:n,showConnectDialog:r,setShowConnectDialog:l,workspace:c}=e,{installations:d}=sQ(c.id),[u,m]=(0,o.useState)("organizations");return(0,i.jsxs)(e9.Vq,{open:r,onOpenChange:e=>{e||m("organizations"),l(e)},children:[(0,i.jsx)(e9.hg,{asChild:!0,className:"hidden",children:(0,i.jsx)(ei.z,{size:"sm",children:"Connect Project"})}),(0,i.jsx)(ts,{children:"organizations"===u?(0,i.jsx)(to,{setStep:m,installations:null!=t?t:[],workspaceInstallations:null!=d?d:[],workspace:c}):(0,i.jsx)(tu,{setStep:m,installations:null!=d?d:[],isTransferProjectLoading:s,isWorkspaceAdmin:a,onTransfer:n})})]})};var tp=t(26237);let tx=e=>{let{isTransferProjectLoading:s,workspaceInstallations:t,onTransfer:a,isWorkspaceAdmin:n,setShowConnectDialog:r}=e,l=(0,ec.Z)("md"),c=(0,tp.C)(),[d,u]=(0,o.useState)(!1),m=(null==t?void 0:t.length)===0,{disabled:h,disabledReason:p}=(0,o.useMemo)(()=>c?{disabled:!0,disabledReason:"Cannot transfer project while there is an active operation in progress."}:!n&&m?{disabled:!0,disabledReason:"Ask a workspace admin to add GitHub Organizations."}:{disabled:!1,disabledReason:null},[c,n,m]);return(0,i.jsxs)(eo.h_,{open:d,onOpenChange:e=>{m?r(!0):u(e)},children:[(0,i.jsx)(eX.b,{showTooltip:h,tooltipContent:p,children:(0,i.jsx)(eo.$F,{asChild:!0,children:(0,i.jsx)(ei.z,{disabled:h,className:"justify-start",size:"sm",loading:s,children:s?"Connecting":(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sh.xR.GitHub,{className:"h-4 w-4"}),"Connect Project"]})})})}),(0,i.jsxs)(eo.AW,{className:"min-w-[200px]",align:l?"start":"end",children:[(0,i.jsx)(eo.Ju,{className:"text-xs font-medium text-muted-foreground",children:"GitHub Organizations"}),null==t?void 0:t.map(e=>(0,i.jsx)(tg,{installation:e,disabled:s||!n&&!!e.suspended_at,onTransfer:a,isWorkspaceAdmin:n},e.account.login)),(0,i.jsx)(eX.b,{showTooltip:!n,tooltipContent:"Only workspace admins can add organizations.",side:"left",instant:!0,children:(0,i.jsxs)(eo.Xi,{disabled:!n,onClick:()=>r(!0),children:[(0,i.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full border bg-background",children:(0,i.jsx)(er.Z,{name:"add",size:"small"})}),m?"Add Organization":"Manage Organizations",(0,i.jsx)(te.p,{badge:"admin",className:"flex md:hidden"})]})})]})]})},tg=e=>{let{installation:s,disabled:t,onTransfer:a,isWorkspaceAdmin:n}=e;return(0,i.jsx)(eX.b,{showTooltip:!!s.suspended_at,tooltipContent:n?"This account is suspended. Click to reconnect.":"This account is suspended. Talk to your workspace owner to reconnect.",side:"left",children:(0,i.jsxs)(eo.Xi,{className:"flex w-full items-center justify-start gap-2",onClick:()=>{if(s.suspended_at){window.open(s.html_url,"_blank");return}a(s)},disabled:t,children:[(0,i.jsx)(tr.qE,{className:"h-6 w-6 border",children:(0,i.jsx)(tr.F$,{src:s.account.avatar_url})}),(0,i.jsx)("p",{className:"truncate text-sm font-medium",children:s.account.login}),s.suspended_at&&(0,i.jsx)(td.C,{className:"inline",variant:"destructive",children:"Suspended"})]},s.account.login)})};var tf=t(65666);let tj=e=>{let s=(0,tf.D)(),{mutate:t,isPending:a}=(0,e2.D)({mutationFn:async e=>{let t={new_owner:{id:e.account.id,name:e.account.login,type:e.target_type}},a=(0,e_.SJ)();return await a.post("/projects/".concat(s,"/github/transfer"),t)},onSuccess:async(s,t)=>{ef.Am.success("A GitHub Repository is now under your account ".concat(t.account.login),{description:s.new_repo_url,action:(0,i.jsx)(ei.z,{size:"sm",asChild:!0,children:(0,i.jsx)("a",{target:"_blank",href:s.new_repo_url,children:"View"})}),duration:2e4}),null==e||e()},onError:e=>{(0,e4.Eo)(e)}});return{transferProject:t,isTransferProjectLoading:a}},tv=e=>{let{isWorkspaceAdmin:s,workspace:t,showConnectDialog:a,setShowConnectDialog:n}=e,{transferProject:r,isTransferProjectLoading:l}=tj(()=>{n(!1)}),o=e=>{r(e)},{installations:c}=(0,sH.D)({enabled:null!=s&&s}),{installations:d}=sQ(t.id);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tx,{isTransferProjectLoading:l,workspaceInstallations:null!=d?d:[],onTransfer:o,isWorkspaceAdmin:s,setShowConnectDialog:n}),(0,i.jsx)(th,{installations:c,isTransferProjectLoading:l,isWorkspaceAdmin:s,onTransfer:o,setShowConnectDialog:n,showConnectDialog:a,workspace:t})]})};var tb=t(27058);let ty=e=>{let{githubRepoName:s,workspace:t,isWorkspaceAdmin:a,showConnectDialog:n,setShowConnectDialog:r}=e;return s?(0,i.jsx)(eN.P,{label:"Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,i.jsx)(tb.H,{status:"connected"}),children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(ei.z,{asChild:!0,variant:"outline",size:"sm",children:(0,i.jsxs)(ex.default,{href:"https://github.com/".concat(s),target:"_blank",rel:"noopener noreferrer",children:["View on GitHub",(0,i.jsx)(er.Z,{size:"small",name:"arrow_outward",className:"ml-auto"})]})})})}):(0,i.jsx)(eN.P,{label:"Connect Project",description:"Connect your project to your GitHub organization in a 2-way sync.",justify:"end",customBadge:(0,i.jsx)(tb.H,{status:"not-connected"}),children:(0,i.jsx)(tv,{isWorkspaceAdmin:a,workspace:t,showConnectDialog:n,setShowConnectDialog:r})})},tw=e=>{let{workspace:s,isInsideEditor:t,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1);return(0,i.jsxs)(h.tM,{value:"github",title:"GitHub",description:"Sync your project 2-way with GitHub to collaborate at source.",docsLink:"https://docs.lovable.dev/integrations/git-integration",children:[t&&(0,i.jsx)(t_,{workspace:s,myWorkspaceRole:a,showConnectDialog:n,setShowConnectDialog:r}),(0,i.jsx)(tN,{myWorkspaceRole:a,setShowConnectDialog:r,isInsideEditor:t})]})},tN=e=>{var s,t;let{myWorkspaceRole:a,setShowConnectDialog:n,isInsideEditor:r}=e,l="admin"===a||"owner"===a,{hasValidAccessToken:o,isLoading:c}=(0,sH.D)({enabled:null!=l&&l}),{userData:d}=(0,eb.SE)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s$,{isLoading:c||!d,hasAccessToken:!!(null==d?void 0:null===(s=d.github)||void 0===s?void 0:s.new_encrypted_access_token),githubUsername:null==d?void 0:null===(t=d.github)||void 0===t?void 0:t.username,hasValidAccessToken:null!=o&&o,onGithubConnected:()=>{r&&n(!0)},isWorkspaceAdmin:l})})};function t_(e){var s,t,a,n,r;let{workspace:l,myWorkspaceRole:o,showConnectDialog:c,setShowConnectDialog:d}=e,u=(0,eT.iZ)(e=>e.project),{installations:m}=sQ(l.id),{userData:h}=(0,eb.SE)(),p=null===(s=(0,sp.G)().features)||void 0===s?void 0:s.git_branch_switching;if(!u)return null;let x=(null==u?void 0:null===(t=u.github_owner)||void 0===t?void 0:t.name)!==sB.aR,g=(null==h?void 0:null===(a=h.github)||void 0===a?void 0:a.new_encrypted_access_token)!==null&&(null==h?void 0:null===(n=h.github)||void 0===n?void 0:n.new_encrypted_access_token)!==void 0;return(0,i.jsxs)(i.Fragment,{children:[(g||m&&(null==m?void 0:m.length)>0)&&(0,i.jsx)(ty,{isWorkspaceAdmin:!!("admin"===o||"owner"===o),workspace:l,githubRepoName:x&&(null==u?void 0:u.github_repo_name)&&(null===(r=u.github_owner)||void 0===r?void 0:r.name)?"".concat(u.github_owner.name,"/").concat(u.github_repo_name):void 0,showConnectDialog:c,setShowConnectDialog:d}),x&&(0,i.jsx)(s9,{project:u}),x&&p&&(0,i.jsx)(s5,{mainBranch:u.main_branch||"main",projectId:u.id})]})}var tk=t(59709),tC=t(65613);let tS=e=>{var s,t;let{workspace:a,open:n,onOpenChange:r,shouldRefreshAfterOAuth:l,onRefreshComplete:c}=e,[d,u]=(0,o.useState)(""),[m,h]=(0,o.useState)(""),[p,x]=(0,o.useState)(null),[g,f]=(0,o.useState)(!1),[j,v]=(0,o.useState)(!1),[b,y]=(0,o.useState)(""),[w,N]=(0,o.useState)(!1),[_,k]=(0,o.useState)(null),C=(0,eR.NL)(),E=(0,e2.D)({mutationFn:async e=>{let s=await (0,e_.SJ)();return await s.post("/workspaces/".concat(a.id,"/integrations/mcp/test"),{...(null==e?void 0:e.serverId)?{server_id:e.serverId}:{url:m,...b&&{manual_token:b}}})},onSuccess:e=>{if(x(e),e.success){var s;ef.Am.success("Connected! Found ".concat((null===(s=e.tools)||void 0===s?void 0:s.length)||0," tools"))}else e.requires_oauth?ef.Am.info("This server requires OAuth authentication"):ef.Am.error(e.error||"Connection failed")},onError:e=>{var s,t,a,n;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.error)||"Failed to test connection"),x({success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.error)||"Failed to test connection"})}}),z=(0,e2.D)({mutationFn:async()=>{let e=await (0,e_.SJ)();if(w&&_)return console.log("[AddMCPServerDialog] OAuth server already created:",_.server_id),{alreadyCreated:!0};await e.post("/workspaces/".concat(a.id,"/integrations/connect"),{type:"mcp",name:d,url:m,...b&&{manual_token:b}})},onSuccess:()=>{C.invalidateQueries({queryKey:["mcp-servers",a.id]}),ef.Am.success("MCP server added successfully"),r(!1),u(""),h(""),x(null),y(""),v(!1),N(!1),k(null)},onError:e=>{var s,t;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.error)||"Failed to add MCP server")}}),A=(0,e2.D)({mutationFn:async()=>{let e=await (0,e_.SJ)();return await e.post("/workspaces/".concat(a.id,"/integrations/mcp/oauth/start"),{name:d,url:m,redirect_uri:"".concat(window.location.origin,"/mcp-callback")})},onSuccess:e=>{let s="".concat(window.location.origin,"/mcp-callback"),t={workspaceId:a.id,serverId:e.server_id,codeVerifier:e.code_verifier,redirectUri:s};k({server_id:e.server_id,name:d,url:m}),console.log("[OAuth Debug] Storing OAuth data in localStorage:",t),localStorage.setItem(tk.G,JSON.stringify(t)),console.log("[OAuth Debug] Verified stored data:",localStorage.getItem(tk.G)),console.log("[OAuth Debug] All localStorage keys:",Object.keys(localStorage)),console.log("[OAuth Debug] Opening OAuth window with URL:",e.authorization_url);let n=window.open(e.authorization_url,"_blank","width=600,height=700,left=200,top=100");n?n.focus():window.location.href=e.authorization_url,n&&setTimeout(()=>{n.closed&&console.error("[OAuth Debug] OAuth window closed within 1 second - possible redirect or error")},1e3)},onError:e=>{var s,t;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.error)||"Failed to start OAuth flow")}});(0,o.useEffect)(()=>{l&&_&&(console.log("[AddMCPServerDialog] Testing connection after OAuth success"),N(!0),E.mutate({serverId:_.server_id}),null==c||c())},[l,_,E,c]);let P=()=>{r(!1),setTimeout(()=>{u(""),h(""),x(null),f(!1),y(""),v(!1),N(!1),k(null)},200)};return(0,i.jsx)(e9.Vq,{open:n,onOpenChange:P,children:(0,i.jsx)(e9.cZ,{className:"sm:max-w-[525px]",children:(0,i.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!d.trim()||!m.trim()){ef.Am.error("Please fill in all fields");return}if(!(null==p?void 0:p.success)&&!w){ef.Am.error("Please test the connection first");return}z.mutate()},children:[(0,i.jsxs)(e9.fK,{children:[(0,i.jsx)(e9.$N,{children:"Add MCP Server"}),(0,i.jsx)(e9.Be,{children:"Connect to a remote MCP server to extend the AI's capabilities."})]}),(0,i.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(sU.Label,{htmlFor:"name",children:"Server Name"}),(0,i.jsx)(sk.I,{id:"name",placeholder:"My MCP Server",value:d,onChange:e=>u(e.target.value),required:!0})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(sU.Label,{htmlFor:"url",children:"Server URL"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(sk.I,{id:"url",type:"url",placeholder:"https://mcp.example.com",value:m,onChange:e=>{h(e.target.value),x(null)},required:!0,className:"flex-1"}),(0,i.jsx)(ei.z,{type:"button",variant:"secondary",onClick:()=>{if(!m.trim()){ef.Am.error("Please enter a URL");return}x(null),E.mutate(void 0)},disabled:E.isPending||!m.trim(),children:E.isPending?"Testing...":"Test"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)(ei.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>v(!j),className:"flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground",children:[(0,i.jsx)(er.Z,{name:j?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"}),"Advanced Settings"]}),j&&(0,i.jsx)("div",{className:"grid gap-2 pl-6",children:(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(sU.Label,{htmlFor:"manual-token",children:"Bearer Token (Optional)"}),(0,i.jsx)(sk.I,{id:"manual-token",type:"password",placeholder:"Enter Bearer token or API key",value:b,onChange:e=>{y(e.target.value),x(null)}}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Some MCP servers use API keys as Bearer tokens instead of OAuth. If your server requires a token, enter it here."})]})})]}),E.isPending&&(0,i.jsx)("div",{className:"rounded-lg border p-4",children:(0,i.jsx)(s2.T,{text:"Testing connection..."})}),p&&!E.isPending&&(0,i.jsxs)(tC.bZ,{className:(0,S.cn)("transition-all",p.success||w?"border-green-600/20 bg-green-50/50 dark:bg-green-950/20":p.requires_oauth?"border-blue-600/20 bg-blue-50/50 dark:bg-blue-950/20":"border-destructive/20 bg-destructive/5"),children:[(0,i.jsx)(er.Z,{name:p.success||w?"check_circle":p.requires_oauth?"lock":"error",className:(0,S.cn)("h-4 w-4",p.success||w?"text-green-600":p.requires_oauth?"text-blue-600":"text-destructive")}),(0,i.jsxs)(tC.X,{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"flex-1",children:p.success?w?"OAuth authenticated successfully! Found ".concat((null===(s=p.tools)||void 0===s?void 0:s.length)||0," tools"):"Connection successful! Found ".concat((null===(t=p.tools)||void 0===t?void 0:t.length)||0," tools"):p.requires_oauth?"This server requires OAuth authentication":p.error||"Connection failed"}),p.success&&p.tools&&p.tools.length>0&&!w&&(0,i.jsx)(ei.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>f(!g),children:(0,i.jsx)(er.Z,{name:g?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),p.requires_oauth&&(0,i.jsx)(ei.z,{type:"button",size:"sm",onClick:()=>{if(!d.trim()||!m.trim()){ef.Am.error("Please fill in server name and URL first");return}A.mutate()},disabled:A.isPending,children:A.isPending?"Starting...":"Authorize"})]})]}),(null==p?void 0:p.success)&&p.tools&&g&&!w&&(0,i.jsx)("div",{className:"max-h-[200px] overflow-y-auto rounded-lg border p-4",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("h4",{className:"mb-2 text-sm font-medium",children:["Available Tools (",p.tools.length,")"]}),p.tools.map((e,s)=>(0,i.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,i.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},s))]})})]}),(0,i.jsxs)(e9.cN,{children:[(0,i.jsx)(ei.z,{type:"button",variant:"outline",onClick:P,children:"Cancel"}),(0,i.jsx)(ei.z,{type:"submit",disabled:z.isPending||!(null==p?void 0:p.success)&&!w,children:z.isPending?"Adding...":"Add Server"})]})]})})})},tE=e=>{let{workspace:s,isWorkspaceAdmin:t,shouldRefresh:a,onRefreshComplete:n}=e,r=(0,eR.NL)(),[l,c]=(0,o.useState)(new Set);(0,o.useEffect)(()=>{a&&(r.invalidateQueries({queryKey:["mcp-servers",s.id]}),null==n||n())},[a,s.id,r,n]);let d=e=>{let s=new Set(l);s.has(e)?s.delete(e):s.add(e),c(s)},{data:u,isLoading:h}=(0,m.a)({queryKey:["mcp-servers",s.id],queryFn:async()=>{let e=await (0,e_.SJ)();return(await e.get("/workspaces/".concat(s.id,"/integrations/mcp"))).servers||[]}}),p=(0,e2.D)({mutationFn:async e=>{let t=await (0,e_.SJ)();await t.delete("/workspaces/".concat(s.id,"/integrations/mcp/").concat(e))},onSuccess:()=>{r.invalidateQueries({queryKey:["mcp-servers",s.id]}),ef.Am.success("MCP server removed successfully")},onError:()=>{ef.Am.error("Failed to remove MCP server")}});return h?(0,i.jsx)("div",{className:"flex justify-center py-8",children:(0,i.jsx)(s2.T,{text:"Loading MCP servers..."})}):u&&0!==u.length?(0,i.jsx)("div",{className:"space-y-4",children:u.map(e=>{let s=l.has(e.id),a=e.tools&&e.tools.length>0;return(0,i.jsxs)("div",{className:"overflow-hidden rounded-lg border",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,i.jsxs)("div",{className:"flex flex-1 items-center gap-3",children:[(0,i.jsx)(er.Z,{name:"cloud",className:"h-5 w-5 flex-shrink-0 text-muted-foreground"}),(0,i.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,i.jsx)("p",{className:"font-medium",children:e.name}),(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,i.jsx)("span",{className:"truncate",children:e.url}),a&&(0,i.jsxs)("span",{className:"flex-shrink-0",children:["• ",e.tools.length," tools"]})]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,i.jsx)(ei.z,{variant:"ghost",size:"sm",onClick:()=>d(e.id),children:(0,i.jsx)(er.Z,{name:s?"keyboard_arrow_up":"keyboard_arrow_down",className:"h-4 w-4"})}),t&&(0,i.jsx)(ei.z,{variant:"ghost",size:"sm",onClick:()=>p.mutate(e.id),disabled:p.isPending,children:(0,i.jsx)(er.Z,{name:"delete"})})]})]}),s&&a&&(0,i.jsx)("div",{className:"border-t bg-muted/30 px-4 py-3",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h5",{className:"mb-2 text-sm font-medium",children:"Available Tools"}),(0,i.jsx)("div",{className:"space-y-1",children:e.tools.map((e,s)=>(0,i.jsxs)("div",{className:"border-l-2 border-muted py-1 pl-3",children:[(0,i.jsx)("div",{className:"text-sm font-medium",children:e.name}),e.description&&(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]},s))})]})})]},e.id)})}):(0,i.jsxs)("div",{className:"rounded-lg border border-dashed p-8 text-center",children:[(0,i.jsx)(er.Z,{name:"cloud",className:"mx-auto h-12 w-12 text-muted-foreground/50"}),(0,i.jsx)("h3",{className:"mt-4 text-sm font-medium",children:"No MCP servers connected"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Get started by adding your first MCP server connection."})]})},tz=e=>{let{workspace:s,isInsideEditor:t,myWorkspaceRole:a}=e,[n,r]=(0,o.useState)(!1),[l,c]=(0,o.useState)(!1),d="admin"===a||"owner"===a,u=(0,o.useCallback)(()=>{console.log("[MCPTab] OAuth success, dialog stays open to show tools"),c(!0)},[]);return(0,tk.d)({workspaceId:s.id,onConnectSuccess:u}),(0,i.jsxs)(h.tM,{value:"mcp",title:"MCP",description:"Connect to Model Context Protocol servers for enhanced AI capabilities.",docsLink:"https://docs.lovable.dev/integrations/mcp",children:[(0,i.jsx)(tS,{workspace:s,open:n,onOpenChange:r,shouldRefreshAfterOAuth:l,onRefreshComplete:()=>c(!1)}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"rounded-lg border p-6",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-lg font-medium",children:"MCP Servers"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Connect to remote MCP servers to extend the AI's capabilities with custom tools and integrations."})]}),d&&(0,i.jsx)(ei.z,{onClick:()=>r(!0),className:"w-full sm:w-auto",children:"Add MCP Server"})]})}),(0,i.jsx)(tE,{workspace:s,isWorkspaceAdmin:d,shouldRefresh:l,onRefreshComplete:()=>c(!1)})]})]})};var tA=t(66070);let tP=e=>{let{workspace:s,isInsideEditor:t,myWorkspaceRole:a,project:n}=e,[r,l]=(0,o.useState)([]),[c,d]=(0,o.useState)(!1),u=(0,tp.C)(),[m,p]=(0,o.useState)(null),[x,g]=(0,o.useState)(!1),[f,j]=(0,o.useState)(!1),[v,b]=(0,o.useState)(!1),[y,w]=(0,o.useState)(null),[N,_]=(0,o.useState)(null),[k,C]=(0,o.useState)({path:"",description:"",content:""});(0,o.useEffect)(()=>{(null==n?void 0:n.id)&&S()},[null==n?void 0:n.id]);let S=async()=>{if(null==n?void 0:n.id){d(!0);try{let e=(0,e_.SJ)(),s=await e.get("/projects/".concat(n.id,"/integrations/memory"));l(s||[])}catch(e){console.error("Failed to load memories:",e),ef.Am.error("Failed to load memories")}finally{d(!1)}}},E=async e=>{if(null==n?void 0:n.id)try{let s=(0,e_.SJ)();await s.post("/projects/".concat(n.id,"/integrations/memory"),e),l(e),ef.Am.success("Memories updated successfully")}catch(e){throw console.error("Failed to save memories:",e),ef.Am.error("Failed to save memories"),e}},z=async()=>{if(!k.path||!k.content){ef.Am.error("Path and content are required");return}if(r.some(e=>e.path===k.path)){ef.Am.error("A memory with this path already exists");return}let e={path:k.path,description:k.description||"",content:k.content,updated_at:new Date().toISOString()};try{await E([...r,e]),C({path:"",description:"",content:""}),g(!1)}catch(e){}},A=async()=>{if(m&&N){if(m.path!==N&&r.some(e=>e.path===m.path)){ef.Am.error("A memory with this path already exists");return}try{let e=r.map(e=>e.path===N?{...m,updated_at:new Date().toISOString()}:e);await E(e),p(null),_(null),j(!1)}catch(e){}}},P=async()=>{if(y)try{let e=r.filter(e=>e.path!==y);await E(e),w(null),b(!1)}catch(e){}},O=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,i.jsx)(Y.pn,{children:(0,i.jsx)(h.tM,{value:"memory",title:"Memory",description:"Manage memory files that help Lovable remember important context about your project.",children:(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)(e9.Vq,{open:x,onOpenChange:g,children:[u?(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"cursor-not-allowed",children:(0,i.jsx)(e9.hg,{asChild:!0,disabled:u,children:(0,i.jsxs)(ei.z,{disabled:u,children:[(0,i.jsx)(er.Z,{name:"add",className:"mr-2 h-4 w-4"}),"Add Memory"]})})})}),(0,i.jsx)(Y._v,{children:"Can't edit memories while Lovable is working"})]}):(0,i.jsx)(e9.hg,{asChild:!0,children:(0,i.jsxs)(ei.z,{children:[(0,i.jsx)(er.Z,{name:"add",className:"mr-2 h-4 w-4"}),"Add Memory"]})}),(0,i.jsxs)(e9.cZ,{className:"max-w-2xl",children:[(0,i.jsxs)(e9.fK,{children:[(0,i.jsx)(e9.$N,{children:"Add New Memory"}),(0,i.jsx)(e9.Be,{children:"Create a new memory file to store important context for the AI."})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"File Path"}),(0,i.jsx)(sk.I,{placeholder:"e.g., user-preferences.md",value:k.path||"",onChange:e=>C({...k,path:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Description (optional)"}),(0,i.jsx)(sk.I,{placeholder:"Brief description of what this memory contains",value:k.description||"",onChange:e=>C({...k,description:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Content"}),(0,i.jsx)(eD.g,{placeholder:"Enter the memory content...",className:"min-h-[200px]",value:k.content||"",onChange:e=>C({...k,content:e.target.value})})]})]}),(0,i.jsxs)(e9.cN,{children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(0,i.jsx)(ei.z,{onClick:z,children:"Add Memory"})]})]})]})}),(0,i.jsx)(eq.Separator,{}),c?(0,i.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,i.jsx)(er.Z,{name:"progress_activity",className:"h-6 w-6 animate-spin"}),(0,i.jsx)("span",{className:"ml-2",children:"Loading memories..."})]}):0===r.length?(0,i.jsx)(tA.Zb,{children:(0,i.jsx)(tA.aY,{className:"pt-6",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(er.Z,{name:"folder",className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),(0,i.jsx)("h3",{className:"mb-2 text-lg font-medium",children:"No memories yet"}),(0,i.jsx)("p",{className:"mb-4 text-muted-foreground",children:"Create your first memory to help the AI remember important context about your project."}),u?(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"cursor-not-allowed",children:(0,i.jsxs)(ei.z,{disabled:u,onClick:()=>g(!0),children:[(0,i.jsx)(er.Z,{name:"add",className:"mr-2 h-4 w-4"}),"Add First Memory"]})})}),(0,i.jsx)(Y._v,{children:"Can't add memories while Lovable is working"})]}):(0,i.jsxs)(ei.z,{onClick:()=>g(!0),children:[(0,i.jsx)(er.Z,{name:"add",className:"mr-2 h-4 w-4"}),"Add First Memory"]})]})})}):(0,i.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,i.jsxs)(tA.Zb,{children:[(0,i.jsxs)(tA.Ol,{className:"pb-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(tA.ll,{className:"text-base",children:e.path}),(0,i.jsx)(td.C,{variant:"secondary",className:"text-xs",children:O(e.updated_at)})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[u?(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"cursor-not-allowed",children:(0,i.jsx)(ei.z,{variant:"ghost",size:"sm",disabled:u,onClick:()=>{p(e),_(e.path),j(!0)},children:(0,i.jsx)(er.Z,{name:"edit",className:"h-4 w-4"})})})}),(0,i.jsx)(Y._v,{children:"Can't edit memories while Lovable is working"})]}):(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)(ei.z,{variant:"ghost",size:"sm",onClick:()=>{p(e),_(e.path),j(!0)},children:(0,i.jsx)(er.Z,{name:"edit",className:"h-4 w-4"})})}),(0,i.jsx)(Y._v,{children:"Edit memory"})]}),u?(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"cursor-not-allowed",children:(0,i.jsx)(ei.z,{variant:"ghost",size:"sm",disabled:u,onClick:()=>{w(e.path),b(!0)},children:(0,i.jsx)(er.Z,{name:"delete",className:"h-4 w-4"})})})}),(0,i.jsx)(Y._v,{children:"Can't delete memories while Lovable is working"})]}):(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsx)(ei.z,{variant:"ghost",size:"sm",onClick:()=>{w(e.path),b(!0)},children:(0,i.jsx)(er.Z,{name:"delete",className:"h-4 w-4"})})}),(0,i.jsx)(Y._v,{children:"Delete memory"})]})]})]}),e.description&&(0,i.jsx)(tA.SZ,{children:e.description})]}),(0,i.jsx)(tA.aY,{children:(0,i.jsx)("div",{className:"rounded-lg bg-muted/50 p-3",children:(0,i.jsx)("pre",{className:"whitespace-pre-wrap font-mono text-sm",children:e.content.length>200?"".concat(e.content.substring(0,200),"..."):e.content})})})]},e.path))}),(0,i.jsx)(e9.Vq,{open:f,onOpenChange:j,children:(0,i.jsxs)(e9.cZ,{className:"max-w-2xl",children:[(0,i.jsxs)(e9.fK,{children:[(0,i.jsx)(e9.$N,{children:"Edit Memory"}),(0,i.jsx)(e9.Be,{children:"Update the memory file path, content, and description."})]}),m&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"File Path"}),(0,i.jsx)(sk.I,{placeholder:"e.g., user-preferences.md",value:m.path,onChange:e=>p({...m,path:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Description"}),(0,i.jsx)(sk.I,{placeholder:"Brief description of what this memory contains",value:m.description,onChange:e=>p({...m,description:e.target.value})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Content"}),(0,i.jsx)(eD.g,{className:"min-h-[300px]",value:m.content,onChange:e=>p({...m,content:e.target.value})})]})]}),(0,i.jsxs)(e9.cN,{children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{j(!1),p(null),_(null)},children:"Cancel"}),(0,i.jsx)(ei.z,{onClick:A,children:"Save Changes"})]})]})}),(0,i.jsx)(e9.Vq,{open:v,onOpenChange:b,children:(0,i.jsxs)(e9.cZ,{children:[(0,i.jsxs)(e9.fK,{children:[(0,i.jsx)(e9.$N,{children:"Delete Memory"}),(0,i.jsxs)(e9.Be,{children:['Are you sure you want to delete "',y,'"? This action cannot be undone.']})]}),(0,i.jsxs)(e9.cN,{children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),(0,i.jsx)(ei.z,{variant:"destructive",onClick:P,children:"Delete"})]})]})})]})})})};var tO=t(50091),tD=t(84428),tI=t(88906),tT=t(95805),tL=t(26748),tR=t(68920),tF=t(25846),tM=t(75403),tZ=t(68959),tq=t(10407);let tU=(0,o.createContext)(void 0);function tW(e){let{children:s,onStackEmpty:t,initialStack:a=[]}=e,[n,r]=(0,o.useState)(a),l=(0,o.useCallback)(e=>{r(s=>[...s,e])},[]),c=(0,o.useCallback)(()=>{r(e=>{let s=e.slice(0,-1);return 0===s.length&&(null==t||t()),s})},[t]),d=(0,o.useCallback)(e=>{e<0||r(s=>s.slice(0,e+1))},[]),u=(0,o.useCallback)(()=>{r([]),null==t||t()},[t]),m=(0,o.useMemo)(()=>({stack:n,push:l,pop:c,popTo:d,reset:u}),[n,l,c,d,u]);return(0,i.jsx)(tU.Provider,{value:m,children:s})}function tK(){let e=(0,o.useContext)(tU);if(void 0===e)throw Error("useSheetNavigation must be used within a SheetNavigationProvider");return e}function tG(e){let{isMobile:s,children:t,navigationItems:a}=e,{stack:n,push:r,popTo:l,reset:o}=tK(),c=(e,s)=>{(1!==n.length||n[0].title!==e)&&(o(),r({title:e,component:s}))},d=n[n.length-1],u=n.length>0?n[0].title:null;return s?(0,i.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,i.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,i.jsx)("div",{className:"grow overflow-y-auto",children:d?d.component:t})}),(0,i.jsx)("div",{className:"border-t bg-background",children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsx)("div",{className:"flex min-w-max gap-1 p-2",children:a.map(e=>{let s=e.icon;return(0,i.jsxs)(ei.z,{variant:u===e.title?"secondary":"ghost",className:"h-16 w-20 min-w-16 flex-col gap-1 px-2 text-xs",onClick:()=>c(e.title,e.component),children:[(0,i.jsx)(s,{className:"h-5 w-5"}),(0,i.jsx)("span",{className:"text-center text-[10px] leading-tight",children:"Auth"===e.title?"Auth":e.title})]},e.title)})})})})]}):(0,i.jsx)("div",{className:"flex h-full w-full",children:(0,i.jsxs)("div",{className:"flex h-full w-full flex-col",children:[n.length>0&&(0,i.jsxs)("div",{className:"relative flex shrink-0 items-center border-b pb-2",children:[(0,i.jsxs)(ei.z,{variant:"ghost",size:"icon",className:"relative z-10 h-8 w-8",onClick:()=>n.length>1?l(n.length-2):o(),children:[(0,i.jsx)(tZ.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Back"})]}),(0,i.jsx)("div",{className:"relative z-10 ml-2 flex items-center gap-1.5 text-sm text-muted-foreground",children:n.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-center gap-1.5",children:[s>0&&(0,i.jsx)(tq.Z,{className:"h-3 w-3"}),s===n.length-1?(0,i.jsx)("span",{className:"font-semibold text-foreground",children:e.title}):(0,i.jsx)("button",{onClick:()=>l(s),className:"hover:underline",children:e.title})]},"".concat(e.title,"-").concat(s)))})]}),(0,i.jsx)("div",{className:"grow",children:d?d.component:t})]})})}var tV=t(43246),tB=t(80733),tH=t(45008),tJ=t(87057);function tQ(){let e=(0,tH._)(["\n    with\n      tables as (","),\n      columns as (",")\n    select\n      *,\n      ","\n    from tables\n  "]);return tQ=function(){return e},e}function tY(){let e=(0,tH._)(["\n    COALESCE(\n      (\n        SELECT\n          array_agg(row_to_json(",")) FILTER (WHERE ",")\n        FROM\n          ","\n      ),\n      '{}'\n    ) AS ","\n  "]);return tY=function(){return e},e}let tX=["information_schema","pg_catalog","pg_toast","_timescaledb_internal"],t$=(e,s)=>(0,tJ.Pn)(tY(),e,s,e,e),t0=async(e,s)=>{let{data:t,error:a}=await s.GET("/v1/projects/{ref}/config/auth",{params:{path:{ref:e}}});if(a)throw a;return t},t1=e=>{let s=t2();return(0,m.a)({queryKey:["auth-config",e],queryFn:()=>t0(e,s),enabled:!!e,retry:!1})},t2=()=>{let e=(0,eT.iZ)(e=>e.projectId);return(0,tV.ZP)({baseUrl:"".concat("https://lovable-api.com","/projects/").concat(e,"/db-proxy"),headers:{Authorization:"Bearer ".concat(tB.g.serverIdToken)}})},t4=async e=>{let{projectRef:s,payload:t,dbClient:a}=e,{data:n,error:r}=await a.PATCH("/v1/projects/{ref}/config/auth",{params:{path:{ref:s}},body:t});if(r)throw r;return n},t5=()=>{let e=(0,eR.NL)();return(0,e2.D)({mutationFn:t4,onSuccess:(s,t)=>{ef.Am.success("Auth config updated."),e.invalidateQueries({queryKey:["auth-config",t.projectRef]})},onError:e=>{var s,t;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"There was a problem with your request.")}})},t6=async e=>{let{projectRef:s,query:t,readOnly:a,dbClient:n}=e,{data:r,error:l}=await n.POST("/v1/projects/{ref}/database/query",{params:{path:{ref:s}},body:{query:t,read_only:a}});if(l)throw l;return r},t3=()=>{let e=t2();return(0,e2.D)({mutationFn:s=>{let{projectRef:t,query:a,readOnly:n}=s;return t6({projectRef:t,query:a,readOnly:n,dbClient:e})},onError:e=>{var s,t;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"There was a problem with your query.")}})},t8=e=>{let{projectRef:s,schemas:t,dbClient:a}=e;return t6({projectRef:s,query:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=(0,tJ.Pn)(tQ(),"\nSELECT\n  c.oid :: int8 AS id,\n  nc.nspname AS schema,\n  c.relname AS name,\n  c.relrowsecurity AS rls_enabled,\n  c.relforcerowsecurity AS rls_forced,\n  CASE\n    WHEN c.relreplident = 'd' THEN 'DEFAULT'\n    WHEN c.relreplident = 'i' THEN 'INDEX'\n    WHEN c.relreplident = 'f' THEN 'FULL'\n    ELSE 'NOTHING'\n  END AS replica_identity,\n  pg_total_relation_size(format('%I.%I', nc.nspname, c.relname)) :: int8 AS bytes,\n  pg_size_pretty(\n    pg_total_relation_size(format('%I.%I', nc.nspname, c.relname))\n  ) AS size,\n  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,\n  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,\n  obj_description(c.oid) AS comment,\n  coalesce(pk.primary_keys, '[]') as primary_keys,\n  coalesce(\n    jsonb_agg(relationships) filter (where relationships is not null),\n    '[]'\n  ) as relationships\nFROM\n  pg_namespace nc\n  JOIN pg_class c ON nc.oid = c.relnamespace\n  left join (\n    select\n      table_id,\n      jsonb_agg(_pk.*) as primary_keys\n    from (\n      select\n        n.nspname as schema,\n        c.relname as table_name,\n        a.attname as name,\n        c.oid :: int8 as table_id\n      from\n        pg_index i,\n        pg_class c,\n        pg_attribute a,\n        pg_namespace n\n      where\n        i.indrelid = c.oid\n        and c.relnamespace = n.oid\n        and a.attrelid = c.oid\n        and a.attnum = any (i.indkey)\n        and i.indisprimary\n    ) as _pk\n    group by table_id\n  ) as pk\n  on pk.table_id = c.oid\n  left join (\n    select\n      c.oid :: int8 as id,\n      c.conname as constraint_name,\n      nsa.nspname as source_schema,\n      csa.relname as source_table_name,\n      sa.attname as source_column_name,\n      nta.nspname as target_table_schema,\n      cta.relname as target_table_name,\n      ta.attname as target_column_name\n    from\n      pg_constraint c\n    join (\n      pg_attribute sa\n      join pg_class csa on sa.attrelid = csa.oid\n      join pg_namespace nsa on csa.relnamespace = nsa.oid\n    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)\n    join (\n      pg_attribute ta\n      join pg_class cta on ta.attrelid = cta.oid\n      join pg_namespace nta on cta.relnamespace = nta.oid\n    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)\n    where\n      c.contype = 'f'\n  ) as relationships\n  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)\n  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)\nWHERE\n  c.relkind IN ('r', 'p')\n  AND NOT pg_is_other_temp_schema(nc.oid)\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_table_privilege(\n      c.oid,\n      'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n    )\n    OR has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n  )\ngroup by\n  c.oid,\n  c.relname,\n  c.relrowsecurity,\n  c.relforcerowsecurity,\n  c.relreplident,\n  nc.nspname,\n  pk.primary_keys\n","\n-- Adapted from information_schema.columns\n\nSELECT\n  c.oid :: int8 AS table_id,\n  nc.nspname AS schema,\n  c.relname AS table,\n  (c.oid || '.' || a.attnum) AS id,\n  a.attnum AS ordinal_position,\n  a.attname AS name,\n  CASE\n    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)\n    ELSE NULL\n  END AS default_value,\n  CASE\n    WHEN t.typtype = 'd' THEN CASE\n      WHEN bt.typelem <> 0 :: oid\n      AND bt.typlen = -1 THEN 'ARRAY'\n      WHEN nbt.nspname = 'pg_catalog' THEN format_type(t.typbasetype, NULL)\n      ELSE 'USER-DEFINED'\n    END\n    ELSE CASE\n      WHEN t.typelem <> 0 :: oid\n      AND t.typlen = -1 THEN 'ARRAY'\n      WHEN nt.nspname = 'pg_catalog' THEN format_type(a.atttypid, NULL)\n      ELSE 'USER-DEFINED'\n    END\n  END AS data_type,\n  COALESCE(bt.typname, t.typname) AS format,\n  a.attidentity IN ('a', 'd') AS is_identity,\n  CASE\n    a.attidentity\n    WHEN 'a' THEN 'ALWAYS'\n    WHEN 'd' THEN 'BY DEFAULT'\n    ELSE NULL\n  END AS identity_generation,\n  a.attgenerated IN ('s') AS is_generated,\n  NOT (\n    a.attnotnull\n    OR t.typtype = 'd' AND t.typnotnull\n  ) AS is_nullable,\n  (\n    c.relkind IN ('r', 'p')\n    OR c.relkind IN ('v', 'f') AND pg_column_is_updatable(c.oid, a.attnum, FALSE)\n  ) AS is_updatable,\n  uniques.table_id IS NOT NULL AS is_unique,\n  check_constraints.definition AS \"check\",\n  array_to_json(\n    array(\n      SELECT\n        enumlabel\n      FROM\n        pg_catalog.pg_enum enums\n      WHERE\n        enums.enumtypid = coalesce(bt.oid, t.oid)\n        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)\n      ORDER BY\n        enums.enumsortorder\n    )\n  ) AS enums,\n  col_description(c.oid, a.attnum) AS comment\nFROM\n  pg_attribute a\n  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid\n  AND a.attnum = ad.adnum\n  JOIN (\n    pg_class c\n    JOIN pg_namespace nc ON c.relnamespace = nc.oid\n  ) ON a.attrelid = c.oid\n  JOIN (\n    pg_type t\n    JOIN pg_namespace nt ON t.typnamespace = nt.oid\n  ) ON a.atttypid = t.oid\n  LEFT JOIN (\n    pg_type bt\n    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid\n  ) ON t.typtype = 'd'\n  AND t.typbasetype = bt.oid\n  LEFT JOIN (\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position\n    FROM pg_catalog.pg_constraint\n    WHERE contype = 'u' AND cardinality(conkey) = 1\n  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum\n  LEFT JOIN (\n    -- We only select the first column check\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position,\n      substring(\n        pg_get_constraintdef(pg_constraint.oid, true),\n        8,\n        length(pg_get_constraintdef(pg_constraint.oid, true)) - 8\n      ) AS \"definition\"\n    FROM pg_constraint\n    WHERE contype = 'c' AND cardinality(conkey) = 1\n    ORDER BY table_id, ordinal_position, oid asc\n  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum\nWHERE\n  NOT pg_is_other_temp_schema(nc.oid)\n  AND a.attnum > 0\n  AND NOT a.attisdropped\n  AND (c.relkind IN ('r', 'v', 'm', 'f', 'p'))\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_column_privilege(\n      c.oid,\n      a.attnum,\n      'SELECT, INSERT, UPDATE, REFERENCES'\n    )\n  )\n",t$("columns","columns.table_id = tables.id"));return s+="\n",e.length>0?s+="where schema in (".concat(e.map(e=>"'".concat(e,"'")).join(","),")"):s+="where schema not in (".concat(tX.map(e=>"'".concat(e,"'")).join(","),")"),s}(t),readOnly:!0,dbClient:a})},t7=(e,s)=>{let t=t2();return(0,m.a)({queryKey:["tables",e,s],queryFn:()=>t8({projectRef:e,schemas:s,dbClient:t}),enabled:!!e})},t9=async(e,s)=>{let{data:t,error:a}=await s.GET("/v1/projects/{ref}/storage/buckets",{params:{path:{ref:e}}});if(a)throw a;return t},ae=e=>{let s=t2();return(0,m.a)({queryKey:["buckets",e],queryFn:()=>t9(e,s),enabled:!!e,retry:!1})},as=async e=>{let{projectRef:s,iso_timestamp_start:t,iso_timestamp_end:a,sql:n,dbClient:r}=e,{data:l,error:i}=await r.GET("/v1/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:s},query:{iso_timestamp_start:t,iso_timestamp_end:a,sql:n}}});if(i)throw i;return l},at=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=t2(),a=["logs",e,s.sql];return(0,m.a)({queryKey:a,queryFn:()=>{var a,n;let r=new Date,l=new Date(r.getTime()-36e5);return as({projectRef:e,sql:s.sql,iso_timestamp_start:null!==(a=s.iso_timestamp_start)&&void 0!==a?a:l.toISOString(),iso_timestamp_end:null!==(n=s.iso_timestamp_end)&&void 0!==n?n:r.toISOString(),dbClient:t})},enabled:!!e,retry:!1})},aa=e=>{let{projectRef:s,days:t,dbClient:a}=e;return t6({projectRef:s,query:"\n    WITH days_series AS (\n      SELECT generate_series(\n        date_trunc('day', now() - interval '".concat(Number(t)-1," days'),\n        date_trunc('day', now()),\n        '1 day'::interval\n      )::date AS date\n    )\n    SELECT\n      d.date,\n      COALESCE(u.users, 0)::int as users\n    FROM\n      days_series d\n    LEFT JOIN (\n      SELECT\n        date_trunc('day', created_at AT TIME ZONE 'UTC')::date as date,\n        count(id) as users\n      FROM\n        auth.users\n      GROUP BY 1\n    ) u ON d.date = u.date\n    ORDER BY\n      d.date ASC;\n  "),readOnly:!0,dbClient:a})},an=(e,s)=>{let t=t2();return(0,m.a)({queryKey:["user-counts",e,s],queryFn:()=>aa({projectRef:e,days:s,dbClient:t}),enabled:!!e,retry:!1})},ar=async(e,s)=>{let[{data:t,error:a},{data:n,error:r}]=await Promise.all([s.GET("/v1/projects/{ref}/advisors/performance",{params:{path:{ref:e}}}),s.GET("/v1/projects/{ref}/advisors/security",{params:{path:{ref:e}}})]);if(a)throw a;if(r)throw r;return[...((null==t?void 0:t.lints)||[]).map(e=>({...e,type:"performance"})),...((null==n?void 0:n.lints)||[]).map(e=>({...e,type:"security"}))]},al=e=>{let s=t2();return(0,m.a)({queryKey:["suggestions",e],queryFn:()=>ar(e,s),enabled:!!e,retry:!1})},ai=async(e,s)=>{let{data:t,error:a}=await s.GET("/v1/projects/{ref}/secrets",{params:{path:{ref:e}}});if(a)throw a;return console.log("SECRETS-DATA",t),t},ao=e=>{let s=t2();return(0,m.a)({queryKey:["secrets",e],queryFn:()=>ai(e,s),enabled:!!e,retry:!1})},ac=async e=>{let{projectRef:s,secrets:t,dbClient:a}=e,{data:n,error:r}=await a.POST("/v1/projects/{ref}/secrets",{params:{path:{ref:s}},body:t});if(r)throw r;return n},ad=()=>{let e=(0,eR.NL)(),s=t2();return(0,e2.D)({mutationFn:e=>{let{projectRef:t,secrets:a}=e;return ac({projectRef:t,secrets:a,dbClient:s})},onSuccess:(s,t)=>{ef.Am.success("Secrets created successfully."),e.refetchQueries({queryKey:["secrets",t.projectRef]})},onError:e=>{var s,t;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"There was a problem with your request.")}})},au=async e=>{let{projectRef:s,secretNames:t,dbClient:a}=e,{data:n,error:r}=await a.DELETE("/v1/projects/{ref}/secrets",{params:{path:{ref:s}},body:t});if(r)throw r;return n},am=()=>{let e=(0,eR.NL)(),s=t2();return(0,e2.D)({mutationFn:e=>{let{projectRef:t,secretNames:a}=e;return au({projectRef:t,secretNames:a,dbClient:s})},onSuccess:(s,t)=>{ef.Am.success("Secrets deleted successfully."),e.invalidateQueries({queryKey:["secrets",t.projectRef]})},onError:e=>{var s,t;ef.Am.error((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"There was a problem with your request.")}})},ah={disable_signup:"Disable Signup",external_anonymous_users_enabled:"Allow Anonymous Sign-ins",external_email_enabled:"Enable Email Provider",mailer_autoconfirm:"Confirm Email",mailer_secure_email_change_enabled:"Secure Email Change",security_update_password_require_reauthentication:"Secure Password Change",password_hibp_enabled:"Prevent Leaked Passwords",password_min_length:"Minimum Password Length",password_required_characters:{label:"Password Requirements",options:{NO_REQUIRED_CHARS:"No requirements","abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Letters and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789":"Lowercase, uppercase, and numbers","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~":"Letters, numbers, and symbols"}},mailer_otp_exp:"Email OTP Expiration (seconds)",mailer_otp_length:"Email OTP Length",external_phone_enabled:"Enable Phone Provider",sms_provider:{label:"SMS Provider",options:{twilio:"Twilio",messagebird:"MessageBird",textlocal:"TextLocal",vonage:"Vonage",twilio_verify:"Twilio Verify"}},sms_twilio_account_sid:"Twilio Account SID",sms_twilio_auth_token:"Twilio Auth Token",sms_twilio_message_service_sid:"Twilio Message Service SID",sms_twilio_content_sid:"Twilio Content SID",sms_twilio_verify_account_sid:"Twilio Verify Account SID",sms_twilio_verify_auth_token:"Twilio Verify Auth Token",sms_twilio_verify_message_service_sid:"Twilio Verify Message Service SID",sms_messagebird_access_key:"MessageBird Access Key",sms_messagebird_originator:"MessageBird Originator",sms_textlocal_api_key:"TextLocal API Key",sms_textlocal_sender:"TextLocal Sender",sms_vonage_api_key:"Vonage API Key",sms_vonage_api_secret:"Vonage API Secret",sms_vonage_from:"Vonage From Number",sms_autoconfirm:"Enable Phone Confirmations",sms_otp_exp:"SMS OTP Expiry (seconds)",sms_otp_length:"SMS OTP Length",sms_template:"SMS Message Template",sms_test_otp:"Test Phone Numbers and OTPs",sms_test_otp_valid_until:"Test OTPs Valid Until",external_google_enabled:"Enable Google Sign-in",external_google_client_id:"Google Client ID(s)",external_google_secret:"Google OAuth Client Secret",external_google_skip_nonce_check:"Skip Nonce Check",name:"Secret Name",value:"Secret Value",secretNames:"Secret Names"},ap=sz.z.object({disable_signup:sz.z.boolean().optional().describe("This will prevent new users from signing up."),external_anonymous_users_enabled:sz.z.boolean().optional().describe("This will enable anonymous users to sign in to your application.")}),ax="NO_REQUIRED_CHARS",ag=sz.z.object({external_email_enabled:sz.z.boolean().optional().describe("This will enable Email based signup and login for your application."),mailer_autoconfirm:sz.z.boolean().optional().describe("Users will need to confirm their email address before signing in for the first time."),mailer_secure_email_change_enabled:sz.z.boolean().optional().describe("Users will be required to confirm any email change on both the old email address and new email address. If disabled, only the new email is required to confirm."),security_update_password_require_reauthentication:sz.z.boolean().optional().describe("Users will need to be recently logged in to change their password without requiring reauthentication. (A user is considered recently logged in if the session was created within the last 24 hours.) If disabled, a user can change their password at any time."),password_hibp_enabled:sz.z.boolean().optional().describe("Rejects the use of known or easy to guess passwords on sign up or password change. Powered by the HaveIBeenPwned.org Pwned Passwords API."),password_min_length:sz.z.number().int().min(6,"Must be greater or equal to 6.").describe("Passwords shorter than this value will be rejected as weak. Minimum 6, recommended 8 or more."),password_required_characters:sz.z.preprocess(e=>""===e||null==e?ax:e,sz.z.enum([ax,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789","abcdefghijklmnopqrstuvwxyz:ABCDEFGHIJKLMNOPQRSTUVWXYZ:0123456789:!@#$%^&*()_+-=[]{};'\\\\:\"|<>?,./`~"])).optional().transform(e=>e===ax?"":e).describe("Passwords that do not have at least one of each will be rejected as weak."),mailer_otp_exp:sz.z.number().int().min(0,"Must be more than 0").max(86400,"Must be no more than 86400").describe("Duration before an email otp / link expires in seconds."),mailer_otp_length:sz.z.number().int().min(6,"Must be at least 6").max(10,"Must be no more than 10").optional().describe("Number of digits in the email OTP")}).describe("Email provider settings."),af=sz.z.object({external_phone_enabled:sz.z.boolean().optional().describe("This will enable phone based login for your application"),sms_provider:sz.z.enum(["twilio","messagebird","textlocal","vonage","twilio_verify"]).optional().describe("External provider that will handle sending SMS messages"),sms_twilio_account_sid:sz.z.string().optional(),sms_twilio_auth_token:sz.z.string().optional(),sms_twilio_message_service_sid:sz.z.string().optional(),sms_twilio_content_sid:sz.z.string().optional().describe("Twilio Content SID (Optional, For WhatsApp Only)"),sms_twilio_verify_account_sid:sz.z.string().optional(),sms_twilio_verify_auth_token:sz.z.string().optional(),sms_twilio_verify_message_service_sid:sz.z.string().optional(),sms_messagebird_access_key:sz.z.string().optional(),sms_messagebird_originator:sz.z.string().optional(),sms_textlocal_api_key:sz.z.string().optional(),sms_textlocal_sender:sz.z.string().optional(),sms_vonage_api_key:sz.z.string().optional(),sms_vonage_api_secret:sz.z.string().optional(),sms_vonage_from:sz.z.string().optional(),sms_autoconfirm:sz.z.boolean().optional().describe("Users will need to confirm their phone number before signing in."),sms_otp_exp:sz.z.number().int().optional().describe("Duration before an SMS OTP expires in seconds."),sms_otp_length:sz.z.number().int().optional().describe("Number of digits in OTP."),sms_template:sz.z.string().optional().describe("To format the OTP code use `{{ .Code }}`"),sms_test_otp:sz.z.string().optional().describe("Register phone number and OTP combinations for testing as a comma separated list of <phone number>=<otp> pairs. Example: `18005550123=789012`"),sms_test_otp_valid_until:sz.z.string().datetime({message:"Invalid datetime string."}).optional().describe("Test phone number and OTP combinations won't be active past this date and time (local time zone).")}).describe("Phone provider settings."),aj=sz.z.object({external_google_enabled:sz.z.boolean().optional().describe("Enable Sign in with Google"),external_google_client_id:sz.z.string().regex(/^([a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*(,[a-z0-9-]+\.[a-z0-9-]+(\.[a-z0-9-]+)*)*)$/i,"Google Client IDs should be a comma-separated list of domain-like strings.").optional(),external_google_secret:sz.z.string().regex(/^[a-z0-9.\/_-]*$/i,"Google OAuth Client Secrets usually contain letters, numbers, dots, dashes, and underscores.").optional(),external_google_skip_nonce_check:sz.z.boolean().optional().describe("Allows ID tokens with any nonce to be accepted, which is less secure.")}),av=aj.superRefine((e,s)=>{e.external_google_enabled&&!e.external_google_client_id&&s.addIssue({code:sz.z.ZodIssueCode.custom,path:["external_google_client_id"],message:"At least one Client ID is required when Google sign-in is enabled."}),e.external_google_client_id&&e.external_google_client_id.includes(" ")&&s.addIssue({code:sz.z.ZodIssueCode.custom,path:["external_google_client_id"],message:"Client IDs should not contain spaces."})}).describe("Google provider settings.");ap.merge(ag).merge(af).merge(aj).partial();let ab=sz.z.object({secrets:sz.z.array(sz.z.object({name:sz.z.string().min(1,"Secret name is required.").regex(/^[a-zA-Z_][a-zA-Z0-9_]*$/,"Must contain letters, numbers, and underscores, starting with a letter or underscore."),value:sz.z.string().min(1,"Secret value is required.")}))}).describe("Secrets schema for managing environment variables.");sz.z.object({secretNames:sz.z.array(sz.z.string().min(1,"Secret name cannot be empty.")).min(1,"At least one secret name is required.")}).describe("Schema for deleting secrets by name.");let ay=e=>{if(!e||"object"!=typeof e._def||null===e._def)throw Error("unwrapZodType received an invalid Zod schema object. Check the console for the problematic schema/key.");let s=e;for(;"ZodOptional"===s._def.typeName||"ZodDefault"===s._def.typeName||"ZodNullable"===s._def.typeName||"ZodEffects"===s._def.typeName;)s="ZodEffects"===s._def.typeName?s._def.schema:s._def.innerType;return s};function aw(e){let{schema:s,onSubmit:t,isLoading:a=!1,initialValues:n,labels:r,columnInfo:l}=e,c=(0,o.useRef)(!0),d=Object.keys(s.shape).reduce((e,t)=>{let a=s.shape[t];if(void 0===a)throw Error("Schema error: schema.shape['".concat(t,"'] is undefined. Check schema definition."));if("ZodDefault"===a._def.typeName)return e[t]=a._def.defaultValue(),e;let n=ay(a);switch(n._def.typeName){case"ZodString":e[t]="";break;case"ZodBoolean":e[t]=!1;break;case"ZodEnum":let r=n._def.values||[];e[t]=r.length>0?r[0]:"";break;case"ZodNumber":e[t]=0;break;case"ZodArray":e[t]=[];break;default:e[t]=void 0}return e},{}),u=(0,sE.cI)({resolver:(0,sS.F)(s),defaultValues:d});(0,o.useEffect)(()=>{if(n){c.current=!0;let e=Object.keys(s.shape).reduce((e,t)=>{let a=s.shape[t];if(void 0===a)throw Error("Schema error in useEffect: schema.shape['".concat(t,"'] is undefined."));let r=n.hasOwnProperty(t)?n[t]:void 0,l=ay(a);if("ZodBoolean"===l._def.typeName)e[t]=!!r;else if("ZodString"===l._def.typeName)e[t]=null==r?"":String(r);else if("ZodEnum"===l._def.typeName){let s=l._def.values||[];e[t]=null!=r&&s.includes(r)?String(r):s[0]||""}else if("ZodNumber"===l._def.typeName){let s=Number(r);e[t]=isNaN(s)?0:s}else if("ZodArray"===l._def.typeName){if(Array.isArray(r))e[t]=r;else if(null==r)e[t]=[];else if("string"==typeof r&&r.startsWith("{")&&r.endsWith("}"))try{let s=r.slice(1,-1);""===s.trim()?e[t]=[]:e[t]=s.split(",").map(e=>e.trim())}catch(s){e[t]=[]}else e[t]=[]}else e[t]=r;return e},{});u.reset(e),setTimeout(()=>{c.current=!1},0)}else c.current=!1},[n,u,s]);let m=(e,s)=>{let t=ay(s),a=t._def.typeName,n=s.description;return(0,i.jsx)(sP.Wi,{control:u.control,name:e,render:s=>{var o,d,u,m;let{field:h}=s,p=null==r?void 0:r[e],x="string"==typeof p?p:(null==p?void 0:p.label)||e,g=(null==l?void 0:null===(o=l[e])||void 0===o?void 0:o.data_type)||"";switch(a){case"ZodString":return(0,i.jsx)(sP.xJ,{className:"border-b py-6",children:(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(sP.lX,{children:x}),(0,i.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:g}),n&&(0,i.jsx)(sP.pf,{children:n}),(0,i.jsx)(sP.zG,{})]}),(0,i.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{placeholder:"Enter your ".concat(e),...h,value:h.value||""})})})]})});case"ZodNumber":return(0,i.jsx)(sP.xJ,{className:"border-b py-6",children:(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(sP.lX,{children:x}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:g}),n&&(0,i.jsx)(sP.pf,{children:n}),(0,i.jsx)(sP.zG,{})]}),(0,i.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{type:"number",placeholder:"Enter value for ".concat(e),...h,value:null!==(d=h.value)&&void 0!==d?d:"",onChange:e=>{let s=parseInt(e.target.value,10);h.onChange(isNaN(s)?void 0:s)}})})})]})});case"ZodBoolean":return(0,i.jsxs)(sP.xJ,{className:"flex flex-row items-center justify-between gap-8 border-b py-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(sP.lX,{children:x}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:g}),n&&(0,i.jsx)(sP.pf,{children:n}),(0,i.jsx)(sP.zG,{})]}),(0,i.jsx)(sP.NI,{children:(0,i.jsx)(eV.r,{checked:!!h.value,onCheckedChange:h.onChange})})]});case"ZodEnum":let f=t._def.values,j="object"==typeof p?p.options:void 0;return(0,i.jsx)(sP.xJ,{className:"border-b py-6",children:(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-4 lg:flex-row lg:items-center lg:gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(sP.lX,{children:x}),(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:g}),n&&(0,i.jsx)(sP.pf,{children:n}),(0,i.jsx)(sP.zG,{})]}),(0,i.jsx)("div",{className:"lg:max-w-1/2 flex-1",children:(0,i.jsxs)(eF.Ph,{onValueChange:e=>{c.current||h.onChange(e)},value:h.value,children:[(0,i.jsx)(sP.NI,{children:(0,i.jsx)(eF.i4,{children:(0,i.jsx)(eF.ki,{placeholder:"Select a ".concat(e)})})}),(0,i.jsx)(eF.Bw,{children:f.map(e=>(0,i.jsx)(eF.Ql,{value:e,children:(null==j?void 0:j[e])||e},e))})]})})]})});case"ZodArray":return(0,i.jsx)(sP.xJ,{className:"border-b py-6",children:(0,i.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-8",children:[(0,i.jsxs)("div",{className:"flex-1 pr-4",children:[(0,i.jsx)(sP.lX,{children:x}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:['Enter as JSON array: ["item1", "item2"]',(null==l?void 0:null===(u=l[e])||void 0===u?void 0:u.is_nullable)&&" (leave empty for null)"]}),n&&(0,i.jsx)(sP.pf,{children:n}),(0,i.jsx)(sP.zG,{})]}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{placeholder:(null==l?void 0:null===(m=l[e])||void 0===m?void 0:m.is_nullable)?'["item1", "item2"] or leave empty for null':'["item1", "item2"]',...h,value:null===h.value||void 0===h.value?"":Array.isArray(h.value)?JSON.stringify(h.value):h.value||"",onChange:e=>{let s=e.target.value;if(""===s.trim())h.onChange(null);else try{let e=JSON.parse(s);Array.isArray(e)?h.onChange(e):h.onChange(s)}catch(e){h.onChange(s)}}})})})]})});default:return(0,i.jsx)(i.Fragment,{})}}},e)};return(0,i.jsx)(sP.l0,{...u,children:(0,i.jsxs)("form",{onSubmit:u.handleSubmit(t),children:[Object.keys(s.shape).map(e=>m(e,s.shape[e])),(0,i.jsx)("div",{className:"pt-6",children:(0,i.jsx)(ei.z,{type:"submit",disabled:a,children:a?"Saving...":"Save"})})]})})}function aN(e){let{projectRef:s,schema:t,title:a,initialValues:n,onSuccess:r}=e,{mutate:l,isPending:c}=t5(),d="shape"in t?t:t._def.schema,u=t2(),m=(0,o.useMemo)(()=>{if(n)return Object.keys(d.shape).reduce((e,s)=>(Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s]),e),{})},[n,d]);return(0,i.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,i.jsx)("h2",{className:"font-semibold mb-2 lg:mb-4 lg:text-xl",children:a}),(0,i.jsx)(aw,{schema:d,onSubmit:e=>{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[s,t]=e;return void 0!==t}));if(0===Object.keys(t).length){alert("No changes to submit. Please modify a field to update.");return}l({projectRef:s,payload:t,dbClient:u},{onSuccess:r})},isLoading:c,initialValues:m,labels:ah})]})}function a_(e){let{projectRef:s}=e,{data:t,isLoading:a,error:n}=t1(s),r=t2(),{mutate:l,isPending:c}=t5(),{push:d,pop:u}=tK(),m=[{icon:(0,i.jsx)(er.Z,{name:"menu",className:"h-4 w-4 text-muted-foreground"}),name:"Email",description:"Sign in with email and password",schema:ag},{icon:(0,i.jsx)(er.Z,{name:"phone_iphone",className:"h-4 w-4 text-muted-foreground"}),name:"Phone",description:"Sign in with phone number",schema:af},{icon:(0,i.jsx)(er.Z,{name:"person",className:"h-4 w-4 text-muted-foreground"}),name:"Google",description:"Sign in with Google",schema:av}],h=(0,o.useCallback)(e=>{d({title:"".concat(e.name," Provider Settings"),component:(0,i.jsx)(aN,{projectRef:s,schema:e.schema,title:"".concat(e.name," Provider Settings"),initialValues:t,onSuccess:()=>u()})})},[s,t,d,u]),p=(0,o.useMemo)(()=>{if(t)return Object.keys(ap.shape).reduce((e,s)=>(Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]),e),{})},[t]);return n?(0,i.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(er.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error loading auth settings"}),(0,i.jsx)(tC.X,{children:"There was a problem loading your authentication configuration."})]})}):a?(0,i.jsxs)("div",{className:"mx-auto w-full max-w-3xl space-y-2 p-12",children:[(0,i.jsx)(Q.O,{className:"mb-8 h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"})]}):(0,i.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,i.jsxs)("div",{className:"mb-12",children:[(0,i.jsx)("h2",{className:"font-semibold text-base lg:text-xl",children:"General Settings"}),(0,i.jsx)("p",{className:"mb-2 mt-1 text-sm text-muted-foreground lg:text-base",children:"Allow people to sign up to your app"}),(0,i.jsx)(aw,{schema:ap,onSubmit:e=>{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[s,t]=e;return void 0!==t}));if(0===Object.keys(t).length){alert("No changes to submit. Please modify a field to update.");return}l({projectRef:s,payload:t,dbClient:r})},isLoading:c,initialValues:p,labels:ah})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"font-semibold lg:text-lg",children:"Sign in methods"}),(0,i.jsx)("p",{className:"mb-6 mt-1 text-sm text-muted-foreground lg:text-base",children:"Configure how people sign in and up to your app."}),(0,i.jsx)("div",{className:"overflow-hidden rounded-md border bg-background",children:m.map(e=>(0,i.jsxs)(ei.z,{variant:"ghost",size:"lg",onClick:()=>h(e),className:"h-auto w-full flex-row justify-start gap-4 rounded-none border-b px-8 py-4 text-left last:border-b-0",children:[e.icon,(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h3",{className:"font-bold",children:e.name}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,i.jsx)(er.Z,{name:"chevron_right",className:"h-4 w-4 text-muted-foreground"})]},e.name))})]})]})}var ak=t(79001),aC=t(76865),aS=t(82029),aE=t(48736),az=t(20464),aA=t(51817),aP=t(20265),aO=t(77031),aD=t(83046),aI=t(61563);let aT=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{className:"relative w-full overflow-auto",children:(0,i.jsx)("table",{ref:s,className:(0,S.cn)("w-full caption-bottom text-sm",t),...a})})});aT.displayName="Table";let aL=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("thead",{ref:s,className:(0,S.cn)("[&_tr]:border-b",t),...a})});aL.displayName="TableHeader";let aR=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("tbody",{ref:s,className:(0,S.cn)("[&_tr:last-child]:border-0",t),...a})});aR.displayName="TableBody",o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("tfoot",{ref:s,className:(0,S.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let aF=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("tr",{ref:s,className:(0,S.cn)("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",t),...a})});aF.displayName="TableRow";let aM=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("th",{ref:s,className:(0,S.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})});aM.displayName="TableHead";let aZ=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("td",{ref:s,className:(0,S.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})});function aq(e){let{data:s,onRowClick:t}=e;if(!s||0===s.length)return(0,i.jsx)("p",{className:"p-4 text-center",children:"The query returned no results."});let a=Object.keys(s[0]);return(0,i.jsx)("div",{className:"overflow-auto",children:(0,i.jsxs)(aT,{children:[(0,i.jsx)(aL,{children:(0,i.jsx)(aF,{className:"hover:bg-transparent",children:a.map(e=>(0,i.jsx)(aM,{className:"first:pl-6 last:pr-6 lg:first:pl-8 lg:last:pr-8",children:e},e))})}),(0,i.jsx)(aR,{children:s.map((e,s)=>(0,i.jsx)(aF,{onClick:()=>null==t?void 0:t(e),className:(0,S.cn)(t&&"group cursor-pointer hover:bg-muted/50"),children:a.map(t=>(0,i.jsx)(aZ,{className:"min-w-[8rem] text-xs text-muted-foreground first:pl-6 last:pr-6 group-hover:text-foreground lg:first:pl-8 lg:last:pr-8",children:(0,i.jsx)("div",{className:"w-fit max-w-96 truncate font-mono text-xs",children:JSON.stringify(e[t]).replace(/^"|"$/g,"")})},"".concat(s,"-").concat(t)))},s))})]})})}function aU(e){var s,t;let{projectRef:a,initialSql:n,queryKey:r,onResults:l,onRowClick:c,label:d="Query your data",hideSql:u=!1,readOnly:m=!1,runAutomatically:h=!1,refetch:p,initialNaturalLanguageMode:x=!1,hideChartOption:g=!1}=e,[f,j]=(0,o.useState)(n||""),[v,b]=(0,o.useState)(!u),[y,w]=(0,o.useState)(x),[N,_]=(0,o.useState)(""),{mutate:k,data:C,isPending:S,error:E}=t3(),[z,A]=(0,o.useState)(!1),[P,O]=(0,o.useState)(null),[D,I]=(0,o.useState)(!1),[T,L]=(0,o.useState)(null),[R,F]=(0,o.useState)(null),M=(0,o.useMemo)(()=>C&&0!==C.length&&C[0]?Object.keys(C[0]):[],[C]);(0,o.useEffect)(()=>{n&&j(n)},[n]);let Z=async()=>{if(N){A(!0),O(null);try{let e=await fetch("/api/ai/sql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:N,projectRef:a})});if(!e.ok){let s=await e.json();throw Error(s.message||"Failed to generate SQL")}let{sql:s}=await e.json();j(s),k({projectRef:a,query:s,readOnly:!0})}catch(e){console.error(e),O(e.message)}finally{A(!1)}}},q=(0,o.useCallback)(()=>{f&&k({projectRef:a,query:f,readOnly:!0})},[f,a,k]);(0,o.useEffect)(()=>{b(!u)},[u]),(0,o.useEffect)(()=>{h&&n&&k({projectRef:a,query:n,readOnly:!0})},[h,n,a,k]),(0,o.useEffect)(()=>{p&&p>0&&q()},[p,q]),(0,o.useEffect)(()=>{l&&l(C)},[C,l]),(0,o.useEffect)(()=>{!(!C||Array.isArray(C)&&0===C.length)||v||y||m||S||b(!0)},[C,v,y]);let U=(null==E?void 0:null===(t=E.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"",W=U.includes("permission denied")||U.includes("42501"),K=(0,o.useMemo)(()=>{let e=[];return y&&e.push("chat"),v&&e.push("sql"),!g&&D&&e.push("chart"),e},[y,v,D,g]);return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"pt-4 lg:px-8 lg:pt-8",children:[(0,i.jsxs)("div",{className:"mb-4 flex items-center gap-4",children:[(0,i.jsx)("h2",{className:"font-semibold flex-1",children:d}),(0,i.jsxs)(aI.t,{type:"multiple",size:"sm",value:K,onValueChange:e=>{w(e.includes("chat")),b(e.includes("sql")),g||I(e.includes("chart"))},className:"gap-1",children:[(0,i.jsx)(aI.G,{value:"chat","aria-label":"Chat",children:(0,i.jsx)(ak.Z,{className:"h-4 w-4"})}),(0,i.jsx)(aI.G,{value:"sql","aria-label":"SQL",children:(0,i.jsx)(aE.Z,{className:"h-4 w-4"})}),!g&&(0,i.jsxs)(s1.J2,{children:[(0,i.jsx)(s1.xo,{asChild:!0,children:(0,i.jsx)(aI.G,{value:"chart","aria-label":"Chart",children:(0,i.jsx)(az.Z,{className:"h-4 w-4"})})}),(0,i.jsx)(s1.yk,{className:"w-80",children:(0,i.jsx)("div",{className:"grid gap-4",children:(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(sU.Label,{className:"mb-2 block flex-1",children:"Show Chart"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Visualize your data with a chart."})]}),(0,i.jsx)(eV.r,{id:"show-chart",className:"mb-0",checked:D,onCheckedChange:I})]}),D&&(0,i.jsxs)("div",{className:"mt-2",children:[(0,i.jsxs)("div",{className:"mb-2 grid grid-cols-3 items-center gap-4",children:[(0,i.jsx)(sU.Label,{htmlFor:"x-axis",children:"X-Axis"}),(0,i.jsxs)(eF.Ph,{onValueChange:L,defaultValue:T||void 0,children:[(0,i.jsx)(eF.i4,{className:"col-span-2 h-8",children:(0,i.jsx)(eF.ki,{placeholder:"Select column"})}),(0,i.jsx)(eF.Bw,{children:M.map(e=>(0,i.jsx)(eF.Ql,{value:e,children:e},e))})]})]}),(0,i.jsxs)("div",{className:"mb-2 grid grid-cols-3 items-center gap-4",children:[(0,i.jsx)(sU.Label,{htmlFor:"y-axis",children:"Y-Axis"}),(0,i.jsxs)(eF.Ph,{onValueChange:F,defaultValue:R||void 0,children:[(0,i.jsx)(eF.i4,{className:"col-span-2 h-8",children:(0,i.jsx)(eF.ki,{placeholder:"Select column"})}),(0,i.jsx)(eF.Bw,{children:M.map(e=>(0,i.jsx)(eF.Ql,{value:e,children:e},e))})]})]})]})]})})})]})]})]}),(0,i.jsxs)("div",{children:[y&&(0,i.jsxs)("div",{className:"mb-4 flex items-center gap-4 rounded-md border bg-muted/50 pl-4 pr-1 shadow",children:[(0,i.jsx)(ak.Z,{strokeWidth:1.5,size:16}),(0,i.jsx)(sk.I,{placeholder:"e.g. Show me all users who signed up in the last 7 days",value:N,onChange:e=>_(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Z())},className:"rounded-none border-none bg-transparent px-0 py-4 text-sm shadow-none focus-visible:ring-0 focus-visible:ring-offset-0 lg:text-base"}),(0,i.jsx)(ei.z,{onClick:Z,disabled:z||S,className:"h-7 w-7 shrink-0 rounded-full p-0",children:z?(0,i.jsx)(aA.Z,{size:16,className:"animate-spin"}):S?(0,i.jsx)(aA.Z,{size:16,className:"animate-spin"}):(0,i.jsx)(aP.Z,{size:16})})]}),v&&(0,i.jsx)("div",{className:"relative -mx-6 mt-4 overflow-hidden border-b border-t bg-muted lg:-mx-8",children:(0,i.jsx)(ei.z,{size:"sm",onClick:q,disabled:S,className:"absolute bottom-4 right-4",children:S?"Running...":"Run Query"})})]})]}),S&&(0,i.jsxs)("div",{className:"space-y-2 p-4 px-6 lg:px-8",children:[(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"})]}),P&&(0,i.jsx)("div",{className:"px-6 py-4 lg:px-8",children:(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(aC.Z,{className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error generating SQL"}),(0,i.jsx)(tC.X,{children:P})]})}),E&&(0,i.jsx)("div",{className:"px-6 py-4 lg:px-8",children:(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(aC.Z,{className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Query Error"}),(0,i.jsx)(tC.X,{children:W?"You can't directly alter your database schema, use chat instead":U||(null==E?void 0:E.message)||"An unexpected error occurred"})]})}),!g&&C&&D&&T&&R&&(0,i.jsx)("div",{className:"mb-4 mt-8 px-8",children:(0,i.jsx)(aW,{data:C,xAxis:T,yAxis:R})}),C&&(0,i.jsx)("div",{children:(0,i.jsx)(aq,{data:C,onRowClick:e=>null==c?void 0:c(e,r)})})]})}function aW(e){let{data:s,xAxis:t,yAxis:a}=e;return(0,i.jsx)(A,{config:{[a]:{label:a,color:"var(--chart-1)"}},className:"aspect-auto h-[250px] w-full",children:(0,i.jsxs)(aO.v,{accessibilityLayer:!0,data:s,margin:{left:-24,right:12},children:[(0,i.jsx)(v.q,{vertical:!1}),(0,i.jsx)(b.K,{dataKey:t,tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32}),(0,i.jsx)(y.B,{dataKey:a,tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,i.jsx)(O,{content:(0,i.jsx)(D,{className:"w-[150px]",indicator:"dot"})}),(0,i.jsx)(aD.$,{dataKey:a,fill:"var(--color-".concat(a,")")})]})})}aZ.displayName="TableCell",o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("caption",{ref:s,className:(0,S.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption";let aK=e=>e&&e.primary_keys?e.primary_keys.map(e=>e.name):[];function aG(e){let{projectRef:s,table:t,row:a,onSuccess:n}=e,{mutate:r,isPending:l}=t3(),c=(0,o.useMemo)(()=>(function(e){if(!e||!e.columns)return sz.z.object({});let s={};for(let t of e.columns){let e;if(!t.is_updatable||t.is_generated)continue;let a=t.data_type.toLowerCase();e=a.includes("array")?sz.z.array(sz.z.any()):a.includes("int")||a.includes("numeric")?sz.z.number():a.includes("bool")?sz.z.boolean():"user-defined"===a&&t.enums&&Array.isArray(t.enums)&&t.enums.length>0?sz.z.enum(t.enums):sz.z.string(),t.is_nullable&&(e=e.nullish()),s[t.name]=e}return sz.z.object(s)})(t),[t]),d=(0,o.useMemo)(()=>{if(!t||!t.columns)return{};let e={};for(let s of t.columns){if(!s.is_updatable||s.is_generated)continue;let t=s.data_type.toLowerCase(),a="user-defined"===t&&s.enums&&Array.isArray(s.enums)&&s.enums.length>0?"enum":t;e[s.name]={data_type:a,is_nullable:s.is_nullable}}return e},[t]),u=(0,o.useCallback)(e=>{let l=aK(t);if(0===l.length){ef.Am.error("Cannot update row. This table does not have a primary key.");return}let i=Object.entries(e).map(e=>{var s;let n,[r,l]=e;if(JSON.stringify(a[r])===JSON.stringify(l))return null;let i=t.columns.find(e=>e.name===r),o=(null==i?void 0:null===(s=i.data_type)||void 0===s?void 0:s.toLowerCase())||"",c=(null==i?void 0:i.is_nullable)||!1;if(null==l||"string"==typeof l&&""===l.trim()){if(c)n="NULL";else if(o.includes("array")){let e=JSON.stringify({[r]:[]});n="(select ".concat(r,' from json_populate_record(null::public."').concat(t.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else n="''"}else if(Array.isArray(l)&&0===l.length){let e=JSON.stringify({[r]:[]});n="(select ".concat(r,' from json_populate_record(null::public."').concat(t.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else if(o.includes("array")){let e=JSON.stringify({[r]:l});n="(select ".concat(r,' from json_populate_record(null::public."').concat(t.name,"\", '").concat(e.replace(/'/g,"''"),"'))")}else n="user-defined"===o&&(null==i?void 0:i.enums)?"'".concat(String(l).replace(/'/g,"''"),"'"):"string"==typeof l?"'".concat(l.replace(/'/g,"''"),"'"):l;return'"'.concat(r,'" = ').concat(n)}).filter(Boolean).join(", ");if(!i){ef.Am.error("No changes to save"),n();return}let o=l.map(e=>{let s=a[e],t="string"==typeof s?"'".concat(s.replace(/'/g,"''"),"'"):s;return'"'.concat(e,'" = ').concat(t)}).join(" AND ");r({projectRef:s,query:'UPDATE public."'.concat(t.name,'" SET ').concat(i," WHERE ").concat(o,";"),readOnly:!1},{onSuccess:n})},[s,t,a,r,n]);return(0,i.jsxs)("div",{className:"px-6 pb-10 pt-4 lg:px-12 lg:pt-10",children:[(0,i.jsxs)("h2",{className:"font-semibold mb-4 text-base lg:text-xl",children:["Editing row in ",t.name]}),(0,i.jsx)(aw,{schema:c,initialValues:a,onSubmit:u,isLoading:l,columnInfo:d})]})}function aV(e){let{projectRef:s,table:t}=e,{push:a,pop:n}=tK(),[r,l]=(0,o.useState)(0),c=(0,o.useCallback)(e=>{a({title:"Editing row",component:(0,i.jsx)(aG,{projectRef:s,table:t,row:e,onSuccess:()=>{n(),l(e=>e+1)}})})},[a,n,s,t]);return(0,i.jsx)(aU,{hideChartOption:!0,projectRef:s,label:"View records in ".concat(t.name),initialSql:'SELECT * FROM public."'.concat(t.name,'" LIMIT 100;'),queryKey:t.id,onRowClick:c,hideSql:!0,runAutomatically:!0,refetch:r,readOnly:!0})}function aB(e){let{projectRef:s}=e,{push:t}=tK(),{data:a,isLoading:n,isError:r}=t7(s,["public"]),l=(0,o.useCallback)(e=>{t({title:e.name,component:(0,i.jsx)(aV,{projectRef:s,table:e})})},[t,s]),c=(0,o.useCallback)(()=>{t({title:"Talk to your database",component:(0,i.jsx)(aU,{projectRef:s,initialNaturalLanguageMode:!0,hideSql:!0})})},[t,s]);return(0,i.jsxs)("div",{className:"pt-4 lg:pt-8",children:[(0,i.jsxs)("div",{className:"mb-6 flex items-center justify-between gap-6",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Database"}),(0,i.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"View and manage the data stored in your app."})]}),(0,i.jsxs)(ei.z,{variant:"outline",className:"flex-row justify-between",onClick:c,children:[(0,i.jsx)(ak.Z,{strokeWidth:1.5,size:16}),"Query your database"]},"talk-to-db")]}),r&&(0,i.jsxs)(tC.bZ,{variant:"destructive",className:"mt-8",children:[(0,i.jsx)(aC.Z,{className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error loading tables"}),(0,i.jsx)(tC.X,{children:"There was a problem loading your database tables."})]}),n&&(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"})]}),a&&a.length>0?(0,i.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,i.jsxs)(ei.z,{variant:"outline",size:"lg",className:"flex-row justify-between text-left",onClick:()=>l(e),children:[(0,i.jsx)(aS.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,i.jsx)("h2",{className:"flex-1 truncate font-mono text-sm font-medium",children:e.name}),(0,i.jsxs)("div",{className:"shrink-0 font-mono text-sm text-muted-foreground",children:[e.live_rows_estimate," rows"]})]},e.id))}):n||a&&0!==a.length?null:(0,i.jsxs)(tC.bZ,{className:"mt-8",children:[(0,i.jsx)(aS.Z,{className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"No database tables"}),(0,i.jsx)(tC.X,{children:"Create tables to store and organize your data."})]})]})}var aH=t(24156),aJ=t(30401),aQ=t(80221),aY=t(23231),aX=t(23518),a$=t(5073);(a=r||(r={})).FN_EDGE="function_edge_logs",a.AUTH="auth_logs",a.POSTGRES="postgres_logs",a.REALTIME="realtime_logs",a.STORAGE="storage_logs",a.PG_CRON="pg_cron_logs",a.EDGE="edge_logs",a.FUNCTIONS="function_logs",a.POSTGREST="postgrest_logs",a.SUPAVISOR="supavisor_logs",a.PGBOUNCER="pgbouncer_logs",a.WAREHOUSE="warehouse_logs",a.PG_UPGRADE="pg_upgrade_logs";let a0=e=>{switch(e){case"edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.request) as request\n  cross join unnest(m.response) as response";case"postgres_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as parsed";case"function_logs":case"auth_logs":return"cross join unnest(metadata) as metadata";case"function_edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.response) as response\n  cross join unnest(m.request) as request";case"supavisor_logs":return"cross join unnest(metadata) as m";default:return""}},a1=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=a0(e),a="order by timestamp desc";switch(e){case"edge_logs":return"select id, ".concat(e,".timestamp, event_message, request.method, request.path, request.search, response.status_code\nfrom ").concat(e,"\n").concat(t,"\n").concat(a,"\nlimit ").concat(s);case"postgres_logs":return"select ".concat(e,".timestamp, id, event_message, parsed.error_severity, parsed.detail, parsed.hint\nfrom ").concat(e,"\n").concat(t,"\n").concat(a,"\nlimit ").concat(s);case"function_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.event_type, metadata.function_id, metadata.level\nfrom ").concat(e,"\n").concat(t,"\n").concat(a,"\nlimit ").concat(s);case"auth_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.level, metadata.status, metadata.path, metadata.msg as msg, metadata.error\nfrom ").concat(e,"\n").concat(t,"\n").concat(a,"\nlimit ").concat(s);case"function_edge_logs":return"select id, ".concat(e,".timestamp, event_message, response.status_code, request.method, m.function_id, m.execution_time_ms, m.deployment_id, m.version\nfrom ").concat(e,"\n").concat(t,"\n").concat(a,"\nlimit ").concat(s);case"supavisor_logs":case"pg_upgrade_logs":default:return"select id, ".concat(e,".timestamp, event_message\nfrom ").concat(e,"\n").concat(t,"\n").concat(a,"\nlimit ").concat(s);case"pg_cron_logs":return"select postgres_logs.timestamp, id, event_message, parsed.error_severity, parsed.query\nfrom postgres_logs\ncross join unnest(metadata) as m\ncross join unnest(m.parsed) as parsed\nwhere (parsed.application_name = 'pg_cron' OR event_message LIKE '%cron job%')\n".concat(a,"\nlimit ").concat(s)}},a2=[{value:r.FN_EDGE,label:"Function Edge Logs",description:"Edge function execution logs with request/response data"},{value:r.AUTH,label:"Authentication Logs",description:"User authentication events and security logs"},{value:r.POSTGRES,label:"PostgreSQL Logs",description:"Database queries, errors, and performance metrics"},{value:r.REALTIME,label:"Realtime Logs",description:"WebSocket connections and realtime subscriptions"},{value:r.STORAGE,label:"Storage Logs",description:"File uploads, downloads, and storage operations"},{value:r.PG_CRON,label:"Cron Job Logs",description:"Scheduled job executions and cron task logs"},{value:r.EDGE,label:"Edge Logs",description:"HTTP requests and responses from Edge Functions"},{value:r.FUNCTIONS,label:"Function Logs",description:"Serverless function execution logs and events"},{value:r.POSTGREST,label:"PostgREST Logs",description:"API requests to your database through PostgREST"},{value:r.SUPAVISOR,label:"Supavisor Logs",description:"Connection pooling and database proxy logs"},{value:r.PGBOUNCER,label:"PgBouncer Logs",description:"Legacy connection pooling logs"},{value:r.WAREHOUSE,label:"Warehouse Logs",description:"Data warehouse operations and analytics"},{value:r.PG_UPGRADE,label:"PostgreSQL Upgrade Logs",description:"Database upgrade processes and migration logs"}];function a4(e){var s;let{projectRef:t}=e,[a,n]=(0,o.useState)(r.FN_EDGE),[l,c]=(0,o.useState)(!1),{data:d,isLoading:u,error:m}=at(t,{sql:(0,o.useMemo)(()=>a1(a),[a])}),h=a2.find(e=>e.value===a);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"sticky top-0 z-10 mb-6 flex items-center justify-between border-b bg-background pt-4 lg:pt-8",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Logs"}),(0,i.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"Debug errors and track activity in your app"})]}),(0,i.jsxs)(s1.J2,{open:l,onOpenChange:c,children:[(0,i.jsx)(s1.xo,{asChild:!0,children:(0,i.jsxs)(ei.z,{variant:"outline",role:"combobox","aria-expanded":l,className:"w-64 justify-between",children:[h?h.label:"Select log type...",(0,i.jsx)(aH.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,i.jsx)(s1.yk,{className:"w-80 p-0",align:"end",children:(0,i.jsxs)(aX.mY,{children:[(0,i.jsx)(aX.sZ,{placeholder:"Search log types...",className:"h-9"}),(0,i.jsxs)(aX.e8,{className:"max-h-60 overflow-y-auto",onWheel:e=>{e.stopPropagation()},style:{overscrollBehavior:"contain"},children:[(0,i.jsx)(aX.rb,{children:"No log type found."}),(0,i.jsx)(aX.fu,{children:a2.map(e=>(0,i.jsxs)(aX.di,{value:e.value,onSelect:e=>{n(e),c(!1)},className:"flex items-center gap-2 p-3",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"mb-1 text-xs font-medium leading-none",children:e.label}),(0,i.jsx)("div",{className:"text-xs leading-snug text-muted-foreground",children:e.description})]}),(0,i.jsx)(aJ.Z,{className:(0,S.cn)("mt-0.5 h-4 w-4",a===e.value?"opacity-100":"opacity-0")})]},e.value))})]})]})})]})]}),u&&(0,i.jsxs)("div",{className:"mx-8 mt-8 space-y-2",children:[(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"})]}),(m||d&&d.error)&&(0,i.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(aQ.Z,{className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error fetching logs"}),(0,i.jsx)(tC.X,{children:(null==m?void 0:m.message)||"object"==typeof(null==d?void 0:d.error)&&(null===(s=d.error)||void 0===s?void 0:s.message)||"An unexpected error occurred. Please try again."})]})}),d&&d.result&&d.result.length>0&&(0,i.jsx)("div",{className:"mt-4 w-full overflow-auto",children:(0,i.jsxs)(aT,{children:[(0,i.jsx)(aL,{children:(0,i.jsx)(aF,{className:"hover:bg-transparent",children:Object.keys(d.result[0]).map((e,s,t)=>(0,i.jsx)(aM,{className:(0===s?"first:pl-6 lg:first:pl-8 ":"")+(s===t.length-1?"last:pr-6 lg:last:pr-8":""),children:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},e))})}),(0,i.jsx)(aR,{children:d.result.map((e,s)=>{var t,a;return(0,i.jsx)(aF,{className:"group relative hover:bg-muted/50",children:Object.keys(null!==(a=null===(t=d.result)||void 0===t?void 0:t[0])&&void 0!==a?a:[]).map((s,t,a)=>{let n=e[s],r="timestamp"===s&&"number"==typeof n?new Date(n/1e3).toLocaleString():null===n?"NULL":"object"==typeof n?JSON.stringify(n,null,2):String(n);return(0,i.jsx)(aZ,{className:"min-w-32 text-xs text-muted-foreground first:pl-6 last:pr-6 group-hover:text-foreground lg:first:pl-8 lg:last:pr-8",children:(0,i.jsxs)(a$.zs,{children:[(0,i.jsx)(a$.Yi,{asChild:!0,children:(0,i.jsx)("div",{className:"w-fit max-w-96 cursor-default truncate font-mono text-xs",children:r})}),(0,i.jsx)(a$.bZ,{className:"max-h-96 w-96 overflow-auto p-3",children:(0,i.jsx)("pre",{className:"whitespace-pre-wrap break-words font-mono text-xs",children:r})})]})},s)})},e.id||s)})})]})}),d&&d.result&&0===d.result.length&&(0,i.jsx)("div",{className:"mx-8 mt-8",children:(0,i.jsxs)(tC.bZ,{children:[(0,i.jsx)(aY.Z,{className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"No logs found"}),(0,i.jsx)(tC.X,{children:"Logs will appear here when your application generates activity."})]})})]})}function a5(e){let{projectRef:s}=e,{data:t,isLoading:a,error:n}=ao(s),{mutate:r,isPending:l}=ad(),{mutate:o,isPending:c}=am(),d=(0,sE.cI)({resolver:(0,sS.F)(ab),defaultValues:{secrets:[{name:"",value:""}]}}),{fields:u,append:m,remove:h}=(0,sE.Dq)({control:d.control,name:"secrets"}),p=e=>{window.confirm('Are you sure you want to delete the secret "'.concat(e,'"?'))&&o({projectRef:s,secretNames:[e]})};return a?(0,i.jsxs)("div",{className:"mx-auto w-full max-w-4xl space-y-4 p-12",children:[(0,i.jsx)(Q.O,{className:"h-48 w-full"}),(0,i.jsx)(Q.O,{className:"h-16 w-full"}),(0,i.jsx)(Q.O,{className:"h-16 w-full"})]}):n?(0,i.jsx)("div",{className:"mx-6 mt-8 lg:mx-8",children:(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(er.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error loading secrets"}),(0,i.jsx)(tC.X,{children:"There was a problem loading your secrets configuration."})]})}):(0,i.jsxs)("div",{className:"mx-auto w-full max-w-3xl pt-4 lg:pt-12",children:[(0,i.jsxs)("div",{className:"mb-16",children:[(0,i.jsx)("h2",{className:"font-semibold mb-1 text-base lg:text-xl",children:"Add New Secret"}),(0,i.jsx)("p",{className:"mb-6 text-sm text-muted-foreground lg:text-base",children:"Add sensitive information like API keys that your app needs to work securely."}),(0,i.jsx)(sP.l0,{...d,children:(0,i.jsxs)("form",{onSubmit:d.handleSubmit(e=>{r({projectRef:s,secrets:e.secrets},{onSuccess:()=>{d.reset({secrets:[{name:"",value:""}]})}})}),className:"space-y-2",children:[u.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,i.jsx)(sP.Wi,{control:d.control,name:"secrets.".concat(s,".name"),render:e=>{let{field:t}=e;return(0,i.jsxs)(sP.xJ,{className:"flex-1",children:[0===s&&(0,i.jsx)(sP.lX,{className:"mb-4",children:"Name"}),(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{placeholder:"SECRET_NAME",...t})}),(0,i.jsx)(sP.zG,{})]})}}),(0,i.jsx)(sP.Wi,{control:d.control,name:"secrets.".concat(s,".value"),render:e=>{let{field:t}=e;return(0,i.jsxs)(sP.xJ,{className:"flex-1",children:[0===s&&(0,i.jsx)(sP.lX,{className:"mb-4",children:"Value"}),(0,i.jsx)(sP.NI,{children:(0,i.jsx)(sk.I,{type:"password",placeholder:"••••••••",...t})}),(0,i.jsx)(sP.zG,{})]})}}),(0,i.jsxs)("div",{className:"w-8",children:[0===s&&(0,i.jsx)(sP.lX,{className:"mb-4 opacity-0",children:"Remove"}),(0,i.jsx)(ei.z,{type:"button",variant:"outline",size:"icon",onClick:()=>h(s),disabled:u.length<=1,children:(0,i.jsx)(er.Z,{name:"remove",className:"h-4 w-4"})})]})]},e.id)),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(0,i.jsxs)(ei.z,{type:"button",variant:"outline",size:"sm",onClick:()=>m({name:"",value:""}),children:[(0,i.jsx)(er.Z,{name:"add",className:"mr-2 h-4 w-4"}),"Add Secret"]})}),(0,i.jsx)(ei.z,{type:"submit",disabled:l,className:"mt-6",children:l?"Creating...":"Create Secrets"})]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"font-semibold mb-4 lg:text-lg",children:"Existing secrets"}),t&&t.length>0?t.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between border-b py-4 last:border-b-0",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-mono text-sm tracking-wider",children:e.name}),e.updated_at&&(0,i.jsxs)("p",{className:"mt-1 text-xs text-muted-foreground",children:["Last updated: ",new Date(e.updated_at).toLocaleString()]})]}),(0,i.jsx)(ei.z,{variant:"outline",size:"sm",onClick:()=>p(e.name),disabled:c,children:"Delete"})]},e.name)):(0,i.jsxs)(tC.bZ,{children:[(0,i.jsx)(er.Z,{name:"key",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"No secrets found"}),(0,i.jsx)(tC.X,{children:"No secrets found for this project."})]})]})]})}function a6(e){let{projectRef:s}=e,{data:t,isLoading:a,isError:n}=ae(s);return(0,i.jsxs)("div",{className:"pt-4 lg:pt-8",children:[(0,i.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Storage"}),(0,i.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"View and manage the files stored in your app."}),a&&(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"}),(0,i.jsx)(Q.O,{className:"h-12 w-full"})]}),n&&(0,i.jsxs)(tC.bZ,{variant:"destructive",className:"mt-8",children:[(0,i.jsx)(er.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error loading buckets"}),(0,i.jsx)(tC.X,{children:"There was a problem loading your storage buckets."})]}),t&&t.length>0?(0,i.jsx)("div",{className:"mt-6 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{asChild:!0,children:(0,i.jsxs)(ei.z,{variant:"outline",className:"h-auto flex-row justify-start gap-4 p-4 text-left",children:[(0,i.jsx)(er.Z,{name:"folder",className:"h-4 w-4 text-muted-foreground"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h2",{className:"font-semibold mb-1",children:e.name}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Updated ",new Date(e.updated_at).toLocaleDateString()]})]}),(0,i.jsx)(td.C,{variant:e.public?"default":"secondary",children:e.public?"Public":"Private"})]},e.id)}),(0,i.jsx)(Y._v,{children:(0,i.jsx)("p",{children:"Viewing files is coming soon"})})]},e.id))}):t&&0===t.length?(0,i.jsxs)(tC.bZ,{className:"mt-8",children:[(0,i.jsx)(er.Z,{name:"folder",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"No storage buckets"}),(0,i.jsx)(tC.X,{children:"A bucket is a container used to store and protect files in your app."})]}):null]})}var a3=t(40236);function a8(e){let{projectRef:s}=e,{data:t,isLoading:a,error:n}=al(s),r=(0,o.useMemo)(()=>{if(!t)return[];let e={ERROR:1,WARN:2,INFO:3};return[...t].sort((s,t)=>(e[s.level]||99)-(e[t.level]||99))},[t]),l=e=>{switch(e){case"ERROR":return"destructive";case"WARN":return"secondary";default:return"outline"}};return(0,i.jsxs)("div",{className:"mx-auto max-w-3xl p-6 pt-4 lg:p-12 lg:pt-12",children:[(0,i.jsx)("h2",{className:"font-semibold mb-1 text-base lg:text-xl",children:"Suggestions"}),(0,i.jsx)("p",{className:"mb-4 text-sm text-muted-foreground lg:mb-8 lg:text-base",children:"Improve your project's security and performance."}),a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"}),(0,i.jsx)(Q.O,{className:"h-6 w-full"})]}),n&&(0,i.jsxs)(tC.bZ,{variant:"destructive",className:"mt-8",children:[(0,i.jsx)(er.Z,{name:"code",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error fetching suggestions"}),(0,i.jsx)(tC.X,{children:(null==n?void 0:n.message)||"An unexpected error occurred. Please try again."})]}),t&&(0,i.jsx)("div",{children:r.length>0?(0,i.jsx)("div",{children:r.map(e=>(0,i.jsx)("div",{className:"group relative border-b py-4 last:border-b-0",children:(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-start justify-start gap-4",children:[(0,i.jsx)("h4",{className:"font-semibold text-sm",children:e.title}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(td.C,{variant:l(e.level),className:"shrink-0",children:e.level}),e.type&&(0,i.jsx)(td.C,{variant:"security"===e.type?"destructive":"secondary",className:"shrink-0",children:e.type.charAt(0).toUpperCase()+e.type.slice(1)})]})]}),(0,i.jsx)("div",{className:"prose prose-sm mt-2 max-w-none text-sm text-muted-foreground",children:(0,i.jsx)(a3.UG,{components:{code(e){let{inline:s,children:t,...a}=e;return s?(0,i.jsx)("code",{className:"rounded bg-muted px-1",...a,children:t}):(0,i.jsx)("pre",{className:"overflow-x-auto rounded bg-muted p-2",...a,children:(0,i.jsx)("code",{children:t})})}},children:e.detail})})]})},e.cache_key))}):(0,i.jsxs)(tC.bZ,{children:[(0,i.jsx)(er.Z,{name:"lightbulb_2",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"No suggestions found"}),(0,i.jsx)(tC.X,{children:"Your project looks good! No suggestions at this time."})]})})]})}let a7={users:{label:"New Users",color:"var(--chart-1)"}};function a9(e){let{projectRef:s,timeRange:t}=e,{data:a,isLoading:n,isError:r}=an(s,t);return(0,i.jsxs)("div",{children:[n&&(0,i.jsx)(Q.O,{className:"h-[250px] w-full"}),r&&(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(er.Z,{name:"warning",className:"h-4 w-4"}),(0,i.jsx)(tC.Cd,{children:"Error loading chart data"}),(0,i.jsx)(tC.X,{children:"There was a problem loading your chart data."})]}),a&&!n&&(0,i.jsx)(A,{config:a7,className:"aspect-auto h-[250px] w-full",children:(0,i.jsxs)(aO.v,{accessibilityLayer:!0,data:a,margin:{left:-24,right:12},children:[(0,i.jsx)(v.q,{vertical:!1}),(0,i.jsx)(b.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,i.jsx)(y.B,{tickLine:!1,axisLine:!1,tickMargin:8,tickCount:5,allowDecimals:!1}),(0,i.jsx)(O,{content:(0,i.jsx)(D,{className:"w-[150px]",labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),indicator:"dot"})}),(0,i.jsx)(aD.$,{dataKey:"users",fill:"var(--color-users)"})]})})]})}function ne(e){let{projectRef:s}=e,[t,a]=(0,o.useState)(90);return(0,i.jsxs)("div",{className:"pb-8",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between pt-4 lg:pt-8",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h1",{className:"font-semibold text-base lg:text-xl",children:"Users"}),(0,i.jsx)("p",{className:"mt-1 hidden text-sm text-muted-foreground lg:block lg:text-base",children:"View user signups over time"})]}),(0,i.jsxs)(eF.Ph,{value:String(t),onValueChange:e=>a(Number(e)),children:[(0,i.jsx)(eF.i4,{className:"w-[160px] rounded-lg sm:ml-auto","aria-label":"Select a value",children:(0,i.jsx)(eF.ki,{placeholder:"Select time range"})}),(0,i.jsxs)(eF.Bw,{className:"rounded-xl",children:[(0,i.jsx)(eF.Ql,{value:"90",className:"rounded-lg",children:"Last 90 days"}),(0,i.jsx)(eF.Ql,{value:"30",className:"rounded-lg",children:"Last 30 days"}),(0,i.jsx)(eF.Ql,{value:"7",className:"rounded-lg",children:"Last 7 days"})]})]})]}),(0,i.jsx)("div",{className:"px-8",children:(0,i.jsx)(a9,{projectRef:s,timeRange:t})}),(0,i.jsx)(aU,{hideChartOption:!0,projectRef:s,initialSql:"SELECT * FROM auth.users ORDER BY created_at DESC LIMIT 100;",initialNaturalLanguageMode:!0,label:"Recent users",hideSql:!0,readOnly:!0,runAutomatically:!0})]})}var ns=t(72253),nt=t(37675);let na=e=>{let{projectId:s,disabled:t}=e,[a,n]=(0,o.useState)(!1),r=()=>n(!1),l=(0,e2.D)({mutationFn:()=>(0,e_.SJ)().post("/projects/".concat(s,"/supabase/disconnect")),onSuccess:()=>{(0,ef.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."}),r()},onError:e=>{ef.Am.error("Error",{description:e.message})}});return(0,i.jsxs)(e9.Vq,{open:a,onOpenChange:n,children:[(0,i.jsx)(e9.hg,{asChild:!0,children:(0,i.jsx)(ei.z,{variant:"outline",size:"sm",disabled:t,children:"Disconnect"})}),(0,i.jsxs)(e9.cZ,{size:"sm",children:[(0,i.jsxs)(e9.fK,{children:[(0,i.jsx)(e9.$N,{children:"Disconnect Supabase"}),(0,i.jsx)(e9.Be,{children:"Are you sure you want to disconnect Supabase?"})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"We will stop deploying edge functions and reading your database schema, but no changes will be made to your code. You can reconnect to Supabase later."}),(0,i.jsxs)(e9.cN,{children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,i.jsx)(ei.z,{variant:"destructive",onClick:()=>{l.mutate()},loading:l.isPending,children:"Disconnect"})]})]})]})},nn=e=>{let{projectId:s}=e,t=(0,nt.bk)(e=>e.isSendChatMessageMutationPending);return(0,i.jsx)(eN.P,{label:"Disconnect Project",description:"Remove the Supabase project from this Lovable project.",justify:"end",children:(0,i.jsx)(na,{projectId:s,disabled:t})})};var nr=t(78844);let nl=e=>{var s;let{workspace:t,myWorkspaceRole:a,setShowConnectDialog:n}=e,{isLoading:r,noOrganizations:l}=(0,ns.S)({workspaceId:t.id}),{handleConnect:o,isConnecting:c}=(0,nr.hb)(null!==(s=null==t?void 0:t.id)&&void 0!==s?s:""),d="admin"===a||"owner"===a;return(0,i.jsx)(eN.P,{label:"Organizations",description:"Connected Supabase organizations will be accessible to all members in this workspace.",justify:"end",badges:["admin"],children:r?(0,i.jsx)(Q.O,{className:"h-7 w-40"}):l?(0,i.jsxs)(ei.z,{disabled:c||!d,onClick:o,size:"sm",loading:c,children:[(0,i.jsx)(sh.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}):(0,i.jsx)(ei.z,{disabled:c||!d,onClick:()=>n(!0),size:"sm",variant:"outline",children:"Manage Connected Organizations"})})};var ni=t(38343);let no=e=>{let{setStep:s,workspace:t,supabaseOrganizations:a,handleConnect:n,isConnecting:r,showConnectStep:l}=e,o=0===a.length;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tt,{title:"Linked Supabase Organizations",description:"Anyone in your Lovable workspace can view and link Supabase projects..",badge:"admin"}),(0,i.jsx)(eq.Separator,{}),(0,i.jsxs)("div",{className:"grid min-h-[200px] grid-cols-1 gap-3 px-6 py-6 md:grid-cols-2",children:[(0,i.jsx)(tn,{workspace:t}),(0,i.jsxs)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Supabase Organizations"}),a.map(e=>{let s="connected"===e.status;return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"flex h-7 w-7 items-center justify-center rounded-full border bg-muted",children:(0,i.jsx)(sh.xR.Supabase,{className:"h-4 w-4"})}),(0,i.jsx)("p",{className:"font-medium",children:e.name}),!s&&(0,i.jsx)(ei.z,{variant:"default",size:"sm",className:"ml-auto",onClick:n,disabled:r,children:"Reconnect"})]},e.id)}),(0,i.jsx)(ei.z,{variant:"outline",className:"mt-auto w-full",onClick:n,size:"sm",children:o?"Add Organization":"Add More Organizations"})]})]}),(0,i.jsx)(eq.Separator,{}),l&&(0,i.jsx)(ta,{children:(0,i.jsx)(ei.z,{onClick:()=>s("connect"),className:"ml-auto",size:"sm",disabled:0===a.length,children:"Continue"})})]})};var nc=t(93459),nd=t(27559);let nu=e=>{let{setStep:s,supabaseOrganizations:t,closeDialog:a}=e,n=(0,tf.D)(),r=(0,nt.bk)(e=>e.isSendChatMessageMutationPending),[l,c]=(0,o.useState)(null),{handleProjectSelect:d,isConnecting:u}=(0,nc._)(n,a),m=u||r;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tt,{title:"Connect Project",description:"Select a project of one of your connected Supabase organizations to connect it to your Lovable project."}),(0,i.jsx)(eq.Separator,{}),(0,i.jsx)("div",{className:"flex max-h-[40vh] flex-col gap-3 overflow-y-auto px-6 py-6",children:t.map(e=>{let s=[...e.projects].sort((e,s)=>(0,nd.u)(e)&&!(0,nd.u)(s)?-1:(0,nd.u)(s)&&!(0,nd.u)(e)?1:0),t=0===s.length;return(0,i.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:e.name}),s.map(e=>{let s=(0,nd.u)(e),t=l===e.id;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("p",{className:"font-medium",children:e.name}),!s&&(0,i.jsx)(eX.b,{showTooltip:!s,tooltipContent:"Check project status in Supabase.",instant:!0,children:(0,i.jsx)(er.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"})},e.id)]}),(0,i.jsx)(ei.z,{size:"sm",disabled:!s||m,onClick:()=>{c(e.id),d(e)},loading:t&&m,children:t&&m?"Connecting":"Connect"})]},e.id)}),(0,i.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[t&&(0,i.jsx)("p",{className:"w-full text-sm text-muted-foreground",children:"No Supabase projects found for this organization."}),(0,i.jsx)(ei.z,{size:"sm",variant:t?"default":"secondary",className:"ml-auto w-fit",asChild:!0,children:(0,i.jsxs)("a",{href:"https://supabase.com/dashboard/new/".concat(e.id),target:"_blank",children:[(0,i.jsx)(sh.xR.Supabase,{className:"h-3 w-3"}),"Create Project"]})})]})]},e.id)})}),(0,i.jsx)(eq.Separator,{}),(0,i.jsx)(ta,{children:(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>s("organizations"),size:"sm",children:"Back"})})]})},nm=e=>{var s;let{workspace:t,showConnectStep:a,showConnectDialog:n,setShowConnectDialog:r}=e,[l,c]=(0,o.useState)("organizations"),{supabaseOrganizations:d}=(0,ns.S)({workspaceId:t.id}),{handleConnect:u,isConnecting:m}=(0,nr.hb)(null!==(s=null==t?void 0:t.id)&&void 0!==s?s:"");return(0,i.jsxs)(e9.Vq,{open:n,onOpenChange:e=>{r(e),e||c("organizations")},children:[(0,i.jsx)(e9.hg,{asChild:!0,className:"hidden",children:(0,i.jsx)(ei.z,{size:"sm",children:"Connect Supabase"})}),(0,i.jsx)(ts,{children:"organizations"===l?(0,i.jsx)(no,{setStep:c,workspace:t,supabaseOrganizations:null!=d?d:[],handleConnect:u,isConnecting:m,showConnectStep:a}):(0,i.jsx)(nu,{setStep:c,supabaseOrganizations:null!=d?d:[],closeDialog:()=>{r(!1),c("organizations")}})})]})};var nh=e=>{let s=(0,eT.iZ)(e=>e.project),t=null==s?void 0:s.supabase_project_config,a=!!(null==t?void 0:t.supabase_project_id);return(0,i.jsx)(nm,{...e,showConnectStep:!a})},np=t(15492);let nx=e=>{let{isConnectedToSupabase:s}=e,[t,a]=(0,np.B)("supabase-explainer",{defaultValue:!0}),[n,r]=(0,o.useState)(!1);return s||!t?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"rounded-md border border-border/50 bg-muted/20 p-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,i.jsx)(er.Z,{name:"info",size:"small",className:"text-muted-foreground"}),(0,i.jsx)("h3",{className:"text-sm font-medium",children:"What is Supabase?"}),(0,i.jsx)(ei.z,{variant:"ghost",className:"ml-auto hover:bg-transparent",size:"icon-sm",onClick:()=>a(!1),children:(0,i.jsx)(er.Z,{name:"close",size:"small",className:"text-muted-foreground"})})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supabase is a complete platform for building apps with user authentication, data storage, and other backend capabilities. Connecting it to your Lovable project will enable you to build more advanced apps and support things such as AI features and payments."}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-3 pt-2",children:[(0,i.jsxs)("a",{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,i.jsx)(er.Z,{name:"menu_book",size:"small"}),"See docs"]}),(0,i.jsxs)("button",{onClick:()=>r(!0),className:"inline-flex items-center gap-1.5 rounded-md bg-primary/10 px-3 py-1.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20",children:[(0,i.jsx)(er.Z,{name:"play_circle",size:"small"}),"Watch tutorial"]})]})]})}),(0,i.jsx)(e9.Vq,{open:n,onOpenChange:r,children:(0,i.jsx)(e9.cZ,{className:"max-w-4xl p-0",children:(0,i.jsx)("div",{className:"aspect-video w-full",children:(0,i.jsx)("iframe",{src:"https://www.youtube.com/embed/eVHg4wipRrU",title:"Supabase Tutorial",className:"h-full w-full rounded-lg",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})})]})},ng=e=>{var s;let{workspace:t,isInsideEditor:a,myWorkspaceRole:n,project:r}=e,[l,c]=(0,o.useState)(!1),d=(0,o.useCallback)(()=>{a&&c(!0)},[a]);return(0,ns.I)({workspaceId:t.id,onConnectSuccess:d}),(0,i.jsx)(h.tM,{value:"supabase",title:"Supabase",description:"Integrate user authentication, data storage, and backend capabilities.",docsLink:"https://docs.lovable.dev/integrations/supabase",children:(null==r?void 0:null===(s=r.enabled_integrations)||void 0===s?void 0:s.includes("supabase_exp"))?(0,i.jsx)(nv,{}):(0,i.jsxs)(i.Fragment,{children:[r?(0,i.jsx)(nh,{workspace:t,showConnectDialog:l,setShowConnectDialog:c}):(0,i.jsx)(nm,{workspace:t,showConnectDialog:l,setShowConnectDialog:c}),r&&(0,i.jsx)(nj,{workspace:t,myWorkspaceRole:n,setShowConnectDialog:c}),(0,i.jsx)(nf,{workspace:t,myWorkspaceRole:n,isInsideEditor:a,showConnectDialog:l,setShowConnectDialog:c})]})})},nf=e=>{let{workspace:s,myWorkspaceRole:t,isInsideEditor:a,showConnectDialog:n,setShowConnectDialog:r}=e;return(0,i.jsx)(nl,{workspace:s,myWorkspaceRole:t,isInsideEditor:a,showConnectDialog:n,setShowConnectDialog:r})},nj=e=>{var s,t,a;let{workspace:n,myWorkspaceRole:r,setShowConnectDialog:l}=e,o=(0,eT.iZ)(e=>e.project),c=null==o?void 0:o.supabase_project_config,d=!!(null==o?void 0:o.is_supabase_enabled),u=(0,ns.S)({workspaceId:n.id}),m=(0,tM.Z)(u,c),h=null==o?void 0:o.creation_options.tech_stack,p=(null==c?void 0:c.supabase_project_id)&&!m,x=null===(s=u.supabaseOrganizations)||void 0===s?void 0:s.flatMap(e=>e.projects||[]),g=null==x?void 0:x.find(e=>e.id===(null==c?void 0:c.supabase_project_id)),f=null==o?void 0:o.id,j=(0,e2.D)({mutationFn:()=>(0,e_.SJ)().post("/projects/".concat(f,"/supabase/disconnect")),onSuccess:()=>{(0,ef.Am)("Supabase disconnected",{description:"You can connect to a new Supabase project later."})},onError:e=>{ef.Am.error("Error",{description:e.message})}}),v=null===(t=u.supabaseOrganizations)||void 0===t?void 0:t.find(e=>e.id===(null==c?void 0:c.supabase_organization_id));if(!o)return null;if(d||h&&"vite_react_shadcn_ts"!==h)return(0,i.jsx)("div",{className:"text-sm",children:"Unfortunately, your project is not able to use Supabase."});let b=u.noOrganizations;return u.isLoading?(0,i.jsx)(s2.T,{text:"Loading Supabase..."}):(0,i.jsxs)(i.Fragment,{children:[!v&&!!(null==c?void 0:c.supabase_organization_id)&&(0,i.jsxs)(tC.bZ,{variant:"destructive",children:[(0,i.jsx)(tC.Cd,{children:"Problem with your Supabase connection"}),(0,i.jsxs)(tC.X,{children:[(0,i.jsxs)("p",{children:["This project is connected to Supabase organization"," ",(0,i.jsx)("span",{className:"rounded-md bg-muted px-1 py-0.5 font-mono font-medium text-muted-foreground",children:null==c?void 0:c.supabase_organization_id}),", but this workspace is not connected to that organization. Disconnect the project or add the organization again."]}),(0,i.jsx)("div",{className:"mt-4 flex",children:(0,i.jsx)(ei.z,{variant:"destructive",onClick:()=>j.mutate(),disabled:j.isPending,size:"sm",children:"Disconnect"})})]})]}),(0,i.jsx)(nx,{isConnectedToSupabase:!u.noOrganizations}),!b&&(0,i.jsx)(ni.c,{supabaseOrganizations:null!==(a=u.supabaseOrganizations)&&void 0!==a?a:[],connectedSupabaseProject:null!=g?g:null,setShowConnectDialog:l,isWorkspaceAdmin:"admin"===r||"owner"===r}),p&&g&&(0,i.jsx)(nn,{projectId:null==o?void 0:o.id})]})},nv=e=>{let{children:s}=e,t="{ref}";if(!(0,eQ.so)())return s;let a=[{title:"Database",icon:tO.Z,component:(0,i.jsx)(aB,{projectRef:t})},{title:"Storage",icon:tD.Z,component:(0,i.jsx)(a6,{projectRef:t})},{title:"Auth",icon:tI.Z,component:(0,i.jsx)(a_,{projectRef:t})},{title:"Users",icon:tT.Z,component:(0,i.jsx)(ne,{projectRef:t})},{title:"Secrets",icon:tL.Z,component:(0,i.jsx)(a5,{projectRef:t})},{title:"Logs",icon:tR.Z,component:(0,i.jsx)(a4,{projectRef:t})},{title:"Suggestions",icon:tF.Z,component:(0,i.jsx)(a8,{projectRef:t})}];return(0,i.jsx)(tW,{onStackEmpty:()=>{},initialStack:[],children:(0,i.jsx)(nb,{navigationItems:a,children:s})})},nb=e=>{let{children:s,navigationItems:t}=e,{push:a}=tK();return(0,i.jsxs)(tG,{navigationItems:t,children:[(0,i.jsx)("div",{className:"grid grid-cols-3 gap-4 pb-4 md:grid-cols-2 lg:grid-cols-3",children:t.map(e=>{let{title:s,component:t,icon:n}=e;return(0,i.jsx)(tA.Zb,{className:"cursor-pointer border-muted-foreground/10 bg-muted p-4 hover:bg-muted/50",onClick:()=>{a({title:s,component:t})},children:(0,i.jsx)(tA.Ol,{children:(0,i.jsxs)(tA.ll,{className:"flex items-center gap-2",children:[(0,i.jsx)(n,{className:"h-4 w-4 flex-shrink-0"}),s]})})},s)})}),s]})};var ny=t(44956),nw=t(48581),nN=t(54596),n_=t(108),nk=t(7309),nC=t(32759),nS=t(59053),nE=t(79358);let nz=e=>{let{workspace:s,myWorkspaceRole:t}=e,{billingPeriodCreditLimit:a,billingPeriodCreditsUsed:n,dailyCreditLimit:r,dailyCreditsUsed:l,billingPeriodEndDate:o}=(0,nS.O)({projectWorkspace:s}),c=s.plan,d=(0,eJ.fA)(c),u=(0,eJ.B9)(c),m="ambassador"===c,h=(d||m)&&0===s.billing_period_credits_limit,p=h?null!=l?l:0:null!=n?n:0,x=h?null!=r?r:0:null!=a?a:0,f=(0,nk.Iw)(c),j=(0,nk.oW)({id:c,type:"monthly"});return u||d||m?(0,i.jsxs)(tA.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{className:"font-medium text-foreground",children:"Credits"}),(0,i.jsx)("span",{className:"text-sm font-medium text-foreground",children:(0,nE.u)(p,x)})]}),(0,i.jsx)(nC.E,{value:p/x*100,className:"h-[11px] w-full"}),("admin"===t||"owner"===t)&&(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[d?(0,i.jsxs)(i.Fragment,{children:["You're currently on a legacy plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:f})," ","charged at $",j,"/mo. You're welcome to stay on this plan — but if you're curious to explore our new plans, you'll get 20% off for the first 3 months."," ",(0,i.jsx)(nA,{workspace:s,children:"Manage your payment preferences"}),", or change to one of our new plans below."]}):(0,i.jsxs)(i.Fragment,{children:["You're currently subscribed to plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:f})," ","charged at $",j,"/mo."," ",(0,i.jsx)(nA,{workspace:s,children:"Manage your payment preferences"}),", or change your plan below."]})," ",!h&&(0,i.jsx)("span",{className:"text-sm text-muted-foreground",children:o?"Your monthly credits will renew on ".concat((0,g.WU)(o,"MMMM d")," at ").concat((0,g.WU)(o,"HH:mm"),"."):"Your credits will renew each month (at midnight UTC)."})]})]}):"inactive"!==c?(0,i.jsx)(tA.Zb,{className:"flex w-full flex-col gap-4 bg-muted p-4",children:(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,i.jsxs)("span",{children:["You're currently on plan:"," ",(0,i.jsx)("span",{className:"font-medium capitalize",children:f}),". "]})," ",(0,i.jsx)(nA,{workspace:s,children:"Manage your payment preferences and view past invoices"}),", or change your plan below."]})}):void 0},nA=e=>{let{workspace:s,children:t}=e,{createPortalSession:a,isCreatePortalSessionLoading:n}=(0,n_.m)();return(0,i.jsx)("span",{role:"button",tabIndex:0,onClick:()=>{n||a({workspaceId:s.id})},onKeyDown:e=>{n||"Enter"!==e.key&&" "!==e.key||a({workspaceId:s.id})},className:"inline cursor-pointer underline disabled:opacity-50","aria-disabled":n,children:t})},nP=[{value:"too_expensive",label:"Too expensive",description:"The current plan doesn't fit my budget"},{value:"not_using",label:"Not using enough",description:"I'm not using all the features or credits"},{value:"missing_features",label:"Missing features",description:"The features I need aren't available"},{value:"other",label:"Other reason",description:"None of the above reasons apply"}],nO=[{id:"custom-domains",name:"Custom domains",description:"Connect your own domain to your projects"},{id:"team-collab",name:"Team collaboration",description:"Invite team members to work together"},{id:"visual-editor",name:"Visual editor",description:"Edit the frontend of your project instantly"},{id:"code-editor",name:"Code editor",description:"Edit the backend of your project in code"},{id:"chat-mode",name:"Chat mode",description:"Plan your next step with AI"},{id:"security-checks",name:"Security checks",description:"Run checks when publishing with Supabase to find and fix vulnerabilities"}];var nD=t(48351);(n=l||(l={})).FEATURES_TO_TRY="FEATURES_TO_TRY",n.KTLO_OFFER="KTLO_OFFER",n.FEEDBACK="FEEDBACK",n.FINAL_CONFIRMATION="FINAL_CONFIRMATION";let nI=(0,o.createContext)(void 0),nT=e=>{let{children:s,targetPlan:t,onCancel:a,workspace:n}=e,r=(0,eQ.f7)(),c=n.plan!==nD.It.KTLO&&r,[d,u]=(0,o.useState)(l.FEATURES_TO_TRY),[m,h]=(0,o.useState)({reason:""}),[p,x]=(0,o.useState)(!1),g=(0,nw.tS)(),{toCheckout:f}=(0,n_.m)(),j=async()=>{x(!0),(null==n?void 0:n.id)&&await g.createPortalSession({workspaceId:n.id})},v=async()=>{x(!0);try{if(null==n?void 0:n.id){var e;if(!(null===(e=nD._I[nD.It.KTLO])||void 0===e?void 0:e.PRODUCT_ID))throw Error("KTLO product ID not found in Stripe configuration");let s={id:nD.It.KTLO,annualPrice:15,monthlyPrice:15,monthlyLookupKey:"ktlo",quantity:1,limit:30,name:"Lite",canManagePlan:!0};await f({plan:s,workspaceId:n.id,planType:g.planType})}}catch(e){console.error("Error switching to KTLO plan:",e),x(!1)}},b={currentStep:d,feedback:m,currentPlan:n.plan,targetPlan:t,shouldShowKtloOffer:c,setCurrentStep:u,setFeedback:h,onCancel:a,onConfirm:j,onSwitchToKtlo:v,isLoading:p,getNextStepAfterFeatures:()=>c?l.KTLO_OFFER:l.FEEDBACK,getNextStepAfterKtlo:()=>l.FEEDBACK,getPreviousStepBeforeFeedback:()=>c?l.KTLO_OFFER:l.FEATURES_TO_TRY,getPreviousStepBeforeFinalConfirmation:()=>l.FEEDBACK};return(0,i.jsx)(nI.Provider,{value:b,children:s})},nL=()=>{let e=(0,o.useContext)(nI);if(void 0===e)throw Error("useDowngrade must be used within a DowngradeProvider");return e},nR=()=>{let{onCancel:e,setCurrentStep:s,getNextStepAfterFeatures:t}=nL();return(0,i.jsx)(tA.Zb,{className:"bg-muted p-4 md:p-6",children:(0,i.jsxs)("div",{className:"flex flex-col md:gap-6",children:[(0,i.jsx)("div",{className:"flex flex-col gap-3 md:gap-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)(sU.Label,{className:"text-lg md:text-xl",children:"Have you tried these features yet?"}),(0,i.jsx)("div",{className:"flex flex-col gap-1.5 md:gap-2",children:nO.map(e=>(0,i.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-2 py-2 transition-colors md:gap-4 md:px-3",children:[(0,i.jsx)("span",{className:"mt-1.5 select-none text-base md:mt-2 md:text-lg",children:"•"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,i.jsx)(sU.Label,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))})]})}),(0,i.jsxs)("div",{className:"flex flex-col justify-end gap-3 sm:flex-row",children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{eg.ZP.capture(eI.f8.FEATURE_USAGE.KEEP_PLAN_CLICKED),e()},className:"w-full sm:w-auto",children:"Keep Current Plan"}),(0,i.jsx)(ei.z,{onClick:()=>{eg.ZP.capture(eI.f8.FEATURE_USAGE.CONTINUE_CLICKED),s(t())},className:"w-full sm:w-auto",children:"Continue Downgrading"})]})]})})},nF=()=>{var e;let{feedback:s,setFeedback:t,setCurrentStep:a,getPreviousStepBeforeFeedback:n}=nL();return(0,i.jsx)(tA.Zb,{className:"bg-muted p-6",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,i.jsx)(sU.Label,{className:"text-2xl",children:"Why are you downgrading?"}),(0,i.jsx)(sW.E,{value:s.reason,onValueChange:e=>t({...s,reason:e}),className:"flex flex-col gap-1",children:nP.map(e=>(0,i.jsxs)("div",{className:(0,S.cn)("flex items-start gap-4 rounded-lg px-3 py-1.5","cursor-pointer transition-colors",s.reason===e.value?"bg-primary/5":"hover:bg-muted/50"),onClick:()=>t({...s,reason:e.value}),children:[(0,i.jsx)(sW.m,{value:e.value,id:e.value,className:"mt-2"}),(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-0.5",children:[(0,i.jsx)(sU.Label,{htmlFor:e.value,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.label}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.value))})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,i.jsx)(sU.Label,{htmlFor:"additional-feedback",className:"text-base",children:"Additional feedback (optional)"}),(0,i.jsx)(eD.g,{id:"additional-feedback",placeholder:"Tell us more about your decision...",value:s.additionalNotes,onChange:e=>t({...s,additionalNotes:e.target.value}),maxLength:500,className:"min-h-[80px] resize-none border-muted-foreground/20 bg-background placeholder:text-muted-foreground/50 focus:border-primary focus:ring-1 focus:ring-primary"}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null===(e=s.additionalNotes)||void 0===e?void 0:e.length)||0,"/500 characters"]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-3 pt-1",children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{eg.ZP.capture(eI.f8.FEEDBACK.BACK_CLICKED),a(n())},children:"Back"}),(0,i.jsx)(ei.z,{variant:"default",onClick:()=>{eg.ZP.capture(eI.f8.FEEDBACK.CONTINUE_CLICKED,{reason:s.reason,has_additional_notes:!!s.additionalNotes,additional_notes:s.additionalNotes||""}),a(l.FINAL_CONFIRMATION)},children:"Continue"})]})]})})},nM=(e,s)=>{var t,a;let n=(0,eJ.Ll)(e),r=(0,eJ.Ll)(s),l=null!==(t=(0,nk.z_)(e))&&void 0!==t?t:0,i=null!==(a=(0,nk.z_)(s))&&void 0!==a?a:0;if("ktlo"===r)return"pro"===n?["Credits will change from ".concat(l," per month to freemium (5 per day, up to 30 per month)"),"Active AI features will be limited to freemium"]:[];if("pro"===n){if("pro"===r)return["Credits will decrease from ".concat(l," to ").concat(i," per month"),"Same pro features will be maintained at a lower tier"];if("free"===r)return["All projects will become public","A Lovable badge will be added to all projects","You will lose team management features","Custom domains will be removed","Editor access will be removed from all projects","Credits will reset to 5 per day"]}return[]},nZ=sz.z.object({reason:sz.z.string().optional(),additional_notes:sz.z.string().max(500,"Additional notes must be less than 500 characters").optional()}),nq=()=>{let{currentPlan:e,targetPlan:s,onConfirm:t,isLoading:a,setCurrentStep:n,feedback:r,getPreviousStepBeforeFinalConfirmation:l}=nL(),o=(0,e_.SJ)(),c=(0,e2.D)({mutationFn:async()=>{let e=nZ.parse({reason:r.reason,additional_notes:r.additionalNotes});await o.post("/user/cancellation",e),await t()},onSuccess:()=>{eg.ZP.capture(eI.f8.FINAL_CONFIRMATION.CONFIRM_CLICKED,{from_plan:e,to_plan:s})},onError:e=>{if(eC.logging.error("Error submitting feedback:",e),e instanceof sz.z.ZodError){let s=e.errors[0];ef.Am.error("Validation Error",{description:s.message})}else{var s;ef.Am.error("Error",{description:(null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to submit feedback"})}}});return(0,i.jsx)(tA.Zb,{className:"bg-muted",children:(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 text-amber-500",children:[(0,i.jsx)(er.Z,{name:"warning_fill",size:"small"}),(0,i.jsx)("h2",{className:"text-lg font-medium",children:"Confirm Plan Downgrade"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-4 text-muted-foreground",children:["By downgrading to the ",(0,eJ.Ll)(s)," plan, you will lose access to the following features:"]}),(0,i.jsx)("ul",{className:"list-disc space-y-2 pl-6",children:nM(e,s).map((e,s)=>(0,i.jsx)("li",{className:"text-foreground",children:e},s))})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{eg.ZP.capture(eI.f8.FINAL_CONFIRMATION.BACK_CLICKED),n(l())},children:"Back"}),(0,i.jsx)(ei.z,{variant:"destructive",onClick:()=>{c.mutate()},disabled:c.isPending||a,children:c.isPending||a?"Processing...":"Confirm Downgrade"})]})]})})};var nU=t(33145);let nW=()=>{let{setCurrentStep:e,feedback:s,onSwitchToKtlo:t,isLoading:a,getNextStepAfterKtlo:n}=nL(),r=async()=>{eg.ZP.capture(eI.f8.KTLO_OFFER.SWITCH_CLICKED,{reason:s.reason}),await t()};return(0,i.jsxs)(tA.Zb,{className:"border-border bg-muted",children:[(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-8 lg:flex-row lg:gap-12",children:[(0,i.jsxs)("div",{className:"flex max-w-md flex-col justify-center",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h2",{className:"mb-3 text-3xl font-medium text-foreground",children:"Switch to Lite"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Try our new Lite plan and retain important features that keep your project going."})]}),(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("p",{className:"mb-2 font-medium text-foreground",children:"What's included:"}),(0,i.jsx)("ul",{className:"flex flex-col gap-2",children:["5 daily credits up to a maximum of 30 per month","Keep custom domains","No Lovable badge","Team settings stay in place","Access to private projects"].map((e,s)=>(0,i.jsxs)("li",{className:"flex items-center gap-3",children:[(0,i.jsx)(er.Z,{name:"check",size:"small",className:"flex-shrink-0 text-success-primary"}),(0,i.jsx)("span",{className:"text-foreground",children:e})]},s))})]}),(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)("span",{className:"text-5xl font-medium text-foreground",children:"$15"}),(0,i.jsx)("span",{className:"text-lg text-muted-foreground",children:"/month"})]})]}),(0,i.jsx)("div",{className:"flex w-full flex-1 items-center justify-center",children:(0,i.jsx)("div",{className:"h-full max-h-80 w-full max-w-lg overflow-hidden rounded-2xl lg:max-h-96",children:(0,i.jsx)(nU.default,{src:"/img/lovable-lite.png",alt:"Lite Plan",className:"h-full w-full object-cover",width:500,height:400})})})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-between",children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{eg.ZP.capture(eI.f8.KTLO_OFFER.BACK_CLICKED),e(l.FEATURES_TO_TRY)},children:"Back"}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,i.jsx)(ei.z,{variant:"outline",onClick:()=>{eg.ZP.capture(eI.f8.KTLO_OFFER.CONTINUE_DOWNGRADE_CLICKED,{reason:s.reason}),e(n())},children:"No, thank you"}),(0,i.jsx)(ei.z,{onClick:r,disabled:a,className:"bg-foreground text-background hover:bg-foreground/90",children:a?"Switching...":"Switch to Lite"})]})]})]})},nK=()=>{let{currentStep:e}=nL();switch(e){case l.FEATURES_TO_TRY:return(0,i.jsx)(nR,{});case l.KTLO_OFFER:return(0,i.jsx)(nW,{});case l.FEEDBACK:return(0,i.jsx)(nF,{});case l.FINAL_CONFIRMATION:return(0,i.jsx)(nq,{});default:return null}};nK.displayName="DowngradeContent";let nG=e=>{let{targetPlan:s,onCancel:t,workspace:a}=e;return(0,i.jsx)(nT,{targetPlan:s,onCancel:t,workspace:a,children:(0,i.jsx)(nK,{})})},nV=e=>{var s,t;let{workspace:a,showDowngradeConfirmation:n,setShowDowngradeConfirmation:r}=e,l=(0,nw.tS)();return n?(0,i.jsx)(nG,{workspace:a,targetPlan:null!==(t=null===(s=l.targetDowngradePlan)||void 0===s?void 0:s.id)&&void 0!==t?t:eJ.tJ.FREE,onCancel:()=>{l.setTargetDowngradePlan(null),r(!1)}}):(0,i.jsx)(nN.S,{className:"w-full",showEnterprise:!0})},nB=e=>{var s;let{workspace:t,myWorkspaceRole:a}=e,n="inactive"===t.plan,[r,l]=(0,o.useState)(!1);return(0,i.jsxs)(h.tM,{title:"Plans & Billing",value:"billing",description:"Choose plans for starting solo, growing your projects, and collaborating with your team.",docsLink:"https://docs.lovable.dev/user-guides/messaging-limits",children:[n?(0,i.jsxs)("span",{children:["Your subscription is currently"," ",(0,i.jsx)("span",{className:"font-medium",children:"inactive"}),". You can select a new plan below to restore full functionality to your workspace."]}):null,!r&&(0,i.jsx)(nz,{workspace:t,myWorkspaceRole:a}),(0,i.jsx)(ny.om,{currentPlan:{id:t.plan,type:null!==(s=t.plan_type)&&void 0!==s?s:"monthly"},context:"billing",workspace:t,myWorkspaceRole:a,onDowngradeClick:()=>l(!0),children:(0,i.jsx)(nV,{workspace:t,showDowngradeConfirmation:r,setShowDowngradeConfirmation:l})})]})};var nH=t(62395),nJ=t(63210);let nQ=e=>{let{workspace:s}=e,{data:t,isLoading:a}=(0,m.a)(sJ.t.libraries({workspaceId:s.id}));return(0,i.jsx)(h.tM,{title:"Libraries",value:"libraries",description:"Browse and manage team libraries, used to start new projects. Publish new libraries from settings.",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(nH.R,{}),(0,i.jsx)(nH.R,{}),(0,i.jsx)(nH.R,{})]}),!a&&(t&&t.length>0?t.map(e=>(0,i.jsx)(nJ.t,{project:e,subtitleType:"created-by",isCommunityProject:!1,positionIndex:0,isLibraryProject:!0},e.id)):(0,i.jsx)("div",{className:"col-span-full text-center text-sm text-muted-foreground",children:"No libraries found. Add projects to your library to get started."}))]})})};var nY=t(32800),nX=t(19878);let n$=e=>"owner"===e,n0=e=>"admin"===e,n1=e=>(0,eJ.Ll)(e.plan),n2={ADD_EDITOR:"claim.workspace.add_editor",ADD_ADMIN:"claim.workspace.add_admin",SEE_USAGE:"claim.workspace.see_usage",MANAGE_PLAN:"claim.workspace.manage_plan",REMOVE_EDITOR:"claim.workspace.remove_editor",REMOVE_ADMIN:"claim.workspace.remove_admin",PROJECT_MAGIC_LINK:"claim.project.magic_link"};class n4{canEmailInvite(){return this.claims.has(n2.ADD_EDITOR)}canSetInviteRole(){return this.claims.has(n2.ADD_ADMIN)}canEditRole(){let{targetRole:e}=this.context;return n0(e)?this.claims.has(n2.REMOVE_ADMIN):this.claims.has(n2.REMOVE_EDITOR)&&!n$(e)}canSeeUsage(){return this.claims.has(n2.SEE_USAGE)}canCreateSecretLink(){return this.claims.has(n2.PROJECT_MAGIC_LINK)}canManagePlan(){return this.claims.has(n2.MANAGE_PLAN)}canRemoveMember(){let{targetRole:e}=this.context;return n0(e)?this.claims.has(n2.REMOVE_ADMIN):this.claims.has(n2.REMOVE_EDITOR)&&!n$(e)}constructor(e){this.context=e,this.claims=new Set;let{role:s}=e,t=n1(e.workspace);"free"===t?n$(s)&&(this.claims.add(n2.ADD_EDITOR),this.claims.add(n2.SEE_USAGE),this.claims.add(n2.MANAGE_PLAN),this.claims.add(n2.REMOVE_EDITOR),this.claims.add(n2.PROJECT_MAGIC_LINK)):(n$(s)?(this.claims.add(n2.ADD_EDITOR),this.claims.add(n2.ADD_ADMIN),this.claims.add(n2.SEE_USAGE),this.claims.add(n2.MANAGE_PLAN),this.claims.add(n2.REMOVE_EDITOR),this.claims.add(n2.REMOVE_ADMIN),this.claims.add(n2.PROJECT_MAGIC_LINK)):n0(s)&&(this.claims.add(n2.ADD_EDITOR),this.claims.add(n2.SEE_USAGE),this.claims.add(n2.REMOVE_EDITOR),this.claims.add(n2.PROJECT_MAGIC_LINK)),"pro"!==t&&"ktlo"!==t||n$(s)||this.claims.delete(n2.PROJECT_MAGIC_LINK))}}let n5=e=>new n4(e),n6=e=>{let{workspace:s,authUserId:t,role:a,targetRole:n}=e;return(0,o.useMemo)(()=>{let e={workspace:s,isWorkspaceOwner:t===s.owner_id,role:a,targetRole:n},r=n5(e);return{canEmailInvite:()=>r.canEmailInvite(),canSetInviteRole:()=>r.canSetInviteRole(),canEditRole:()=>r.canEditRole(),canSeeUsage:()=>r.canSeeUsage(),canCreateSecretLink:()=>r.canCreateSecretLink(),canManagePlan:()=>r.canManagePlan(),canRemoveMember:()=>r.canRemoveMember(),isWorkspaceOwner:e.isWorkspaceOwner}},[s,t,a,n])};var n3=t(40782),n8=t(70335);let n7=e=>{let{workspace:s,memberships:t}=e,a=new Date().getMonth()+1,n=new Date().getFullYear(),{data:r}=(0,m.a)(sJ.t.workspaceUsage({workspaceId:null==s?void 0:s.id,month:a,year:n})),{data:l}=(0,m.a)(sJ.t.workspaceUserTotalUsage({workspaceId:null==s?void 0:s.id})),c=(0,o.useMemo)(()=>null==l?void 0:l.map(e=>{let s=t.find(s=>s.user_id===e.user_id);return s?{...e,membership:s}:null}).filter(e=>null!==e).sort((e,s)=>s.count-e.count),[l,t]),d=(0,o.useMemo)(()=>null==r?void 0:r.user_usages.map(e=>{let s=t.find(s=>s.user_id===e.user_id);return s?{...e,membership:s}:null}).filter(e=>null!==e).sort((e,s)=>s.count-e.count),[r,t]);return(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("p",{className:"pb-2 text-sm text-muted-foreground",children:["Showing usage for"," ",(0,g.WU)(new Date(n,a-1),"MMMM yyyy"),"."]}),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:(null==d?void 0:d.length)===0?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:"No usage data for this period. Usage will appear here once members begin using the workspace."}):null==d?void 0:d.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n8.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,i.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name})]}),(0,i.jsxs)("div",{className:"text-muted-foreground",children:[(0,nE.H)(e.count)," credit",1===e.count?"":"s"," used"]})]},e.user_id))}),c&&c.length>0&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"border-t pt-4",children:[(0,i.jsx)("p",{className:"pb-2 text-sm text-muted-foreground",children:"Total usage across all months."}),(0,i.jsx)("div",{className:"flex flex-col gap-2",children:c.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n8.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,i.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name})]}),(0,i.jsxs)("div",{className:"font-medium text-muted-foreground",children:[(0,nE.H)(e.count)," credit",1===e.count?"":"s"," total"]})]},e.user_id))})]})})]})};var n9=t(45659),re=t(61011),rs=e=>{let{memberName:s,onConfirm:t,onCancel:a}=e;return(0,i.jsx)(re.Z,{title:"Remove workspace member",targetName:s,descriptionTemplate:"Are you sure you want to remove ".concat(s," from this workspace? They will no longer have access to any workspace projects or resources."),onConfirm:t,onCancel:a})},rt=t(82157);let ra={owner:"Owner",admin:"Admin",member:"Editor"},rn={owner:"Owners can manage all collaborators, projects, and integrations.",admin:"Admins can manage editors, projects, and integrations.",member:"Editors can only create and edit projects."},rr=e=>{var s;let{currentMembership:t,workspaceId:a,memberships:n,workspace:r}=e,{authUser:l}=(0,d.Eu)(),o=t.user_id===(null==l?void 0:l.uid),c=(0,ew.z)(rs),u=null===(s=n.find(e=>e.user_id===(null==l?void 0:l.uid)))||void 0===s?void 0:s.role,m=!t.joined_at,h=n6({workspace:r,authUserId:null==l?void 0:l.uid,role:u,targetRole:t.role}),p=h.canEditRole()&&!o&&!m,{updateWorkspaceMemberRole:x}=function(e){let{workspaceId:s}=e,t=(0,eR.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,e2.D)({mutationFn:async e=>{let{userId:t,role:a}=e,n=(0,e_.SJ)();await n.put("/user/workspaces/".concat(s,"/memberships/").concat(t),{role:a})},onMutate:async e=>{let n=sJ.t.workspaceMemberships({workspaceId:s,userId:null==a?void 0:a.uid});await t.cancelQueries({queryKey:n.queryKey});let r=t.getQueryData(n.queryKey);return r&&t.setQueryData(n.queryKey,{...r,memberships:(0,n3.q)(r.memberships.map(s=>s.user_id===e.userId?{...s,role:e.role}:s))}),{previousData:r}},onError:(e,n,r)=>{if((0,e4.Eo)(e),null==r?void 0:r.previousData){let e=sJ.t.workspaceMemberships({workspaceId:s,userId:null==a?void 0:a.uid});t.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{t.invalidateQueries({queryKey:sJ.t.workspaceMemberships({workspaceId:s,userId:null==a?void 0:a.uid}).queryKey})}});return{updateWorkspaceMemberRole:n}}({workspaceId:a}),{removeWorkspaceMember:g}=function(e){let{workspaceId:s}=e,t=(0,eR.NL)(),{authUser:a}=(0,d.Eu)(),{mutateAsync:n}=(0,e2.D)({mutationFn:async e=>{let{userId:t}=e,a=(0,e_.SJ)();await a.delete("/workspaces/".concat(s,"/memberships/").concat(t))},onMutate:async e=>{let n=sJ.t.workspaceMemberships({workspaceId:s,userId:null==a?void 0:a.uid});await t.cancelQueries({queryKey:n.queryKey});let r=t.getQueryData(n.queryKey);return r&&t.setQueryData(n.queryKey,{...r,memberships:r.memberships.filter(s=>s.user_id!==e.userId)}),{previousData:r}},onError:(e,n,r)=>{if((0,e4.Eo)(e),null==r?void 0:r.previousData){let e=sJ.t.workspaceMemberships({workspaceId:s,userId:null==a?void 0:a.uid});t.setQueryData(e.queryKey,r.previousData)}},onSettled:()=>{t.invalidateQueries({queryKey:sJ.t.workspaceMemberships({workspaceId:s,userId:null==a?void 0:a.uid}).queryKey})}});return{removeWorkspaceMember:n}}({workspaceId:a}),f=async e=>{m||await x({userId:t.user_id,role:e})},j=()=>{c({childProps:{memberName:t.display_name||t.username,onConfirm:async()=>{await g({userId:t.user_id}),c(!1)},onCancel:()=>c(!1)}})},v=(0,i.jsxs)(eo.h_,{children:[(0,i.jsxs)(Y.u,{children:[(0,i.jsx)(Y.aJ,{children:(0,i.jsx)(eo.$F,{asChild:!0,disabled:o||!h.canRemoveMember(),children:(0,i.jsxs)(ei.z,{"aria-haspopup":"true",variant:"ghost",children:[m?"Pending":ra[t.role]," ",(0,i.jsx)(er.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})]})})}),(0,i.jsx)(Y._v,{className:"max-w-[30ch]",children:m?"This user has been invited to join as ".concat(ra[t.role]):rn[t.role]})]}),(0,i.jsx)(eo.AW,{align:"end",children:m?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(rt.w,{label:"Pending",isSelected:!0,onClick:()=>{},disabled:!0}),(0,i.jsx)(rt.w,{label:"Remove",destructive:!0,onClick:j})]}):(0,i.jsxs)(i.Fragment,{children:[h.canSetInviteRole()&&(0,i.jsx)(rt.w,{label:"Admin",isSelected:"admin"===t.role,onClick:()=>f("admin"),disabled:!p,tooltip:rn.admin}),(0,i.jsx)(rt.w,{label:"Editor",isSelected:"member"===t.role,onClick:()=>f("member"),disabled:!p,tooltip:rn.member}),(0,i.jsx)(rt.w,{label:o?"Leave":"Remove",destructive:!0,onClick:j})]})})]});return(0,i.jsx)(n9.Q,{id:t.user_id,username:t.username,displayName:t.display_name,photoURL:t.photo_url,avatarClassName:"h-8 w-8",actionComponent:v,isCurrentUser:o,email:t.email,isInvited:m})},rl=[{value:"admin",label:"Admin"},{value:"member",label:"Editor"}],ri=e=>{var s;let{memberships:t,workspace:a}=e,{authUser:n}=(0,d.Eu)(),[r,l]=(0,o.useState)(""),c=null===(s=t.find(e=>e.user_id===(null==n?void 0:n.uid)))||void 0===s?void 0:s.role,u=n6({workspace:a,authUserId:null==n?void 0:n.uid,role:c}),m="free"===(0,eJ.Ll)(a.plan),h=t?(0,n3.q)(t):[],p=h.filter(e=>{var s;return null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(r.toLowerCase())}),{inviteWorkspaceMember:x,isInvitingMember:g}=(0,nX.B)({workspaceId:a.id}),f=async e=>{let{emails:s,role:t}=e;if(0===s.length)return{success:!1};let a=0,n=m?"member":t;for(let e of s)await x({email:e,role:n}),a++;return{success:a>0}};return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)(nY.s,{onInvite:e=>{let{emails:s,role:t}=e;return f({emails:s,role:t})},isInviting:g,roleOptions:rl,canSelectRoles:u.canSetInviteRole(),defaultRole:"member",placeholder:"Add emails",completelyDisabled:!u.canEmailInvite(),onInputChange:e=>l(e)}),(0,i.jsxs)("div",{className:"flex flex-col gap-2 border-b pb-3",children:[(0,i.jsx)("h4",{children:"Members"}),(0,i.jsx)("ul",{className:"flex flex-col gap-2",children:p.length>0?p.map((e,s)=>(0,i.jsx)(rr,{currentMembership:e,workspaceId:a.id,memberships:h,workspace:a},"".concat(e.user_id,"-").concat(s))):(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:r?"No users found for '".concat(r,"'"):"No members found"})})]}),u.canSeeUsage()&&h&&(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("h4",{children:"Usage"}),(0,i.jsx)(n7,{workspace:a,memberships:h})]})]})},ro=e=>{let{workspace:s}=e;return(0,eP.MD)()?(0,i.jsx)(rd,{workspace:s}):(0,i.jsx)(rc,{workspace:s})};function rc(e){let{workspace:s}=e,t=(0,u.aS)(e=>e.memberships),a=s.num_seats||20,n=t.length,r=s.name||"Workspace",l=(0,i.jsxs)(i.Fragment,{children:["Inviting people to ",(0,i.jsx)("strong",{children:r})," gives access to workspace shared projects and credits. You're using ",n,"/",a," seats. Need more?"," ",(0,i.jsx)(ex.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,i.jsx)(h.tM,{title:"People",value:"people",description:l,docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,i.jsx)(ri,{memberships:t,workspace:s})})}function rd(e){let{workspace:s}=e,t=(0,eP.hO)(e=>e.memberships),a=s.num_seats||20,n=t.length,r=s.name||"Workspace",l=(0,i.jsxs)(i.Fragment,{children:["Inviting people to ",(0,i.jsxs)("strong",{children:[r,"'s workspace"]})," gives access to workspace shared projects and credits. You're using"," ",n,"/",a," seats. Need more?"," ",(0,i.jsx)(ex.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,i.jsx)(h.tM,{title:"People",value:"people",description:l,children:(0,i.jsx)(ri,{memberships:t,workspace:s})})}var ru=t(56141);let rm=()=>{var e;let{authUser:s}=(0,d.Eu)(),t=(0,eT.iZ)(e=>e.project),{projectWorkspace:a,isMemberOfWorkspace:n,workspaceMemberships:r}=(0,sd.f)(),l=null===(e=r.find(e=>e.user_id===(null==s?void 0:s.uid)))||void 0===e?void 0:e.role;return(0,i.jsx)(rh,{project:t,workspace:null!=a?a:void 0,isMemberOfWorkspace:n,myWorkspaceRole:l})},rh=e=>{let{project:s,workspace:t,myWorkspaceRole:a,isMemberOfWorkspace:n}=e,[r,l]=(0,o.useState)(!0),u=(0,su.v)(),m=u?"admin":a,{activeTab:p,openSettings:x,closeSettings:g}=(0,eY.r)();(0,o.useEffect)(()=>{null!==p?l(!0):l(!1)},[p]),(0,c.y1)("mod+.",()=>{null===p?x(s?"project":"account"):g()});let{authUser:f}=(0,d.Eu)(),j=(null==f?void 0:f.displayName)||"Your Account",v=u||n,b=null==t?void 0:t.name,y=(0,eQ.R5)(),w=(0,eQ.uF)(),N=(0,eQ.Hj)();return(0,i.jsx)(si,{open:r,onOpenChange:e=>{e?x():g()},children:(0,i.jsxs)(h.v_,{value:p||"settings",onValueChange:e=>x(e,!0),children:[(0,i.jsxs)(h.eD,{hasActiveTab:!!p,children:[s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.yf,{title:"Project"}),(0,i.jsxs)(h.QK,{value:"project",children:[(0,i.jsx)(er.Z,{name:"settings"}),(0,i.jsx)("p",{children:"Project Settings"})]}),(0,i.jsxs)(h.QK,{value:"domains",children:[(0,i.jsx)(er.Z,{name:"language"}),(0,i.jsx)("p",{children:"Domains"})]}),w&&(0,i.jsxs)(h.QK,{value:"analytics",children:[(0,i.jsx)(er.Z,{name:"bid_landscape"}),(0,i.jsx)("p",{children:"Analytics"})]}),(0,i.jsxs)(h.QK,{value:"knowledge",children:[(0,i.jsx)(er.Z,{name:"school"}),(0,i.jsx)("p",{children:"Knowledge"})]}),N&&(0,i.jsxs)(h.QK,{value:"memory",children:[(0,i.jsx)(er.Z,{name:"database"}),(0,i.jsx)("p",{children:"Memory"})]})]}),t&&v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.yf,{title:"Workspace"}),(0,i.jsxs)(h.QK,{value:"workspace",className:"-ml-0.5",children:[(0,i.jsx)(sm.z,{className:(0,S.cn)("h-6 w-6 !rounded-[6px] md:h-5 md:w-5"),workspace:t}),(0,i.jsx)("p",{className:"-ml-0.5",children:b})]}),(0,i.jsxs)(h.QK,{value:"people",children:[(0,i.jsx)(er.Z,{name:"group"}),(0,i.jsx)("p",{children:"People"})]}),y&&(0,i.jsxs)(h.QK,{value:"libraries",children:[(0,i.jsx)(er.Z,{name:"book_ribbon"}),(0,i.jsx)("p",{children:"Libraries"})]}),(0,i.jsxs)(h.QK,{value:"billing",children:[(0,i.jsx)(er.Z,{name:"credit_card"}),(0,i.jsx)("p",{children:"Plans & Billing"})]})]}),(0,i.jsx)(h.yf,{title:"Account"}),(0,i.jsxs)(h.QK,{value:"account",children:[(0,i.jsx)(er.Z,{name:"account_circle"}),(0,i.jsx)("p",{children:j})]}),(0,i.jsxs)(h.QK,{value:"labs",children:[(0,i.jsx)(er.Z,{name:"science"}),(0,i.jsx)("p",{children:"Labs"})]}),v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.yf,{title:"Integrations"}),(0,i.jsxs)(h.QK,{value:"supabase",children:[(0,i.jsx)(sh.xR.Supabase,{className:"h-4 w-4"}),(0,i.jsx)("p",{children:"Supabase"})]}),(s||t)&&(0,i.jsxs)(h.QK,{value:"github",children:[(0,i.jsx)(sh.xR.GitHub,{className:"h-4 w-4"}),(0,i.jsx)("p",{children:"GitHub"})]}),u&&t&&(0,i.jsxs)(h.QK,{value:"mcp",children:[(0,i.jsx)(er.Z,{name:"cloud"}),(0,i.jsx)("p",{children:"MCP"})]})]})]}),(0,i.jsxs)("div",{className:(0,S.cn)("relative h-full flex-1 overflow-x-auto scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted-foreground md:w-auto",p?"flex":"hidden md:flex"),children:[s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.tM,{value:"project",title:"Project Settings",description:"Manage your project details, visibility, and preferences.",children:(0,i.jsx)(e3,{projectId:s.id})}),(0,i.jsx)(h.tM,{value:"knowledge",title:"Knowledge",description:"Add custom knowledge to your project.",docsLink:"https://docs.lovable.dev/features/knowledge",children:(0,i.jsx)(eL,{})}),(0,i.jsx)(h.tM,{value:"domains",title:"Domains",description:"Publish your project to custom domains.",docsLink:"https://docs.lovable.dev/tips-tricks/custom-domain",children:(0,i.jsx)(eO,{project:s})}),w&&(0,i.jsx)(eu,{project:s}),N&&(0,i.jsx)(tP,{workspace:t,isInsideEditor:!!s,myWorkspaceRole:m,project:s})]}),t&&n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ru.r,{workspace:t}),(0,i.jsx)(ro,{workspace:t}),(0,i.jsx)(nB,{workspace:t,myWorkspaceRole:a}),y&&(0,i.jsx)(nQ,{workspace:t})]}),(0,i.jsx)(sV,{}),(0,i.jsx)(sj,{}),v&&t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tw,{workspace:t,isInsideEditor:!!s,myWorkspaceRole:m}),(0,i.jsx)(ng,{workspace:t,isInsideEditor:!!s,project:s,myWorkspaceRole:m}),u&&(0,i.jsx)(tz,{workspace:t,isInsideEditor:!!s,myWorkspaceRole:m})]})]})]})})};var rp=()=>{var e;let{authUser:s}=(0,d.Eu)(),t=(0,eP.MD)(),a=(0,u.aS)(e=>e.currentWorkspace),n=(0,u.aS)(e=>e.memberships),r=n.some(e=>e.user_id===(null==s?void 0:s.uid));if(t)return(0,i.jsx)(rm,{});let l=null===(e=n.find(e=>e.user_id===(null==s?void 0:s.uid)))||void 0===e?void 0:e.role;return(0,i.jsx)(rh,{workspace:null!=a?a:void 0,isMemberOfWorkspace:r,myWorkspaceRole:l})}},19878:function(e,s,t){t.d(s,{B:function(){return d}});var a=t(29827),n=t(21770),r=t(52558),l=t(64040),i=t(49131),o=t(89668),c=t(40782);function d(e){let{workspaceId:s}=e,t=(0,a.NL)(),{authUser:d}=(0,r.Eu)(),{mutateAsync:u,isPending:m}=(0,n.D)({mutationFn:async e=>{let{email:t,role:a="member"}=e;return(0,i.SJ)().post("/workspaces/".concat(s,"/memberships"),{email:t,role:a})},onSuccess:async e=>{if(e){let a=o.t.workspaceMemberships({workspaceId:s,userId:null==d?void 0:d.uid}),n=t.getQueryData(a.queryKey);n&&!n.memberships.some(s=>s.user_id===e.user_id)&&t.setQueryData(a.queryKey,{...n,memberships:(0,c.q)([...n.memberships,e])})}t.invalidateQueries({queryKey:o.t.workspaceMemberships({workspaceId:s,userId:null==d?void 0:d.uid}).queryKey})},onError:e=>{(0,l.Eo)(e)}});return{inviteWorkspaceMember:u,isInvitingMember:m}}},40782:function(e,s,t){t.d(s,{q:function(){return n}});let a={owner:3,admin:2,member:1};function n(e){return[...e].sort((e,s)=>{let t=!!e.joined_at,n=!!s.joined_at;if(t&&!n)return -1;if(!t&&n)return 1;let r=a[s.role]-a[e.role];return 0!==r?r:e.joined_at&&s.joined_at?new Date(s.joined_at).getTime()-new Date(e.joined_at).getTime():0})}},56141:function(e,s,t){t.d(s,{r:function(){return L},Y:function(){return R}});var a=t(57437),n=t(13590),r=t(92850),l=t(29827),i=t(21770),o=t(29501),c=t(14438),d=t(91115),u=t(52558),m=t(6812),h=t(69084),p=t(32165),x=t(66870),g=t(62869),f=t(78276),j=t(26110),v=t(15681),b=t(95186),y=t(76818),w=t(64040),N=t(49131),_=t(89668),k=t(99376),C=t(61922),S=t(2265),E=t(57346),z=t(26034),A=t(97318),P=t(94508),O=t(94949);let D=["image/png","image/jpeg","image/jpg","image/webp"],I=e=>{let{workspace:s,className:t}=e,{authUser:n}=(0,u.Eu)(),r=(0,N.SJ)(),{upload:o}=(0,O.F)(),d=(0,l.NL)(),m=(0,S.useRef)(null),h=()=>{m.current&&(m.current.value="")},{mutateAsync:p,isPending:x}=(0,i.D)({mutationFn:async e=>{let{file:t,workspaceId:a}=e;if(!n)throw Error("You must be logged in to upload files");await o({fileName:t.name,file:t,options:{maxFileSize:10240,maxDimension:200},continueOnError:!1});let{url:l}=await (0,z._c)({dir_name:n.uid,file_name:t.name});return await r.put("/user/workspaces/".concat(s.id),{image_url:l})},onSuccess:(e,s)=>{c.Am.success("Updated workspace avatar",{description:"Succesfully uploaded new workspace avatar"}),d.invalidateQueries({queryKey:A.E.all}),h()},onError:()=>{c.Am.error("Failed to update workspace avatar",{description:"Please try again"}),h()}}),f=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&await p({file:a,workspaceId:s.id})};return(0,a.jsxs)(g.z,{variant:"secondary",size:"icon-sm",className:(0,P.cn)("absolute -bottom-1 -right-2 h-5 w-5 rounded-sm border disabled:opacity-100",t),type:"button",disabled:x,onClick:()=>{var e;null===(e=m.current)||void 0===e||e.click()},children:[(0,a.jsx)("input",{type:"file",className:"hidden",accept:D.join(","),onChange:f,disabled:x,ref:m}),(0,a.jsx)(E.Z,{name:x?"progress_activity":"edit_square",size:"xsmall",className:x?"animate-spin":""})]})},T=d.z.object({name:d.z.string().min(1,"Workspace name is required"),description:d.z.string().optional()}),L=e=>{var s,t,l;let{workspace:c}=e,d=(0,o.cI)({defaultValues:{name:null!==(t=c.name)&&void 0!==t?t:"",description:null!==(l=c.description)&&void 0!==l?l:""},resolver:(0,n.F)(T)}),{authUser:m}=(0,u.Eu)(),{data:w}=(0,r.a)(_.t.workspaceMemberships({userId:null==m?void 0:m.uid,workspaceId:c.id})),S=null==w?void 0:null===(s=w.memberships.find(e=>e.user_id===(null==m?void 0:m.uid)))||void 0===s?void 0:s.role,E="owner"===S,z="member"===S,{leaveWorkspace:A,isLeavingWorkspace:P}=function(){let{setCurrentWorkspaceId:e}=(0,C.J1)(),s=(0,k.useRouter)(),{mutateAsync:t,isPending:a}=(0,i.D)({mutationFn:async e=>(0,N.SJ)().post("/user/workspaces/".concat(e,"/leave")),onSuccess:async()=>{e(null),s.push("/")}});return{leaveWorkspace:t,isLeavingWorkspace:a}}(),{updateWorkspace:O,isUpdatingWorkspace:D}=R({form:d,workspaceId:c.id});return(0,a.jsx)(x.tM,{title:"Workspace Settings",value:"workspace",description:"Workspaces allow you to collaborate on projects in real time.",docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(v.l0,{...d,children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:d.handleSubmit(e=>{O(e)}),children:[(0,a.jsx)(p.P,{label:"Workspace Avatar",description:"Set an avatar for your workspace.",mobileLayout:"horizontal",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.z,{className:"h-10 w-10",workspace:c}),("admin"===S||E)&&(0,a.jsx)(I,{workspace:c})]})}),(0,a.jsx)(p.P,{label:"Workspace Name",description:"Your full workspace name, as visible to others.",children:(0,a.jsx)(v.Wi,{control:d.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsxs)(v.xJ,{className:"w-full",children:[(0,a.jsx)(v.NI,{children:(0,a.jsx)(f.b,{showTooltip:z,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(b.I,{...s,placeholder:"Enter workspace name",disabled:z})})}),(0,a.jsx)(v.zG,{})]})}})}),(0,a.jsx)(p.P,{label:"Workspace Description",description:"A short description about your workspace or team.",isLast:E,children:(0,a.jsx)(v.Wi,{control:d.control,name:"description",render:e=>{let{field:s}=e;return(0,a.jsxs)(v.xJ,{className:"w-full",children:[(0,a.jsx)(v.NI,{children:(0,a.jsx)(f.b,{showTooltip:z,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(y.g,{rows:3,className:"border bg-background",placeholder:"Description",disabled:z,...s})})}),(0,a.jsx)(v.zG,{})]})}})}),!E&&(0,a.jsx)(p.P,{label:"Leave Workspace",description:"Leave the workspace (you will lose all access to projects inside this workspace).",isLast:!0,children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,a.jsxs)(j.Vq,{children:[(0,a.jsx)(j.hg,{asChild:!0,children:(0,a.jsx)(g.z,{variant:"destructive",type:"button",loading:P,children:"Leave Workspace"})}),(0,a.jsxs)(j.cZ,{size:"sm",children:[(0,a.jsxs)(j.fK,{children:[(0,a.jsx)(j.$N,{children:"Leave Workspace"}),(0,a.jsx)(j.Be,{children:"Are you sure you want to leave this workspace?"})]}),(0,a.jsxs)(j.cN,{children:[(0,a.jsx)(j.GG,{asChild:!0,children:(0,a.jsx)(g.z,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(g.z,{variant:"destructive",type:"button",loading:P,onClick:()=>A(c.id),children:"Leave Workspace"})]})]})]})})}),d.formState.isDirty&&(0,a.jsx)(p.j,{children:(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)(g.z,{variant:"secondary",type:"button",onClick:()=>{d.reset()},children:"Cancel"}),(0,a.jsx)(g.z,{variant:"affirmative",type:"submit",loading:D,children:"Update"})]})})]})})})};function R(e){let{form:s,workspaceId:t}=e,a=(0,l.NL)(),{authUser:n}=(0,u.Eu)(),{store:r}=(0,m.bm)(),{mutate:o,isPending:d}=(0,i.D)({mutationFn:async e=>{var s;return(0,N.SJ)().put("/user/workspaces/".concat(t),{name:e.name,description:null!==(s=e.description)&&void 0!==s?s:""})},onSuccess:e=>{var l,i,o;c.Am.success("Success",{description:"Workspace settings updated successfully"});let d=_.t.detail({workspaceId:t}).queryKey;a.setQueryData(d,s=>s?{...s,workspace:e}:{workspace:e,projects:[]});let u=_.t.workspaces({userId:null==n?void 0:n.uid}).queryKey;a.setQueryData(u,s=>s?{workspaces:s.workspaces.map(s=>s.id===e.id?e:s)}:{workspaces:[e]});let m=(null!==(l=null==r?void 0:r.getState().workspaces)&&void 0!==l?l:[]).map(s=>s.id===e.id?e:s);null==r||r.setState({workspaces:m}),s.reset({name:null!==(i=e.name)&&void 0!==i?i:"",description:null!==(o=e.description)&&void 0!==o?o:""})},onError:e=>{(0,w.Eo)(e)}});return{updateWorkspace:o,isUpdatingWorkspace:d}}},74751:function(e,s,t){t.d(s,{p:function(){return i}});var a=t(57437),n=t(35974),r=t(94508);let l={pro:"brand-twilight",admin:"brand-saffron",labs:"brand-twilight",internal:"secondary"},i=e=>{let{badge:s,className:t}=e;return(0,a.jsx)(n.C,{variant:l[s],className:(0,r.cn)("capitalize",t),children:s})}},32165:function(e,s,t){t.d(s,{P:function(){return l},j:function(){return i}});var a=t(57437),n=t(94508),r=t(74751);let l=e=>{let{children:s,label:t,className:l,isLast:i=!1,description:o,badges:c,customBadge:d,mobileLayout:u="vertical",justify:m="start",...h}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("relative grid gap-4 pb-4 last:border-b-0 md:grid md:grid-cols-2",{"border-b-0":i,"border-b":!i,"flex justify-between":"horizontal"===u,"grid-cols-1":"vertical"===u},l),...h,children:[(t||o)&&(0,a.jsxs)("div",{className:"flex-col gap-1 md:flex",children:[(0,a.jsxs)("p",{className:"flex flex-wrap items-center gap-x-1.5 text-base font-medium",children:[t,null==c?void 0:c.map(e=>(0,a.jsx)(r.p,{badge:e},e)),d]}),o&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:o})]}),(0,a.jsx)("div",{className:(0,n.cn)("flex items-center","end"===m&&"md:justify-end"),children:s})]})},i=e=>{let{children:s,className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("absolute inset-x-0 bottom-0 z-10 flex min-h-8 items-center border-t bg-background px-6 py-3 md:px-10",t),...r,children:s})}},66870:function(e,s,t){t.d(s,{QK:function(){return u},eD:function(){return d},tM:function(){return m},v_:function(){return c},yf:function(){return h}});var a=t(57437),n=t(20271),r=t(55157),l=t(57346),i=t(27132),o=t(94508);let c=e=>{let{children:s,className:t,...r}=e;return(0,a.jsx)(n.mQ,{className:(0,o.cn)("mt-0 flex w-full flex-1 flex-col items-start overflow-hidden md:flex-row",t),orientation:"vertical",...r,children:s})},d=e=>{let{children:s,className:t,hasActiveTab:r,...l}=e;return(0,a.jsxs)(n.dr,{className:(0,o.cn)("mt-[22px] flex h-full w-full flex-col gap-0.5 overflow-y-auto px-4 py-6 md:mt-0 md:w-[240px] md:flex-nowrap md:border-r",t,r?"hidden md:flex":"flex"),...l,children:[(0,a.jsx)(p,{hideBackButton:!0,className:"mt-[22px]",children:"Settings"}),s]})},u=e=>{let{children:s,className:t,...r}=e;return(0,a.jsx)(n.SP,{className:(0,o.cn)("flex min-h-10 w-full items-center justify-start gap-3 rounded-md px-2.5 py-2 text-start text-base data-[state=active]:bg-muted hover:bg-muted-hover md:min-h-8 md:w-auto md:gap-2 md:text-sm [&>svg]:size-5 md:[&>svg]:size-4",t),...r,children:s})},m=e=>{let{children:s,className:t,title:r,description:i,docsLink:c,descriptionAction:d,...u}=e;return(0,a.jsxs)(n.nU,{className:(0,o.cn)("flex max-h-full w-full flex-1 flex-col gap-6 overflow-y-auto px-6 pb-6 pt-20 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted-foreground data-[state=inactive]:hidden focus:outline-none md:px-10 md:pt-6",t),...u,children:[r&&(0,a.jsxs)("div",{className:"hidden w-full flex-col gap-2 border-b pb-3 md:flex",children:[(0,a.jsx)("h4",{className:"text-lg font-medium",children:r}),i&&(0,a.jsxs)("p",{className:(0,o.cn)("flex items-start justify-between gap-2 text-sm text-muted-foreground"),children:[(0,a.jsx)("div",{className:"",children:i}),c&&(0,a.jsxs)("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-muted-foreground duration-150 ease-in-out hover:text-muted-foreground/80",children:[(0,a.jsx)(l.Z,{name:"help",size:"small"}),"Docs"]}),d&&d]})]}),(0,a.jsx)(p,{descriptionAction:d,children:r}),s]})},h=e=>{let{title:s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("mb-1 mt-6 px-3 text-sm font-medium text-muted-foreground first:mt-0 md:text-xs"),children:s})},p=e=>{let{children:s,className:t,hideBackButton:n=!1,descriptionAction:c,...d}=e,{openSettings:u}=(0,r.r)();return(0,i.Z)("md")?(0,a.jsxs)("div",{className:(0,o.cn)("absolute inset-x-0 top-0 z-20 flex min-h-8 items-center justify-between border-b bg-background px-2 py-3 md:hidden",t),...d,children:[(0,a.jsx)("div",{className:"flex items-baseline",children:!n&&(0,a.jsxs)("button",{className:(0,o.cn)("flex items-center gap-1 text-base md:text-sm"),onClick:()=>u(),children:[(0,a.jsx)(l.Z,{name:"chevron_left",size:"default"})," Settings"]})}),(0,a.jsx)("div",{className:"absolute left-1/2 flex -translate-x-1/2 items-baseline justify-center text-center text-lg font-medium",children:s}),(0,a.jsx)("div",{className:"flex min-h-7 items-baseline pr-0.5",children:c})]}):null}},30811:function(e,s,t){t.d(s,{B:function(){return m}});var a=t(57437),n=t(35974),r=t(94508),l=t(54616),i=t(78276),o=t(57346);let c=/[,;\n\t]+/g,d=/\s+/g,u=e=>e.replace(c," ").replace(d," ").trim().split(" ").map(e=>e.trim()).filter(e=>""!==e),m=e=>{let{tags:s,setTags:t,inputValue:c,setInputValue:d,placeholder:m="Type and press Enter...",className:h="",...p}=e,x=e=>{s.includes(e)||""===e.trim()||t([...s,e]),d("")},g=e=>{t(s.filter((s,t)=>t!==e))};return(0,a.jsxs)("div",{className:(0,r.cn)("flex min-h-9 w-full min-w-0 flex-wrap items-center gap-1.5 overflow-hidden rounded-md border border-input bg-transparent p-2 py-1.5 text-sm shadow-sm transition-colors focus-within:ring-1 focus-within:ring-ring",h),children:[s.map((e,s)=>{let t=(0,l.Jh)(e);return(0,a.jsx)(i.b,{showTooltip:!t,tooltipContent:"This is not a valid email.",instant:!0,className:"min-w-0",children:(0,a.jsxs)(n.C,{variant:"secondary",className:"flex min-w-0 cursor-default items-center gap-1 rounded-sm px-1 py-0 text-xs font-medium",children:[!t&&(0,a.jsx)(o.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 max-w-[160px] overflow-hidden truncate md:whitespace-nowrap",children:e}),(0,a.jsx)("button",{type:"button",className:"flex-shrink-0 rounded-sm duration-100 ease-out hover:bg-muted-hover",onClick:()=>g(s),children:(0,a.jsx)(o.Z,{name:"close_small"})})]})},s)}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key&&" "!==e.key||e.metaKey||""===c.trim()?"Backspace"===e.key&&""===c&&s.length>0&&g(s.length-1):(e.preventDefault(),x(c.trim()))},onPaste:e=>{e.preventDefault();let a=u(e.clipboardData.getData("text")),n=new Set(s),r=[...s];a.forEach(e=>{let s=""!==e.trim();!n.has(e)&&s&&(r.push(e),n.add(e))}),t(r)},placeholder:m,className:"min-w-[80px] flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground",...p})]})};m.displayName="TagsInput"},99153:function(e,s,t){t.d(s,{O:function(){return o}});var a=t(57437),n=t(78298),r=t(55721),l=t(57346),i=t(27132);let o=()=>{let e=(0,i.Z)("md"),{theme:s,setTheme:t}=(0,n.F)();return e?null:(0,a.jsxs)(r.Ph,{children:[(0,a.jsxs)(r.kt,{children:[(0,a.jsx)(l.Z,{name:"contrast"}),(0,a.jsx)("p",{children:"Appearance"})]}),(0,a.jsx)(r.cq,{children:(0,a.jsx)(r.TG,{children:(0,a.jsxs)(r._x,{value:s,onValueChange:e=>{("light"===e||"dark"===e||"system"===e)&&t(e)},children:[(0,a.jsx)(r.qB,{value:"light",children:"Light"}),(0,a.jsx)(r.qB,{value:"dark",children:"Dark"}),(0,a.jsx)(r.qB,{value:"system",children:"System theme"})]})})})]})}},35194:function(e,s,t){t.d(s,{CreateWorkspaceDialog:function(){return k}});var a=t(57437),n=t(27648),r=t(2265),l=t(14438),i=t(6812),o=t(6371),c=t(7309),d=t(62869),u=t(95186),m=t(26815),h=t(65269),p=t(94508),x=t(29827),g=t(21770),f=t(52558),j=t(61922),v=t(108),b=t(64040),y=t(49131),w=t(89668);let N=e=>{let{closeDialog:s}=e,t=(0,x.NL)(),{setCurrentWorkspaceId:a}=(0,j.J1)(),{store:n}=(0,i.bm)(),{authUser:r}=(0,f.Eu)(),{toCheckout:o}=(0,v.m)(),{mutate:c,isPending:d}=(0,g.D)({mutationFn:async e=>{let{name:s}=e;return(0,y.SJ)().post("/user/workspaces",{name:s})},onSuccess:async(e,i)=>{var c;let{plan:d}=i,u=w.t.workspaces({userId:null==r?void 0:r.uid}).queryKey;t.setQueryData(u,s=>({workspaces:[...(null==s?void 0:s.workspaces)||[],e]}));let m=w.t.detail({workspaceId:e.id}).queryKey;t.setQueryData(m,{workspace:e,projects:[]}),null==n||n.setState({workspaces:[...null!==(c=null==n?void 0:n.getState().workspaces)&&void 0!==c?c:[],e]}),a(e.id);try{if(!e.id)throw Error("Workspace ID is required");await o({plan:d,workspaceId:e.id}),l.Am.success("Workspace created successfully",{description:e.name})}finally{s()}},onSettled:e=>{e&&(t.invalidateQueries({queryKey:w.t.workspaces({userId:null==r?void 0:r.uid}).queryKey}),t.invalidateQueries({queryKey:w.t.detail({workspaceId:e.id}).queryKey}))},onError:e=>{(0,b.Eo)(e)}});return{createWorkspace:c,isCreatingWorkspace:d}},_={name:{title:"Create a Workspace",description:"Create a new place to make projects or collaborate with others."},plan:{title:"Select a Plan",description:"Select a plan for your new workspace."}},k=()=>{let e=(0,i.Q)(e=>e.showCreateWorkspaceDialog),s=(0,i.Q)(e=>e.setShowCreateWorkspaceDialog),[t,n]=(0,r.useState)("name"),{title:l,description:o}=_[t];return(0,a.jsx)(h.v,{title:l,description:o,open:e,onOpenChange:e=>{e||n("name"),s(e)},className:"plan"===t?"max-w-[500px]":"",children:(0,a.jsx)(C,{closeDialog:()=>{n("name"),s(!1)},step:t,setStep:n})})},C=e=>{let{closeDialog:s,step:t,setStep:n}=e,[i,o]=(0,r.useState)(""),{createWorkspace:d,isCreatingWorkspace:u}=N({closeDialog:s}),m=c.qI.planOptions[0],[h,p]=(0,r.useState)(m);return(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),"name"===t){if(""===i){l.Am.error("Workspace name is required");return}n("plan");return}null!==h&&d({name:i,plan:h})},className:"flex flex-col gap-4",children:[(0,a.jsx)(S,{step:t,workspaceName:i,setWorkspaceName:o,closeDialog:s,setStep:n}),(0,a.jsx)(E,{step:t,plan:h,setPlan:p,setStep:n,workspaceName:i,isCreatingWorkspace:u})]})},S=e=>{let{step:s,workspaceName:t,setWorkspaceName:n,closeDialog:r,setStep:l}=e;return(0,a.jsxs)("div",{className:(0,p.cn)("hidden flex-col gap-4","name"===s&&"flex"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 px-1",children:[(0,a.jsx)(m.Label,{children:"Workspace Name"}),(0,a.jsx)(u.I,{id:"workspaceName",value:t,onChange:e=>n(e.target.value),placeholder:"Enter workspace name",required:!0})]}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6 px-1 pb-1",children:[(0,a.jsx)(d.z,{type:"button",className:"flex-1",variant:"secondary",onClick:r,children:"Go Back"}),(0,a.jsx)(d.z,{className:"flex-1",disabled:!t,type:"button",onClick:()=>l("plan"),children:"Continue to Plan"})]})]})},E=e=>{let{step:s,plan:t,setPlan:r,setStep:l,workspaceName:i,isCreatingWorkspace:u}=e,m=t===c.qI.planOptions[0];return(0,a.jsxs)("div",{className:(0,p.cn)("hidden flex-col gap-4","plan"===s&&"flex"),children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-2",children:[(0,a.jsxs)(o._b,{name:"Pro",price:c.qI.planOptions[0].monthlyPrice,description:"For more projects and usage",highlighted:m,children:[(0,a.jsx)(o.ak,{type:"button",onClick:()=>r(c.qI.planOptions[0]),variant:m?"affirmative":"default",className:"cursor-default hover:opacity-100",children:m?"Selected":"Select"}),(0,a.jsx)(o.jq,{label:"Everything in Free, plus:",features:["100+ credits per month","Private projects","Remove the Lovable badge","Custom domains","Role based access"]})]}),(0,a.jsxs)(o._b,{name:"Enterprise",price:0,description:"For custom needs",highlighted:!1,hidePrice:!1,customPriceLabel:"Custom",children:[(0,a.jsx)(d.z,{type:"button",asChild:!0,className:"w-full whitespace-nowrap bg-brand-twilight text-brand-twilight-foreground hover:bg-brand-twilight/80",children:(0,a.jsx)(n.default,{target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"})}),(0,a.jsx)(o.jq,{label:"Everything in Pro, plus:",features:["Dedicated support","Custom integrations","SSO","Opt out of data training"]})]})]}),(0,a.jsxs)("div",{className:"mt-2 flex w-full gap-6 px-1 py-1",children:[(0,a.jsx)(d.z,{type:"button",className:"flex-1",variant:"secondary",onClick:()=>l("name"),children:"Go Back"}),(0,a.jsx)(d.z,{type:"submit",className:"flex-1",disabled:null===t||!i||u,loading:u,children:u?"Creating...":"Create Workspace"})]})]})}},65269:function(e,s,t){t.d(s,{v:function(){return u}});var a=t(57437),n=t(49027),r=t(95098),l=t(2265),i=t(62869),o=t(57346),c=t(41135),d=t(94508);let u=e=>{let{title:s,description:t,children:u,open:m,onOpenChange:h,className:p}=e;return(0,l.useEffect)(()=>(m?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[m]),(0,a.jsx)(n.Vq,{open:m,onOpenChange:h,children:(0,a.jsx)(n.PK,{children:(0,a.jsxs)(n.cZ,{className:"fixed inset-0 z-[10000] flex items-center justify-center bg-background px-4 md:px-0",onCloseAutoFocus:e=>{e.preventDefault(),document.body.style.pointerEvents=""},children:[(0,a.jsxs)(r.TX,{children:[(0,a.jsx)(n.$N,{children:s}),(0,a.jsx)(n.Be,{children:t})]}),(0,a.jsxs)("div",{className:(0,d.cn)("flex max-w-96 flex-col gap-6 overflow-auto",p),children:[(0,a.jsx)(c.xx,{className:"size-9 shrink-0"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h2",{className:"mr-auto text-2xl md:text-3xl",children:s}),(0,a.jsx)("p",{className:"w-full",children:t})]}),u]}),(0,a.jsx)("div",{className:"absolute right-2 top-2 md:right-8 md:top-8",children:(0,a.jsx)(n.GG,{asChild:!0,children:(0,a.jsx)(i.z,{className:"hover:bg-transparent hover:opacity-75",variant:"ghost",children:(0,a.jsx)(o.Z,{name:"close",size:"small"})})})})]})})})}},82157:function(e,s,t){t.d(s,{w:function(){return c}});var a=t(57437),n=t(2265),r=t(55721),l=t(57346),i=t(94508),o=t(81103);let c=e=>{let{label:s,isSelected:t,onClick:c,disabled:d,className:u,destructive:m,tooltip:h}=e,[p,x]=(0,n.useState)(!1);return(0,a.jsxs)(o.u,{open:void 0!==h&&p,onOpenChange:x,children:[(0,a.jsx)(o.aJ,{asChild:!0,children:(0,a.jsxs)(r.Xi,{onClick:c,disabled:d,className:(0,i.cn)("flex items-center justify-between",{"bg-muted":t,"cursor-default":d,"text-destructive-primary focus:bg-destructive focus:text-destructive-foreground":m},u),children:[s,t&&(0,a.jsx)(l.Z,{name:"check",size:"small"})]})}),(0,a.jsx)(o._v,{side:"right",className:"max-w-[30ch]",children:h})]})}},65613:function(e,s,t){t.d(s,{Cd:function(){return c},X:function(){return d},bZ:function(){return o}});var a=t(57437),n=t(77712),r=t(2265),l=t(94508);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg]:absolute [&>svg]:text-foreground [&>svg]:left-4 [&>svg]:top-4 [&>svg+div]:translate-y-[-3px] [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground bg-destructive border-destructive-foreground dark:border-destructive-foreground [&>svg]:text-destructive-foreground",warning:"text-warning-foreground bg-warning border-warning-foreground dark:border-warning-foreground [&>svg]:text-warning-foreground",affirmative:"text-affirmative-foreground bg-affirmative border-affirmative-foreground dark:border-affirmative-foreground [&>svg]:text-affirmative-foreground"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,s)=>{let{className:t,variant:n,...r}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,l.cn)(i({variant:n}),t),...r})});o.displayName="Alert";let c=r.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("h5",{ref:s,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",t),...n})});c.displayName="AlertTitle";let d=r.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",t),...n})});d.displayName="AlertDescription"},5073:function(e,s,t){t.d(s,{Yi:function(){return o},bZ:function(){return c},zs:function(){return i}});var a=t(57437),n=t(2265),r=t(16605),l=t(94508);let i=r.fC,o=r.xz,c=n.forwardRef((e,s)=>{let{className:t,align:n="center",sideOffset:i=4,...o}=e;return(0,a.jsx)(r.VY,{ref:s,align:n,sideOffset:i,className:(0,l.cn)("z-50 w-64 origin-[--radix-hover-card-content-transform-origin] rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})});c.displayName=r.VY.displayName},32759:function(e,s,t){t.d(s,{E:function(){return i}});var a=t(57437),n=t(60610),r=t(2265),l=t(94508);let i=r.forwardRef((e,s)=>{let{className:t,value:r,...i}=e;return(0,a.jsx)(n.fC,{ref:s,className:(0,l.cn)("relative h-4 w-full overflow-hidden rounded-full bg-muted-active",t),...i,children:(0,a.jsx)(n.z$,{className:"h-full w-full flex-1 bg-brand-twilight-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});i.displayName=n.fC.displayName},6512:function(e,s,t){t.d(s,{Separator:function(){return i}});var a=t(57437),n=t(55156),r=t(2265),l=t(94508);let i=r.forwardRef((e,s)=>{let{className:t,orientation:r="horizontal",decorative:i=!0,...o}=e;return(0,a.jsx)(n.f,{ref:s,decorative:i,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t),...o})});i.displayName=n.f.displayName},1828:function(e,s,t){t.d(s,{r:function(){return i}});var a=t(57437),n=t(50721),r=t(2265),l=t(94508);let i=r.forwardRef((e,s)=>{let{className:t,thumbClassName:r,...i}=e;return(0,a.jsx)(n.fC,{className:(0,l.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...i,ref:s,children:(0,a.jsx)(n.bU,{className:(0,l.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0",r)})})});i.displayName=n.fC.displayName},61563:function(e,s,t){t.d(s,{G:function(){return d},t:function(){return c}});var a=t(57437),n=t(90175),r=t(2265),l=t(63611),i=t(94508);let o=r.createContext({size:"default",variant:"default"}),c=r.forwardRef((e,s)=>{let{className:t,variant:r,size:l,children:c,...d}=e;return(0,a.jsx)(n.fC,{ref:s,className:(0,i.cn)("flex items-center justify-center gap-1",t),...d,children:(0,a.jsx)(o.Provider,{value:{variant:r,size:l},children:c})})});c.displayName=n.fC.displayName;let d=r.forwardRef((e,s)=>{let{className:t,children:c,variant:d,size:u,...m}=e,h=r.useContext(o);return(0,a.jsx)(n.ck,{ref:s,className:(0,i.cn)((0,l.E)({variant:h.variant||d,size:h.size||u}),t),...m,children:c})});d.displayName=n.ck.displayName},63611:function(e,s,t){t.d(s,{E:function(){return o},Z:function(){return c}});var a=t(57437),n=t(9987),r=t(77712),l=t(2265),i=t(94508);let o=(0,r.j)("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-accent focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,s)=>{let{className:t,variant:r,size:l,...c}=e;return(0,a.jsx)(n.f,{ref:s,className:(0,i.cn)(o({variant:r,size:l,className:t})),...c})});c.displayName=n.f.displayName},81677:function(e,s,t){t.d(s,{GD:function(){return o},Zl:function(){return c},Hp:function(){return h},Mn:function(){return m}});var a=t(14438),n=t(91115),r=t(21288);let l="https://github.com/login/oauth/authorize?client_id=".concat("Iv1.365d6a195dbca85b"),i="https://github.com/apps/".concat("lovable-dev","/installations/new"),o="githubOAuthNonce",c=n.z.object({nonce:n.z.string(),workspaceId:n.z.string().optional()}),d=e=>(null==e?void 0:e.id)?"".concat(i,"/permissions?target_id=").concat(e.id,"&target_type=").concat(e.type):i,u=(e,s)=>{let t=crypto.randomUUID();try{localStorage.setItem(o,t)}catch(e){r.logging.error("Failed to set state in GitHub OAuth popup"),a.Am.error("Failed to initiate GitHub OAuth flow",{description:"Try clearing browser local storage and try again."});return}let n=(null==s?void 0:s.workspaceId)?{nonce:t,workspaceId:s.workspaceId}:{nonce:t,workspaceId:void 0},l=new URL(e);l.searchParams.set("state",btoa(JSON.stringify(n))),e=l.toString();let i=window.open(e,"_blank","width=600,height=700,left=100,top=100");if(!i){r.logging.error("Failed to open GitHub OAuth popup");return}i.focus()},m=e=>{let{githubOwner:s,workspaceId:t}=e;u(d(s),{workspaceId:t})},h=()=>{u(l)}},33910:function(e,s,t){t.d(s,{D:function(){return i}});var a=t(92850),n=t(2265),r=t(60256),l=t(79804);let i=e=>{var s,t,i,o;let{enabled:c}=e,{userData:d}=(0,r.SE)(),u=(0,a.a)(l.V.installations({enabled:c})),m=null==d?void 0:null===(s=d.github)||void 0===s?void 0:s.encrypted_access_token,h=(0,n.useRef)(m);return(0,n.useEffect)(()=>{h.current!==m&&(u.refetch(),h.current=m)},[m,u]),{isLoading:u.isLoading,installations:null===(t=u.data)||void 0===t?void 0:t.installations,hasAccessToken:null===(i=u.data)||void 0===i?void 0:i.has_access_token,hasValidAccessToken:null===(o=u.data)||void 0===o?void 0:o.has_valid_access_token}}},59709:function(e,s,t){t.d(s,{G:function(){return i},d:function(){return c}});var a=t(29827),n=t(2265),r=t(14438),l=t(91115);let i="mcp_oauth_data",o=l.z.object({type:l.z.literal("mcpAuth"),success:l.z.boolean(),error:l.z.string().optional()}),c=e=>{let{workspaceId:s,onConnectSuccess:t,onConnectError:l,enabled:i=!0}=e,c=(0,a.NL)();(0,n.useEffect)(()=>{if(!i)return;let e=async e=>{if(e.origin!==window.location.origin)return;let a=o.safeParse(e.data);a.success&&(a.data.success?(r.Am.success("Authorization successful!"),await c.invalidateQueries({queryKey:["mcp-servers",s]}),t&&t()):(r.Am.error(a.data.error||"OAuth authorization failed"),l&&l()))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[c,s,t,l,i])}},10441:function(e,s,t){t.d(s,{c:function(){return l}});var a=t(52274),n=t(49131),r=t(97318);let l={domains:e=>{let{projectId:s,enabled:t=!0}=e;return(0,a.C)({queryKey:r.iZ.domains(s),queryFn:async()=>(0,n.SJ)().get("/projects/".concat(s,"/domains")),refetchOnMount:!1,refetchOnWindowFocus:!1,enabled:t&&!!s,staleTime:3e5,retry:!1})}}},51408:function(e,s,t){t.d(s,{V:function(){return i}});var a=t(52274),n=t(49131),r=t(21288),l=t(97318);let i={workspace:e=>{let{workspaceId:s,userData:t}=e;return(0,a.C)({queryKey:l.TZ.workspace(s),queryFn:async()=>{let e=(0,n.SJ)();return(await e.get("/user/workspaces/".concat(s))).workspace},enabled:!!t&&!!s})},workspaces:e=>{let{userData:s}=e;return(0,a.C)({queryKey:l.TZ.workspaces(),queryFn:async()=>{let e=(0,n.SJ)();return await e.get("/user/workspaces")},enabled:!!s})},experimentalFeatures:e=>{let{user:s}=e;return(0,a.C)({queryKey:l.TZ.experimentalFeatures(),enabled:!!s&&!!s.idToken,refetchOnWindowFocus:!1,queryFn:async()=>{let e=(0,n.SJ)();try{return await e.get("/users/".concat(null==s?void 0:s.uid,"/experimental-features"))}catch(e){return r.logging.error("Failed to fetch experimental features",{error:e}),null}}})},contributions:e=>{let{userData:s}=e;return(0,a.C)({queryKey:l.TZ.contributions(null==s?void 0:s.id),queryFn:async()=>(null==s?void 0:s.id)?(0,n.SJ)().get("/users/".concat(s.id,"/contributions")):{},enabled:!!(null==s?void 0:s.username)})},publicProfile:e=>{let{username:s}=e;return(0,a.C)({queryKey:l.TZ.profile(s),queryFn:()=>(0,n.Tb)().get("/profile/".concat(s)),enabled:!!s,retry:!1})}}},74225:function(e,s,t){t.d(s,{P:function(){return a}});let a=e=>e.replace(/(^\w+:|^)\/\//,"")},54616:function(e,s,t){t.d(s,{Jh:function(){return l},UM:function(){return o},hO:function(){return i}});var a=t(91115);let n=a.z.string().min(1,"Email is required").email("Please enter a valid email address"),r=a.z.array(n).max(3,"You can invite up to 3 team members").refine(e=>new Set(e.map(e=>e.toLowerCase())).size===e.length,{message:"Duplicate email addresses are not allowed"});function l(e){return n.safeParse(e).success}function i(e){let s=e.filter(e=>""!==e.trim());return r.safeParse(s)}function o(e,s){let t=e.filter(e=>""!==e.trim()),a=r.safeParse(t),l=[null,null,null];for(let s=0;s<3;s++){let t=e[s];if(t&&t.trim()){let e=n.safeParse(t);if(!e.success){var i;l[s]=(null===(i=e.error.errors[0])||void 0===i?void 0:i.message)||"Invalid email address"}}}let o=[];return a.success||(o=a.error.errors.filter(e=>0===e.path.length).map(e=>e.message)),s&&t.some(e=>e.trim().toLowerCase()===s.trim().toLowerCase())&&o.push("You cannot invite yourself"),{globalErrors:o,fieldErrors:l}}}}]);